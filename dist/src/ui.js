const a13_0x158406=a13_0x1b54;function a13_0x3744(){const _0x25f019=['KCtIF','cleanability','Error\x20loading\x20machines','zMBAV','LpZBM','BYGYZ','Hide\x20PDE','length','nZQKs','machineStageDisplayOrder','Vybvu','toggle-pm-','innerHTML','products','add','Failed\x20to\x20export\x20Train\x20Summary\x20data\x20to\x20Excel.','iHrvl','jyaXu','ZWAMD','TSbBZ','yqwot','true','Product_MACO_Report','textContent','No\x20trains\x20match\x20the\x20selected\x20criteria.','setScoringWasInEditModeForPrint','Yqjkx','dIUnb','push','lwZFZ','khCIl','bodyWeight','renderMacoForTrains','./macoProductView.js','iUlpO','ghWAP','sort','jnPlR','LdcaG','input','Show\x20PDE','\x20.mainTable,\x20#','isCritical','solubility','\x20-\x20','printSelectedTrain','ThNvv','setMachineStageDisplayOrder','EcEZZ','aputv','renderWorstCaseByTrain','duiuL','FmqyL','There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','MACO_Machines_','hPYIH','juFlF','jELTk','XzEuw','aPsgG','Health-Based\x20Limit\x20(ADE)','No\x20Data','flex','detergentMaco','macoDetergentIngredients','gpKXv','WHJcv','parse','!cols','VVoiP','iZvEe','AGbic','qBusd','WZwSI','uowIQ','area','./trainSummaryView.js','Success','zZvTq','hAQQT','Show\x20LD50','QZgNm','MSJRJ','ueMiM','sRMyI','kmxYm','ONDNS','mddMg','join','split','OQYCA','hide-pde','SNbQc','addEventListener','cVItA','GLFWy','FolMW','Error\x20loading\x20products','download','99iKlaJc','trainId','NuGBx','Failed\x20to\x20export\x20Product\x20MACO\x20data\x20to\x20Excel.','JKjMX','Error\x20loading\x20train\x20summary\x20view:','Critical\x20Products','CnKAD','Error\x20creating\x20Train\x20Summary\x20sheet:','setDetergentIngredients','12881gCnKxu','hide-ld50','macoProducts','Failed\x20to\x20export\x20machines\x20data\x20to\x20Excel.','assumedSsa','kVqIo','dfSVn','SWBiB','NWgpF','Trains\x20','block','osWuF','dEZmM','minMbsKg','HvnmS','cJwmn','sUkWJ','filter','finally','fMOfr','all','ALKnH','createObjectURL','woUkE','setScoringCriteria','lvAlY','aaHff','button','dark','lkjee','osRKD','toggle-','YJtTL','nZCyV','result','Other','productType','max','PLOrJ','uJEnv','maco-breakdown-details-','hhqvj','sfyNV','GbJnb','machineNumber','macoChartInstance','name','qXQEs','toExponential','TNuwY','hmWWO','message','Show\x20MACO\x20Calculation\x20Breakdown','xLivL','qZFNK','renderDetergentMaco','Train\x20Summary\x20Report','macoMachines','\x20-\x20Worst\x20Case\x20Analysis','776648QQdvnJ','therapeuticDoseScore','LKOjY','SEaoE',')\x20-\x20RPN:\x20','find','UtRMv','Machines','AZQos','rjait','oUSAs','vmMQE','ugJkp','shjxn','hidden','iOafQ','batchSizeKg','Train\x20summary\x20container\x20is\x20hidden\x20or\x20missing','ingredientName','dtiKw','RdVgi','remove','TmHWD','joTul','JxQLG','json_to_sheet','Invalid\x20JSON\x20file\x20structure.','Error\x20loading\x20detergent\x20view\x20for\x20print:','min','BMrQW','disabled','target','\x20.ingredients-sub-table','jjLOW','Top\x2010\x20RPN','pde','Hide','toggle-dm-','sLkFX','files','bHpKt','OFCNR','ld50','mwBNT','YsjPh','wxoSy','ArcXB','Error\x20creating\x20Top\x2010\x20RPN\x20sheet:','Product\x20MACO','FHYTP','zrRGe','Error\x20creating\x20Critical\x20Products\x20sheet:','pLRzJ','dNJtD','jzqsP','Complete\x20report\x20with\x20all\x20tabs\x20exported\x20to\x20Excel\x20successfully!','gthSs','hFGeM','Train\x20Summary','solubilityScore','removeEventListener','pdeScore','There\x20is\x20no\x20data\x20in\x20the\x20current\x20view\x20to\x20export.','scoring-system','gMcIk','AmgeS','KehAD','createElement','productRegister-pdeHidden','eoBMc','4616370uhqSYr','loader','startsWith','MACO\x20Report','None','aBIWP','Detergent_MACO_Report_','pLOan','onload','UGsgp','DkHGo','SMWjE','safetyFactorConfig','Detergent\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','sortValue','FOBEd','viewProducts','lAFTD','stringify','utils','stage-','rpnRatingText','shxcQ','XoMFl','pSqeu','therapeuticDose','ZFEQo','KdqGI','.xlsx','keys','TvLii','getItem','gmsqy','./utils.js','tKmhw','detection','RJrfI','FcZSU','ZsmYD','setItem','scoringCriteria','toggle','10\x20ppm\x20Criterion','Error\x20exporting\x20Product\x20MACO\x20to\x20Excel:','evBwW','getElementById','iJWBA','EqKyU','349265pqrbEL','\x20.train-content-inner','minBsMddRatio','worstProductRpn','forEach','productRegister','theme-toggle-light-icon','ZryVh','qMXIs','Error\x20exporting\x20machines\x20to\x20Excel:','lowestPde','No\x20train\x20data\x20to\x20print.\x20Please\x20ensure\x20you\x20have\x20created\x20trains\x20first.','not\x20found','Yes','Error\x20loading\x20scoring\x20criteria','lqbTs','worstCaseProducts','productCode','VLmoQ','Error\x20exporting\x20Detergent\x20MACO\x20to\x20Excel:','wSFFX','N/A','.toggle-ld50','-pdeHidden','Error','appendChild','GVieg','WRxGf','SLYcU','HGFCE','RKMdH','error','zSgoX','nTBWE','BMZhH','LDopZ','rpKze','Train\x20Summary\x20data\x20exported\x20to\x20Excel\x20successfully!','obmGo','FNEAK','CEoUT','1190RJPMGf','UfbCx','xdXcK','sf-input-train-','wysUj','stage','No\x20trains\x20message\x20display:','kbquR','dUfse','Failed\x20to\x20export\x20Detergent\x20MACO\x20data\x20to\x20Excel.','jRNPn','126guNGeW','LZrXl','\x20.mainTable.hide-','collapsed','Apfzn','BieHf','DQZIp','history','njiwD','criticalReason','number','azNzy','0.1%\x20Therapeutic\x20Dose','Failed\x20to\x20save\x20data\x20to\x20localStorage','toLocaleDateString','trainSummaryContainer','macoForTrains','./worstCaseView.js','cbvCp','zPJYM','productName','Machines\x20data\x20exported\x20to\x20Excel\x20successfully!','product-sf-input','vFllW','UGbln','ySDRo','vSbAu','KcpYZ','renderTrainSummary','vicbF','tKJnF','NCXFJ','Complete_MACO_Report_','isArray','cQcEm','ZQnGS','aCimi','setHistory','MACO_Worst_Case_Products','YHTQo','vDjCr','LsUMq','Worst\x20Case\x20Products','iwjpS','qgNCg','Error\x20creating\x20All\x20Products\x20sheet:','ijEnb','TZHDN','vSbJA','button[onclick=\x22toggleColumnVisibilityDropdown()\x22]','body','lowestLtd','Hide\x20LD50','Train:','reduce','rMLkm','activeIngredients','closest','cleanabilityScore','Visual\x20Clean\x20Limit','hPMrP','Train\x20','ARvnV','detergentIngredients','keGDs','Container\x20has\x20content:','_Trains_','avAJe','There\x20are\x20no\x20detergent\x20ingredients\x20configured.\x20Add\x20detergent\x20ingredients\x20first.','toISOString','All\x20Products','scoringInEditMode','Error\x20exporting\x20Summary\x20to\x20Excel:','setProducts','UjALW','Setting\x20printSelectedTrain\x20to:','setMachines','fWKLp','OJMQr','xFHWA','NBYqJ','rpnChartInstance','Unknown\x20(ID:\x20','KJUhF','\x20\x20└─\x20','content-dm-','CAGGl','customAlertMessage','hyPro','map','Beril','parentElement','writeFile','yYaRI','glbFN','ssbzg','150bvjMYi','#macoForTrains\x20.train-content.collapsed','machineIds','./macoDetergentView.js','rkKYF','YjUJk','BAHfJ','grser','qOihr','warn','breakdown-toggle-btn-','SZyHC','RxVxb','renderRpnChart','catch','iVOjS','then','PRODUCT','PwMwa','3205377xgiOhx','uiftK','bMgJB','classList','book_append_sheet','Hide\x20MACO\x20Calculation\x20Breakdown','FVwQN','.toggle-pde','trim','#productRegister\x20.mainTable.hide-','iZeQa','gbjox','kBdql','Hssrh','machineStage-','rpn','ljuJE','Ofcis',',\x20#','JslET','Error\x20exporting\x20worst\x20case\x20to\x20Excel:','jMUiS','gwvWD','hhufu','removeChild','sf-input-train','macoScoringCriteria','bqChW','1904072tevIJQ','TEBXQ','lsJGt','MuRrL','Product\x20MACO\x20Report','dJcIU','date','querySelector','querySelectorAll','includes','iXGFO','print','log','content-','slice','TUjhp','MXhTp','ztyTV','productRegister-ld50Hidden','XQHkZ','orFro','_Train_','readAsText','JwHTb','aKlkA','style','contains','WelvE','Ngthx','XnKVY','mfgeW','match','14350XyYJeo','Hidden','elvTB','SSTjR','click','UWjCB','fHQZM','aelFK','RVkkh','OEJHg','application/json','Error\x20exporting\x20Train\x20Summary\x20to\x20Excel:','Failed\x20to\x20export\x20Summary\x20report\x20data\x20to\x20Excel.','ld50Score','required','book_new','Failed\x20to\x20export\x20data\x20to\x20JSON.','Error\x20exporting\x20to\x20Excel:','YOWQe','nYJPY','hDHWU','DDOgq','nnbRy','Eyrsa','There\x20are\x20no\x20machines\x20to\x20export.','IMVcP','oqYzD','mvaIu','EOQnU','ltdMg','Product\x20Register','ZVoVb','FGOZj','FvvGs','columnVisibilityDropdown','flatMap','content-pm-','BGnqa','Adgww','WRiqI','rxRqg','FLBXM','yltiE','qDNvb','Detergent\x20MACO\x20Report','MfMTi','toLocaleString','eaJpX','VZJpH','wmtAH','toFixed','Error\x20exporting\x20all\x20tabs\x20to\x20Excel:','VoUMI','trainSummary','none','Error\x20creating\x20Product\x20MACO\x20sheet:','MACO_All_Products_Report.xlsx','\x20not\x20found\x20or\x20has\x20no\x20products.','MpqXG','essa','redo-btn','YWmQf','Data\x20imported\x20successfully.','OJGZY','pdeMg','value','noTrainSummaryMessage','EKzWZ','IeUJI','historyIndex','Show','severity','productRegister-','customAlertModal','-hidden','EGIPd','display','zaPud','Failed\x20to\x20export\x20data\x20to\x20Excel.','vVnxA','SYsQD','machines','OOGUZ','documentElement'];a13_0x3744=function(){return _0x25f019;};return a13_0x3744();}(function(_0x44bef6,_0x13e45e){const _0x303674=a13_0x1b54,_0x33c4a8=_0x44bef6();while(!![]){try{const _0xbd3e07=parseInt(_0x303674(0x120))/0x1*(parseInt(_0x303674(0x16f))/0x2)+parseInt(_0x303674(0x133))/0x3+-parseInt(_0x303674(0x14f))/0x4+-parseInt(_0x303674(0x2b1))/0x5+-parseInt(_0x303674(0x315))/0x6*(-parseInt(_0x303674(0x2e1))/0x7)+-parseInt(_0x303674(0x26b))/0x8*(parseInt(_0x303674(0x226))/0x9)+-parseInt(_0x303674(0x30a))/0xa*(parseInt(_0x303674(0x230))/0xb);if(_0xbd3e07===_0x13e45e)break;else _0x33c4a8['push'](_0x33c4a8['shift']());}catch(_0x271ec1){_0x33c4a8['push'](_0x33c4a8['shift']());}}}(a13_0x3744,0x8f0f4));import*as a13_0x20cf21 from'./state.js';import{fullAppRender as a13_0xf47647}from'./app.js';import{generateTrainMap as a13_0x28854b}from'./utils.js';function a13_0x1b54(_0x35b3a1,_0x1089a1){const _0x374456=a13_0x3744();return a13_0x1b54=function(_0x1b540c,_0x194727){_0x1b540c=_0x1b540c-0x119;let _0x5d524e=_0x374456[_0x1b540c];return _0x5d524e;},a13_0x1b54(_0x35b3a1,_0x1089a1);}import{toggleScoringEditMode as a13_0x121f5f}from'./scoringView.js';import{renderRpnChart as a13_0x1e3f3c}from'./worstCaseView.js';import{renderMacoChart as a13_0x122f94}from'./dashboardView.js';const s=document[a13_0x158406(0x2de)](a13_0x158406(0x2b2));export const showLoader=()=>s[a13_0x158406(0x168)][a13_0x158406(0x1bb)]=a13_0x158406(0x201);export const hideLoader=()=>s['style'][a13_0x158406(0x1bb)]=a13_0x158406(0x1a5);export function showCustomAlert(_0x1d7078,_0x1fdc9f){const _0x56e136=a13_0x158406,_0xb71163={'prDvy':'customAlertTitle','LDopZ':_0x56e136(0x36c),'SLYcU':_0x56e136(0x1b8),'caclR':_0x56e136(0x201)};document[_0x56e136(0x2de)](_0xb71163['prDvy'])[_0x56e136(0x1da)]=_0x1d7078,document['getElementById'](_0xb71163[_0x56e136(0x304)])[_0x56e136(0x1da)]=_0x1fdc9f,document['getElementById'](_0xb71163[_0x56e136(0x2fd)])[_0x56e136(0x168)][_0x56e136(0x1bb)]=_0xb71163['caclR'];}export const hideModal=_0x3b3c1c=>document[a13_0x158406(0x2de)](_0x3b3c1c)['style'][a13_0x158406(0x1bb)]='none';export function saveAllDataToLocalStorage(){const _0x4d7ded=a13_0x158406,_0x4ce357={'GVieg':_0x4d7ded(0x232),'fMOfr':_0x4d7ded(0x269),'dJcIU':_0x4d7ded(0x14d),'vDjCr':_0x4d7ded(0x203),'XzEuw':_0x4d7ded(0x1cc),'WRiqI':_0x4d7ded(0x322),'SNbQc':'Could\x20not\x20save\x20data.\x20Storage\x20might\x20be\x20full.'};try{localStorage[_0x4d7ded(0x2d8)](_0x4ce357[_0x4d7ded(0x2fb)],JSON[_0x4d7ded(0x2c3)](a13_0x20cf21[_0x4d7ded(0x1d0)])),localStorage[_0x4d7ded(0x2d8)](_0x4ce357[_0x4d7ded(0x243)],JSON[_0x4d7ded(0x2c3)](a13_0x20cf21[_0x4d7ded(0x1c0)])),localStorage[_0x4d7ded(0x2d8)](_0x4ce357[_0x4d7ded(0x154)],JSON['stringify'](a13_0x20cf21['scoringCriteria'])),localStorage[_0x4d7ded(0x2d8)](_0x4ce357[_0x4d7ded(0x33d)],JSON[_0x4d7ded(0x2c3)](a13_0x20cf21[_0x4d7ded(0x354)])),localStorage[_0x4d7ded(0x2d8)](_0x4ce357[_0x4d7ded(0x1fd)],JSON[_0x4d7ded(0x2c3)](a13_0x20cf21[_0x4d7ded(0x1cc)]));}catch(_0x13d6bb){console[_0x4d7ded(0x300)](_0x4ce357[_0x4d7ded(0x196)],_0x13d6bb),showCustomAlert('Save\x20Error',_0x4ce357[_0x4d7ded(0x21f)]);}}export function loadAllDataFromLocalStorage(){const _0x27041c=a13_0x158406,_0x17348f={'UjALW':_0x27041c(0x232),'sUkWJ':_0x27041c(0x269),'Vybvu':_0x27041c(0x14d),'OJGZY':'macoDetergentIngredients','bMgJB':_0x27041c(0x1cc),'skXYE':_0x27041c(0x224),'xLivL':_0x27041c(0x1c5),'hyPro':_0x27041c(0x2ef),'tKJnF':'Error\x20loading\x20machine\x20stage\x20order'},_0x372f7b=localStorage[_0x27041c(0x2d0)](_0x17348f[_0x27041c(0x35f)]),_0x488f34=localStorage[_0x27041c(0x2d0)](_0x17348f[_0x27041c(0x240)]),_0x4efefd=localStorage[_0x27041c(0x2d0)](_0x17348f[_0x27041c(0x1cd)]),_0x2646b5=localStorage['getItem'](_0x17348f[_0x27041c(0x1ae)]),_0x6a8cca=localStorage[_0x27041c(0x2d0)](_0x17348f[_0x27041c(0x135)]);if(_0x372f7b)try{a13_0x20cf21[_0x27041c(0x35e)](JSON['parse'](_0x372f7b));}catch(_0x2bbaee){console[_0x27041c(0x300)](_0x17348f['skXYE'],_0x2bbaee);}if(_0x488f34)try{a13_0x20cf21[_0x27041c(0x361)](JSON[_0x27041c(0x206)](_0x488f34));}catch(_0x111ed1){console[_0x27041c(0x300)](_0x17348f[_0x27041c(0x265)],_0x111ed1);}if(_0x4efefd)try{a13_0x20cf21[_0x27041c(0x248)](JSON[_0x27041c(0x206)](_0x4efefd));}catch(_0x58fea0){console[_0x27041c(0x300)](_0x17348f[_0x27041c(0x36d)],_0x58fea0);}if(_0x2646b5)try{a13_0x20cf21[_0x27041c(0x22f)](JSON[_0x27041c(0x206)](_0x2646b5));}catch(_0x3d460c){console[_0x27041c(0x300)]('Error\x20loading\x20detergent\x20ingredients',_0x3d460c);}if(_0x6a8cca)try{a13_0x20cf21[_0x27041c(0x1f2)](JSON['parse'](_0x6a8cca));}catch(_0x139aab){console[_0x27041c(0x300)](_0x17348f[_0x27041c(0x333)],_0x139aab);}}export function saveStateForUndo(){const _0x4781eb=a13_0x158406,_0x706f02={'kBdql':function(_0x4157f1){return _0x4157f1();},'GbJnb':function(_0x3ce809,_0x597e33){return _0x3ce809-_0x597e33;},'EcEZZ':function(_0x42de17){return _0x42de17();}};_0x706f02[_0x4781eb(0x13f)](a13_0x28854b);const _0x5d0c48=a13_0x20cf21[_0x4781eb(0x31c)][_0x4781eb(0x15d)](0x0,a13_0x20cf21[_0x4781eb(0x1b4)]+0x1),_0x4f59d8={'products':JSON[_0x4781eb(0x206)](JSON[_0x4781eb(0x2c3)](a13_0x20cf21[_0x4781eb(0x1d0)])),'machines':JSON[_0x4781eb(0x206)](JSON[_0x4781eb(0x2c3)](a13_0x20cf21[_0x4781eb(0x1c0)])),'scoringCriteria':JSON[_0x4781eb(0x206)](JSON[_0x4781eb(0x2c3)](a13_0x20cf21['scoringCriteria'])),'detergentIngredients':JSON[_0x4781eb(0x206)](JSON['stringify'](a13_0x20cf21['detergentIngredients']))};_0x5d0c48[_0x4781eb(0x1df)](_0x4f59d8),a13_0x20cf21[_0x4781eb(0x33a)](_0x5d0c48,_0x706f02[_0x4781eb(0x25b)](_0x5d0c48[_0x4781eb(0x1ca)],0x1)),_0x706f02[_0x4781eb(0x13f)](updateUndoRedoButtons),_0x706f02[_0x4781eb(0x1f3)](saveAllDataToLocalStorage);}export function updateUndoRedoButtons(){const _0x1919b8=a13_0x158406,_0x3aee43={'lwZFZ':_0x1919b8(0x1ab),'azNzy':function(_0x410ace,_0x4cf1d5){return _0x410ace<=_0x4cf1d5;},'AmgeS':function(_0x2a78ec,_0x41cebb){return _0x2a78ec>=_0x41cebb;},'Beril':function(_0x2d09fb,_0x3ac05f){return _0x2d09fb-_0x3ac05f;}},_0x249fa4=document[_0x1919b8(0x2de)]('undo-btn'),_0x567094=document[_0x1919b8(0x2de)](_0x3aee43[_0x1919b8(0x1e0)]);_0x249fa4&&(_0x249fa4[_0x1919b8(0x289)]=_0x3aee43[_0x1919b8(0x320)](a13_0x20cf21[_0x1919b8(0x1b4)],0x0)),_0x567094&&(_0x567094[_0x1919b8(0x289)]=_0x3aee43[_0x1919b8(0x2ac)](a13_0x20cf21[_0x1919b8(0x1b4)],_0x3aee43[_0x1919b8(0x11a)](a13_0x20cf21[_0x1919b8(0x31c)][_0x1919b8(0x1ca)],0x1)));}export function undoChange(){const _0x3ccd39=a13_0x158406,_0x77c422={'LLipo':function(_0xa776c4,_0x5229b5){return _0xa776c4>_0x5229b5;},'BMZhH':function(_0x59fa17,_0x568b31){return _0x59fa17(_0x568b31);},'zSgoX':function(_0xb991b6){return _0xb991b6();}};if(_0x77c422['LLipo'](a13_0x20cf21[_0x3ccd39(0x1b4)],0x0)){const _0xb379e2=a13_0x20cf21['historyIndex']-0x1,_0x407111=a13_0x20cf21[_0x3ccd39(0x31c)][_0xb379e2];a13_0x20cf21[_0x3ccd39(0x35e)](JSON[_0x3ccd39(0x206)](JSON[_0x3ccd39(0x2c3)](_0x407111[_0x3ccd39(0x1d0)]))),a13_0x20cf21[_0x3ccd39(0x361)](JSON[_0x3ccd39(0x206)](JSON[_0x3ccd39(0x2c3)](_0x407111[_0x3ccd39(0x1c0)]))),a13_0x20cf21['setScoringCriteria'](JSON['parse'](JSON[_0x3ccd39(0x2c3)](_0x407111[_0x3ccd39(0x2d9)]))),a13_0x20cf21[_0x3ccd39(0x22f)](JSON[_0x3ccd39(0x206)](JSON[_0x3ccd39(0x2c3)](_0x407111['detergentIngredients']))),a13_0x20cf21[_0x3ccd39(0x33a)](a13_0x20cf21[_0x3ccd39(0x31c)],_0xb379e2),a13_0x20cf21['scoringInEditMode']&&_0x77c422[_0x3ccd39(0x303)](a13_0x121f5f,!0x1),_0x77c422[_0x3ccd39(0x301)](a13_0xf47647),_0x77c422[_0x3ccd39(0x301)](updateUndoRedoButtons),saveAllDataToLocalStorage();}}export function redoChange(){const _0x4b9abf=a13_0x158406,_0x23945e={'wRXbf':function(_0x3275d7,_0xb81bec){return _0x3275d7-_0xb81bec;},'gxJBZ':function(_0x24698b,_0xe56aed){return _0x24698b(_0xe56aed);},'YHTQo':function(_0x36856c){return _0x36856c();},'oUiEp':function(_0x4d01a0){return _0x4d01a0();}};if(a13_0x20cf21[_0x4b9abf(0x1b4)]<_0x23945e['wRXbf'](a13_0x20cf21['history']['length'],0x1)){const _0x1e203b=a13_0x20cf21['historyIndex']+0x1,_0x46e817=a13_0x20cf21[_0x4b9abf(0x31c)][_0x1e203b];a13_0x20cf21['setProducts'](JSON[_0x4b9abf(0x206)](JSON[_0x4b9abf(0x2c3)](_0x46e817[_0x4b9abf(0x1d0)]))),a13_0x20cf21[_0x4b9abf(0x361)](JSON[_0x4b9abf(0x206)](JSON[_0x4b9abf(0x2c3)](_0x46e817[_0x4b9abf(0x1c0)]))),a13_0x20cf21[_0x4b9abf(0x248)](JSON[_0x4b9abf(0x206)](JSON[_0x4b9abf(0x2c3)](_0x46e817[_0x4b9abf(0x2d9)]))),a13_0x20cf21[_0x4b9abf(0x22f)](JSON[_0x4b9abf(0x206)](JSON['stringify'](_0x46e817[_0x4b9abf(0x354)]))),a13_0x20cf21[_0x4b9abf(0x33a)](a13_0x20cf21[_0x4b9abf(0x31c)],_0x1e203b),a13_0x20cf21['scoringInEditMode']&&_0x23945e['gxJBZ'](a13_0x121f5f,!0x1),_0x23945e[_0x4b9abf(0x33c)](a13_0xf47647),_0x23945e['YHTQo'](updateUndoRedoButtons),_0x23945e['oUiEp'](saveAllDataToLocalStorage);}}export function toggleDarkMode(_0x4305fd){const _0x4ebfef=a13_0x158406,_0x3f831c={'UWjCB':_0x4ebfef(0x24c),'RxVxb':_0x4ebfef(0x279),'ZryVh':function(_0x3b7724){return _0x3b7724();},'zrRGe':function(_0x158945){return _0x158945();}},_0x4de5da=document[_0x4ebfef(0x2de)](_0x4ebfef(0x2e7)),_0x338a61=document[_0x4ebfef(0x2de)]('theme-toggle-dark-icon');_0x4305fd?(document[_0x4ebfef(0x1c2)]['classList'][_0x4ebfef(0x1d1)](_0x3f831c[_0x4ebfef(0x174)]),_0x4de5da&&_0x4de5da[_0x4ebfef(0x136)][_0x4ebfef(0x1d1)](_0x3f831c[_0x4ebfef(0x12c)]),_0x338a61&&_0x338a61[_0x4ebfef(0x136)]['remove'](_0x4ebfef(0x279))):(document['documentElement'][_0x4ebfef(0x136)][_0x4ebfef(0x280)](_0x4ebfef(0x24c)),_0x4de5da&&_0x4de5da[_0x4ebfef(0x136)][_0x4ebfef(0x280)](_0x4ebfef(0x279)),_0x338a61&&_0x338a61[_0x4ebfef(0x136)]['add'](_0x3f831c[_0x4ebfef(0x12c)])),a13_0x20cf21[_0x4ebfef(0x366)]&&_0x3f831c[_0x4ebfef(0x2e8)](a13_0x1e3f3c),a13_0x20cf21[_0x4ebfef(0x25d)]&&_0x3f831c[_0x4ebfef(0x29d)](a13_0x122f94);}export function printCurrentView(_0x49aa78,_0x54da88=a13_0x158406(0x244)){const _0x1a8c60=a13_0x158406,_0x1b2e2e={'UfbCx':function(_0xefd70d,_0x36d3e,_0x40fd61){return _0xefd70d(_0x36d3e,_0x40fd61);},'hDHWU':_0x1a8c60(0x318),'tCFZj':_0x1a8c60(0x279),'vVnxA':'#detergentMaco\x20.train-content.collapsed','aputv':_0x1a8c60(0x286),'zMBAV':_0x1a8c60(0x123),'IMVcP':_0x1a8c60(0x1b1),'iJWBA':_0x1a8c60(0x2ed),'oUSAs':function(_0x46b7ad,_0x55af72){return _0x46b7ad>_0x55af72;},'ZWAMD':function(_0x4bbdb4,_0x1d17f4){return _0x4bbdb4===_0x1d17f4;},'jYcTG':_0x1a8c60(0x27c),'pLRzJ':function(_0x37e8c2,_0x399953){return _0x37e8c2(_0x399953);},'rMLkm':_0x1a8c60(0x2ec),'jRNPn':_0x1a8c60(0x22b),'SRaof':function(_0x1e3caf,_0x2b8e9a){return _0x1e3caf+_0x2b8e9a;},'Yqjkx':'Error\x20loading\x20train\x20summary:\x20','fWKLp':'Printing\x20view:','PcjFY':_0x1a8c60(0x34a),'EKzWZ':function(_0x374684,_0x1126da){return _0x374684===_0x1126da;},'mfgeW':_0x1a8c60(0x326),'cQcEm':_0x1a8c60(0x1e4),'vmMQE':_0x1a8c60(0x202),'VLmoQ':function(_0x3b10e0,_0x2d984a){return _0x3b10e0===_0x2d984a;},'qXQEs':_0x1a8c60(0x1a4),'vicbF':_0x1a8c60(0x20f),'vFllW':function(_0xb812b7,_0x458a82,_0x43c3b9){return _0xb812b7(_0x458a82,_0x43c3b9);}};_0x1b2e2e[_0x1a8c60(0x1d5)](_0x1a8c60(0x2aa),_0x49aa78)&&a13_0x20cf21[_0x1a8c60(0x35c)]&&(a13_0x20cf21[_0x1a8c60(0x1dc)](!0x0),a13_0x121f5f(!0x1)),console[_0x1a8c60(0x15b)](_0x1b2e2e[_0x1a8c60(0x362)],_0x49aa78,_0x1b2e2e['PcjFY'],_0x54da88),document[_0x1a8c60(0x347)][_0x1a8c60(0x136)][_0x1a8c60(0x1d1)]('printing-'+_0x49aa78),_0x1b2e2e[_0x1a8c60(0x1b2)](_0x1a8c60(0x2f1),_0x49aa78)?import(_0x1b2e2e[_0x1a8c60(0x16d)])[_0x1a8c60(0x130)](_0x1246da=>{const _0x5e746e=_0x1a8c60;window[_0x5e746e(0x1f0)]=_0x54da88,_0x1246da[_0x5e746e(0x1f5)](),_0x1b2e2e[_0x5e746e(0x30b)](setTimeout,()=>{const _0x178205=_0x5e746e;window[_0x178205(0x15a)]();},0xc8);}):_0x1b2e2e[_0x1a8c60(0x1b2)](_0x1a8c60(0x325),_0x49aa78)?(window[_0x1a8c60(0x1f0)]=_0x54da88,import(_0x1b2e2e[_0x1a8c60(0x337)])['then'](_0x1f8ecb=>{const _0x1c3053=_0x1a8c60,_0x10ee51={'YOWQe':'hidden'};_0x1f8ecb[_0x1c3053(0x1e3)]();const _0x175875=document['querySelectorAll'](_0x1c3053(0x121)),_0x1cdbda=[];_0x175875[_0x1c3053(0x2e5)](_0x3f2ff2=>{const _0x3c8fd9=_0x1c3053,_0x5d741b=_0x3f2ff2['id'][_0x3c8fd9(0x16e)](/content-pm-(\d+)/);if(_0x5d741b){_0x1cdbda[_0x3c8fd9(0x1df)](_0x5d741b[0x1]),_0x3f2ff2[_0x3c8fd9(0x136)][_0x3c8fd9(0x280)](_0x1b2e2e['hDHWU']);const _0x23148f=document['getElementById'](_0x3c8fd9(0x1ce)+_0x5d741b[0x1]);_0x23148f&&(_0x23148f[_0x3c8fd9(0x1da)]='▼');}});const _0x24515d=document[_0x1c3053(0x157)]('#macoForTrains\x20[id^=\x22maco-breakdown-details-\x22].hidden'),_0x311ab9=[];_0x24515d[_0x1c3053(0x2e5)](_0x211652=>{const _0x24ed72=_0x1c3053,_0x5a520e=_0x211652['id'][_0x24ed72(0x16e)](/maco-breakdown-details-(\d+)/);if(_0x5a520e){_0x311ab9[_0x24ed72(0x1df)](_0x5a520e[0x1]),_0x211652[_0x24ed72(0x136)][_0x24ed72(0x280)](_0x10ee51[_0x24ed72(0x181)]);const _0x8e6baa=document[_0x24ed72(0x2de)]('breakdown-toggle-btn-'+_0x5a520e[0x1]);_0x8e6baa&&(_0x8e6baa[_0x24ed72(0x1da)]=_0x24ed72(0x138));}}),setTimeout(()=>{const _0x2440e3=_0x1c3053,_0xcdd8dc={'Nubgu':_0x1b2e2e['tCFZj'],'dUfse':_0x2440e3(0x264)};window['print'](),setTimeout(()=>{const _0x3f9dc6=_0x2440e3;_0x1cdbda[_0x3f9dc6(0x2e5)](_0x46bcb7=>{const _0x38d5c2=_0x3f9dc6,_0x28038d=document['getElementById'](_0x38d5c2(0x193)+_0x46bcb7),_0x1eb18d=document[_0x38d5c2(0x2de)]('toggle-pm-'+_0x46bcb7);_0x28038d&&_0x28038d[_0x38d5c2(0x136)]['add']('collapsed'),_0x1eb18d&&(_0x1eb18d[_0x38d5c2(0x1da)]='▶');}),_0x311ab9[_0x3f9dc6(0x2e5)](_0x57790c=>{const _0x243ca1=_0x3f9dc6,_0x2a9a3e=document[_0x243ca1(0x2de)](_0x243ca1(0x258)+_0x57790c),_0x3c1576=document[_0x243ca1(0x2de)](_0x243ca1(0x12a)+_0x57790c);_0x2a9a3e&&_0x2a9a3e[_0x243ca1(0x136)][_0x243ca1(0x1d1)](_0xcdd8dc['Nubgu']),_0x3c1576&&(_0x3c1576[_0x243ca1(0x1da)]=_0xcdd8dc[_0x243ca1(0x312)]);});},0x3e8);},0xc8);})):_0x1b2e2e[_0x1a8c60(0x276)]===_0x49aa78?(window['printSelectedTrain']=_0x54da88,import(_0x1b2e2e['zMBAV'])[_0x1a8c60(0x130)](_0x2dec69=>{const _0x3eae6f=_0x1a8c60,_0x2e69cd={'yuRkx':_0x1b2e2e[_0x3eae6f(0x183)]};_0x2dec69['renderDetergentMaco']();const _0x5d0efa=document[_0x3eae6f(0x157)](_0x1b2e2e[_0x3eae6f(0x1be)]),_0xd09983=[];_0x5d0efa['forEach'](_0x5ee750=>{const _0x5ebed3=_0x3eae6f,_0x59278a=_0x5ee750['id'][_0x5ebed3(0x16e)](/content-dm-(\d+)/);if(_0x59278a){_0xd09983[_0x5ebed3(0x1df)](_0x59278a[0x1]),_0x5ee750[_0x5ebed3(0x136)][_0x5ebed3(0x280)](_0x1b2e2e[_0x5ebed3(0x183)]);const _0x4a8624=document[_0x5ebed3(0x2de)](_0x5ebed3(0x290)+_0x59278a[0x1]);_0x4a8624&&(_0x4a8624[_0x5ebed3(0x1da)]='▼');}}),_0x1b2e2e[_0x3eae6f(0x30b)](setTimeout,()=>{const _0x3e87a1=_0x3eae6f;window[_0x3e87a1(0x15a)](),setTimeout(()=>{const _0x447d64=_0x3e87a1,_0x573106={'VVoiP':_0x2e69cd['yuRkx']};_0xd09983[_0x447d64(0x2e5)](_0x222d0f=>{const _0x25f422=_0x447d64,_0x20da75=document['getElementById'](_0x25f422(0x36a)+_0x222d0f),_0x2c99d5=document[_0x25f422(0x2de)](_0x25f422(0x290)+_0x222d0f);_0x20da75&&_0x20da75['classList']['add'](_0x573106[_0x25f422(0x208)]),_0x2c99d5&&(_0x2c99d5['textContent']='▶');});},0x3e8);},0xc8);})[_0x1a8c60(0x12e)](_0x2d0c85=>{const _0x362660=_0x1a8c60;console['error'](_0x1b2e2e[_0x362660(0x1f4)],_0x2d0c85),window[_0x362660(0x15a)]();})[_0x1a8c60(0x242)](()=>{_0x1b2e2e['UfbCx'](setTimeout,()=>{const _0x2b6bd4=a13_0x1b54;window['printSelectedTrain']=null,import(_0x1b2e2e[_0x2b6bd4(0x1c6)])[_0x2b6bd4(0x130)](_0x3787e8=>_0x3787e8[_0x2b6bd4(0x267)]())[_0x2b6bd4(0x12e)](()=>{});},0x4b0);})):_0x1b2e2e[_0x1a8c60(0x2f3)](_0x1b2e2e[_0x1a8c60(0x25f)],_0x49aa78)?(window[_0x1a8c60(0x1f0)]=_0x54da88,console[_0x1a8c60(0x15b)](_0x1a8c60(0x360),_0x54da88),import(_0x1b2e2e[_0x1a8c60(0x332)])[_0x1a8c60(0x130)](_0x584f18=>{const _0x494236=_0x1a8c60,_0x30a44a={'PvuwM':_0x1b2e2e[_0x494236(0x188)],'hmWWO':'Container\x20display:','gthSs':_0x1b2e2e[_0x494236(0x2df)],'elvTB':_0x494236(0x310),'LpZBM':_0x494236(0x356),'TUjhp':function(_0x3606bb,_0xab1574){const _0x8222b7=_0x494236;return _0x1b2e2e[_0x8222b7(0x275)](_0x3606bb,_0xab1574);},'YWmQf':function(_0xe6098b,_0x38d8df){const _0x31e45d=_0x494236;return _0x1b2e2e[_0x31e45d(0x1d5)](_0xe6098b,_0x38d8df);},'sLkFX':_0x494236(0x1a5),'QBDQG':_0x1b2e2e['jYcTG'],'UEjzv':function(_0x2737c7,_0x6b9e39){const _0x50e6a0=_0x494236;return _0x1b2e2e[_0x50e6a0(0x29f)](_0x2737c7,_0x6b9e39);},'DDOgq':_0x1b2e2e[_0x494236(0x34c)]};_0x584f18[_0x494236(0x331)](),setTimeout(()=>{const _0x5bcd51=_0x494236,_0x11e08d=document['getElementById'](_0x5bcd51(0x324)),_0x3ee947=document[_0x5bcd51(0x2de)](_0x30a44a['PvuwM']);if(console[_0x5bcd51(0x15b)](_0x30a44a[_0x5bcd51(0x262)],_0x11e08d?_0x11e08d[_0x5bcd51(0x168)]['display']:_0x30a44a[_0x5bcd51(0x2a3)]),console[_0x5bcd51(0x15b)](_0x30a44a[_0x5bcd51(0x171)],_0x3ee947?_0x3ee947[_0x5bcd51(0x168)]['display']:_0x30a44a[_0x5bcd51(0x2a3)]),console[_0x5bcd51(0x15b)](_0x30a44a[_0x5bcd51(0x1c7)],!!_0x11e08d&&_0x30a44a[_0x5bcd51(0x15e)](_0x11e08d[_0x5bcd51(0x1cf)][_0x5bcd51(0x1ca)],0x0)),!_0x11e08d||_0x30a44a[_0x5bcd51(0x1ac)](_0x30a44a[_0x5bcd51(0x291)],_0x11e08d[_0x5bcd51(0x168)][_0x5bcd51(0x1bb)]))return console[_0x5bcd51(0x129)](_0x30a44a['QBDQG']),void _0x30a44a['UEjzv'](alert,_0x30a44a[_0x5bcd51(0x184)]);window[_0x5bcd51(0x15a)](),setTimeout(()=>{const _0x1c1a79=_0x5bcd51;window[_0x1c1a79(0x1f0)]=null,_0x584f18[_0x1c1a79(0x331)]();},0x3e8);},0x1f4);})['catch'](_0xbc454a=>{const _0x47fce0=_0x1a8c60;console[_0x47fce0(0x300)](_0x1b2e2e[_0x47fce0(0x314)],_0xbc454a),alert(_0x1b2e2e['SRaof'](_0x1b2e2e[_0x47fce0(0x1dd)],_0xbc454a['message']));})):_0x1b2e2e[_0x1a8c60(0x32c)](setTimeout,()=>{const _0xecf9e4=_0x1a8c60;window[_0xecf9e4(0x15a)]();},0x64);}export function toggleColumn(_0x1b9b1b,_0x920ec4){const _0x54f948=a13_0x158406,_0x55272e={'SZyHC':_0x54f948(0x28e),'lqbTs':function(_0x5e5776,_0x222606){return _0x5e5776===_0x222606;},'lkjee':_0x54f948(0x295),'Eyrsa':_0x54f948(0x2f1),'gmsqy':function(_0x59161f,_0x5538cb){return _0x59161f(_0x5538cb);},'TSbBZ':_0x54f948(0x2e6),'LsUMq':_0x54f948(0x326),'wxoSy':function(_0x58fba0,_0x586376){return _0x58fba0!==_0x586376;}};if(_0x55272e[_0x54f948(0x12b)]===_0x1b9b1b||_0x55272e[_0x54f948(0x2f0)](_0x55272e[_0x54f948(0x24d)],_0x1b9b1b)){[_0x54f948(0x2e6),_0x55272e[_0x54f948(0x186)]]['forEach'](_0x226278=>{const _0x13b9e0=_0x54f948;document['querySelectorAll']('#'+_0x226278+_0x13b9e0(0x1ec)+_0x226278+_0x13b9e0(0x28b))[_0x13b9e0(0x2e5)](_0xe86f2=>{const _0x3481f0=_0x13b9e0;_0xe86f2[_0x3481f0(0x136)][_0x3481f0(0x2da)]('hide-'+_0x1b9b1b);}),document[_0x13b9e0(0x157)]('#'+_0x226278+_0x13b9e0(0x145)+_0x226278+_0x13b9e0(0x2e2))[_0x13b9e0(0x2e5)](_0x51de87=>{const _0x1df7a0=_0x13b9e0;_0x51de87&&_0x51de87['classList'][_0x1df7a0(0x2da)]('hide-'+_0x1b9b1b);});});const _0x2190f9=null!==document[_0x54f948(0x156)](_0x54f948(0x13c)+_0x1b9b1b);localStorage[_0x54f948(0x2d8)](_0x54f948(0x1b7)+_0x1b9b1b+_0x54f948(0x170),_0x2190f9),_0x55272e[_0x54f948(0x2d1)](updateToggleIcons,_0x55272e[_0x54f948(0x1d6)]),_0x55272e[_0x54f948(0x2d1)](updateToggleIcons,_0x55272e['Eyrsa']),import(_0x55272e[_0x54f948(0x33e)])['then'](_0x34318a=>{const _0x1fde1d=_0x54f948;_0x34318a[_0x1fde1d(0x1f5)]();}),import(_0x55272e[_0x54f948(0x33e)])[_0x54f948(0x130)](_0x48c79c=>{const _0x546b6f=_0x54f948;_0x48c79c[_0x546b6f(0x12d)]&&_0x48c79c[_0x546b6f(0x12d)]();});}else{document['querySelectorAll']('#'+_0x920ec4+'\x20.mainTable,\x20#'+_0x920ec4+_0x54f948(0x28b))[_0x54f948(0x2e5)](_0x534955=>{const _0x9f992=_0x54f948;_0x534955[_0x9f992(0x136)]['toggle']('hide-'+_0x1b9b1b);});const _0x3c46da=_0x55272e[_0x54f948(0x298)](null,document[_0x54f948(0x156)]('#'+_0x920ec4+_0x54f948(0x317)+_0x1b9b1b));localStorage[_0x54f948(0x2d8)](_0x920ec4+'-'+_0x1b9b1b+_0x54f948(0x170),_0x3c46da),_0x55272e['gmsqy'](updateToggleIcons,_0x920ec4);}}export function toggleColumnVisibilityDropdown(){const _0x2fde8b=a13_0x158406,_0x228f9f={'Apfzn':'#columnVisibilityDropdown','aKlkA':_0x2fde8b(0x346),'qMXIs':'hidden','KdqGI':_0x2fde8b(0x173),'JhjNN':_0x2fde8b(0x191)},_0x51a6f8=document[_0x2fde8b(0x2de)](_0x228f9f['JhjNN']);_0x51a6f8[_0x2fde8b(0x136)][_0x2fde8b(0x2da)](_0x228f9f['qMXIs']),_0x51a6f8[_0x2fde8b(0x136)][_0x2fde8b(0x169)](_0x228f9f['qMXIs'])||document[_0x2fde8b(0x220)](_0x2fde8b(0x173),function _0x27b577(_0x2fa0d6){const _0x2b4475=_0x2fde8b;_0x2fa0d6['target'][_0x2b4475(0x34e)](_0x228f9f[_0x2b4475(0x319)])||_0x2fa0d6[_0x2b4475(0x28a)][_0x2b4475(0x34e)](_0x228f9f[_0x2b4475(0x167)])||(_0x51a6f8['classList'][_0x2b4475(0x1d1)](_0x228f9f[_0x2b4475(0x2e9)]),document[_0x2b4475(0x2a7)](_0x228f9f[_0x2b4475(0x2cc)],_0x27b577));});}export function updateToggleIcons(_0x3d1caa){const _0x4f3a4f=a13_0x158406,_0x1b8df1={'IeUJI':_0x4f3a4f(0x21e),'Ofcis':'hide-ld50','HvnmS':function(_0x19a0e7,_0x5889b1){return _0x19a0e7===_0x5889b1;},'joTul':'true','orFro':function(_0x124477,_0x807210){return _0x124477===_0x807210;},'kmxYm':function(_0x10bf8a,_0x32b1aa){return _0x10bf8a===_0x32b1aa;},'bHpKt':_0x4f3a4f(0x13a),'lAFTD':_0x4f3a4f(0x2f7),'rMhwf':_0x4f3a4f(0x1eb),'WRxGf':_0x4f3a4f(0x1c9),'MpqXG':_0x4f3a4f(0x213)},_0xc37d89=document[_0x4f3a4f(0x2de)](_0x3d1caa);if(!_0xc37d89)return;let _0x508bbe,_0x23a40b;if('worstCaseProducts'===_0x3d1caa){const _0x559ba4=localStorage['getItem'](_0x4f3a4f(0x2af)),_0x45f2e6=localStorage['getItem'](_0x4f3a4f(0x161));if(null===_0x559ba4&&_0x1b8df1[_0x4f3a4f(0x23e)](null,_0x45f2e6))_0x508bbe=!0x1,_0x23a40b=!0x1;else{const _0x594c85=_0x1b8df1[_0x4f3a4f(0x282)]===_0x559ba4,_0x3b777c=_0x1b8df1[_0x4f3a4f(0x163)](_0x4f3a4f(0x1d8),_0x45f2e6);_0x594c85&&_0x3b777c?(_0x508bbe=!0x1,_0x23a40b=!0x0):(_0x508bbe=_0x594c85,_0x23a40b=_0x3b777c);}}else{const _0x1320fa=localStorage['getItem'](_0x3d1caa+_0x4f3a4f(0x2f8)),_0x584ebc=localStorage[_0x4f3a4f(0x2d0)](_0x3d1caa+'-ld50Hidden');_0x508bbe=_0x1b8df1[_0x4f3a4f(0x163)](_0x1b8df1[_0x4f3a4f(0x282)],_0x1320fa),_0x23a40b=_0x1b8df1[_0x4f3a4f(0x218)](_0x1b8df1[_0x4f3a4f(0x282)],_0x584ebc);}const _0x527b0b=_0xc37d89[_0x4f3a4f(0x156)](_0x1b8df1[_0x4f3a4f(0x293)]),_0x5b2d79=_0xc37d89[_0x4f3a4f(0x156)](_0x1b8df1[_0x4f3a4f(0x2c2)]);_0x527b0b&&(_0x527b0b['innerHTML']=_0x508bbe?_0x1b8df1['rMhwf']:_0x1b8df1[_0x4f3a4f(0x2fc)]),_0x5b2d79&&(_0x5b2d79['innerHTML']=_0x23a40b?_0x1b8df1[_0x4f3a4f(0x1a9)]:_0x4f3a4f(0x349)),document[_0x4f3a4f(0x157)]('#'+_0x3d1caa+_0x4f3a4f(0x1ec)+_0x3d1caa+_0x4f3a4f(0x28b))[_0x4f3a4f(0x2e5)](_0x86302f=>{const _0x121c30=_0x4f3a4f;_0x86302f&&(_0x86302f[_0x121c30(0x136)][_0x121c30(0x2da)](_0x1b8df1[_0x121c30(0x1b3)],_0x508bbe),_0x86302f[_0x121c30(0x136)][_0x121c30(0x2da)](_0x1b8df1[_0x121c30(0x144)],_0x23a40b));}),document[_0x4f3a4f(0x157)]('#'+_0x3d1caa+_0x4f3a4f(0x145)+_0x3d1caa+'\x20.train-content-inner')[_0x4f3a4f(0x2e5)](_0x11a2a2=>{const _0x38e75c=_0x4f3a4f;_0x11a2a2&&(_0x11a2a2['classList'][_0x38e75c(0x2da)]('hide-pde',_0x508bbe),_0x11a2a2[_0x38e75c(0x136)][_0x38e75c(0x2da)](_0x38e75c(0x231),_0x23a40b));});}export function exportToExcel(){const _0x2b57ae=a13_0x158406,_0x23fda5={'oqYzD':function(_0x488537,_0x4b28f9){return _0x488537+_0x4b28f9;},'ONDNS':'Yes','XNzKs':function(_0x3c1e53,_0x2aa2b6){return _0x3c1e53(_0x2aa2b6);},'eoBMc':function(_0x5b0d6d,_0x4dae0c){return _0x5b0d6d===_0x4dae0c;},'tINQh':function(_0x3b5102){return _0x3b5102();},'ssbzg':function(_0x976039,_0x50bed7,_0x4a8e3f){return _0x976039(_0x50bed7,_0x4a8e3f);},'shxcQ':_0x2b57ae(0x200),'qZFNK':_0x2b57ae(0x2a9),'glbFN':_0x2b57ae(0x2b4),'nZCyV':_0x2b57ae(0x1a7),'WelvE':_0x2b57ae(0x180),'ugJkp':function(_0x5a9a21){return _0x5a9a21();},'dxGDu':function(_0x4dd2f3,_0x44f1f9,_0x20a355){return _0x4dd2f3(_0x44f1f9,_0x20a355);},'BmAWP':_0x2b57ae(0x2f9),'kmeZZ':_0x2b57ae(0x1bd),'ziNnS':function(_0x326cda){return _0x326cda();},'iwjpS':'./utils.js'};_0x23fda5['ziNnS'](showLoader),import(_0x23fda5[_0x2b57ae(0x340)])[_0x2b57ae(0x130)](_0x4218af=>{const _0x382822=_0x2b57ae,_0x3da1f6={'shjxn':function(_0x50193c,_0x54e2cb){const _0x1d2823=a13_0x1b54;return _0x23fda5[_0x1d2823(0x189)](_0x50193c,_0x54e2cb);},'SWBiB':_0x23fda5[_0x382822(0x219)],'yYaRI':function(_0x25e4c8,_0x6dface){return _0x23fda5['XNzKs'](_0x25e4c8,_0x6dface);}},{getProductTrainId:_0x3866b3,calculateScores:_0x4262e8}=_0x4218af,_0x2c188e=[];if(a13_0x20cf21[_0x382822(0x1d0)][_0x382822(0x2e5)](_0x3357d3=>{const _0x244da2=_0x382822;let _0x29f4fb='No';_0x3357d3[_0x244da2(0x1ed)]&&(_0x29f4fb=_0x3da1f6[_0x244da2(0x278)](_0x3da1f6[_0x244da2(0x237)],_0x3357d3[_0x244da2(0x31e)]?':\x20'+_0x3357d3[_0x244da2(0x31e)]:''));const _0x470e2d=_0x3da1f6[_0x244da2(0x11d)](_0x3866b3,_0x3357d3),_0x521965=_0x3357d3[_0x244da2(0x155)]?new Date(_0x3357d3[_0x244da2(0x155)])[_0x244da2(0x323)]():'';_0x2c188e[_0x244da2(0x1df)]({'Date':_0x521965,'Product\x20Code':_0x3357d3[_0x244da2(0x2f2)],'Product\x20Name':_0x3357d3[_0x244da2(0x25e)],'Train\x20No.':_0x470e2d,'Dosage\x20Form':_0x3357d3[_0x244da2(0x254)]||'','Batch\x20Size\x20(Kg)':_0x3357d3[_0x244da2(0x27b)],'Special\x20Case\x20Product':_0x29f4fb,'Active\x20Ingredient':'','Solubility':'','Therapeutic\x20Dose\x20(mg/day)':'','Cleanability':'','PDE\x20(µg/day)':'','LD50\x20(mg/kg)':'','Solubility\x20Score':'','Therapeutic\x20Dose\x20Score':'','Cleanability\x20Score':'','Toxicity\x20Score':'','RPN':'','RPN\x20Rating':''}),_0x3357d3[_0x244da2(0x34d)][_0x244da2(0x2e5)](_0x4bd464=>{const _0x474808=_0x244da2,_0x32f2ed=_0x4262e8(_0x4bd464);_0x2c188e[_0x474808(0x1df)]({'Date':'','Product\x20Code':'','Product\x20Name':_0x474808(0x369)+_0x4bd464[_0x474808(0x25e)],'Train\x20No.':'','Dosage\x20Form':'','Batch\x20Size\x20(Kg)':'','Special\x20Case\x20Product':'','Active\x20Ingredient':_0x4bd464[_0x474808(0x25e)],'Solubility':_0x4bd464[_0x474808(0x1ee)]||'','Therapeutic\x20Dose\x20(mg/day)':_0x4bd464[_0x474808(0x2ca)]||'','Cleanability':_0x4bd464[_0x474808(0x1c4)]||'','PDE\x20(µg/day)':_0x4bd464[_0x474808(0x28e)]||'','LD50\x20(mg/kg)':_0x4bd464[_0x474808(0x295)]||'','Solubility\x20Score':_0x32f2ed[_0x474808(0x2a6)]||'','Therapeutic\x20Dose\x20Score':_0x32f2ed[_0x474808(0x26c)]||'','Cleanability\x20Score':_0x32f2ed[_0x474808(0x34f)]||'','Toxicity\x20Score':_0x32f2ed[_0x474808(0x2a8)]||_0x32f2ed[_0x474808(0x17c)]||'','RPN':_0x32f2ed[_0x474808(0x142)],'RPN\x20Rating':_0x32f2ed[_0x474808(0x2c6)]});});}),_0x23fda5[_0x382822(0x2b0)](0x0,_0x2c188e[_0x382822(0x1ca)]))return _0x23fda5['tINQh'](hideLoader),void _0x23fda5[_0x382822(0x11f)](showCustomAlert,_0x23fda5[_0x382822(0x2c7)],_0x23fda5[_0x382822(0x266)]);const _0x38930c=XLSX[_0x382822(0x2c4)][_0x382822(0x284)](_0x2c188e),_0x5b25c5=XLSX[_0x382822(0x2c4)]['book_new']();XLSX['utils'][_0x382822(0x137)](_0x5b25c5,_0x38930c,_0x23fda5[_0x382822(0x11e)]);const _0x16122c=Object['keys'](_0x2c188e[0x0])[_0x382822(0x119)](_0x360703=>({'wch':Math[_0x382822(0x255)](_0x360703[_0x382822(0x1ca)],..._0x2c188e['map'](_0x7d904e=>String(_0x7d904e[_0x360703]||'')[_0x382822(0x1ca)]))+0x2}));_0x38930c[_0x382822(0x207)]=_0x16122c,XLSX[_0x382822(0x11c)](_0x5b25c5,_0x23fda5[_0x382822(0x251)]),_0x23fda5['tINQh'](hideLoader);})[_0x2b57ae(0x12e)](_0x9267f8=>{const _0x4e5316=_0x2b57ae;console[_0x4e5316(0x300)](_0x23fda5[_0x4e5316(0x16a)],_0x9267f8),_0x23fda5[_0x4e5316(0x277)](hideLoader),_0x23fda5['dxGDu'](showCustomAlert,_0x23fda5['BmAWP'],_0x23fda5['kmeZZ']);});}export function exportAllToJson(){const _0x452ca7=a13_0x158406,_0x542e55={'duiuL':function(_0x3190f0){return _0x3190f0();},'vyvGE':_0x452ca7(0x179),'gwvWD':'maco_data_export.json','UGsgp':function(_0x539ea5,_0x41d7a7,_0x386c45){return _0x539ea5(_0x41d7a7,_0x386c45);},'BGnqa':_0x452ca7(0x2f9),'OOGUZ':function(_0x5570d5,_0x57d2a7){return _0x5570d5+_0x57d2a7;}};_0x542e55[_0x452ca7(0x1f6)](showLoader);try{const _0x15c092={'exportDate':new Date()[_0x452ca7(0x35a)](),'scoringCriteria':a13_0x20cf21['scoringCriteria'],'products':a13_0x20cf21[_0x452ca7(0x1d0)],'machines':a13_0x20cf21[_0x452ca7(0x1c0)],'detergentIngredients':a13_0x20cf21[_0x452ca7(0x354)]},_0x473415=JSON[_0x452ca7(0x2c3)](_0x15c092,null,0x2),_0x42c13c=new Blob([_0x473415],{'type':_0x542e55['vyvGE']}),_0x47e2b7=URL[_0x452ca7(0x246)](_0x42c13c),_0x334837=document[_0x452ca7(0x2ae)]('a');_0x334837['href']=_0x47e2b7,_0x334837[_0x452ca7(0x225)]=_0x542e55[_0x452ca7(0x149)],document[_0x452ca7(0x347)][_0x452ca7(0x2fa)](_0x334837),_0x334837[_0x452ca7(0x173)](),document['body'][_0x452ca7(0x14b)](_0x334837),URL['revokeObjectURL'](_0x47e2b7);}catch(_0x5bb128){_0x542e55[_0x452ca7(0x2ba)](showCustomAlert,_0x542e55[_0x452ca7(0x194)],_0x542e55[_0x452ca7(0x1c1)](_0x452ca7(0x17f),_0x5bb128[_0x452ca7(0x263)]));}finally{hideLoader();}}export function importFromJson(_0x4ef5f8){const _0x109512=a13_0x158406,_0x37113a={'xdXcK':function(_0x222e2e){return _0x222e2e();},'CEoUT':function(_0xb03e6e){return _0xb03e6e();},'wSFFX':_0x109512(0x1ad),'Adgww':'Error','qOaid':_0x109512(0x285),'grser':function(_0x324401,_0x495d3e,_0x1c8d3f){return _0x324401(_0x495d3e,_0x1c8d3f);},'MuRrL':'Failed\x20to\x20parse\x20JSON\x20file.'},_0x5c14b4=_0x4ef5f8[_0x109512(0x28a)][_0x109512(0x292)][0x0];if(!_0x5c14b4)return;const _0x56f8de=new FileReader();_0x56f8de[_0x109512(0x2b9)]=function(_0x49f689){const _0x27713a=_0x109512;try{const _0x19032f=JSON['parse'](_0x49f689[_0x27713a(0x28a)][_0x27713a(0x252)]);_0x19032f&&_0x19032f['products']&&_0x19032f[_0x27713a(0x2d9)]&&_0x19032f['machines']?(a13_0x20cf21['setProducts'](_0x19032f[_0x27713a(0x1d0)]),a13_0x20cf21['setMachines'](_0x19032f[_0x27713a(0x1c0)]),a13_0x20cf21[_0x27713a(0x248)](_0x19032f[_0x27713a(0x2d9)]),_0x19032f[_0x27713a(0x354)]&&a13_0x20cf21['setDetergentIngredients'](_0x19032f['detergentIngredients']),_0x37113a[_0x27713a(0x30c)](saveStateForUndo),_0x37113a[_0x27713a(0x309)](a13_0xf47647),showCustomAlert(_0x27713a(0x210),_0x37113a[_0x27713a(0x2f5)])):showCustomAlert(_0x37113a[_0x27713a(0x195)],_0x37113a['qOaid']);}catch(_0x41d389){_0x37113a[_0x27713a(0x127)](showCustomAlert,_0x37113a['Adgww'],_0x37113a[_0x27713a(0x152)]);}finally{_0x4ef5f8[_0x27713a(0x28a)]['value']='';}},_0x56f8de[_0x109512(0x165)](_0x5c14b4);}export function toggleOtherProductType(_0x2ef034,_0x390884){const _0x5de38f=a13_0x158406,_0x194eb7={'caGeQ':function(_0x348c8b,_0x35fbb9){return _0x348c8b===_0x35fbb9;},'XkJmz':_0x5de38f(0x253)},_0x2dfb21=document[_0x5de38f(0x2de)](_0x390884),_0x45932c=_0x2dfb21[_0x5de38f(0x156)](_0x5de38f(0x1ea));_0x194eb7['caGeQ'](_0x194eb7['XkJmz'],_0x2ef034[_0x5de38f(0x1b0)])?(_0x2dfb21['style'][_0x5de38f(0x1bb)]='block',_0x45932c[_0x5de38f(0x17d)]=!0x0):(_0x2dfb21['style']['display']=_0x5de38f(0x1a5),_0x45932c[_0x5de38f(0x17d)]=!0x1,_0x45932c[_0x5de38f(0x1b0)]='');}export function toggleOtherMachineStage(_0x4b732b,_0x3e7481){const _0x57c139=a13_0x158406,_0x53cd42={'LKOjY':_0x57c139(0x1ea),'pSqeu':function(_0x1316c9,_0x59f2af){return _0x1316c9===_0x59f2af;},'yltiE':_0x57c139(0x23a),'IAmcQ':_0x57c139(0x1a5)},_0x4790e4=document[_0x57c139(0x2de)](_0x3e7481),_0x127645=_0x4790e4[_0x57c139(0x156)](_0x53cd42[_0x57c139(0x26d)]);_0x53cd42[_0x57c139(0x2c9)](_0x57c139(0x253),_0x4b732b[_0x57c139(0x1b0)])?(_0x4790e4[_0x57c139(0x168)]['display']=_0x53cd42[_0x57c139(0x199)],_0x127645['required']=!0x0):(_0x4790e4[_0x57c139(0x168)][_0x57c139(0x1bb)]=_0x53cd42['IAmcQ'],_0x127645[_0x57c139(0x17d)]=!0x1,_0x127645[_0x57c139(0x1b0)]='');}export function toggleOtherMachineGroup(_0x5c4e03,_0x1f2a8a){const _0x2b4ae3=a13_0x158406,_0x15d26d={'EOQnU':_0x2b4ae3(0x1ea),'aaHff':function(_0x1aa344,_0x1e6bfd){return _0x1aa344===_0x1e6bfd;},'wzdsP':_0x2b4ae3(0x253),'JKjMX':_0x2b4ae3(0x23a),'ZQZqc':_0x2b4ae3(0x1a5)},_0x1a71d4=document[_0x2b4ae3(0x2de)](_0x1f2a8a),_0x43c2d0=_0x1a71d4[_0x2b4ae3(0x156)](_0x15d26d[_0x2b4ae3(0x18b)]);_0x15d26d[_0x2b4ae3(0x24a)](_0x15d26d['wzdsP'],_0x5c4e03['value'])?(_0x1a71d4['style'][_0x2b4ae3(0x1bb)]=_0x15d26d[_0x2b4ae3(0x22a)],_0x43c2d0['required']=!0x0):(_0x1a71d4[_0x2b4ae3(0x168)][_0x2b4ae3(0x1bb)]=_0x15d26d['ZQZqc'],_0x43c2d0[_0x2b4ae3(0x17d)]=!0x1,_0x43c2d0[_0x2b4ae3(0x1b0)]='');}export function clampSafetyFactor(_0x150966,_0x5544b4){const _0x48dc35=a13_0x158406,_0x3b6b78={'SYsQD':function(_0x3cf3ba,_0x4875c3){return _0x3cf3ba(_0x4875c3);},'iZeQa':function(_0x17bb71,_0xd45164){return _0x17bb71(_0xd45164);},'TZHDN':function(_0x1edd01,_0x5a40fd){return _0x1edd01(_0x5a40fd);},'woUkE':function(_0x655b84,_0x5b8e00){return _0x655b84<_0x5b8e00;},'FLBXM':function(_0x28e52d,_0x424e4b){return _0x28e52d>_0x424e4b;},'xBWzF':function(_0x3ac451,_0x37fc55){return _0x3ac451!==_0x37fc55;},'dIUnb':_0x48dc35(0x14c),'gLvRd':function(_0x15094d,_0xfd9ce1){return _0x15094d(_0xfd9ce1);}},_0x279793=_0x3b6b78['SYsQD'](parseFloat,_0x150966['min']),_0x165033=_0x3b6b78[_0x48dc35(0x1bf)](parseFloat,_0x150966[_0x48dc35(0x255)]);let _0x1befca=_0x3b6b78[_0x48dc35(0x13d)](parseFloat,_0x150966[_0x48dc35(0x1b0)]);_0x3b6b78[_0x48dc35(0x344)](isNaN,_0x1befca)&&(_0x1befca=_0x279793),_0x3b6b78[_0x48dc35(0x247)](_0x1befca,_0x279793)?_0x1befca=_0x279793:_0x3b6b78[_0x48dc35(0x198)](_0x1befca,_0x165033)&&(_0x1befca=_0x165033),_0x3b6b78['xBWzF'](_0x3b6b78['TZHDN'](parseFloat,_0x150966[_0x48dc35(0x1b0)]),_0x1befca)&&(_0x150966['value']=_0x1befca),_0x150966['id']['startsWith'](_0x48dc35(0x32b))?_0x3b6b78[_0x48dc35(0x13d)](recalculateProductMacoForTrain,_0x5544b4):_0x150966['id'][_0x48dc35(0x2b3)](_0x3b6b78[_0x48dc35(0x1de)])&&_0x3b6b78['gLvRd'](recalculateDetergentMacoForTrain,_0x5544b4);}export function toggleTrain(_0x155ef4){const _0x5118f6=a13_0x158406,_0x5657a3={'zPJYM':function(_0x5a8c89,_0x476c69){return _0x5a8c89&&_0x476c69;},'TvLii':_0x5118f6(0x318)},_0x2dabe9=document[_0x5118f6(0x2de)](_0x5118f6(0x15c)+_0x155ef4),_0x2d6604=document['getElementById'](_0x5118f6(0x24f)+_0x155ef4);_0x5657a3[_0x5118f6(0x328)](_0x2dabe9,_0x2d6604)&&(_0x2dabe9[_0x5118f6(0x136)][_0x5118f6(0x169)](_0x5657a3['TvLii'])?(_0x2dabe9[_0x5118f6(0x136)][_0x5118f6(0x280)](_0x5657a3[_0x5118f6(0x2cf)]),_0x2d6604[_0x5118f6(0x1da)]='▼'):(_0x2dabe9['classList'][_0x5118f6(0x1d1)](_0x5657a3['TvLii']),_0x2d6604[_0x5118f6(0x1da)]='▶'));}export function toggleMacoBreakdown(_0x429f35){const _0x385da7=a13_0x158406,_0x7cea6e={'nZQKs':_0x385da7(0x279),'juFlF':'Hide\x20MACO\x20Calculation\x20Breakdown','LZrXl':_0x385da7(0x264)},_0x288352=document[_0x385da7(0x2de)]('maco-breakdown-details-'+_0x429f35),_0x2a5213=document[_0x385da7(0x2de)](_0x385da7(0x12a)+_0x429f35);_0x288352[_0x385da7(0x136)][_0x385da7(0x169)](_0x7cea6e['nZQKs'])?(_0x288352[_0x385da7(0x136)][_0x385da7(0x280)](_0x7cea6e[_0x385da7(0x1cb)]),_0x2a5213[_0x385da7(0x1da)]=_0x7cea6e[_0x385da7(0x1fb)]):(_0x288352['classList']['add'](_0x7cea6e['nZQKs']),_0x2a5213[_0x385da7(0x1da)]=_0x7cea6e[_0x385da7(0x316)]);}export function exportWorstCaseToExcel(_0x3ffa9f=a13_0x158406(0x244)){const _0x50d227=a13_0x158406,_0x1355ce={'TEBXQ':function(_0xe9da8d,_0x2ac16e){return _0xe9da8d(_0x2ac16e);},'ibovh':function(_0x11e002,_0x374f79){return _0x11e002>_0x374f79;},'hPMrP':'N/A','CnKAD':function(_0x219b87,_0x3a87ae){return _0x219b87===_0x3a87ae;},'YVFXl':function(_0x49acab,_0x33148c,_0x568245){return _0x49acab(_0x33148c,_0x568245);},'sfyNV':_0x50d227(0x200),'FcZSU':'There\x20are\x20no\x20products\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','zZvTq':_0x50d227(0x244),'fHQZM':function(_0x1c0df9){return _0x1c0df9();},'bqChW':function(_0x1c1a84,_0x253d11){return _0x1c1a84===_0x253d11;},'ZsmYD':function(_0x12c673,_0x2d8308,_0x4e4a8a){return _0x12c673(_0x2d8308,_0x4e4a8a);},'gbjox':_0x50d227(0x33f),'ZFEQo':_0x50d227(0x207),'MXhTp':function(_0x3ea214){return _0x3ea214();},'MBHEZ':_0x50d227(0x147),'RdVgi':function(_0x5dfb5c){return _0x5dfb5c();},'aPsgG':_0x50d227(0x2f9),'MfMTi':'Failed\x20to\x20export\x20worst\x20case\x20data\x20to\x20Excel.','njiwD':_0x50d227(0x2d2)};showLoader(),import(_0x1355ce[_0x50d227(0x31d)])[_0x50d227(0x130)](_0x5afa9c=>{const _0x431e9b=_0x50d227,_0x57c9f5={'XoMFl':_0x1355ce[_0x431e9b(0x351)]},{getProductTrainId:_0x5eed6b,calculateScores:_0x53f50e,getToxicityPreference:_0x71a501}=_0x5afa9c,_0x44dca7=[];let _0x29d8e0=a13_0x20cf21[_0x431e9b(0x2c1)][_0x431e9b(0x2f1)]||a13_0x20cf21[_0x431e9b(0x1d0)];if(_0x1355ce[_0x431e9b(0x22d)](0x0,_0x29d8e0[_0x431e9b(0x1ca)]))return hideLoader(),void _0x1355ce['YVFXl'](showCustomAlert,_0x1355ce['sfyNV'],_0x1355ce[_0x431e9b(0x2d6)]);const _0x4548ff={};_0x29d8e0['forEach'](_0x104f51=>{const _0x5a2de5=_0x431e9b,_0x4f30a7=_0x1355ce[_0x5a2de5(0x150)](_0x5eed6b,_0x104f51);_0x5a2de5(0x2f6)!==_0x4f30a7&&(_0x4548ff[_0x4f30a7]||(_0x4548ff[_0x4f30a7]=[]),_0x4548ff[_0x4f30a7][_0x5a2de5(0x1df)](_0x104f51));});let _0x38954a=_0x4548ff;if(_0x1355ce[_0x431e9b(0x211)]!==_0x3ffa9f&&(_0x38954a={},Array[_0x431e9b(0x336)](_0x3ffa9f)?_0x3ffa9f[_0x431e9b(0x2e5)](_0x4ce9a5=>{_0x4548ff[_0x4ce9a5]&&(_0x38954a[_0x4ce9a5]=_0x4548ff[_0x4ce9a5]);}):_0x4548ff[_0x3ffa9f]&&(_0x38954a={[_0x3ffa9f]:_0x4548ff[_0x3ffa9f]}),0x0===Object[_0x431e9b(0x2ce)](_0x38954a)[_0x431e9b(0x1ca)]))return hideLoader(),void showCustomAlert('No\x20Data',(Array[_0x431e9b(0x336)](_0x3ffa9f)?_0x431e9b(0x239)+_0x3ffa9f['join'](',\x20'):_0x431e9b(0x352)+_0x3ffa9f)+_0x431e9b(0x1a8));const _0x4b1385=_0x1355ce[_0x431e9b(0x175)](_0x71a501);if(Object[_0x431e9b(0x2ce)](_0x38954a)[_0x431e9b(0x1e7)]((_0x558abd,_0x260bfa)=>_0x558abd-_0x260bfa)[_0x431e9b(0x2e5)](_0x52f990=>{const _0x3a8ad1=_0x431e9b,_0x402aaa={'FNEAK':function(_0x347219,_0x15793a){return _0x1355ce['ibovh'](_0x347219,_0x15793a);}},_0xacbc07=_0x38954a[_0x52f990];_0x44dca7['push']({'Train':'Train\x20'+_0x52f990+_0x3a8ad1(0x26a),'Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),_0xacbc07[_0x3a8ad1(0x2e5)](_0x4051cf=>{const _0x39825e=_0x3a8ad1,_0x5347b1=_0x4051cf[_0x39825e(0x34d)][_0x39825e(0x119)](_0x5cb875=>_0x53f50e(_0x5cb875,_0x4b1385)['rpn']);_0x4051cf[_0x39825e(0x2bf)]=_0x402aaa[_0x39825e(0x308)](_0x5347b1[_0x39825e(0x1ca)],0x0)?Math['max'](..._0x5347b1):0x0;}),_0xacbc07[_0x3a8ad1(0x1e7)]((_0x16ded2,_0x537c26)=>_0x537c26[_0x3a8ad1(0x2bf)]-_0x16ded2[_0x3a8ad1(0x2bf)]),_0xacbc07['forEach'](_0x24839f=>{const _0x2fbafc=_0x3a8ad1,_0x553f06={'JsZqf':_0x57c9f5[_0x2fbafc(0x2c8)]},_0x94e398=_0x24839f['isCritical']?_0x2fbafc(0x2ee):'No';_0x44dca7[_0x2fbafc(0x1df)]({'Train':'','Product\x20Code':_0x24839f[_0x2fbafc(0x2f2)],'Product\x20Name':_0x24839f[_0x2fbafc(0x25e)],'Highest\x20RPN':_0x24839f[_0x2fbafc(0x2bf)],'Special\x20Case\x20Product':_0x94e398,'Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),(_0x24839f['activeIngredients']['sort']((_0x296567,_0x4d9c74)=>_0x53f50e(_0x4d9c74,_0x4b1385)[_0x2fbafc(0x142)]-_0x53f50e(_0x296567,_0x4b1385)['rpn'])['forEach'](_0x181b14=>{const _0x1d4a27=_0x2fbafc,_0x385769=_0x53f50e(_0x181b14,_0x4b1385);_0x44dca7[_0x1d4a27(0x1df)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':_0x181b14[_0x1d4a27(0x25e)],'TD\x20Score':_0x385769[_0x1d4a27(0x26c)],'Solubility\x20Score':_0x385769[_0x1d4a27(0x2a6)],'Cleanability\x20Score':_0x385769[_0x1d4a27(0x34f)],'PDE\x20Score':_0x385769[_0x1d4a27(0x2a8)]??_0x553f06['JsZqf'],'LD50\x20Score':_0x385769[_0x1d4a27(0x17c)]??_0x553f06['JsZqf'],'RPN':_0x385769['rpn'],'Rating':_0x385769[_0x1d4a27(0x2c6)]});}),_0x44dca7[_0x2fbafc(0x1df)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}));});}),_0x1355ce[_0x431e9b(0x14e)](0x0,_0x44dca7[_0x431e9b(0x1ca)]))return hideLoader(),void _0x1355ce['ZsmYD'](showCustomAlert,_0x1355ce[_0x431e9b(0x25a)],'There\x20is\x20no\x20data\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.');const _0x42529f=XLSX['utils'][_0x431e9b(0x284)](_0x44dca7),_0x4eede0=XLSX[_0x431e9b(0x2c4)][_0x431e9b(0x17e)]();XLSX[_0x431e9b(0x2c4)]['book_append_sheet'](_0x4eede0,_0x42529f,_0x1355ce[_0x431e9b(0x13e)]);const _0x3dfc5f=Object[_0x431e9b(0x2ce)](_0x44dca7[0x0])[_0x431e9b(0x119)](_0x70ae7b=>({'wch':Math[_0x431e9b(0x255)](_0x70ae7b[_0x431e9b(0x1ca)],..._0x44dca7[_0x431e9b(0x119)](_0x2ae9fc=>String(_0x2ae9fc[_0x70ae7b]||'')[_0x431e9b(0x1ca)]))+0x2}));_0x42529f[_0x1355ce[_0x431e9b(0x2cb)]]=_0x3dfc5f;const _0x288b09=new Date()['toISOString']()[_0x431e9b(0x21c)]('T')[0x0];let _0x1cb580='';_0x1355ce[_0x431e9b(0x211)]!==_0x3ffa9f&&(_0x1cb580=Array[_0x431e9b(0x336)](_0x3ffa9f)?'_Trains_'+_0x3ffa9f[_0x431e9b(0x21b)]('_'):_0x431e9b(0x164)+_0x3ffa9f),XLSX[_0x431e9b(0x11c)](_0x4eede0,_0x431e9b(0x33b)+_0x1cb580+'_'+_0x288b09+'.xlsx'),_0x1355ce[_0x431e9b(0x15f)](hideLoader);})[_0x50d227(0x12e)](_0x2340a2=>{const _0x3d582a=_0x50d227;console['error'](_0x1355ce['MBHEZ'],_0x2340a2),_0x1355ce[_0x3d582a(0x27f)](hideLoader),_0x1355ce[_0x3d582a(0x2d7)](showCustomAlert,_0x1355ce[_0x3d582a(0x1fe)],_0x1355ce[_0x3d582a(0x19c)]);});}export function exportMachinesToExcel(){const _0x4a0500=a13_0x158406,_0x325270={'osRKD':function(_0x258c3c){return _0x258c3c();},'WonXp':function(_0x491ee6,_0x37efbf){return _0x491ee6===_0x37efbf;},'rjait':function(_0x2d60fe,_0x4cfc40,_0x2692cc){return _0x2d60fe(_0x4cfc40,_0x2692cc);},'cbvCp':_0x4a0500(0x187),'VZJpH':_0x4a0500(0x207),'DkHGo':function(_0x3ffadb,_0x443d3a,_0x19b5f3){return _0x3ffadb(_0x443d3a,_0x19b5f3);},'ElQHZ':_0x4a0500(0x210),'iOafQ':_0x4a0500(0x32a),'EGIPd':_0x4a0500(0x2ea),'BYGYZ':function(_0x302c24){return _0x302c24();},'aoaeV':_0x4a0500(0x2f9)};_0x325270[_0x4a0500(0x24e)](showLoader);try{if(_0x325270['WonXp'](0x0,a13_0x20cf21['machines'][_0x4a0500(0x1ca)]))return hideLoader(),void _0x325270[_0x4a0500(0x274)](showCustomAlert,_0x4a0500(0x200),_0x325270[_0x4a0500(0x327)]);const _0x4964d8=[],_0x1619a7={};a13_0x20cf21[_0x4a0500(0x1c0)]['forEach'](_0x5e27a8=>{const _0x49e1a2=_0x4a0500;_0x1619a7[_0x5e27a8[_0x49e1a2(0x30f)]]||(_0x1619a7[_0x5e27a8[_0x49e1a2(0x30f)]]=[]),_0x1619a7[_0x5e27a8[_0x49e1a2(0x30f)]][_0x49e1a2(0x1df)](_0x5e27a8);}),a13_0x20cf21['machineStageDisplayOrder'][_0x4a0500(0x2e5)](_0x1e63e3=>{const _0x14d729=_0x4a0500,_0x101666={'ticCU':_0x14d729(0x2b5)};_0x1619a7[_0x1e63e3]&&_0x1619a7[_0x1e63e3][_0x14d729(0x2e5)](_0x20f618=>{const _0x1f26fb=_0x14d729,_0x2efeb3=a13_0x20cf21[_0x1f26fb(0x1d0)][_0x1f26fb(0x241)](_0x883a66=>_0x883a66['machineIds']&&_0x883a66[_0x1f26fb(0x122)][_0x1f26fb(0x158)](_0x20f618['id'])),_0x3c6e9e=_0x2efeb3[_0x1f26fb(0x119)](_0xf675cd=>_0xf675cd[_0x1f26fb(0x25e)])['join'](',\x20')||_0x101666['ticCU'],_0x3c105a=_0x2efeb3['length'];_0x4964d8[_0x1f26fb(0x1df)]({'Machine\x20Number':_0x20f618[_0x1f26fb(0x25c)],'Machine\x20Name':_0x20f618[_0x1f26fb(0x25e)],'Stage':_0x20f618['stage'],'Area\x20(sq\x20cm)':_0x20f618[_0x1f26fb(0x20e)],'Assigned\x20Products\x20Count':_0x3c105a,'Assigned\x20Products':_0x3c6e9e});});});const _0x39089a=XLSX[_0x4a0500(0x2c4)][_0x4a0500(0x284)](_0x4964d8),_0x2724ae=XLSX[_0x4a0500(0x2c4)][_0x4a0500(0x17e)]();XLSX[_0x4a0500(0x2c4)][_0x4a0500(0x137)](_0x2724ae,_0x39089a,_0x4a0500(0x272));const _0x14acda=[{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0xf},{'wch':0x14},{'wch':0x32}];_0x39089a[_0x325270[_0x4a0500(0x19f)]]=_0x14acda;const _0x1c113=new Date()['toISOString']()['split']('T')[0x0];XLSX[_0x4a0500(0x11c)](_0x2724ae,_0x4a0500(0x1f9)+_0x1c113+'.xlsx'),hideLoader(),_0x325270[_0x4a0500(0x2bb)](showCustomAlert,_0x325270['ElQHZ'],_0x325270[_0x4a0500(0x27a)]);}catch(_0x4b8167){console[_0x4a0500(0x300)](_0x325270[_0x4a0500(0x1ba)],_0x4b8167),_0x325270[_0x4a0500(0x1c8)](hideLoader),_0x325270[_0x4a0500(0x274)](showCustomAlert,_0x325270['aoaeV'],_0x4a0500(0x233));}}export function exportProductMacoToExcel(_0x351d54=a13_0x158406(0x244)){const _0x458234=a13_0x158406,_0x2c1970={'ijEnb':function(_0x4a747f,_0x21adc0){return _0x4a747f||_0x21adc0;},'dEZmM':_0x458234(0x2f6),'ALKnH':function(_0x3a620e,_0x3d372b){return _0x3a620e/_0x3d372b;},'NWgpF':function(_0x4d8ec8,_0x2bfcd5){return _0x4d8ec8*_0x2bfcd5;},'ARvnV':function(_0x39f74a,_0x9c1575){return _0x39f74a*_0x9c1575;},'WHJcv':function(_0x51bcb6,_0x43d63a){return _0x51bcb6!==_0x43d63a;},'KBFXi':function(_0x501ec4,_0x2d00e2){return _0x501ec4*_0x2d00e2;},'NuhBg':'0.1%\x20Therapeutic\x20Dose','EqKyU':_0x458234(0x2db),'osWuF':_0x458234(0x1ff),'JwHTb':_0x458234(0x350),'IZcMI':function(_0x639a09){return _0x639a09();},'hPYIH':function(_0x5b802d,_0x5046eb){return _0x5b802d===_0x5046eb;},'TNuwY':function(_0x1e6906,_0x1df847,_0x40e701){return _0x1e6906(_0x1df847,_0x40e701);},'zRKWn':function(_0x457245,_0x4a7083){return _0x457245!==_0x4a7083;},'nYJPY':_0x458234(0x244),'kbquR':'No\x20trains\x20match\x20the\x20selected\x20criteria.','HGFCE':_0x458234(0x207),'CQYSq':_0x458234(0x1d9),'kfBvr':function(_0x1ae85c,_0x5a33dd){return _0x1ae85c!==_0x5a33dd;},'RJrfI':function(_0x103ebc){return _0x103ebc();},'LdcaG':'Product\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','iVOjS':_0x458234(0x2dc),'FVwQN':_0x458234(0x2f9),'SSTjR':_0x458234(0x229)};showLoader(),import(_0x458234(0x2d2))[_0x458234(0x130)](_0x3f9246=>{const _0x1860a8=_0x458234,_0x23f47b={'QZgNm':function(_0x2583d0,_0x127948){const _0x1fc658=a13_0x1b54;return _0x2c1970[_0x1fc658(0x343)](_0x2583d0,_0x127948);},'nTBWE':_0x2c1970[_0x1860a8(0x23c)],'hhufu':function(_0x3d32bc,_0x84082f){return _0x3d32bc(_0x84082f);},'NCXFJ':function(_0x4f78cb,_0x4a4065){const _0x3cb0ca=_0x1860a8;return _0x2c1970[_0x3cb0ca(0x245)](_0x4f78cb,_0x4a4065);},'GLFWy':function(_0x4b4cd8,_0x4a3424){const _0x195b2d=_0x1860a8;return _0x2c1970[_0x195b2d(0x238)](_0x4b4cd8,_0x4a3424);},'iUlpO':function(_0x196da5,_0x39a499){const _0x23ba32=_0x1860a8;return _0x2c1970[_0x23ba32(0x353)](_0x196da5,_0x39a499);},'iHrvl':function(_0x22ee42,_0x560e64){const _0x1c6626=_0x1860a8;return _0x2c1970[_0x1c6626(0x205)](_0x22ee42,_0x560e64);},'JslET':function(_0x4fe367,_0x2bc236){return _0x2c1970['KBFXi'](_0x4fe367,_0x2bc236);},'hFGeM':_0x2c1970['NuhBg'],'KbOgk':_0x2c1970[_0x1860a8(0x2e0)],'NBYqJ':_0x2c1970[_0x1860a8(0x23b)],'UGbln':function(_0x35f69e,_0x3ec3a3){return _0x35f69e==_0x3ec3a3;},'GrjBu':_0x2c1970[_0x1860a8(0x166)]},{getTrainData:_0x3b6c7e,getWorstCaseProductType:_0x1ad19e,getMacoPerSwabForTrain:_0x3f8739}=_0x3f9246,_0x240c43=_0x2c1970['IZcMI'](_0x3b6c7e);if(_0x2c1970[_0x1860a8(0x1fa)](0x0,_0x240c43[_0x1860a8(0x1ca)]))return hideLoader(),void _0x2c1970[_0x1860a8(0x261)](showCustomAlert,_0x1860a8(0x200),_0x1860a8(0x1f8));let _0xbce194=_0x240c43;if(_0x2c1970['zRKWn'](_0x2c1970[_0x1860a8(0x182)],_0x351d54)&&(_0xbce194=Array[_0x1860a8(0x336)](_0x351d54)?_0x240c43[_0x1860a8(0x241)](_0x4f5ec6=>_0x351d54[_0x1860a8(0x158)](String(_0x4f5ec6['id']))):_0x240c43[_0x1860a8(0x241)](_0x18b982=>String(_0x18b982['id'])===String(_0x351d54))),0x0===_0xbce194[_0x1860a8(0x1ca)])return _0x2c1970['IZcMI'](hideLoader),void showCustomAlert(_0x1860a8(0x200),_0x2c1970[_0x1860a8(0x311)]);const _0x280324=[],_0x43b567=_0x240c43[_0x1860a8(0x34b)]((_0x26e4a3,_0x496887)=>_0x496887[_0x1860a8(0x1aa)]>_0x26e4a3[_0x1860a8(0x1aa)]?_0x496887:_0x26e4a3)['essa'];_0xbce194[_0x1860a8(0x2e5)](_0x199157=>{const _0x36f44e=_0x1860a8,_0x5bc790=_0x23f47b[_0x36f44e(0x14a)](_0x1ad19e,_0x199157[_0x36f44e(0x1d0)]['map'](_0x25be6c=>_0x25be6c[_0x36f44e(0x254)])),_0x4ff6b6=(a13_0x20cf21[_0x36f44e(0x2bd)][_0x5bc790]||a13_0x20cf21[_0x36f44e(0x2bd)][_0x36f44e(0x253)])[_0x36f44e(0x255)],_0x27cdd2=_0x23f47b[_0x36f44e(0x334)](_0x23f47b[_0x36f44e(0x222)](_0x199157[_0x36f44e(0x348)],_0x199157['minBsMddRatio']),_0x4ff6b6),_0x30a616=_0x23f47b[_0x36f44e(0x1e5)](0xa,_0x199157[_0x36f44e(0x23d)]);let _0x5dc9e4=_0x23f47b['nTBWE'];_0x23f47b[_0x36f44e(0x1d3)](null,_0x199157[_0x36f44e(0x2eb)])&&(_0x5dc9e4=_0x23f47b[_0x36f44e(0x146)](_0x199157[_0x36f44e(0x2eb)],_0x199157['minBsMddRatio']));const _0x1f4273=0.004*_0x43b567,_0x161fc6=[{'name':_0x23f47b[_0x36f44e(0x2a4)],'value':_0x27cdd2},{'name':_0x23f47b['KbOgk'],'value':_0x30a616},{'name':_0x23f47b[_0x36f44e(0x365)],'value':_0x23f47b[_0x36f44e(0x32d)](_0x36f44e(0x31f),typeof _0x5dc9e4)?_0x5dc9e4:0x1/0x0},{'name':_0x23f47b['GrjBu'],'value':_0x1f4273}][_0x36f44e(0x34b)]((_0x18dca8,_0x100978)=>_0x100978[_0x36f44e(0x1b0)]<_0x18dca8[_0x36f44e(0x1b0)]?_0x100978:_0x18dca8),_0x23d433=_0x161fc6['value'],_0x8e1813=_0x43b567>0x0?_0x23d433/_0x43b567:0x0,_0x4d297d=_0x23f47b[_0x36f44e(0x222)](_0x8e1813,_0x199157['assumedSsa']),_0x55b860=_0x199157[_0x36f44e(0x122)]['map'](_0x2ec77a=>{const _0x44e410=_0x36f44e,_0x2d1f88=a13_0x20cf21['machines'][_0x44e410(0x270)](_0x53cfef=>_0x53cfef['id']===_0x2ec77a);return _0x23f47b[_0x44e410(0x214)](_0x2d1f88,{'name':_0x44e410(0x367)+_0x2ec77a+')','machineNumber':_0x23f47b['nTBWE']});}),_0x2688d9=_0x199157[_0x36f44e(0x122)][_0x36f44e(0x119)](_0x58eaba=>{const _0x2bbf68=_0x36f44e,_0x27c495=a13_0x20cf21[_0x2bbf68(0x1c0)]['find'](_0x265d80=>_0x265d80['id']===_0x58eaba);return _0x27c495?_0x27c495[_0x2bbf68(0x25e)]:_0x2bbf68(0x367)+_0x58eaba+')';})[_0x36f44e(0x21b)](',\x20'),_0x169b45=_0x199157[_0x36f44e(0x1d0)]['map'](_0x5b406a=>_0x5b406a[_0x36f44e(0x2f2)]+_0x36f44e(0x1ef)+_0x5b406a[_0x36f44e(0x25e)])['join'](';\x20'),_0x5794fa=_0x199157[_0x36f44e(0x2e4)]?_0x199157[_0x36f44e(0x2e4)][_0x36f44e(0x329)]+'\x20('+_0x199157[_0x36f44e(0x2e4)][_0x36f44e(0x27d)]+')\x20-\x20RPN:\x20'+_0x199157[_0x36f44e(0x2e4)][_0x36f44e(0x142)]:_0x36f44e(0x2f6);_0x280324[_0x36f44e(0x1df)]({'Train':'T'+_0x199157['id'],'Total\x20Products':_0x199157[_0x36f44e(0x1d0)][_0x36f44e(0x1ca)],'Total\x20Machines':_0x55b860[_0x36f44e(0x1ca)],'Total\x20Area\x20(ESSA)\x20cm²':_0x199157[_0x36f44e(0x1aa)][_0x36f44e(0x19d)](),'Products':_0x169b45,'Machines':_0x2688d9,'Worst-Case\x20Dosage\x20Form':_0x5bc790,'Safety\x20Factor':_0x4ff6b6,'Lowest\x20LTD\x20(mg)':_0x199157[_0x36f44e(0x348)],'Min\x20Batch\x20Size\x20(kg)':_0x199157[_0x36f44e(0x23d)],'Min\x20BS/MDD\x20Ratio':_0x199157[_0x36f44e(0x2e3)][_0x36f44e(0x1a1)](0x2),'Lowest\x20PDE\x20(mg)':_0x23f47b[_0x36f44e(0x1d3)](null,_0x199157[_0x36f44e(0x2eb)])?_0x199157[_0x36f44e(0x2eb)]:_0x23f47b[_0x36f44e(0x302)],'Worst-Case\x20Product\x20(by\x20RPN)':_0x5794fa,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x27cdd2['toFixed'](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x30a616[_0x36f44e(0x1a1)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x23f47b[_0x36f44e(0x32d)](_0x36f44e(0x31f),typeof _0x5dc9e4)?_0x5dc9e4[_0x36f44e(0x1a1)](0x2):_0x36f44e(0x2f6),'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x1f4273[_0x36f44e(0x1a1)](0x2),'Selected\x20MACO\x20Method':_0x161fc6[_0x36f44e(0x25e)],'Final\x20MACO\x20(mg)':_0x23d433[_0x36f44e(0x1a1)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x8e1813[_0x36f44e(0x260)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x4d297d['toFixed'](0x4)});});const _0x17fba0=XLSX[_0x1860a8(0x2c4)][_0x1860a8(0x284)](_0x280324),_0x4ed1de=XLSX['utils'][_0x1860a8(0x17e)]();XLSX['utils'][_0x1860a8(0x137)](_0x4ed1de,_0x17fba0,_0x1860a8(0x153)),_0x17fba0[_0x2c1970[_0x1860a8(0x2fe)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0x12},{'wch':0xf},{'wch':0x12},{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0x12},{'wch':0x12}];const _0x411dbd=new Date()[_0x1860a8(0x35a)]()[_0x1860a8(0x21c)]('T')[0x0];let _0x186862=_0x2c1970['CQYSq'];if(_0x2c1970['kfBvr'](_0x2c1970[_0x1860a8(0x182)],_0x351d54)){if(Array['isArray'](_0x351d54))_0x186862+=_0x1860a8(0x357)+_0x351d54[_0x1860a8(0x1e7)]((_0x5df2cc,_0xf13a)=>_0x5df2cc-_0xf13a)[_0x1860a8(0x21b)]('_');else _0x186862+=_0x1860a8(0x164)+_0x351d54;}_0x186862+='_'+_0x411dbd+_0x1860a8(0x2cd),XLSX[_0x1860a8(0x11c)](_0x4ed1de,_0x186862),_0x2c1970[_0x1860a8(0x2d5)](hideLoader),_0x2c1970[_0x1860a8(0x261)](showCustomAlert,_0x1860a8(0x210),_0x2c1970[_0x1860a8(0x1e9)]);})[_0x458234(0x12e)](_0x2e465f=>{const _0x347493=_0x458234;console[_0x347493(0x300)](_0x2c1970[_0x347493(0x12f)],_0x2e465f),_0x2c1970['IZcMI'](hideLoader),showCustomAlert(_0x2c1970[_0x347493(0x139)],_0x2c1970[_0x347493(0x172)]);});}export function exportDetergentMacoToExcel(_0x118d40='all'){const _0x58d696=a13_0x158406,_0x2b7e15={'rXHPW':function(_0x14e913,_0x5f11cf){return _0x14e913(_0x5f11cf);},'JxQLG':function(_0xdd98eb,_0x45e755){return _0xdd98eb/_0x45e755;},'DQZIp':function(_0x3065e7,_0x5949d8){return _0x3065e7*_0x5949d8;},'sRMyI':function(_0x7d7b50,_0x545263){return _0x7d7b50>_0x545263;},'KBefs':function(_0x52c029,_0x4e5e07){return _0x52c029*_0x4e5e07;},'uowIQ':function(_0x4b6ebc){return _0x4b6ebc();},'mwBNT':'all','KJUhF':function(_0x358354,_0x48b9c6,_0x1d8a4c){return _0x358354(_0x48b9c6,_0x1d8a4c);},'PLOrJ':_0x58d696(0x200),'qOihr':_0x58d696(0x1f8),'KehAD':function(_0x1eae1b,_0x3a11c9){return _0x1eae1b===_0x3a11c9;},'ySDRo':function(_0x5374f7){return _0x5374f7();},'uiftK':_0x58d696(0x359),'jELTk':_0x58d696(0x1e2),'KcpYZ':_0x58d696(0x19b),'nNfzX':function(_0x49e040,_0x5e0c97,_0x3c11e9){return _0x49e040(_0x5e0c97,_0x3c11e9);},'XnKVY':_0x58d696(0x210),'rZfps':_0x58d696(0x2be),'cVItA':_0x58d696(0x2f4),'lsJGt':_0x58d696(0x2f9),'FolMW':_0x58d696(0x313),'jyaXu':_0x58d696(0x2d2)};_0x2b7e15['ySDRo'](showLoader),import(_0x2b7e15[_0x58d696(0x1d4)])[_0x58d696(0x130)](_0x1aab62=>{const _0x7eb359=_0x58d696,{getTrainData:_0x26e037,getWorstCaseProductType:_0x14486b}=_0x1aab62;let _0x11d25a=_0x2b7e15[_0x7eb359(0x20d)](_0x26e037);if(_0x2b7e15[_0x7eb359(0x296)]!==_0x118d40&&(_0x11d25a=Array[_0x7eb359(0x336)](_0x118d40)?_0x11d25a[_0x7eb359(0x241)](_0x4f30dc=>_0x118d40[_0x7eb359(0x158)](String(_0x4f30dc['id']))):_0x11d25a[_0x7eb359(0x241)](_0x356b11=>String(_0x356b11['id'])===String(_0x118d40))),0x0===_0x11d25a[_0x7eb359(0x1ca)])return hideLoader(),void _0x2b7e15['KJUhF'](showCustomAlert,_0x2b7e15[_0x7eb359(0x256)],_0x2b7e15[_0x7eb359(0x128)]);if(_0x2b7e15[_0x7eb359(0x2ad)](0x0,a13_0x20cf21[_0x7eb359(0x354)][_0x7eb359(0x1ca)]))return _0x2b7e15[_0x7eb359(0x32e)](hideLoader),void _0x2b7e15['KJUhF'](showCustomAlert,_0x2b7e15[_0x7eb359(0x256)],_0x2b7e15[_0x7eb359(0x134)]);const _0x51450d=[],_0x3c4c3d=_0x11d25a[_0x7eb359(0x1ca)]>0x0?Math['max'](..._0x11d25a['map'](_0xfae45c=>_0xfae45c[_0x7eb359(0x1aa)])):0x0,_0x5817a1=_0x2b7e15['rXHPW'](parseFloat,document[_0x7eb359(0x2de)](_0x2b7e15[_0x7eb359(0x1fc)])?.[_0x7eb359(0x1b0)])||0x46,_0x52cfce=a13_0x20cf21[_0x7eb359(0x354)][_0x7eb359(0x119)](_0x33ac09=>parseFloat(_0x33ac09[_0x7eb359(0x295)]))['filter'](_0x457f12=>!isNaN(_0x457f12)),_0x1cb376=_0x52cfce[_0x7eb359(0x1ca)]>0x0?Math[_0x7eb359(0x287)](..._0x52cfce):0x0,_0x2d5247=a13_0x20cf21[_0x7eb359(0x354)]['map'](_0x20ff41=>_0x20ff41[_0x7eb359(0x25e)])[_0x7eb359(0x241)](_0x3d3873=>''!==_0x3d3873[_0x7eb359(0x13b)]())[_0x7eb359(0x21b)](',\x20');_0x11d25a['forEach'](_0x186237=>{const _0x128b24=_0x7eb359,_0x35021e=_0x14486b(_0x186237['products'][_0x128b24(0x119)](_0xdcc24b=>_0xdcc24b[_0x128b24(0x254)])),_0x1ea238=a13_0x20cf21[_0x128b24(0x2bd)][_0x35021e]||a13_0x20cf21[_0x128b24(0x2bd)][_0x128b24(0x253)],_0x374f0b=document[_0x128b24(0x2de)](_0x128b24(0x30d)+_0x186237['id']),_0x524c24=_0x374f0b&&_0x2b7e15['rXHPW'](parseFloat,_0x374f0b[_0x128b24(0x1b0)])||_0x1ea238[_0x128b24(0x255)],_0x584526=_0x2b7e15[_0x128b24(0x283)](_0x2b7e15[_0x128b24(0x31b)](_0x2b7e15['DQZIp'](0.0005,_0x1cb376),_0x5817a1),_0x524c24),_0x43357c=_0x2b7e15[_0x128b24(0x31b)](_0x584526,_0x186237[_0x128b24(0x2e3)]),_0x59bdd2=_0x2b7e15[_0x128b24(0x217)](_0x3c4c3d,0x0)?_0x43357c/_0x3c4c3d:0x0,_0xb90a84=_0x2b7e15['KBefs'](_0x59bdd2,_0x186237[_0x128b24(0x234)]),_0x229055=_0x186237[_0x128b24(0x122)][_0x128b24(0x119)](_0x15c711=>{const _0x223a6e=_0x128b24,_0x55e6a8=a13_0x20cf21[_0x223a6e(0x1c0)][_0x223a6e(0x270)](_0x32bbbf=>_0x32bbbf['id']===_0x15c711);return _0x55e6a8||{'name':_0x223a6e(0x367)+_0x15c711+')','machineNumber':_0x223a6e(0x2f6)};}),_0x1a710e=_0x186237[_0x128b24(0x122)][_0x128b24(0x119)](_0x483e22=>{const _0x5e4449=_0x128b24,_0x30f010=a13_0x20cf21[_0x5e4449(0x1c0)][_0x5e4449(0x270)](_0xf92776=>_0xf92776['id']===_0x483e22);return _0x30f010?_0x30f010['name']:'Unknown\x20(ID:\x20'+_0x483e22+')';})['join'](',\x20'),_0x16b9d3=_0x186237[_0x128b24(0x1d0)]['map'](_0x297a4d=>_0x297a4d[_0x128b24(0x2f2)]+_0x128b24(0x1ef)+_0x297a4d[_0x128b24(0x25e)])['join'](';\x20'),_0x4f9247=_0x186237[_0x128b24(0x2e4)]?_0x186237[_0x128b24(0x2e4)][_0x128b24(0x329)]+'\x20('+_0x186237[_0x128b24(0x2e4)][_0x128b24(0x27d)]+')\x20-\x20RPN:\x20'+_0x186237['worstProductRpn'][_0x128b24(0x142)]:_0x128b24(0x2f6);_0x51450d[_0x128b24(0x1df)]({'Train':'T'+_0x186237['id'],'Total\x20Products':_0x186237['products'][_0x128b24(0x1ca)],'Total\x20Machines':_0x229055['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x186237[_0x128b24(0x1aa)][_0x128b24(0x19d)](),'Products':_0x16b9d3,'Machines':_0x1a710e,'Worst-Case\x20Dosage\x20Form':_0x35021e,'Safety\x20Factor\x20Range':_0x1ea238[_0x128b24(0x287)]+_0x128b24(0x1ef)+_0x1ea238['max'],'Applied\x20Safety\x20Factor':_0x524c24,'Detergent\x20Ingredients':_0x2d5247,'Body\x20Weight\x20(kg)':_0x5817a1,'Minimum\x20LD50\x20(mg/kg)':_0x1cb376,'Min\x20Batch\x20Size\x20(kg)':_0x186237[_0x128b24(0x23d)],'Min\x20BS/MDD\x20Ratio':_0x186237[_0x128b24(0x2e3)][_0x128b24(0x1a1)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x4f9247,'ADI\x20(mg)':_0x584526[_0x128b24(0x1a1)](0x4),'MACO\x20(mg)':_0x43357c['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x59bdd2[_0x128b24(0x260)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0xb90a84['toFixed'](0x4)});});const _0xccfbea=XLSX['utils']['json_to_sheet'](_0x51450d),_0x3efcad=XLSX[_0x7eb359(0x2c4)][_0x7eb359(0x17e)]();XLSX[_0x7eb359(0x2c4)][_0x7eb359(0x137)](_0x3efcad,_0xccfbea,_0x2b7e15[_0x7eb359(0x330)]),_0xccfbea[_0x7eb359(0x207)]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0x1e},{'wch':0xc},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0xc},{'wch':0xc},{'wch':0x12},{'wch':0x12}];const _0x51b473=new Date()[_0x7eb359(0x35a)]()['split']('T')[0x0];XLSX[_0x7eb359(0x11c)](_0x3efcad,_0x7eb359(0x2b7)+_0x51b473+_0x7eb359(0x2cd)),hideLoader(),_0x2b7e15['nNfzX'](showCustomAlert,_0x2b7e15[_0x7eb359(0x16c)],_0x2b7e15['rZfps']);})[_0x58d696(0x12e)](_0x56e3f7=>{const _0x147ee3=_0x58d696;console[_0x147ee3(0x300)](_0x2b7e15[_0x147ee3(0x221)],_0x56e3f7),hideLoader(),_0x2b7e15[_0x147ee3(0x368)](showCustomAlert,_0x2b7e15[_0x147ee3(0x151)],_0x2b7e15[_0x147ee3(0x223)]);});}export function exportTrainSummaryToExcel(_0x1db687=a13_0x158406(0x244)){const _0x438698=a13_0x158406,_0x57d699={'lWmHX':function(_0x5060ec,_0x320e45){return _0x5060ec!==_0x320e45;},'bgUTQ':'N/A','SEaoE':function(_0x4167a9,_0x2715c2){return _0x4167a9===_0x2715c2;},'VgogC':function(_0x3cb9d6){return _0x3cb9d6();},'ZVoVb':function(_0xfbdef8,_0x43b565,_0x323273){return _0xfbdef8(_0x43b565,_0x323273);},'OFCNR':_0x438698(0x200),'mmyKT':function(_0x2dcd4b,_0xcf7690){return _0x2dcd4b!==_0xcf7690;},'CAGGl':'all','FvvGs':function(_0x23126b){return _0x23126b();},'aelFK':_0x438698(0x1db),'aCimi':_0x438698(0x268),'qBusd':'Train_Summary_Report','hAQQT':function(_0x566ab0,_0x32268f,_0x1ff5b1){return _0x566ab0(_0x32268f,_0x1ff5b1);},'UtRMv':_0x438698(0x306),'BAHfJ':_0x438698(0x2f9),'xvMPW':_0x438698(0x1d2),'rVsSf':_0x438698(0x2d2)};showLoader(),import(_0x57d699['rVsSf'])[_0x438698(0x130)](_0x30b9f7=>{const _0x23756c=_0x438698,_0x20f0a4={'kVqIo':function(_0x45a815,_0x13473c){return _0x45a815||_0x13473c;},'ThNvv':function(_0x30919f,_0x290e3c){return _0x57d699['lWmHX'](_0x30919f,_0x290e3c);},'dtiKw':_0x57d699['bgUTQ']},{getTrainData:_0xe7ddfb}=_0x30b9f7,_0x2563bd=_0xe7ddfb();if(_0x57d699[_0x23756c(0x26e)](0x0,_0x2563bd[_0x23756c(0x1ca)]))return _0x57d699['VgogC'](hideLoader),void _0x57d699['ZVoVb'](showCustomAlert,_0x57d699[_0x23756c(0x294)],_0x23756c(0x1f8));let _0x246dbf=_0x2563bd;if(_0x57d699['mmyKT'](_0x57d699[_0x23756c(0x36b)],_0x1db687)&&(_0x246dbf=Array[_0x23756c(0x336)](_0x1db687)?_0x2563bd[_0x23756c(0x241)](_0xdac5b5=>_0x1db687[_0x23756c(0x158)](String(_0xdac5b5['id']))):_0x2563bd[_0x23756c(0x241)](_0x2617d2=>String(_0x2617d2['id'])===String(_0x1db687))),_0x57d699['SEaoE'](0x0,_0x246dbf[_0x23756c(0x1ca)]))return _0x57d699[_0x23756c(0x190)](hideLoader),void _0x57d699['ZVoVb'](showCustomAlert,_0x57d699['OFCNR'],_0x57d699[_0x23756c(0x176)]);const _0x366b5d=[];_0x246dbf[_0x23756c(0x2e5)](_0x3ecec2=>{const _0x55032f=_0x23756c,_0x1b3e91={'ndsVJ':function(_0x4e6077,_0x252d9c){const _0x454feb=a13_0x1b54;return _0x20f0a4[_0x454feb(0x235)](_0x4e6077,_0x252d9c);},'nnbRy':_0x55032f(0x2f6)},_0x19f884=_0x3ecec2['machineIds']['map'](_0x34edac=>{const _0x224425=_0x55032f,_0x3b6562=a13_0x20cf21[_0x224425(0x1c0)][_0x224425(0x270)](_0x20a3f=>_0x20a3f['id']===_0x34edac);return _0x1b3e91['ndsVJ'](_0x3b6562,{'id':_0x34edac,'name':'Unknown\x20(ID:\x20'+_0x34edac+')','machineNumber':_0x1b3e91[_0x224425(0x185)]});}),_0xd7e415=_0x3ecec2['machineIds'][_0x55032f(0x119)](_0x289afd=>{const _0x7e82d2=_0x55032f,_0x5d3451=a13_0x20cf21[_0x7e82d2(0x1c0)][_0x7e82d2(0x270)](_0x360acb=>_0x360acb['id']===_0x289afd);return _0x5d3451?_0x5d3451[_0x7e82d2(0x25e)]:_0x7e82d2(0x367)+_0x289afd+')';})['join'](',\x20'),_0x373df5=_0x3ecec2['products'][_0x55032f(0x119)](_0x24d7de=>_0x24d7de[_0x55032f(0x2f2)]+'\x20-\x20'+_0x24d7de[_0x55032f(0x25e)])[_0x55032f(0x21b)](';\x20'),_0x255f12=_0x3ecec2[_0x55032f(0x1d0)][_0x55032f(0x119)](_0x2e17f3=>_0x2e17f3[_0x55032f(0x2f2)]+':\x20'+_0x2e17f3[_0x55032f(0x25e)])['join']('\x0a'),_0x5697f4=_0x19f884[_0x55032f(0x119)](_0x474a08=>_0x474a08['machineNumber']+':\x20'+_0x474a08['name'])[_0x55032f(0x21b)]('\x0a');_0x366b5d['push']({'Train\x20ID':'T'+_0x3ecec2['id'],'Products\x20Count':_0x3ecec2[_0x55032f(0x1d0)][_0x55032f(0x1ca)],'Machines\x20Count':_0x19f884[_0x55032f(0x1ca)],'Total\x20Area\x20(ESSA)\x20cm²':_0x3ecec2['essa']['toLocaleString'](),'Products\x20(Code\x20-\x20Name)':_0x373df5,'Machines\x20(Number\x20-\x20Name)':_0xd7e415,'Products\x20Detailed':_0x255f12,'Machines\x20Detailed':_0x5697f4,'Min\x20Batch\x20Size\x20(kg)':_0x3ecec2[_0x55032f(0x23d)],'Min\x20BS/MDD\x20Ratio':_0x3ecec2[_0x55032f(0x2e3)]['toFixed'](0x2),'Assumed\x20SSA\x20(cm²)':_0x3ecec2[_0x55032f(0x234)],'Lowest\x20LTD\x20(mg)':_0x3ecec2['lowestLtd'],'Lowest\x20PDE\x20(mg)':_0x20f0a4[_0x55032f(0x1f1)](null,_0x3ecec2[_0x55032f(0x2eb)])?_0x3ecec2[_0x55032f(0x2eb)]:'N/A','Worst\x20RPN\x20Product':_0x3ecec2[_0x55032f(0x2e4)]?_0x3ecec2[_0x55032f(0x2e4)][_0x55032f(0x329)]+'\x20('+_0x3ecec2['worstProductRpn'][_0x55032f(0x27d)]+_0x55032f(0x26f)+_0x3ecec2[_0x55032f(0x2e4)][_0x55032f(0x142)]:_0x20f0a4[_0x55032f(0x27e)]});});const _0x3c0ed8=XLSX['utils'][_0x23756c(0x284)](_0x366b5d),_0x170c82=XLSX[_0x23756c(0x2c4)]['book_new']();XLSX['utils'][_0x23756c(0x137)](_0x170c82,_0x3c0ed8,_0x57d699[_0x23756c(0x339)]),_0x3c0ed8[_0x23756c(0x207)]=[{'wch':0xa},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x3c},{'wch':0x3c},{'wch':0x28},{'wch':0x28},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32}];const _0x4c5990=new Date()[_0x23756c(0x35a)]()[_0x23756c(0x21c)]('T')[0x0];let _0x57e06e=_0x57d699[_0x23756c(0x20b)];if(_0x57d699['mmyKT'](_0x57d699[_0x23756c(0x36b)],_0x1db687)){if(Array[_0x23756c(0x336)](_0x1db687))_0x57e06e+=_0x23756c(0x357)+_0x1db687[_0x23756c(0x1e7)]((_0x4f2775,_0x157efd)=>_0x4f2775-_0x157efd)[_0x23756c(0x21b)]('_');else _0x57e06e+=_0x23756c(0x164)+_0x1db687;}_0x57e06e+='_'+_0x4c5990+'.xlsx',XLSX[_0x23756c(0x11c)](_0x170c82,_0x57e06e),hideLoader(),_0x57d699[_0x23756c(0x212)](showCustomAlert,_0x23756c(0x210),_0x57d699[_0x23756c(0x271)]);})[_0x438698(0x12e)](_0x23a563=>{const _0x55649e=_0x438698;console['error'](_0x55649e(0x17a),_0x23a563),_0x57d699[_0x55649e(0x190)](hideLoader),_0x57d699[_0x55649e(0x18e)](showCustomAlert,_0x57d699[_0x55649e(0x126)],_0x57d699['xvMPW']);});}export function exportSummaryToExcel(){const _0x3f119b=a13_0x158406,_0x27983a={'gpKXv':function(_0x44b0c6,_0x37944d){return _0x44b0c6(_0x37944d);},'hhqvj':_0x3f119b(0x2f6),'BMrQW':function(_0x22ed20,_0x15192f){return _0x22ed20!==_0x15192f;},'YsjPh':'Yes','dfSVn':function(_0x5aa13c,_0x12049f){return _0x5aa13c>_0x12049f;},'mvaIu':function(_0x1fe461,_0x18a71f){return _0x1fe461===_0x18a71f;},'jnPlR':function(_0x35bf58){return _0x35bf58();},'ArcXB':function(_0x3f34c2,_0x38ded8,_0x3777e0){return _0x3f34c2(_0x38ded8,_0x3777e0);},'ljuJE':'There\x20are\x20no\x20summary\x20data\x20to\x20export.\x20Add\x20products\x20and\x20ingredients\x20first.','lvAlY':_0x3f119b(0x207),'rpKze':function(_0x55124f,_0x33d7b4){return _0x55124f>_0x33d7b4;},'qDNvb':_0x3f119b(0x35b),'iZvEe':'Success','AGbic':'Summary\x20report\x20data\x20exported\x20to\x20Excel\x20successfully!','AZQos':_0x3f119b(0x35d),'FvUPK':_0x3f119b(0x17b),'avAJe':function(_0x582ec5){return _0x582ec5();}};_0x27983a[_0x3f119b(0x358)](showLoader),import('./utils.js')['then'](_0x5a662f=>{const _0x40710e=_0x3f119b,_0x22e6b8={'rxRqg':function(_0x56ac12,_0x2b63df){return _0x56ac12(_0x2b63df);},'unXmp':function(_0x493cd8,_0x26cc08){const _0x88aedd=a13_0x1b54;return _0x27983a[_0x88aedd(0x236)](_0x493cd8,_0x26cc08);}},{getProductTrainId:_0x1806a4,calculateScores:_0x3451f7}=_0x5a662f,_0x64e974=a13_0x20cf21[_0x40710e(0x1d0)][_0x40710e(0x192)](_0x25b454=>{const _0x13384c=_0x40710e,_0x51eb0a=_0x27983a[_0x13384c(0x204)](_0x1806a4,_0x25b454);return _0x25b454[_0x13384c(0x34d)][_0x13384c(0x119)](_0xe5f812=>({'productName':_0x25b454[_0x13384c(0x25e)],'productCode':_0x25b454[_0x13384c(0x2f2)],'ingredientName':_0xe5f812[_0x13384c(0x25e)],'rpn':_0x3451f7(_0xe5f812)['rpn'],'trainId':_0x13384c(0x2f6)!==_0x51eb0a?'T'+_0x51eb0a:'N/A','scores':_0x3451f7(_0xe5f812)}));})[_0x40710e(0x1e7)]((_0x2df531,_0x388732)=>_0x388732['rpn']-_0x2df531[_0x40710e(0x142)])[_0x40710e(0x15d)](0x0,0xa),_0x3df860=a13_0x20cf21['products']['filter'](_0x109cca=>_0x109cca[_0x40710e(0x1ed)]);if(0x0===_0x64e974[_0x40710e(0x1ca)]&&_0x27983a[_0x40710e(0x18a)](0x0,_0x3df860[_0x40710e(0x1ca)]))return _0x27983a[_0x40710e(0x1e8)](hideLoader),void _0x27983a[_0x40710e(0x299)](showCustomAlert,_0x40710e(0x200),_0x27983a[_0x40710e(0x143)]);const _0x51dc3a=XLSX[_0x40710e(0x2c4)][_0x40710e(0x17e)]();if(_0x27983a[_0x40710e(0x236)](_0x64e974[_0x40710e(0x1ca)],0x0)){const _0x32c59b=_0x64e974['map']((_0xf71adb,_0x4248a6)=>({'Rank':_0x4248a6+0x1,'Product\x20Code':_0xf71adb[_0x40710e(0x2f2)],'Product\x20Name':_0xf71adb[_0x40710e(0x329)],'Train':_0xf71adb[_0x40710e(0x227)],'Ingredient':_0xf71adb[_0x40710e(0x27d)],'RPN':_0xf71adb[_0x40710e(0x142)]})),_0x2f4886=XLSX['utils']['json_to_sheet'](_0x32c59b),_0x32e309=[{'wch':0x8},{'wch':0xf},{'wch':0x1e},{'wch':0xa},{'wch':0x19},{'wch':0x8}];_0x2f4886[_0x27983a[_0x40710e(0x249)]]=_0x32e309,XLSX[_0x40710e(0x2c4)][_0x40710e(0x137)](_0x51dc3a,_0x2f4886,_0x40710e(0x28d));}if(_0x27983a[_0x40710e(0x305)](_0x3df860['length'],0x0)){const _0x3b21ec=_0x3df860[_0x40710e(0x119)](_0x5eab12=>({'Product\x20Code':_0x5eab12['productCode'],'Product\x20Name':_0x5eab12[_0x40710e(0x25e)],'Product\x20Type':_0x5eab12[_0x40710e(0x254)],'Batch\x20Size\x20(kg)':_0x5eab12[_0x40710e(0x27b)],'MDD\x20(mg)':_0x5eab12[_0x40710e(0x21a)],'Critical\x20Reason':_0x5eab12['criticalReason']||'No\x20reason\x20provided','Train':'N/A'!==_0x1806a4(_0x5eab12)?'T'+_0x1806a4(_0x5eab12):_0x40710e(0x2f6)})),_0x428833=XLSX['utils'][_0x40710e(0x284)](_0x3b21ec),_0x646c30=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32},{'wch':0xa}];_0x428833[_0x27983a[_0x40710e(0x249)]]=_0x646c30,XLSX[_0x40710e(0x2c4)]['book_append_sheet'](_0x51dc3a,_0x428833,_0x40710e(0x22c));}const _0x335ea3=a13_0x20cf21['products'][_0x40710e(0x119)](_0x522c04=>{const _0x4b95c0=_0x40710e,_0x3b7d5a=_0x27983a['gpKXv'](_0x1806a4,_0x522c04),_0x4e98ac=_0x522c04[_0x4b95c0(0x34d)][_0x4b95c0(0x34b)]((_0x28bd87,_0x2f9ae6)=>{const _0x54a83c=_0x4b95c0,_0x553f44=_0x22e6b8[_0x54a83c(0x197)](_0x3451f7,_0x2f9ae6)[_0x54a83c(0x142)];return _0x22e6b8['unXmp'](_0x553f44,_0x28bd87[_0x54a83c(0x142)])?{..._0x2f9ae6,'rpn':_0x553f44}:_0x28bd87;},{'rpn':0x0,'name':_0x27983a[_0x4b95c0(0x259)]});return{'Product\x20Code':_0x522c04[_0x4b95c0(0x2f2)],'Product\x20Name':_0x522c04[_0x4b95c0(0x25e)],'Product\x20Type':_0x522c04[_0x4b95c0(0x254)],'Batch\x20Size\x20(kg)':_0x522c04[_0x4b95c0(0x27b)],'MDD\x20(mg)':_0x522c04[_0x4b95c0(0x21a)],'Train':_0x27983a[_0x4b95c0(0x288)](_0x27983a[_0x4b95c0(0x259)],_0x3b7d5a)?'T'+_0x3b7d5a:_0x27983a['hhqvj'],'Is\x20Critical':_0x522c04[_0x4b95c0(0x1ed)]?_0x27983a[_0x4b95c0(0x297)]:'No','Critical\x20Reason':_0x522c04[_0x4b95c0(0x31e)]||_0x27983a[_0x4b95c0(0x259)],'Ingredients\x20Count':_0x522c04[_0x4b95c0(0x34d)][_0x4b95c0(0x1ca)],'Highest\x20RPN\x20Ingredient':_0x4e98ac[_0x4b95c0(0x25e)],'Highest\x20RPN\x20Value':_0x4e98ac[_0x4b95c0(0x142)]||0x0};}),_0x499f8c=XLSX[_0x40710e(0x2c4)]['json_to_sheet'](_0x335ea3);_0x499f8c[_0x27983a[_0x40710e(0x249)]]=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xa},{'wch':0xa},{'wch':0x28},{'wch':0xc},{'wch':0x19},{'wch':0xc}],XLSX[_0x40710e(0x2c4)][_0x40710e(0x137)](_0x51dc3a,_0x499f8c,_0x27983a[_0x40710e(0x19a)]);const _0x399c31=new Date()[_0x40710e(0x35a)]()[_0x40710e(0x21c)]('T')[0x0];XLSX[_0x40710e(0x11c)](_0x51dc3a,'MACO_Summary_Report_'+_0x399c31+'.xlsx'),_0x27983a['jnPlR'](hideLoader),_0x27983a[_0x40710e(0x299)](showCustomAlert,_0x27983a[_0x40710e(0x209)],_0x27983a[_0x40710e(0x20a)]);})[_0x3f119b(0x12e)](_0x5e26ad=>{const _0x24364e=_0x3f119b;console[_0x24364e(0x300)](_0x27983a[_0x24364e(0x273)],_0x5e26ad),_0x27983a[_0x24364e(0x1e8)](hideLoader),_0x27983a[_0x24364e(0x299)](showCustomAlert,_0x24364e(0x2f9),_0x27983a['FvUPK']);});}export function exportAllTabsToExcel(){const _0x425884=a13_0x158406,_0x51dea8={'jMUiS':function(_0x18bd73,_0x2fe4ca){return _0x18bd73||_0x2fe4ca;},'TmHWD':function(_0x2e3357,_0x306843){return _0x2e3357!==_0x306843;},'KCtIF':function(_0x18cdbc,_0x439866){return _0x18cdbc(_0x439866);},'ueMiM':_0x425884(0x2f6),'geoWW':'INGREDIENT','uJEnv':'Yes','DBVuc':function(_0x2b226c,_0x52f46d){return _0x2b226c||_0x52f46d;},'BieHf':function(_0x70cf0f,_0x280cef){return _0x70cf0f*_0x280cef;},'vSbAu':_0x425884(0x321),'ztyTV':function(_0x510426,_0x40db0a){return _0x510426==_0x40db0a;},'VoUMI':_0x425884(0x31f),'MSJRJ':_0x425884(0x350),'eaJpX':function(_0x934fff,_0x33d7f6){return _0x934fff/_0x33d7f6;},'wmtAH':function(_0x230e99,_0x1e5643){return _0x230e99!==_0x1e5643;},'iXGFO':function(_0x1d3ca7,_0x3c8d16){return _0x1d3ca7*_0x3c8d16;},'XQHkZ':function(_0x5484bf){return _0x5484bf();},'YJtTL':_0x425884(0x29b),'Akocf':_0x425884(0x1a6),'pLOan':function(_0xf39408,_0x45e49c){return _0xf39408>_0x45e49c;},'OEJHg':'bodyWeight','ngWoB':function(_0x3feaf5,_0x12f6fd){return _0x3feaf5>_0x12f6fd;},'aBIWP':'Detergent\x20MACO','FHYTP':'Error\x20creating\x20Detergent\x20MACO\x20sheet:','RKMdH':_0x425884(0x2a5),'adCRm':_0x425884(0x22e),'svbSG':'Top\x2010\x20RPN','khCIl':'Critical\x20Products','evBwW':_0x425884(0x29e),'dNJtD':_0x425884(0x35b),'zaPud':_0x425884(0x342),'XbpwI':_0x425884(0x18d),'keGDs':function(_0x60e714){return _0x60e714();},'SMWjE':function(_0x460f9e,_0x3c5da3,_0x44c10d){return _0x460f9e(_0x3c5da3,_0x44c10d);},'ZQnGS':_0x425884(0x210),'yqwot':_0x425884(0x1a2),'qgNCg':function(_0x85907a){return _0x85907a();},'jjLOW':_0x425884(0x2f9),'FGOZj':'Failed\x20to\x20export\x20complete\x20report\x20to\x20Excel.','wysUj':_0x425884(0x2d2)};showLoader(),import(_0x51dea8[_0x425884(0x30e)])[_0x425884(0x130)](_0x3df87a=>{const _0x1b0b76=_0x425884,_0x216ff3={'jBGTF':function(_0x204a31,_0x133653){return _0x51dea8['DBVuc'](_0x204a31,_0x133653);},'rkKYF':_0x1b0b76(0x2f6),'Hssrh':function(_0x1150c0,_0x2ab20f){return _0x1150c0(_0x2ab20f);},'tKmhw':function(_0x3163ae,_0x165c21){const _0x23264b=_0x1b0b76;return _0x51dea8[_0x23264b(0x31a)](_0x3163ae,_0x165c21);},'RVkkh':function(_0x3b25b2,_0x1edbc7){return _0x51dea8['BieHf'](_0x3b25b2,_0x1edbc7);},'obmGo':_0x51dea8[_0x1b0b76(0x32f)],'YjUJk':'10\x20ppm\x20Criterion','WIDRF':function(_0x41aeee,_0xfdb1c1){const _0x39924e=_0x1b0b76;return _0x51dea8[_0x39924e(0x160)](_0x41aeee,_0xfdb1c1);},'Ngthx':_0x51dea8[_0x1b0b76(0x1a3)],'NuGBx':function(_0x5cc67d,_0x596e27){return _0x5cc67d/_0x596e27;},'OQYCA':_0x51dea8[_0x1b0b76(0x215)],'xFHWA':function(_0x5b71ee,_0x5535f6){return _0x5b71ee>_0x5535f6;},'jzqsP':function(_0x582438,_0x352317){const _0x4ea008=_0x1b0b76;return _0x51dea8[_0x4ea008(0x19e)](_0x582438,_0x352317);},'vSbJA':function(_0x33a1e6,_0x2e330a){const _0x4a7c79=_0x1b0b76;return _0x51dea8[_0x4a7c79(0x1a0)](_0x33a1e6,_0x2e330a);},'OJMQr':function(_0x130286,_0x283c49){const _0x3017a0=_0x1b0b76;return _0x51dea8[_0x3017a0(0x148)](_0x130286,_0x283c49);},'PwMwa':function(_0x2472a6,_0xebf943){return _0x2472a6/_0xebf943;},'gMcIk':function(_0x152db3,_0x1dfacb){const _0x58483d=_0x1b0b76;return _0x51dea8[_0x58483d(0x159)](_0x152db3,_0x1dfacb);}},{getTrainData:_0x1cab59,getWorstCaseProductType:_0x28d249,getProductTrainId:_0x320754,calculateScores:_0x1384ab}=_0x3df87a,_0x44abcb=_0x51dea8[_0x1b0b76(0x162)](_0x1cab59);if(0x0===_0x44abcb[_0x1b0b76(0x1ca)])return hideLoader(),void showCustomAlert(_0x1b0b76(0x200),'There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.');const _0xf942d5=XLSX[_0x1b0b76(0x2c4)][_0x1b0b76(0x17e)]();try{const _0x23f5fd=_0x44abcb[_0x1b0b76(0x34b)]((_0xc387e7,_0x41ffc8)=>_0x41ffc8[_0x1b0b76(0x1aa)]>_0xc387e7['essa']?_0x41ffc8:_0xc387e7)['essa'],_0x1c060f=[];_0x44abcb[_0x1b0b76(0x2e5)](_0x5c4604=>{const _0x24ada0=_0x1b0b76,_0xd1b879=_0x216ff3[_0x24ada0(0x140)](_0x28d249,_0x5c4604[_0x24ada0(0x1d0)][_0x24ada0(0x119)](_0x52b5c9=>_0x52b5c9[_0x24ada0(0x254)])),_0x7c0f65=(a13_0x20cf21[_0x24ada0(0x2bd)][_0xd1b879]||a13_0x20cf21[_0x24ada0(0x2bd)][_0x24ada0(0x253)])[_0x24ada0(0x255)],_0x31ef38=_0x216ff3[_0x24ada0(0x2d3)](_0x5c4604[_0x24ada0(0x348)],_0x5c4604[_0x24ada0(0x2e3)])/_0x7c0f65,_0x49fc23=_0x216ff3[_0x24ada0(0x177)](0xa,_0x5c4604[_0x24ada0(0x23d)]);let _0x10f453='N/A';null!==_0x5c4604[_0x24ada0(0x2eb)]&&(_0x10f453=_0x216ff3[_0x24ada0(0x177)](_0x5c4604[_0x24ada0(0x2eb)],_0x5c4604[_0x24ada0(0x2e3)]));const _0x216769=0.004*_0x23f5fd,_0x43faee=[{'name':_0x216ff3[_0x24ada0(0x307)],'value':_0x31ef38},{'name':_0x216ff3[_0x24ada0(0x125)],'value':_0x49fc23},{'name':_0x24ada0(0x1ff),'value':_0x216ff3['WIDRF'](_0x216ff3[_0x24ada0(0x16b)],typeof _0x10f453)?_0x10f453:_0x216ff3[_0x24ada0(0x228)](0x1,0x0)},{'name':_0x216ff3[_0x24ada0(0x21d)],'value':_0x216769}][_0x24ada0(0x34b)]((_0x46de90,_0x234da5)=>_0x234da5[_0x24ada0(0x1b0)]<_0x46de90[_0x24ada0(0x1b0)]?_0x234da5:_0x46de90),_0xca77bb=_0x43faee[_0x24ada0(0x1b0)],_0x75f553=_0x216ff3['xFHWA'](_0x23f5fd,0x0)?_0x216ff3[_0x24ada0(0x2a1)](_0xca77bb,_0x23f5fd):0x0,_0x179b50=_0x216ff3[_0x24ada0(0x2d3)](_0x75f553,_0x5c4604[_0x24ada0(0x234)]),_0x18a972=_0x5c4604[_0x24ada0(0x122)][_0x24ada0(0x119)](_0x51602f=>{const _0x232436=_0x24ada0,_0x44445f=a13_0x20cf21[_0x232436(0x1c0)][_0x232436(0x270)](_0x27327f=>_0x27327f['id']===_0x51602f);return _0x216ff3['jBGTF'](_0x44445f,{'name':_0x232436(0x367)+_0x51602f+')','machineNumber':_0x216ff3['rkKYF']});}),_0x249cbd=_0x5c4604[_0x24ada0(0x122)][_0x24ada0(0x119)](_0x2e7589=>{const _0xbcd759=_0x24ada0,_0x16208e=a13_0x20cf21[_0xbcd759(0x1c0)]['find'](_0x5c019e=>_0x5c019e['id']===_0x2e7589);return _0x16208e?_0x16208e[_0xbcd759(0x25e)]:_0xbcd759(0x367)+_0x2e7589+')';})['join'](',\x20'),_0x11983a=_0x5c4604['products'][_0x24ada0(0x119)](_0x459c13=>_0x459c13[_0x24ada0(0x2f2)]+_0x24ada0(0x1ef)+_0x459c13[_0x24ada0(0x25e)])[_0x24ada0(0x21b)](';\x20'),_0x404a8b=_0x5c4604[_0x24ada0(0x2e4)]?_0x5c4604[_0x24ada0(0x2e4)][_0x24ada0(0x329)]+'\x20('+_0x5c4604[_0x24ada0(0x2e4)][_0x24ada0(0x27d)]+_0x24ada0(0x26f)+_0x5c4604[_0x24ada0(0x2e4)][_0x24ada0(0x142)]:_0x216ff3['rkKYF'];_0x1c060f[_0x24ada0(0x1df)]({'Train':'T'+_0x5c4604['id'],'Total\x20Products':_0x5c4604[_0x24ada0(0x1d0)]['length'],'Total\x20Machines':_0x18a972[_0x24ada0(0x1ca)],'Total\x20Area\x20(ESSA)\x20cm²':_0x5c4604[_0x24ada0(0x1aa)][_0x24ada0(0x19d)](),'Products':_0x11983a,'Machines':_0x249cbd,'Worst-Case\x20Dosage\x20Form':_0xd1b879,'Safety\x20Factor':_0x7c0f65,'Lowest\x20LTD\x20(mg)':_0x5c4604['lowestLtd'],'Min\x20Batch\x20Size\x20(kg)':_0x5c4604[_0x24ada0(0x23d)],'Min\x20BS/MDD\x20Ratio':_0x5c4604['minBsMddRatio'][_0x24ada0(0x1a1)](0x2),'Lowest\x20PDE\x20(mg)':_0x216ff3[_0x24ada0(0x345)](null,_0x5c4604[_0x24ada0(0x2eb)])?_0x5c4604[_0x24ada0(0x2eb)]:_0x216ff3[_0x24ada0(0x124)],'Worst-Case\x20Product\x20(by\x20RPN)':_0x404a8b,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x31ef38['toFixed'](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x49fc23[_0x24ada0(0x1a1)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x216ff3['Ngthx']==typeof _0x10f453?_0x10f453[_0x24ada0(0x1a1)](0x2):'N/A','MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x216769[_0x24ada0(0x1a1)](0x2),'Selected\x20MACO\x20Method':_0x43faee[_0x24ada0(0x25e)],'Final\x20MACO\x20(mg)':_0xca77bb['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x75f553[_0x24ada0(0x260)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x179b50['toFixed'](0x4)});});const _0x3720de=XLSX['utils'][_0x1b0b76(0x284)](_0x1c060f);XLSX[_0x1b0b76(0x2c4)][_0x1b0b76(0x137)](_0xf942d5,_0x3720de,_0x51dea8[_0x1b0b76(0x250)]);}catch(_0x1d8878){console[_0x1b0b76(0x300)](_0x51dea8['Akocf'],_0x1d8878);}try{if(a13_0x20cf21['detergentIngredients']['length']>0x0){const _0x1f710b=_0x51dea8[_0x1b0b76(0x2b8)](_0x44abcb[_0x1b0b76(0x1ca)],0x0)?Math[_0x1b0b76(0x255)](..._0x44abcb[_0x1b0b76(0x119)](_0xf8aeaf=>_0xf8aeaf[_0x1b0b76(0x1aa)])):0x0,_0x3b4cee=_0x51dea8[_0x1b0b76(0x1c3)](parseFloat,document['getElementById'](_0x51dea8[_0x1b0b76(0x178)])?.[_0x1b0b76(0x1b0)])||0x46,_0x46eed5=a13_0x20cf21[_0x1b0b76(0x354)][_0x1b0b76(0x119)](_0x5e6cdd=>parseFloat(_0x5e6cdd['ld50']))['filter'](_0x206b95=>!isNaN(_0x206b95)),_0x2d7de4=_0x51dea8['ngWoB'](_0x46eed5[_0x1b0b76(0x1ca)],0x0)?Math['min'](..._0x46eed5):0x0,_0x299192=a13_0x20cf21['detergentIngredients'][_0x1b0b76(0x119)](_0x16dc25=>_0x16dc25[_0x1b0b76(0x25e)])['filter'](_0x2112ba=>''!==_0x2112ba['trim']())[_0x1b0b76(0x21b)](',\x20'),_0x5b277e=[];_0x44abcb[_0x1b0b76(0x2e5)](_0x2b81c5=>{const _0x464b3a=_0x1b0b76,_0x4bbf76=_0x216ff3[_0x464b3a(0x140)](_0x28d249,_0x2b81c5['products'][_0x464b3a(0x119)](_0x10179d=>_0x10179d['productType'])),_0xa5e7d6=a13_0x20cf21[_0x464b3a(0x2bd)][_0x4bbf76]||a13_0x20cf21[_0x464b3a(0x2bd)][_0x464b3a(0x253)],_0x41b309=document[_0x464b3a(0x2de)](_0x464b3a(0x30d)+_0x2b81c5['id']),_0x4b114b=_0x41b309&&_0x216ff3[_0x464b3a(0x140)](parseFloat,_0x41b309[_0x464b3a(0x1b0)])||_0xa5e7d6[_0x464b3a(0x255)],_0x21a0fc=_0x216ff3[_0x464b3a(0x132)](0.0005*_0x2d7de4*_0x3b4cee,_0x4b114b),_0x30f791=_0x216ff3[_0x464b3a(0x2d3)](_0x21a0fc,_0x2b81c5[_0x464b3a(0x2e3)]),_0x1305ec=_0x216ff3[_0x464b3a(0x364)](_0x1f710b,0x0)?_0x216ff3[_0x464b3a(0x2a1)](_0x30f791,_0x1f710b):0x0,_0x19ddeb=_0x216ff3[_0x464b3a(0x2ab)](_0x1305ec,_0x2b81c5[_0x464b3a(0x234)]),_0x849c37=_0x2b81c5['machineIds']['map'](_0x509c8f=>{const _0x3e881b=_0x464b3a,_0x331675=a13_0x20cf21[_0x3e881b(0x1c0)][_0x3e881b(0x270)](_0x5ea769=>_0x5ea769['id']===_0x509c8f);return _0x216ff3[_0x3e881b(0x363)](_0x331675,{'name':_0x3e881b(0x367)+_0x509c8f+')','machineNumber':_0x216ff3[_0x3e881b(0x124)]});}),_0x29045e=_0x2b81c5['machineIds'][_0x464b3a(0x119)](_0x105db0=>{const _0x3e2620=_0x464b3a,_0x19e5da=a13_0x20cf21[_0x3e2620(0x1c0)]['find'](_0x57009b=>_0x57009b['id']===_0x105db0);return _0x19e5da?_0x19e5da['name']:_0x3e2620(0x367)+_0x105db0+')';})['join'](',\x20'),_0x2675a3=_0x2b81c5[_0x464b3a(0x1d0)][_0x464b3a(0x119)](_0x350181=>_0x350181['productCode']+_0x464b3a(0x1ef)+_0x350181[_0x464b3a(0x25e)])[_0x464b3a(0x21b)](';\x20'),_0x1e6adc=_0x2b81c5[_0x464b3a(0x2e4)]?_0x2b81c5[_0x464b3a(0x2e4)][_0x464b3a(0x329)]+'\x20('+_0x2b81c5[_0x464b3a(0x2e4)][_0x464b3a(0x27d)]+')\x20-\x20RPN:\x20'+_0x2b81c5[_0x464b3a(0x2e4)]['rpn']:_0x216ff3[_0x464b3a(0x124)];_0x5b277e['push']({'Train':'T'+_0x2b81c5['id'],'Total\x20Products':_0x2b81c5[_0x464b3a(0x1d0)]['length'],'Total\x20Machines':_0x849c37[_0x464b3a(0x1ca)],'Total\x20Area\x20(ESSA)\x20cm²':_0x2b81c5[_0x464b3a(0x1aa)][_0x464b3a(0x19d)](),'Products':_0x2675a3,'Machines':_0x29045e,'Worst-Case\x20Dosage\x20Form':_0x4bbf76,'Safety\x20Factor\x20Range':_0xa5e7d6['min']+_0x464b3a(0x1ef)+_0xa5e7d6['max'],'Applied\x20Safety\x20Factor':_0x4b114b,'Detergent\x20Ingredients':_0x299192,'Body\x20Weight\x20(kg)':_0x3b4cee,'Minimum\x20LD50\x20(mg/kg)':_0x2d7de4,'Min\x20Batch\x20Size\x20(kg)':_0x2b81c5['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x2b81c5[_0x464b3a(0x2e3)][_0x464b3a(0x1a1)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x1e6adc,'ADI\x20(mg)':_0x21a0fc['toFixed'](0x4),'MACO\x20(mg)':_0x30f791[_0x464b3a(0x1a1)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x1305ec[_0x464b3a(0x260)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x19ddeb[_0x464b3a(0x1a1)](0x4)});});const _0x70735d=XLSX[_0x1b0b76(0x2c4)][_0x1b0b76(0x284)](_0x5b277e);XLSX[_0x1b0b76(0x2c4)][_0x1b0b76(0x137)](_0xf942d5,_0x70735d,_0x51dea8[_0x1b0b76(0x2b6)]);}}catch(_0x553d4d){console[_0x1b0b76(0x300)](_0x51dea8[_0x1b0b76(0x29c)],_0x553d4d);}try{const _0x3bc756=[];_0x44abcb[_0x1b0b76(0x2e5)](_0x390f35=>{const _0x1f81b2=_0x1b0b76,_0xe4afa9={'FmqyL':function(_0x28c991,_0x22dbb4){const _0x37bbd5=a13_0x1b54;return _0x51dea8[_0x37bbd5(0x148)](_0x28c991,_0x22dbb4);}},_0x13b607=_0x390f35[_0x1f81b2(0x122)][_0x1f81b2(0x119)](_0x3fb1dc=>{const _0x4a761e=_0x1f81b2,_0x41bc14=a13_0x20cf21[_0x4a761e(0x1c0)][_0x4a761e(0x270)](_0x508512=>_0x508512['id']===_0x3fb1dc);return _0xe4afa9[_0x4a761e(0x1f7)](_0x41bc14,{'id':_0x3fb1dc,'name':_0x4a761e(0x367)+_0x3fb1dc+')','machineNumber':'N/A'});}),_0x1deb89=_0x390f35[_0x1f81b2(0x122)][_0x1f81b2(0x119)](_0x1194fa=>{const _0x53333a=_0x1f81b2,_0x1da641=a13_0x20cf21[_0x53333a(0x1c0)][_0x53333a(0x270)](_0x53f427=>_0x53f427['id']===_0x1194fa);return _0x1da641?_0x1da641['name']:_0x53333a(0x367)+_0x1194fa+')';})[_0x1f81b2(0x21b)](',\x20'),_0x1893ea=_0x390f35['products'][_0x1f81b2(0x119)](_0x28e467=>_0x28e467[_0x1f81b2(0x2f2)]+_0x1f81b2(0x1ef)+_0x28e467[_0x1f81b2(0x25e)])[_0x1f81b2(0x21b)](';\x20'),_0x5e86a9=_0x390f35[_0x1f81b2(0x1d0)][_0x1f81b2(0x119)](_0x17e3f9=>_0x17e3f9[_0x1f81b2(0x2f2)]+':\x20'+_0x17e3f9['name'])[_0x1f81b2(0x21b)]('\x0a'),_0x240541=_0x13b607[_0x1f81b2(0x119)](_0x19bcfa=>_0x19bcfa['machineNumber']+':\x20'+_0x19bcfa[_0x1f81b2(0x25e)])['join']('\x0a');_0x3bc756[_0x1f81b2(0x1df)]({'Train\x20ID':'T'+_0x390f35['id'],'Products\x20Count':_0x390f35[_0x1f81b2(0x1d0)][_0x1f81b2(0x1ca)],'Machines\x20Count':_0x13b607[_0x1f81b2(0x1ca)],'Total\x20Area\x20(ESSA)\x20cm²':_0x390f35['essa'][_0x1f81b2(0x19d)](),'Products\x20(Code\x20-\x20Name)':_0x1893ea,'Machines\x20(Number\x20-\x20Name)':_0x1deb89,'Products\x20Detailed':_0x5e86a9,'Machines\x20Detailed':_0x240541,'Min\x20Batch\x20Size\x20(kg)':_0x390f35[_0x1f81b2(0x23d)],'Min\x20BS/MDD\x20Ratio':_0x390f35[_0x1f81b2(0x2e3)][_0x1f81b2(0x1a1)](0x2),'Assumed\x20SSA\x20(cm²)':_0x390f35[_0x1f81b2(0x234)],'Lowest\x20LTD\x20(mg)':_0x390f35['lowestLtd'],'Lowest\x20PDE\x20(mg)':_0x51dea8[_0x1f81b2(0x281)](null,_0x390f35[_0x1f81b2(0x2eb)])?_0x390f35[_0x1f81b2(0x2eb)]:_0x1f81b2(0x2f6),'Worst\x20RPN\x20Product':_0x390f35[_0x1f81b2(0x2e4)]?_0x390f35['worstProductRpn'][_0x1f81b2(0x329)]+'\x20('+_0x390f35[_0x1f81b2(0x2e4)]['ingredientName']+_0x1f81b2(0x26f)+_0x390f35['worstProductRpn'][_0x1f81b2(0x142)]:'N/A'});});const _0x1d9931=XLSX[_0x1b0b76(0x2c4)]['json_to_sheet'](_0x3bc756);XLSX[_0x1b0b76(0x2c4)]['book_append_sheet'](_0xf942d5,_0x1d9931,_0x51dea8[_0x1b0b76(0x2ff)]);}catch(_0x591158){console['error'](_0x51dea8['adCRm'],_0x591158);}try{const _0x58954a=a13_0x20cf21[_0x1b0b76(0x1d0)][_0x1b0b76(0x192)](_0x43d549=>{const _0x501275=_0x1b0b76,_0x5ebaf0=_0x320754(_0x43d549);return _0x43d549[_0x501275(0x34d)]['map'](_0x57849e=>({'productName':_0x43d549[_0x501275(0x25e)],'productCode':_0x43d549[_0x501275(0x2f2)],'ingredientName':_0x57849e[_0x501275(0x25e)],'rpn':_0x1384ab(_0x57849e)[_0x501275(0x142)],'trainId':_0x501275(0x2f6)!==_0x5ebaf0?'T'+_0x5ebaf0:_0x501275(0x2f6)}));})[_0x1b0b76(0x1e7)]((_0x4f1661,_0x5382a9)=>_0x5382a9['rpn']-_0x4f1661[_0x1b0b76(0x142)])[_0x1b0b76(0x15d)](0x0,0xa);if(_0x51dea8['ngWoB'](_0x58954a[_0x1b0b76(0x1ca)],0x0)){const _0x22b1f0=_0x58954a['map']((_0x30ce1c,_0x30702e)=>({'Rank':_0x30702e+0x1,'Product\x20Code':_0x30ce1c['productCode'],'Product\x20Name':_0x30ce1c[_0x1b0b76(0x329)],'Train':_0x30ce1c[_0x1b0b76(0x227)],'Ingredient':_0x30ce1c[_0x1b0b76(0x27d)],'RPN':_0x30ce1c['rpn']})),_0x58566c=XLSX[_0x1b0b76(0x2c4)]['json_to_sheet'](_0x22b1f0);XLSX[_0x1b0b76(0x2c4)][_0x1b0b76(0x137)](_0xf942d5,_0x58566c,_0x51dea8['svbSG']);}}catch(_0x3aebe7){console[_0x1b0b76(0x300)](_0x1b0b76(0x29a),_0x3aebe7);}try{const _0x3c9942=a13_0x20cf21[_0x1b0b76(0x1d0)][_0x1b0b76(0x241)](_0x141275=>_0x141275[_0x1b0b76(0x1ed)]);if(_0x51dea8[_0x1b0b76(0x2b8)](_0x3c9942[_0x1b0b76(0x1ca)],0x0)){const _0xa10806=_0x3c9942['map'](_0x5b5dc0=>({'Product\x20Code':_0x5b5dc0[_0x1b0b76(0x2f2)],'Product\x20Name':_0x5b5dc0[_0x1b0b76(0x25e)],'Product\x20Type':_0x5b5dc0[_0x1b0b76(0x254)],'Batch\x20Size\x20(kg)':_0x5b5dc0[_0x1b0b76(0x27b)],'MDD\x20(mg)':_0x5b5dc0['mddMg'],'Critical\x20Reason':_0x5b5dc0[_0x1b0b76(0x31e)]||'No\x20reason\x20provided','Train':_0x1b0b76(0x2f6)!==_0x320754(_0x5b5dc0)?'T'+_0x320754(_0x5b5dc0):'N/A'})),_0x4bb790=XLSX['utils'][_0x1b0b76(0x284)](_0xa10806);XLSX['utils'][_0x1b0b76(0x137)](_0xf942d5,_0x4bb790,_0x51dea8[_0x1b0b76(0x1e1)]);}}catch(_0x492463){console[_0x1b0b76(0x300)](_0x51dea8[_0x1b0b76(0x2dd)],_0x492463);}try{const _0x261605=a13_0x20cf21['products'][_0x1b0b76(0x119)](_0x51fcd7=>{const _0x567238=_0x1b0b76,_0x302e1f=_0x51dea8[_0x567238(0x1c3)](_0x320754,_0x51fcd7),_0x506525=_0x51fcd7[_0x567238(0x34d)][_0x567238(0x34b)]((_0xc33974,_0xbb2d2)=>{const _0x481277=_0x567238,_0x51bee3=_0x216ff3[_0x481277(0x140)](_0x1384ab,_0xbb2d2)[_0x481277(0x142)];return _0x51bee3>_0xc33974['rpn']?{..._0xbb2d2,'rpn':_0x51bee3}:_0xc33974;},{'rpn':0x0,'name':_0x567238(0x2f6)});return{'Product\x20Code':_0x51fcd7[_0x567238(0x2f2)],'Product\x20Name':_0x51fcd7['name'],'Product\x20Type':_0x51fcd7[_0x567238(0x254)],'Batch\x20Size\x20(kg)':_0x51fcd7[_0x567238(0x27b)],'MDD\x20(mg)':_0x51fcd7[_0x567238(0x21a)],'Train':_0x51dea8[_0x567238(0x281)](_0x51dea8['ueMiM'],_0x302e1f)?'T'+_0x302e1f:_0x51dea8[_0x567238(0x216)],'Is\x20Critical':_0x51fcd7['isCritical']?_0x567238(0x2ee):'No','Critical\x20Reason':_0x51fcd7[_0x567238(0x31e)]||_0x51dea8['ueMiM'],'Ingredients\x20Count':_0x51fcd7[_0x567238(0x34d)][_0x567238(0x1ca)],'Highest\x20RPN\x20Ingredient':_0x506525[_0x567238(0x25e)],'Highest\x20RPN\x20Value':_0x506525[_0x567238(0x142)]||0x0};}),_0x40ec83=XLSX[_0x1b0b76(0x2c4)]['json_to_sheet'](_0x261605);XLSX[_0x1b0b76(0x2c4)][_0x1b0b76(0x137)](_0xf942d5,_0x40ec83,_0x51dea8[_0x1b0b76(0x2a0)]);}catch(_0x30ea0c){console['error'](_0x51dea8[_0x1b0b76(0x1bc)],_0x30ea0c);}try{const _0xddd7fb=[];a13_0x20cf21[_0x1b0b76(0x1d0)]['forEach'](_0x2fe8b9=>{const _0x41d689=_0x1b0b76,_0x13218c={'XgJdF':_0x51dea8['geoWW'],'ghWAP':_0x51dea8[_0x41d689(0x216)]},_0x577e8e=_0x51dea8['KCtIF'](_0x320754,_0x2fe8b9),_0x1330a6={'Product\x20Code':_0x2fe8b9[_0x41d689(0x2f2)],'Product\x20Name':_0x2fe8b9[_0x41d689(0x25e)],'Product\x20Type':_0x2fe8b9[_0x41d689(0x254)],'Batch\x20Size\x20(kg)':_0x2fe8b9[_0x41d689(0x27b)],'MDD\x20(mg)':_0x2fe8b9['mddMg'],'Train':_0x51dea8[_0x41d689(0x216)]!==_0x577e8e?'T'+_0x577e8e:_0x51dea8[_0x41d689(0x216)],'Is\x20Critical':_0x2fe8b9[_0x41d689(0x1ed)]?_0x51dea8[_0x41d689(0x257)]:'No','Critical\x20Reason':_0x2fe8b9[_0x41d689(0x31e)]||_0x51dea8['ueMiM'],'Ingredient\x20Type':_0x41d689(0x131),'Ingredient\x20Name':'','LTD\x20(mg)':'','PDE\x20(mg)':'','LD50\x20(mg/kg)':'','Severity':'','Occurrence':'','Detection':'','RPN':''};_0xddd7fb[_0x41d689(0x1df)](_0x1330a6),_0x2fe8b9[_0x41d689(0x34d)][_0x41d689(0x2e5)](_0xa91307=>{const _0x36e20f=_0x41d689,_0x27162f=_0x1384ab(_0xa91307);_0xddd7fb[_0x36e20f(0x1df)]({'Product\x20Code':'','Product\x20Name':'','Product\x20Type':'','Batch\x20Size\x20(kg)':'','MDD\x20(mg)':'','Train':'','Is\x20Critical':'','Critical\x20Reason':'','Ingredient\x20Type':_0x13218c['XgJdF'],'Ingredient\x20Name':_0xa91307[_0x36e20f(0x25e)],'LTD\x20(mg)':_0xa91307[_0x36e20f(0x18c)]||_0x13218c[_0x36e20f(0x1e6)],'PDE\x20(mg)':_0xa91307[_0x36e20f(0x1af)]||_0x13218c[_0x36e20f(0x1e6)],'LD50\x20(mg/kg)':_0xa91307[_0x36e20f(0x295)]||_0x13218c[_0x36e20f(0x1e6)],'Severity':_0x27162f[_0x36e20f(0x1b6)],'Occurrence':_0x27162f['occurrence'],'Detection':_0x27162f[_0x36e20f(0x2d4)],'RPN':_0x27162f[_0x36e20f(0x142)]});});});const _0x111003=XLSX[_0x1b0b76(0x2c4)]['json_to_sheet'](_0xddd7fb);XLSX[_0x1b0b76(0x2c4)][_0x1b0b76(0x137)](_0xf942d5,_0x111003,_0x51dea8['XbpwI']);}catch(_0xa2285f){console['error']('Error\x20creating\x20Product\x20Register\x20sheet:',_0xa2285f);}const _0x40c2de=new Date()[_0x1b0b76(0x35a)]()[_0x1b0b76(0x21c)]('T')[0x0];XLSX[_0x1b0b76(0x11c)](_0xf942d5,_0x1b0b76(0x335)+_0x40c2de+_0x1b0b76(0x2cd)),_0x51dea8[_0x1b0b76(0x355)](hideLoader),_0x51dea8['SMWjE'](showCustomAlert,_0x51dea8[_0x1b0b76(0x338)],_0x1b0b76(0x2a2));})[_0x425884(0x12e)](_0x298294=>{const _0x48acc6=_0x425884;console[_0x48acc6(0x300)](_0x51dea8[_0x48acc6(0x1d7)],_0x298294),_0x51dea8[_0x48acc6(0x341)](hideLoader),_0x51dea8[_0x48acc6(0x2bc)](showCustomAlert,_0x51dea8[_0x48acc6(0x28c)],_0x51dea8[_0x48acc6(0x18f)]);});}export function toggleStageSection(_0x476018){const _0xfc8a89=a13_0x158406,_0x234350={'TVldo':_0xfc8a89(0x1a5),'cJwmn':_0xfc8a89(0x24b),'WZwSI':_0xfc8a89(0x28f),'FOBEd':_0xfc8a89(0x1b5)},_0x1e0c24=document[_0xfc8a89(0x2de)](_0xfc8a89(0x2c5)+_0x476018),_0x57fc5d=_0xfc8a89(0x1a5)===_0x1e0c24[_0xfc8a89(0x168)][_0xfc8a89(0x1bb)];_0x1e0c24[_0xfc8a89(0x168)][_0xfc8a89(0x1bb)]=_0x57fc5d?'':_0x234350['TVldo'],localStorage['setItem'](_0xfc8a89(0x141)+_0x476018+_0xfc8a89(0x1b9),!_0x57fc5d);const _0x1b0cb9=_0x1e0c24[_0xfc8a89(0x11b)][_0xfc8a89(0x156)](_0x234350[_0xfc8a89(0x23f)]);_0x1b0cb9&&(_0x1b0cb9[_0xfc8a89(0x1da)]=_0x57fc5d?_0x234350[_0xfc8a89(0x20c)]:_0x234350[_0xfc8a89(0x2c0)]);}