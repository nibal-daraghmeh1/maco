const a16_0x500c1c=a16_0x4d99;(function(_0x2ca763,_0x53909b){const _0x44edd6=a16_0x4d99,_0x5f4892=_0x2ca763();while(!![]){try{const _0x531c57=-parseInt(_0x44edd6(0x20c))/0x1*(-parseInt(_0x44edd6(0x229))/0x2)+-parseInt(_0x44edd6(0x3d9))/0x3+parseInt(_0x44edd6(0x1b0))/0x4*(-parseInt(_0x44edd6(0x24c))/0x5)+parseInt(_0x44edd6(0x298))/0x6*(-parseInt(_0x44edd6(0x252))/0x7)+parseInt(_0x44edd6(0x227))/0x8*(parseInt(_0x44edd6(0x1dd))/0x9)+-parseInt(_0x44edd6(0x2c9))/0xa*(-parseInt(_0x44edd6(0x217))/0xb)+-parseInt(_0x44edd6(0x1d7))/0xc;if(_0x531c57===_0x53909b)break;else _0x5f4892['push'](_0x5f4892['shift']());}catch(_0x241524){_0x5f4892['push'](_0x5f4892['shift']());}}}(a16_0x4557,0xc83fd));import*as a16_0xc61194 from'./state.js';import{fullAppRender as a16_0xa36d4e}from'./app.js';import{generateTrainMap as a16_0x158646,getTrainIdToLineNumberMap as a16_0x92985a,getProductTrainNumber as a16_0x8e9379}from'./utils.js';import{toggleScoringEditMode as a16_0xee0d83}from'./scoringView.js';import{renderRpnChart as a16_0x14de91}from'./worstCaseView.js';function a16_0x4d99(_0xf19f79,_0x282ab2){const _0x45579f=a16_0x4557();return a16_0x4d99=function(_0x4d9906,_0xa13fd6){_0x4d9906=_0x4d9906-0x192;let _0x4489c2=_0x45579f[_0x4d9906];return _0x4489c2;},a16_0x4d99(_0xf19f79,_0x282ab2);}function i(_0x3c90fd,_0x4795f4=''){const _0x2d2de5=a16_0x4d99,_0xcacbb5={'ptswY':function(_0x4b056d,_0x3aec33){return _0x4b056d==_0x3aec33;},'pGaGa':function(_0x383ad5,_0xad5872){return _0x383ad5+_0xad5872;},'hnmgF':function(_0x197d24,_0x33a107){return _0x197d24+_0x33a107;},'cksQL':function(_0x4a5882,_0x2a79e8){return _0x4a5882<_0x2a79e8;},'pJWxt':function(_0xcb09fa,_0x192429){return _0xcb09fa<_0x192429;},'qZRLC':function(_0x483958,_0x279218){return _0x483958+_0x279218;}};if(0x0===_0x3c90fd||_0xcacbb5[_0x2d2de5(0x22f)](null,_0x3c90fd)||isNaN(_0x3c90fd))return _0xcacbb5[_0x2d2de5(0x35c)]('0',_0x4795f4?_0xcacbb5['hnmgF']('\x20',_0x4795f4):'');const _0x563055=Math[_0x2d2de5(0x303)](_0x3c90fd);return _0xcacbb5['cksQL'](_0x563055,0.0001)?''+_0x3c90fd[_0x2d2de5(0x3bd)](0x3)+(_0x4795f4?_0xcacbb5[_0x2d2de5(0x19a)]('\x20',_0x4795f4):''):_0xcacbb5[_0x2d2de5(0x1e6)](_0x563055,0.01)?''+_0x3c90fd[_0x2d2de5(0x1ff)](0x6)+(_0x4795f4?_0xcacbb5[_0x2d2de5(0x3da)]('\x20',_0x4795f4):''):''+_0x3c90fd[_0x2d2de5(0x1ff)](0x4)+(_0x4795f4?_0xcacbb5[_0x2d2de5(0x3da)]('\x20',_0x4795f4):'');}import{renderMacoChart as a16_0x3eceea}from'./dashboardView.js';const d=document[a16_0x500c1c(0x3ca)]('loader');export const showLoader=()=>d[a16_0x500c1c(0x29c)]['display']='flex';export const hideLoader=()=>d['style']['display']=a16_0x500c1c(0x219);export function showCustomAlert(_0x3e2e76,_0x2e3331){const _0x15e77f=a16_0x500c1c,_0x25743b={'EhgUn':_0x15e77f(0x382),'Rutwn':_0x15e77f(0x1af),'vuUhW':_0x15e77f(0x2e4)};document[_0x15e77f(0x3ca)](_0x25743b[_0x15e77f(0x202)])[_0x15e77f(0x39f)]=_0x3e2e76,document[_0x15e77f(0x3ca)](_0x15e77f(0x2a7))[_0x15e77f(0x39f)]=_0x2e3331,document[_0x15e77f(0x3ca)](_0x25743b['Rutwn'])[_0x15e77f(0x29c)][_0x15e77f(0x312)]=_0x25743b['vuUhW'];}export const hideModal=_0x27d327=>document[a16_0x500c1c(0x3ca)](_0x27d327)[a16_0x500c1c(0x29c)]['display']=a16_0x500c1c(0x219);export const showModal=_0x18f023=>document['getElementById'](_0x18f023)[a16_0x500c1c(0x29c)][a16_0x500c1c(0x312)]=a16_0x500c1c(0x2e4);export function saveAllDataToLocalStorage(){const _0x283534=a16_0x500c1c,_0x2e4a2f={'LQxoo':_0x283534(0x3f0),'OTEdV':_0x283534(0x2f4),'hOSfT':_0x283534(0x34b),'XGTSr':_0x283534(0x3de),'fdMdH':_0x283534(0x293),'dOQSx':function(_0x4455b3,_0x43526e,_0x1c4397){return _0x4455b3(_0x43526e,_0x1c4397);},'UKabB':'Could\x20not\x20save\x20data.\x20Storage\x20might\x20be\x20full.'};try{localStorage['setItem'](_0x2e4a2f[_0x283534(0x1ae)],JSON[_0x283534(0x292)](a16_0xc61194[_0x283534(0x343)])),localStorage[_0x283534(0x1a6)](_0x283534(0x37b),JSON['stringify'](a16_0xc61194[_0x283534(0x203)])),localStorage[_0x283534(0x1a6)](_0x2e4a2f[_0x283534(0x330)],JSON[_0x283534(0x292)](a16_0xc61194['scoringCriteria'])),localStorage[_0x283534(0x1a6)](_0x2e4a2f[_0x283534(0x3f5)],JSON[_0x283534(0x292)](a16_0xc61194[_0x283534(0x279)])),localStorage[_0x283534(0x1a6)](_0x2e4a2f[_0x283534(0x3eb)],JSON[_0x283534(0x292)](a16_0xc61194[_0x283534(0x3de)]));}catch(_0x2aa95f){console[_0x283534(0x3db)](_0x2e4a2f[_0x283534(0x23a)],_0x2aa95f),_0x2e4a2f['dOQSx'](showCustomAlert,_0x283534(0x239),_0x2e4a2f['UKabB']);}}export function loadAllDataFromLocalStorage(){const _0x185ad3=a16_0x500c1c,_0x433a2e={'FyBwe':'macoProducts','bGPcn':_0x185ad3(0x2f4),'DGqnU':_0x185ad3(0x34b),'LplMP':_0x185ad3(0x3c3),'rAKSV':_0x185ad3(0x325),'NmbOV':'Error\x20loading\x20machine\x20stage\x20order'},_0x54b1b3=localStorage[_0x185ad3(0x3bb)](_0x433a2e['FyBwe']),_0x3a6de6=localStorage['getItem'](_0x185ad3(0x37b)),_0x1f6d6d=localStorage[_0x185ad3(0x3bb)](_0x433a2e[_0x185ad3(0x25d)]),_0x368e26=localStorage['getItem'](_0x433a2e[_0x185ad3(0x33c)]),_0x45ef78=localStorage['getItem'](_0x185ad3(0x3de));if(_0x54b1b3)try{a16_0xc61194['setProducts'](JSON['parse'](_0x54b1b3));}catch(_0x35d4b6){console[_0x185ad3(0x3db)](_0x433a2e[_0x185ad3(0x1a5)],_0x35d4b6);}if(_0x3a6de6)try{a16_0xc61194[_0x185ad3(0x2df)](JSON['parse'](_0x3a6de6));}catch(_0x46936a){console[_0x185ad3(0x3db)](_0x433a2e[_0x185ad3(0x35b)],_0x46936a);}if(_0x1f6d6d)try{a16_0xc61194[_0x185ad3(0x1be)](JSON[_0x185ad3(0x346)](_0x1f6d6d));}catch(_0x8b6463){console[_0x185ad3(0x3db)](_0x185ad3(0x337),_0x8b6463);}if(_0x368e26)try{a16_0xc61194[_0x185ad3(0x3a4)](JSON[_0x185ad3(0x346)](_0x368e26));}catch(_0x2c8f5d){console[_0x185ad3(0x3db)]('Error\x20loading\x20detergent\x20ingredients',_0x2c8f5d);}if(_0x45ef78)try{a16_0xc61194[_0x185ad3(0x1e8)](JSON['parse'](_0x45ef78));}catch(_0x432a30){console[_0x185ad3(0x3db)](_0x433a2e[_0x185ad3(0x329)],_0x432a30);}}export function saveStateForUndo(){const _0x115a38=a16_0x500c1c,_0x8c8b39={'nwchW':function(_0x579c62){return _0x579c62();},'fWQtb':function(_0x56cea2,_0x37b641){return _0x56cea2+_0x37b641;}};_0x8c8b39[_0x115a38(0x375)](a16_0x158646);const _0x15db75=a16_0xc61194[_0x115a38(0x2be)][_0x115a38(0x28c)](0x0,_0x8c8b39[_0x115a38(0x291)](a16_0xc61194[_0x115a38(0x336)],0x1)),_0x1305d3={'products':JSON[_0x115a38(0x346)](JSON[_0x115a38(0x292)](a16_0xc61194[_0x115a38(0x343)])),'machines':JSON[_0x115a38(0x346)](JSON[_0x115a38(0x292)](a16_0xc61194[_0x115a38(0x203)])),'scoringCriteria':JSON[_0x115a38(0x346)](JSON['stringify'](a16_0xc61194[_0x115a38(0x2b7)])),'detergentIngredients':JSON[_0x115a38(0x346)](JSON[_0x115a38(0x292)](a16_0xc61194['detergentIngredients']))};_0x15db75[_0x115a38(0x1cc)](_0x1305d3),a16_0xc61194['setHistory'](_0x15db75,_0x15db75['length']-0x1),updateUndoRedoButtons(),saveAllDataToLocalStorage();}export function updateUndoRedoButtons(){const _0x1b92a2=a16_0x500c1c,_0x3f22eb={'rpWWl':_0x1b92a2(0x2a8),'Eaked':function(_0x537f65,_0x51084b){return _0x537f65<=_0x51084b;},'hLMTT':function(_0x5c7a17,_0x264c00){return _0x5c7a17-_0x264c00;}},_0x5bdc87=document[_0x1b92a2(0x3ca)](_0x3f22eb[_0x1b92a2(0x2b5)]),_0x14b774=document[_0x1b92a2(0x3ca)]('redo-btn');_0x5bdc87&&(_0x5bdc87[_0x1b92a2(0x263)]=_0x3f22eb[_0x1b92a2(0x34f)](a16_0xc61194[_0x1b92a2(0x336)],0x0)),_0x14b774&&(_0x14b774[_0x1b92a2(0x263)]=a16_0xc61194[_0x1b92a2(0x336)]>=_0x3f22eb[_0x1b92a2(0x1fd)](a16_0xc61194[_0x1b92a2(0x2be)]['length'],0x1));}export function undoChange(){const _0x5192cf=a16_0x500c1c,_0x3c3bce={'WxsJr':function(_0x4d3ee7,_0x5b7526){return _0x4d3ee7>_0x5b7526;},'ohbhQ':function(_0x19981a,_0x5c087f){return _0x19981a(_0x5c087f);},'MRjdB':function(_0xb666a2){return _0xb666a2();}};if(_0x3c3bce[_0x5192cf(0x290)](a16_0xc61194[_0x5192cf(0x336)],0x0)){const _0x5da40c=a16_0xc61194[_0x5192cf(0x336)]-0x1,_0xcca8af=a16_0xc61194['history'][_0x5da40c];a16_0xc61194[_0x5192cf(0x409)](JSON['parse'](JSON[_0x5192cf(0x292)](_0xcca8af[_0x5192cf(0x343)]))),a16_0xc61194['setMachines'](JSON[_0x5192cf(0x346)](JSON[_0x5192cf(0x292)](_0xcca8af['machines']))),a16_0xc61194[_0x5192cf(0x1be)](JSON[_0x5192cf(0x346)](JSON[_0x5192cf(0x292)](_0xcca8af[_0x5192cf(0x2b7)]))),a16_0xc61194[_0x5192cf(0x3a4)](JSON[_0x5192cf(0x346)](JSON['stringify'](_0xcca8af['detergentIngredients']))),a16_0xc61194[_0x5192cf(0x33b)](a16_0xc61194['history'],_0x5da40c),a16_0xc61194[_0x5192cf(0x37c)]&&_0x3c3bce['ohbhQ'](a16_0xee0d83,!0x1),_0x3c3bce[_0x5192cf(0x3dc)](a16_0xa36d4e),_0x3c3bce['MRjdB'](updateUndoRedoButtons),_0x3c3bce[_0x5192cf(0x3dc)](saveAllDataToLocalStorage);}}export function redoChange(){const _0x41488c=a16_0x500c1c,_0x26c875={'WnvQQ':function(_0x4b3204,_0x18df0a){return _0x4b3204-_0x18df0a;},'MhlTv':function(_0xbf83ff,_0x508cfe){return _0xbf83ff+_0x508cfe;},'urWAG':function(_0x5fbb79){return _0x5fbb79();}};if(a16_0xc61194['historyIndex']<_0x26c875[_0x41488c(0x377)](a16_0xc61194[_0x41488c(0x2be)]['length'],0x1)){const _0x3138bd=_0x26c875[_0x41488c(0x402)](a16_0xc61194[_0x41488c(0x336)],0x1),_0x5255ff=a16_0xc61194[_0x41488c(0x2be)][_0x3138bd];a16_0xc61194[_0x41488c(0x409)](JSON['parse'](JSON[_0x41488c(0x292)](_0x5255ff['products']))),a16_0xc61194[_0x41488c(0x2df)](JSON[_0x41488c(0x346)](JSON[_0x41488c(0x292)](_0x5255ff[_0x41488c(0x203)]))),a16_0xc61194[_0x41488c(0x1be)](JSON[_0x41488c(0x346)](JSON[_0x41488c(0x292)](_0x5255ff[_0x41488c(0x2b7)]))),a16_0xc61194[_0x41488c(0x3a4)](JSON[_0x41488c(0x346)](JSON[_0x41488c(0x292)](_0x5255ff[_0x41488c(0x279)]))),a16_0xc61194[_0x41488c(0x33b)](a16_0xc61194['history'],_0x3138bd),a16_0xc61194['scoringInEditMode']&&a16_0xee0d83(!0x1),_0x26c875[_0x41488c(0x1eb)](a16_0xa36d4e),_0x26c875[_0x41488c(0x1eb)](updateUndoRedoButtons),_0x26c875[_0x41488c(0x1eb)](saveAllDataToLocalStorage);}}export function toggleDarkMode(_0x5c5645){const _0x53476d=a16_0x500c1c,_0x5682a1={'deDJr':_0x53476d(0x2b6),'QlpgI':_0x53476d(0x282),'vgAKB':function(_0x1c9d33){return _0x1c9d33();}},_0x49eefe=document[_0x53476d(0x3ca)](_0x53476d(0x1c7)),_0x5608e4=document[_0x53476d(0x3ca)](_0x53476d(0x1c8));_0x5c5645?(document['documentElement']['classList'][_0x53476d(0x2e8)](_0x5682a1[_0x53476d(0x3e1)]),_0x49eefe&&_0x49eefe['classList'][_0x53476d(0x2e8)](_0x5682a1[_0x53476d(0x26a)]),_0x5608e4&&_0x5608e4[_0x53476d(0x1ef)][_0x53476d(0x294)](_0x5682a1['QlpgI'])):(document[_0x53476d(0x30f)][_0x53476d(0x1ef)]['remove'](_0x5682a1[_0x53476d(0x3e1)]),_0x49eefe&&_0x49eefe[_0x53476d(0x1ef)][_0x53476d(0x294)](_0x5682a1[_0x53476d(0x26a)]),_0x5608e4&&_0x5608e4[_0x53476d(0x1ef)]['add'](_0x53476d(0x282))),a16_0xc61194[_0x53476d(0x3cb)]&&a16_0x14de91(),a16_0xc61194[_0x53476d(0x21c)]&&_0x5682a1[_0x53476d(0x353)](a16_0x3eceea);}export function printCurrentView(_0x44b43e,_0x642453=a16_0x500c1c(0x230)){const _0x2e5c68=a16_0x500c1c,_0x43d719={'pLsTY':function(_0x37edf7,_0x26d8eb,_0x494825){return _0x37edf7(_0x26d8eb,_0x494825);},'GORGp':_0x2e5c68(0x1ab),'erknH':function(_0x24d9a,_0x869fac,_0xa01030){return _0x24d9a(_0x869fac,_0xa01030);},'lsbfA':_0x2e5c68(0x282),'iloIU':_0x2e5c68(0x253),'YHEYx':_0x2e5c68(0x26c),'dXeRD':function(_0xe1929f,_0x28f4c3,_0x128e17){return _0xe1929f(_0x28f4c3,_0x128e17);},'XwQFq':_0x2e5c68(0x32a),'vSTGP':_0x2e5c68(0x255),'oxQan':_0x2e5c68(0x1bc),'xomzX':_0x2e5c68(0x236),'HJzOe':_0x2e5c68(0x232),'COGet':function(_0x48ca59,_0x59ccd3){return _0x48ca59>_0x59ccd3;},'dxsGR':function(_0x521feb,_0x1db24c){return _0x521feb===_0x1db24c;},'JjAkL':_0x2e5c68(0x219),'Rxkfg':_0x2e5c68(0x399),'QyEUU':function(_0x3faa81,_0x5097fc){return _0x3faa81(_0x5097fc);},'Pmost':_0x2e5c68(0x36e),'uMJdy':_0x2e5c68(0x3ff),'KehFw':function(_0x2e87b4,_0x3c7009){return _0x2e87b4(_0x3c7009);},'XHQzd':function(_0x246cc1,_0x359e26){return _0x246cc1+_0x359e26;},'NJhjN':'Error\x20loading\x20train\x20summary:\x20','WfGuD':function(_0x260d2d,_0x593f63){return _0x260d2d===_0x593f63;},'sayxM':'scoring-system','RZJoB':'Printing\x20view:','hOdFc':_0x2e5c68(0x30b),'hBCyY':function(_0x1aaeed,_0x357824){return _0x1aaeed===_0x357824;},'HoYNO':_0x2e5c68(0x2b1),'HonBy':'./worstCaseView.js','wubYA':_0x2e5c68(0x192),'dfZuU':'./macoProductView.js','iPrLE':_0x2e5c68(0x1f0),'mUMGM':'trainSummary','Ffarr':'Setting\x20printSelectedTrain\x20to:','PABiq':_0x2e5c68(0x356)};_0x43d719[_0x2e5c68(0x2c4)](_0x43d719[_0x2e5c68(0x3fb)],_0x44b43e)&&a16_0xc61194[_0x2e5c68(0x37c)]&&(a16_0xc61194['setScoringWasInEditModeForPrint'](!0x0),_0x43d719[_0x2e5c68(0x1fe)](a16_0xee0d83,!0x1)),console[_0x2e5c68(0x317)](_0x43d719['RZJoB'],_0x44b43e,_0x43d719[_0x2e5c68(0x27c)],_0x642453),document[_0x2e5c68(0x3e4)][_0x2e5c68(0x1ef)][_0x2e5c68(0x2e8)](_0x2e5c68(0x2ff)+_0x44b43e),_0x43d719['hBCyY'](_0x43d719[_0x2e5c68(0x249)],_0x44b43e)?import(_0x43d719[_0x2e5c68(0x39b)])['then'](_0x1c12f=>{const _0x29b9b8=_0x2e5c68;window[_0x29b9b8(0x2d7)]=_0x642453,_0x1c12f[_0x29b9b8(0x30d)](),_0x43d719[_0x29b9b8(0x38b)](setTimeout,()=>{const _0x247b3a=_0x29b9b8;window[_0x247b3a(0x2ad)]();},0xc8);}):_0x43d719['WfGuD'](_0x43d719[_0x2e5c68(0x360)],_0x44b43e)?(window['printSelectedTrain']=_0x642453,import(_0x43d719[_0x2e5c68(0x289)])['then'](_0x36ef7c=>{const _0xff944a=_0x2e5c68,_0x2a6091={'GVloa':_0x43d719[_0xff944a(0x3cc)],'Buigp':_0xff944a(0x328)};_0x36ef7c['renderMacoForTrains']();const _0x571b3d=document[_0xff944a(0x29b)]('#macoForTrains\x20.train-content.collapsed'),_0x5356c4=[];_0x571b3d[_0xff944a(0x205)](_0x15f93b=>{const _0x1a95a8=_0xff944a,_0x175d99=_0x15f93b['id'][_0x1a95a8(0x2a1)](/content-pm-(\d+)/);if(_0x175d99){_0x5356c4[_0x1a95a8(0x1cc)](_0x175d99[0x1]),_0x15f93b[_0x1a95a8(0x1ef)][_0x1a95a8(0x294)](_0x43d719['GORGp']);const _0x1b27b9=document[_0x1a95a8(0x3ca)](_0x1a95a8(0x389)+_0x175d99[0x1]);_0x1b27b9&&(_0x1b27b9['textContent']='▼');}});const _0x1944e2=document[_0xff944a(0x29b)](_0x43d719[_0xff944a(0x27e)]),_0x4fdffa=[];_0x1944e2[_0xff944a(0x205)](_0x4a250b=>{const _0x4ebbae=_0xff944a,_0x1a5bba=_0x4a250b['id'][_0x4ebbae(0x2a1)](/maco-breakdown-details-(\d+)/);if(_0x1a5bba){_0x4fdffa['push'](_0x1a5bba[0x1]),_0x4a250b['classList']['remove'](_0x2a6091[_0x4ebbae(0x385)]);const _0x535f6c=document[_0x4ebbae(0x3ca)](_0x4ebbae(0x19e)+_0x1a5bba[0x1]);_0x535f6c&&(_0x535f6c['textContent']=_0x2a6091[_0x4ebbae(0x1bd)]);}}),setTimeout(()=>{const _0x2b5444=_0xff944a;window['print'](),_0x43d719[_0x2b5444(0x3cd)](setTimeout,()=>{const _0x57d5f7=_0x2b5444,_0x192c72={'XjoSE':_0x57d5f7(0x1ab),'uqSxe':'hidden','YCKvR':_0x57d5f7(0x237)};_0x5356c4[_0x57d5f7(0x205)](_0x1f714b=>{const _0x402aa9=_0x57d5f7,_0x4dbaca=document[_0x402aa9(0x3ca)](_0x402aa9(0x33d)+_0x1f714b),_0xf05646=document['getElementById']('toggle-pm-'+_0x1f714b);_0x4dbaca&&_0x4dbaca[_0x402aa9(0x1ef)][_0x402aa9(0x2e8)](_0x192c72[_0x402aa9(0x359)]),_0xf05646&&(_0xf05646[_0x402aa9(0x39f)]='▶');}),_0x4fdffa[_0x57d5f7(0x205)](_0x51e7ff=>{const _0x4ffb74=_0x57d5f7,_0x212d9f=document[_0x4ffb74(0x3ca)]('maco-breakdown-details-'+_0x51e7ff),_0x3a18e0=document[_0x4ffb74(0x3ca)]('breakdown-toggle-btn-'+_0x51e7ff);_0x212d9f&&_0x212d9f['classList'][_0x4ffb74(0x2e8)](_0x192c72[_0x4ffb74(0x400)]),_0x3a18e0&&(_0x3a18e0['textContent']=_0x192c72[_0x4ffb74(0x371)]);});},0x3e8);},0xc8);})):_0x43d719[_0x2e5c68(0x2c4)]('detergentMaco',_0x44b43e)?(window[_0x2e5c68(0x2d7)]=_0x642453,import(_0x43d719['iPrLE'])[_0x2e5c68(0x1ba)](_0x513f58=>{const _0x27b71c=_0x2e5c68,_0x1cc9be={'TAupN':_0x43d719[_0x27b71c(0x39d)]};_0x513f58[_0x27b71c(0x28a)]();const _0x2549fc=document[_0x27b71c(0x29b)](_0x43d719[_0x27b71c(0x214)]),_0x3bfefb=[];_0x2549fc[_0x27b71c(0x205)](_0x114fc5=>{const _0x285172=_0x27b71c,_0x46a9d5=_0x114fc5['id'][_0x285172(0x2a1)](/content-dm-(\d+)/);if(_0x46a9d5){_0x3bfefb['push'](_0x46a9d5[0x1]),_0x114fc5[_0x285172(0x1ef)]['remove'](_0x1cc9be[_0x285172(0x280)]);const _0x3d6509=document[_0x285172(0x3ca)](_0x285172(0x369)+_0x46a9d5[0x1]);_0x3d6509&&(_0x3d6509[_0x285172(0x39f)]='▼');}}),setTimeout(()=>{const _0x4f795d=_0x27b71c,_0x3d9bd8={'wHYFw':_0x43d719[_0x4f795d(0x39d)]};window['print'](),_0x43d719['erknH'](setTimeout,()=>{const _0x5d9387=_0x4f795d;_0x3bfefb[_0x5d9387(0x205)](_0x14bd12=>{const _0x325785=_0x5d9387,_0x28aaa4=document[_0x325785(0x3ca)](_0x325785(0x392)+_0x14bd12),_0x4bf073=document[_0x325785(0x3ca)]('toggle-dm-'+_0x14bd12);_0x28aaa4&&_0x28aaa4[_0x325785(0x1ef)][_0x325785(0x2e8)](_0x3d9bd8['wHYFw']),_0x4bf073&&(_0x4bf073['textContent']='▶');});},0x3e8);},0xc8);})[_0x2e5c68(0x1d0)](_0x4791b8=>{const _0x132af7=_0x2e5c68;console[_0x132af7(0x3db)]('Error\x20loading\x20detergent\x20view\x20for\x20print:',_0x4791b8),window['print']();})[_0x2e5c68(0x305)](()=>{const _0x3c0980=_0x2e5c68;_0x43d719[_0x3c0980(0x277)](setTimeout,()=>{const _0x13c272=_0x3c0980;window[_0x13c272(0x2d7)]=null,import(_0x13c272(0x1f0))[_0x13c272(0x1ba)](_0x33c4a5=>_0x33c4a5[_0x13c272(0x28a)]())[_0x13c272(0x1d0)](()=>{});},0x4b0);})):_0x43d719[_0x2e5c68(0x25e)](_0x43d719['mUMGM'],_0x44b43e)?(window[_0x2e5c68(0x2d7)]=_0x642453,console['log'](_0x43d719[_0x2e5c68(0x2f6)],_0x642453),import(_0x43d719['PABiq'])[_0x2e5c68(0x1ba)](_0xc43ef=>{const _0x313bef=_0x2e5c68,_0x4807bb={'txpzW':_0x43d719[_0x313bef(0x248)],'OOggc':_0x313bef(0x3fa),'JqYTx':_0x43d719[_0x313bef(0x1c6)],'krKmM':_0x43d719[_0x313bef(0x25c)],'rPwQJ':_0x43d719['xomzX'],'NkdSM':_0x43d719[_0x313bef(0x2c8)],'dXPam':function(_0xcc9135,_0x52663e){const _0xb241e4=_0x313bef;return _0x43d719[_0xb241e4(0x34c)](_0xcc9135,_0x52663e);},'zWowX':function(_0x26671b,_0x5c8d22){const _0x48f64e=_0x313bef;return _0x43d719[_0x48f64e(0x33a)](_0x26671b,_0x5c8d22);},'DMMVY':_0x43d719['JjAkL'],'xKJiM':_0x43d719[_0x313bef(0x241)],'lOviD':function(_0x47512a,_0x43dc71){return _0x43d719['QyEUU'](_0x47512a,_0x43dc71);},'qQjAf':_0x43d719[_0x313bef(0x3b0)],'wyava':function(_0x56ba55,_0x467723,_0x5cab42){const _0x3f2804=_0x313bef;return _0x43d719[_0x3f2804(0x38b)](_0x56ba55,_0x467723,_0x5cab42);}};_0xc43ef[_0x313bef(0x1ad)](),setTimeout(()=>{const _0x1f276e=_0x313bef,_0x47b35a=document[_0x1f276e(0x3ca)](_0x4807bb['txpzW']),_0x2f7609=document[_0x1f276e(0x3ca)](_0x4807bb[_0x1f276e(0x196)]);if(console[_0x1f276e(0x317)](_0x4807bb['JqYTx'],_0x47b35a?_0x47b35a[_0x1f276e(0x29c)]['display']:_0x4807bb[_0x1f276e(0x1ed)]),console[_0x1f276e(0x317)](_0x4807bb[_0x1f276e(0x1ec)],_0x2f7609?_0x2f7609['style'][_0x1f276e(0x312)]:_0x4807bb[_0x1f276e(0x1ed)]),console[_0x1f276e(0x317)](_0x4807bb[_0x1f276e(0x2fd)],!!_0x47b35a&&_0x4807bb['dXPam'](_0x47b35a[_0x1f276e(0x34e)][_0x1f276e(0x323)],0x0)),!_0x47b35a||_0x4807bb[_0x1f276e(0x3c7)](_0x4807bb[_0x1f276e(0x1b9)],_0x47b35a[_0x1f276e(0x29c)][_0x1f276e(0x312)]))return console[_0x1f276e(0x372)](_0x4807bb[_0x1f276e(0x2da)]),void _0x4807bb[_0x1f276e(0x2bd)](alert,_0x4807bb[_0x1f276e(0x2e7)]);window['print'](),_0x4807bb[_0x1f276e(0x3f4)](setTimeout,()=>{window['printSelectedTrain']=null,_0xc43ef['renderTrainSummary']();},0x3e8);},0x1f4);})[_0x2e5c68(0x1d0)](_0x5cadca=>{const _0x37f559=_0x2e5c68;console['error'](_0x43d719[_0x37f559(0x234)],_0x5cadca),_0x43d719[_0x37f559(0x2c7)](alert,_0x43d719[_0x37f559(0x3cf)](_0x43d719['NJhjN'],_0x5cadca[_0x37f559(0x212)]));})):_0x43d719[_0x2e5c68(0x277)](setTimeout,()=>{const _0x413ae8=_0x2e5c68;window[_0x413ae8(0x2ad)]();},0x64);}export function toggleColumn(_0xb98ccf,_0x4bf6d1){const _0x32de3e=a16_0x500c1c,_0x5b9ad9={'ENpus':function(_0x316125,_0x1f5027){return _0x316125===_0x1f5027;},'xlPqX':_0x32de3e(0x22b),'VyPEH':'ld50','wfclp':_0x32de3e(0x208),'wYAeB':_0x32de3e(0x2b1),'NbEzg':function(_0x40e912,_0x1848b4){return _0x40e912(_0x1848b4);},'moCpf':'./worstCaseView.js','mOyIx':function(_0x375dde,_0x1b91e5){return _0x375dde!==_0x1b91e5;}};if(_0x5b9ad9[_0x32de3e(0x373)](_0x5b9ad9[_0x32de3e(0x3c2)],_0xb98ccf)||_0x5b9ad9[_0x32de3e(0x373)](_0x5b9ad9[_0x32de3e(0x21f)],_0xb98ccf)){[_0x5b9ad9['wfclp'],_0x5b9ad9[_0x32de3e(0x324)]]['forEach'](_0x5df80f=>{const _0x459455=_0x32de3e;document['querySelectorAll']('#'+_0x5df80f+_0x459455(0x3c6)+_0x5df80f+'\x20.ingredients-sub-table')[_0x459455(0x205)](_0x34a06d=>{const _0x59a8e5=_0x459455;_0x34a06d[_0x59a8e5(0x1ef)][_0x59a8e5(0x2d1)]('hide-'+_0xb98ccf);}),document[_0x459455(0x29b)]('#'+_0x5df80f+_0x459455(0x40b)+_0x5df80f+_0x459455(0x2ac))[_0x459455(0x205)](_0x524603=>{const _0x6ef76c=_0x459455;_0x524603&&_0x524603[_0x6ef76c(0x1ef)][_0x6ef76c(0x2d1)](_0x6ef76c(0x3a8)+_0xb98ccf);});});const _0x3cc280=null!==document[_0x32de3e(0x30e)](_0x32de3e(0x223)+_0xb98ccf);localStorage[_0x32de3e(0x1a6)](_0x32de3e(0x1c5)+_0xb98ccf+_0x32de3e(0x1f5),_0x3cc280),updateToggleIcons(_0x5b9ad9[_0x32de3e(0x24d)]),_0x5b9ad9['NbEzg'](updateToggleIcons,_0x5b9ad9['wYAeB']),import(_0x5b9ad9[_0x32de3e(0x1ac)])[_0x32de3e(0x1ba)](_0x27e62c=>{const _0xa7fb62=_0x32de3e;_0x27e62c[_0xa7fb62(0x30d)]();}),import(_0x5b9ad9[_0x32de3e(0x1ac)])[_0x32de3e(0x1ba)](_0x2f2b0f=>{const _0xb9d448=_0x32de3e;_0x2f2b0f[_0xb9d448(0x23e)]&&_0x2f2b0f[_0xb9d448(0x23e)]();});}else{document[_0x32de3e(0x29b)]('#'+_0x4bf6d1+_0x32de3e(0x3c6)+_0x4bf6d1+_0x32de3e(0x332))[_0x32de3e(0x205)](_0x5749f5=>{const _0x51543d=_0x32de3e;_0x5749f5[_0x51543d(0x1ef)][_0x51543d(0x2d1)]('hide-'+_0xb98ccf);});const _0xdc7c2c=_0x5b9ad9[_0x32de3e(0x218)](null,document['querySelector']('#'+_0x4bf6d1+_0x32de3e(0x2ab)+_0xb98ccf));localStorage[_0x32de3e(0x1a6)](_0x4bf6d1+'-'+_0xb98ccf+_0x32de3e(0x1f5),_0xdc7c2c),_0x5b9ad9[_0x32de3e(0x391)](updateToggleIcons,_0x4bf6d1);}}function a16_0x4557(){const _0x379410=['\x20not\x20found\x20or\x20has\x20no\x20products.','uMJdy','ZSuWP','No\x20trains\x20message\x20display:','Show\x20MACO\x20Calculation\x20Breakdown','columnVisibilityDropdown','Save\x20Error','fdMdH','split','Success','\x20-\x20','renderRpnChart','mddMg','Product\x20Register','Rxkfg','VbgZM','VGrWa','toLocaleString','#columnVisibilityDropdown','assumedSsa','nhJWp','XwQFq','HoYNO','xvRSu','Hide\x20LD50','5cActSP','wfclp','Health-Based\x20Limit\x20(PDE)','button','aNWTk','rudob','14rKefBl','#macoForTrains\x20[id^=\x22maco-breakdown-details-\x22].hidden','Error\x20exporting\x20Detergent\x20MACO\x20to\x20Excel:','Container\x20display:','number','bamGI','Failed\x20to\x20export\x20Train\x20Summary\x20data\x20to\x20Excel.','lQhuM','flatMap','gTlYH','oxQan','bGPcn','hBCyY','FFhhr','cBWuo','Show\x20PDE','date','disabled','QZSJl','CeeXC','fUccm','cwceJ','ld50','Critical\x20Products','QlpgI','gfwzg','#detergentMaco\x20.train-content.collapsed','mNpAl','Show','KuhOz','rQLUM','Trains\x20','wuQDu','Odtda','TGjrL','bodyWeight','isArray','dXeRD','removeEventListener','detergentIngredients','FdhED','xdNOi','hOdFc','WiCAY','iloIU','tBtFG','TAupN','BjhfY','hidden','qmgPd','criticalReason','zXeqq','All\x20Products','DkiZb','toggle-','dfZuU','renderDetergentMaco','aHtuh','slice','KEbtO','Detergent_MACO_Report_','wjKrB','WxsJr','fWQtb','stringify','Failed\x20to\x20save\x20data\x20to\x20localStorage','remove','Failed\x20to\x20export\x20Product\x20MACO\x20data\x20to\x20Excel.','true','MACO_Worst_Case_Products','1742754UCQRWE','ETqFl','bKOts','querySelectorAll','style','etqlI','llarI','Product\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','Detergent\x20MACO','match','nonMu','cleanability','kQKNf','ldhQV','MGEya','customAlertMessage','undo-btn','Unknown\x20(ID:\x20','jOMVF','\x20.mainTable.hide-','\x20.train-content-inner','print','N/A','VEUdz','ld50Score','worstCaseProducts','pdeScore','sdetV','hOWKs','rpWWl','dark','scoringCriteria','gXXDo','.toggle-ld50','jtVsF','solubility','find','lOviD','history','rgJel','ZthGZ','LVDcH','Failed\x20to\x20export\x20Detergent\x20MACO\x20data\x20to\x20Excel.','ThEeD','WfGuD','LFfhI','saUpm','KehFw','HJzOe','8990qdEFys','sf-input-train','minMbsKg','Complete_MACO_Report_','therapeuticDoseScore','href','kxwDK','bwCXS','toggle','mLJaL','KVHig','Visual\x20Clean\x20Limit','./utils.js','udgkq','printSelectedTrain','keys','gdbRj','xKJiM','wnRRZ','application/json','Hide\x20PDE','USqep','setMachines','hfVJy','Hide','JCLNd','lowestLtd','flex','includes','OpDCa','qQjAf','add','ZUdFd','qECiZ','ZBkug','hide-ld50','YNWUa','Mkwiq','Health-Based\x20Limit\x20(NOEL)','dxBch','click','kwetC','fhQip','macoScoringCriteria','zAqtH','Ffarr','activeIngredients','IaMXL','get','KtFZu','IjMWH','kKGQv','NkdSM','GNzBM','printing-','Error\x20exporting\x20Summary\x20to\x20Excel:','szive','lHcJP','abs','hIbgR','finally','fYngq','map','pjQfQ','oYkQn','zybTS','Train:','QdfPc','renderWorstCaseByTrain','querySelector','documentElement','sortValue','uENvZ','display','target','mdd','Error\x20creating\x20Product\x20MACO\x20sheet:','hQQPl','log','Error\x20creating\x20Critical\x20Products\x20sheet:','productType','parentElement','kSSWP','xRnLk','productName','cIPGn','MACO_All_Products_Report.xlsx','zWBap','block','INGREDIENT','length','wYAeB','Error\x20loading\x20machines','productCode','nRbJV','Hide\x20MACO\x20Calculation\x20Breakdown','NmbOV','trainSummaryContainer','MpKiE','revokeObjectURL','gPkDq','max','required','OTEdV','qEmPU','\x20.ingredients-sub-table','Train\x20Summary','qwauE','Failed\x20to\x20parse\x20JSON\x20file.','historyIndex','Error\x20loading\x20scoring\x20criteria','readAsText','QPSxP','dxsGR','setHistory','DGqnU','content-pm-','Error\x20creating\x20Detergent\x20MACO\x20sheet:','No\x20reason\x20provided','Train\x20Summary\x20Report','filter','UGkEz','products','-hidden','There\x20are\x20no\x20summary\x20data\x20to\x20export.\x20Add\x20products\x20and\x20ingredients\x20first.','parse','aHvys','knCQW','XZSdM','oBCFV','macoDetergentIngredients','COGet','UqEXZ','innerHTML','Eaked','maco_data_export.json','zJNcK','zxQdC','vgAKB','viewProducts','UkVWR','./trainSummaryView.js','trim','toLocaleDateString','XjoSE','Yes','rAKSV','pGaGa','JxoZo','EEbLw','isCritical','wubYA','SJckK','No\x20Data','Summary\x20report\x20data\x20exported\x20to\x20Excel\x20successfully!','bmBWU','TYmTg','clJiG','rQtMh','json_to_sheet','toggle-dm-','Error\x20creating\x20Train\x20Summary\x20sheet:','fWFgF','rpnRatingText','bDXJP','No\x20train\x20data\x20to\x20print.\x20Please\x20ensure\x20you\x20have\x20created\x20trains\x20first.','sf-input-train-','fAVbg','YCKvR','warn','ENpus','closest','nwchW','YOnLB','WnvQQ','toISOString','Other','arafs','macoMachines','scoringInEditMode',')\x20-\x20RPN:\x20','Error\x20exporting\x20all\x20tabs\x20to\x20Excel:','severity','oJGmA','ggBIW','customAlertTitle','oWHWp','MACO_Machines_','GVloa','batchSizeKg','OjbZu','!cols','toggle-pm-','fXLRr','pLsTY','Error\x20exporting\x20to\x20Excel:','pXtwd','mJeqr','nnmSd','ROsnD','NbEzg','content-dm-','eslqj','Invalid\x20JSON\x20file\x20structure.','iHmAt','MkaYn','rDGsI','safetyFactorConfig','Train\x20summary\x20container\x20is\x20hidden\x20or\x20missing','hYMGM','HonBy','tphWV','GORGp','Show\x20LD50','textContent','xexPY','There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','eKQUv','ixNxa','setDetergentIngredients','dFePM','therapeuticDose','kFVne','hide-','ingredientName','iQbLL','xiVdH','uOEHZ','-ld50Hidden','.xlsx','iUeIt','Pmost','productRegister-ld50Hidden','reduce','rpn','PRODUCT','0.1%\x20Therapeutic\x20Dose','EjjgP','bvUqO','book_append_sheet','UwZNw','MFVmx','getItem','_Train_','toExponential','vJKcn','trainId','KpSZe','Error\x20exporting\x20worst\x20case\x20to\x20Excel:','xlPqX','Error\x20loading\x20products','zawCc','aQtRg','\x20.mainTable,\x20#','zWowX','productRegister-pdeHidden','rtwxe','getElementById','rpnChartInstance','lsbfA','erknH','TDWRL','XHQzd','aZuVv','ZvqET','Failed\x20to\x20export\x20data\x20to\x20Excel.','ilnyl','ZfOZN','maco-breakdown-details-','QnuTC','Yvedq','KNRvG','80061YhOkbQ','qZRLC','error','MRjdB','JqdOC','machineStageDisplayOrder','Worst\x20Case\x20Products','result','deDJr','yaPVV','qxpfB','body','lowestLd50','sort','izeEw','KhWnK','vYefl','Lpnqu','XGTSr','files','name','zLdmj','Train\x20Summary\x20data\x20exported\x20to\x20Excel\x20successfully!','macoProducts','AnIpE','addEventListener','mMYHb','wyava','hOSfT','There\x20is\x20no\x20data\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','Detergent\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','slDYf','Product\x20MACO','noTrainSummaryMessage','sayxM','lowestPde','WCqrl','iSTVi','Error\x20loading\x20train\x20summary\x20view:','uqSxe','_Trains_','MhlTv','FfIJQ','machineIds','No\x20trains\x20match\x20the\x20selected\x20criteria.','EytlN','awkqz','FSjps','setProducts','Train\x20',',\x20#','macoForTrains','utils','ETKzH','wwOJV','OOggc','WcotI','aHDXf','10\x20ppm\x20Criterion','hnmgF','pdeMg','Train_Summary_Report','QSQoh','breakdown-toggle-btn-','Ckbpe','worstProductRpn','Failed\x20to\x20export\x20worst\x20case\x20data\x20to\x20Excel.','Xqyyy','JPDpJ','xKMCX','LplMP','setItem','Error','NXPkR','stage','ENuiC','collapsed','moCpf','renderTrainSummary','LQxoo','customAlertModal','5402428yCWlzW','Error\x20creating\x20Product\x20Register\x20sheet:','tTaPX','nhpms','XPnfV','join','Failed\x20to\x20export\x20complete\x20report\x20to\x20Excel.','Failed\x20to\x20export\x20data\x20to\x20JSON.','pcoYC','DMMVY','then','wYBZQ','not\x20found','Buigp','setScoringCriteria','MACO_Summary_Report_','contains','smpTb','min','QyMPl','QwygI','productRegister-','vSTGP','theme-toggle-light-icon','theme-toggle-dark-icon','szluL','.toggle-pde','ltdMg','push','NjnVl','cleanabilityScore','Ejzov','catch','eEmlj','RlSRw','aAdZC','iiQuy','input','PZOQU','686760HCsGRm','gALIv','cRzYG','ZJxfT','EmYdm','MBCcx','36SolQhr','detection','occurrence','Error\x20exporting\x20machines\x20to\x20Excel:','startsWith','hide-pde','solubilityScore','-pdeHidden','writeFile','pJWxt','ImhfQ','setMachineStageDisplayOrder','pOJkw','HZPxh','urWAG','rPwQJ','krKmM','minBsMddRatio','classList','./macoDetergentView.js','qzKRY','MACO\x20Report','OsKcq','product-sf-input','Hidden','Machines\x20data\x20exported\x20to\x20Excel\x20successfully!','stage-','qyQPl','onload','hlcXM','TdvVp','area','hLMTT','QyEUU','toFixed','VfAJR','IvBky','EhgUn','machines','JirnQ','forEach','book_new','poqUp','productRegister','pqdfD','GALvb','FaeNU','1TvpItR','ubPdO','Error\x20exporting\x20Product\x20MACO\x20to\x20Excel:','pMupe','gdIyZ','pHTsh','message','xnYNp','YHEYx','AVfCz','OruWO','6292UaaxUx','mOyIx','none','machineNumber','johHb','macoChartInstance','essa','There\x20are\x20no\x20detergent\x20ingredients\x20configured.\x20Add\x20detergent\x20ingredients\x20first.','VyPEH','Error\x20creating\x20All\x20Products\x20sheet:','Complete\x20report\x20with\x20all\x20tabs\x20exported\x20to\x20Excel\x20successfully!','hIBUP','#productRegister\x20.mainTable.hide-','yZWyb','MtEoM','NEyqH','1433232AjtZdw','cECXz','3209638CUsDqQ','tNqqB','pde','QpRhW','kiUKG','value','ptswY','all','rFrVs','Container\x20has\x20content:'];a16_0x4557=function(){return _0x379410;};return a16_0x4557();}export function toggleColumnVisibilityDropdown(){const _0x3e667a=a16_0x500c1c,_0x36ad0f={'Mkwiq':'button[onclick=\x22toggleColumnVisibilityDropdown()\x22]','IvBky':_0x3e667a(0x282),'hIBUP':_0x3e667a(0x2f1),'ZfOZN':_0x3e667a(0x238)},_0x570e3c=document[_0x3e667a(0x3ca)](_0x36ad0f[_0x3e667a(0x3d4)]);_0x570e3c['classList']['toggle'](_0x36ad0f[_0x3e667a(0x201)]),_0x570e3c[_0x3e667a(0x1ef)][_0x3e667a(0x1c0)]('hidden')||document[_0x3e667a(0x3f2)](_0x36ad0f[_0x3e667a(0x222)],function _0x5bffc1(_0x4142b7){const _0x3617bf=_0x3e667a;_0x4142b7['target'][_0x3617bf(0x374)](_0x3617bf(0x245))||_0x4142b7[_0x3617bf(0x313)][_0x3617bf(0x374)](_0x36ad0f[_0x3617bf(0x2ee)])||(_0x570e3c[_0x3617bf(0x1ef)]['add'](_0x36ad0f[_0x3617bf(0x201)]),document[_0x3617bf(0x278)](_0x36ad0f[_0x3617bf(0x222)],_0x5bffc1));});}export function updateToggleIcons(_0x4bc75c){const _0xe9296c=a16_0x500c1c,_0x59692e={'QPSxP':_0xe9296c(0x1e2),'UwZNw':_0xe9296c(0x2ec),'tphWV':function(_0x20f48e,_0x2b9227){return _0x20f48e===_0x2b9227;},'bvUqO':_0xe9296c(0x2b1),'qxpfB':_0xe9296c(0x3c8),'ldhQV':'productRegister-ld50Hidden','wuQDu':'true','pXtwd':function(_0x4e8c9f,_0x42774d){return _0x4e8c9f===_0x42774d;},'YNWUa':function(_0x3be1c5,_0x1c4834){return _0x3be1c5&&_0x1c4834;},'saUpm':function(_0x21ea6a,_0x57854b){return _0x21ea6a===_0x57854b;},'qECiZ':function(_0x1fa31f,_0x23df7c){return _0x1fa31f===_0x23df7c;},'pqdfD':_0xe9296c(0x2b9),'ilnyl':_0xe9296c(0x2dd),'bCsXP':_0xe9296c(0x24b)},_0x4826db=document[_0xe9296c(0x3ca)](_0x4bc75c);if(!_0x4826db)return;let _0x2275e4,_0xaba1f6;if(_0x59692e['tphWV'](_0x59692e[_0xe9296c(0x3b7)],_0x4bc75c)){const _0x31fb5d=localStorage[_0xe9296c(0x3bb)](_0x59692e[_0xe9296c(0x3e3)]),_0x150af5=localStorage['getItem'](_0x59692e[_0xe9296c(0x2a5)]);if(_0x59692e[_0xe9296c(0x39c)](null,_0x31fb5d)&&null===_0x150af5)_0x2275e4=!0x1,_0xaba1f6=!0x1;else{const _0x5e7e3a=_0x59692e['wuQDu']===_0x31fb5d,_0x5ec5b3=_0x59692e[_0xe9296c(0x38d)](_0x59692e[_0xe9296c(0x272)],_0x150af5);_0x59692e[_0xe9296c(0x2ed)](_0x5e7e3a,_0x5ec5b3)?(_0x2275e4=!0x1,_0xaba1f6=!0x0):(_0x2275e4=_0x5e7e3a,_0xaba1f6=_0x5ec5b3);}}else{const _0x30cbe3=localStorage[_0xe9296c(0x3bb)](_0x4bc75c+_0xe9296c(0x1e4)),_0x597214=localStorage[_0xe9296c(0x3bb)](_0x4bc75c+_0xe9296c(0x3ad));_0x2275e4=_0x59692e[_0xe9296c(0x2c6)](_0x59692e[_0xe9296c(0x272)],_0x30cbe3),_0xaba1f6=_0x59692e[_0xe9296c(0x2ea)](_0x59692e[_0xe9296c(0x272)],_0x597214);}const _0x869972=_0x4826db['querySelector'](_0xe9296c(0x1ca)),_0x22980c=_0x4826db[_0xe9296c(0x30e)](_0x59692e[_0xe9296c(0x209)]);_0x869972&&(_0x869972[_0xe9296c(0x34e)]=_0x2275e4?_0xe9296c(0x261):_0x59692e[_0xe9296c(0x3d3)]),_0x22980c&&(_0x22980c[_0xe9296c(0x34e)]=_0xaba1f6?_0xe9296c(0x39e):_0x59692e['bCsXP']),document['querySelectorAll']('#'+_0x4bc75c+_0xe9296c(0x3c6)+_0x4bc75c+'\x20.ingredients-sub-table')[_0xe9296c(0x205)](_0x39908a=>{const _0x21bbfd=_0xe9296c;_0x39908a&&(_0x39908a[_0x21bbfd(0x1ef)][_0x21bbfd(0x2d1)](_0x59692e['QPSxP'],_0x2275e4),_0x39908a[_0x21bbfd(0x1ef)]['toggle'](_0x59692e[_0x21bbfd(0x3b9)],_0xaba1f6));}),document[_0xe9296c(0x29b)]('#'+_0x4bc75c+_0xe9296c(0x40b)+_0x4bc75c+'\x20.train-content-inner')[_0xe9296c(0x205)](_0x45f914=>{const _0x2f7ebe=_0xe9296c;_0x45f914&&(_0x45f914[_0x2f7ebe(0x1ef)][_0x2f7ebe(0x2d1)](_0x59692e[_0x2f7ebe(0x339)],_0x2275e4),_0x45f914[_0x2f7ebe(0x1ef)][_0x2f7ebe(0x2d1)](_0x2f7ebe(0x2ec),_0xaba1f6));});}export function exportToExcel(){const _0x52ea92=a16_0x500c1c,_0x3d445a={'ubPdO':function(_0x4370c7,_0x567944){return _0x4370c7(_0x567944);},'tNqqB':function(_0x775e8a,_0x1456e0){return _0x775e8a===_0x1456e0;},'TdvVp':function(_0x3ffea0){return _0x3ffea0();},'pMupe':'No\x20Data','iHmAt':'There\x20is\x20no\x20data\x20in\x20the\x20current\x20view\x20to\x20export.','WiCAY':_0x52ea92(0x1f2),'OsKcq':'!cols','lNGzD':_0x52ea92(0x31f),'OruWO':function(_0x5b677f){return _0x5b677f();},'nonMu':_0x52ea92(0x38c),'TDWRL':_0x52ea92(0x1a7),'KVVJU':_0x52ea92(0x3d2),'aHvys':_0x52ea92(0x2d5)};showLoader(),import(_0x3d445a[_0x52ea92(0x347)])[_0x52ea92(0x1ba)](_0x55771a=>{const _0x507fee=_0x52ea92,_0x3c395f={'eKQUv':function(_0x1701ec,_0x25f08b){return _0x1701ec(_0x25f08b);}},{getProductTrainId:_0x47ecd0,calculateScores:_0x489652}=_0x55771a,_0x287827=[];if(a16_0xc61194[_0x507fee(0x343)]['forEach'](_0x2e0a8a=>{const _0x43451c=_0x507fee;let _0x1778f9='No';_0x2e0a8a[_0x43451c(0x35f)]&&(_0x1778f9=_0x43451c(0x35a)+(_0x2e0a8a[_0x43451c(0x284)]?':\x20'+_0x2e0a8a[_0x43451c(0x284)]:''));const _0x206675=_0x3d445a[_0x43451c(0x20d)](a16_0x8e9379,_0x2e0a8a),_0x264620=_0x2e0a8a[_0x43451c(0x262)]?new Date(_0x2e0a8a[_0x43451c(0x262)])[_0x43451c(0x358)]():'';_0x287827[_0x43451c(0x1cc)]({'Date':_0x264620,'Product\x20Code':_0x2e0a8a[_0x43451c(0x326)],'Product\x20Name':_0x2e0a8a[_0x43451c(0x3ed)],'Train\x20No.':_0x206675,'Dosage\x20Form':_0x2e0a8a['productType']||'','Batch\x20Size\x20(Kg)':_0x2e0a8a[_0x43451c(0x386)],'Special\x20Case\x20Product':_0x1778f9,'Active\x20Ingredient':'','Solubility':'','Therapeutic\x20Dose\x20(mg/day)':'','Cleanability':'','PDE\x20(µg/day)':'','LD50\x20(mg/kg)':'','Solubility\x20Score':'','Therapeutic\x20Dose\x20Score':'','Cleanability\x20Score':'','Toxicity\x20Score':'','RPN':'','RPN\x20Rating':''}),_0x2e0a8a[_0x43451c(0x2f7)][_0x43451c(0x205)](_0x3875b5=>{const _0x24e9f7=_0x43451c,_0x5bea40=_0x3c395f[_0x24e9f7(0x3a2)](_0x489652,_0x3875b5);_0x287827[_0x24e9f7(0x1cc)]({'Date':'','Product\x20Code':'','Product\x20Name':'\x20\x20└─\x20'+_0x3875b5['name'],'Train\x20No.':'','Dosage\x20Form':'','Batch\x20Size\x20(Kg)':'','Special\x20Case\x20Product':'','Active\x20Ingredient':_0x3875b5[_0x24e9f7(0x3ed)],'Solubility':_0x3875b5[_0x24e9f7(0x2bb)]||'','Therapeutic\x20Dose\x20(mg/day)':_0x3875b5[_0x24e9f7(0x3a6)]||'','Cleanability':_0x3875b5[_0x24e9f7(0x2a3)]||'','PDE\x20(µg/day)':_0x3875b5[_0x24e9f7(0x22b)]||'','LD50\x20(mg/kg)':_0x3875b5[_0x24e9f7(0x268)]||'','Solubility\x20Score':_0x5bea40[_0x24e9f7(0x1e3)]||'','Therapeutic\x20Dose\x20Score':_0x5bea40[_0x24e9f7(0x2cd)]||'','Cleanability\x20Score':_0x5bea40[_0x24e9f7(0x1ce)]||'','Toxicity\x20Score':_0x5bea40[_0x24e9f7(0x2b2)]||_0x5bea40[_0x24e9f7(0x2b0)]||'','RPN':_0x5bea40['rpn'],'RPN\x20Rating':_0x5bea40[_0x24e9f7(0x36c)]});});}),_0x3d445a[_0x507fee(0x22a)](0x0,_0x287827[_0x507fee(0x323)]))return _0x3d445a[_0x507fee(0x1fb)](hideLoader),void showCustomAlert(_0x3d445a[_0x507fee(0x20f)],_0x3d445a[_0x507fee(0x395)]);const _0x59f928=XLSX[_0x507fee(0x193)][_0x507fee(0x368)](_0x287827),_0x22631c=XLSX[_0x507fee(0x193)][_0x507fee(0x206)]();XLSX[_0x507fee(0x193)][_0x507fee(0x3b8)](_0x22631c,_0x59f928,_0x3d445a[_0x507fee(0x27d)]);const _0x2aacf3=Object['keys'](_0x287827[0x0])[_0x507fee(0x307)](_0x78aa34=>({'wch':Math[_0x507fee(0x32e)](_0x78aa34[_0x507fee(0x323)],..._0x287827[_0x507fee(0x307)](_0x35d3cd=>String(_0x35d3cd[_0x78aa34]||'')[_0x507fee(0x323)]))+0x2}));_0x59f928[_0x3d445a[_0x507fee(0x1f3)]]=_0x2aacf3,XLSX[_0x507fee(0x1e5)](_0x22631c,_0x3d445a['lNGzD']),_0x3d445a[_0x507fee(0x216)](hideLoader);})[_0x52ea92(0x1d0)](_0x25e2e4=>{const _0x461024=_0x52ea92;console[_0x461024(0x3db)](_0x3d445a[_0x461024(0x2a2)],_0x25e2e4),hideLoader(),showCustomAlert(_0x3d445a[_0x461024(0x3ce)],_0x3d445a['KVVJU']);});}export function exportAllToJson(){const _0x1372df=a16_0x500c1c,_0x1f08c2={'fWFgF':_0x1372df(0x2dc),'AVfCz':_0x1372df(0x350),'FfIJQ':function(_0x5d61bc,_0x33f645,_0x2fd045){return _0x5d61bc(_0x33f645,_0x2fd045);},'TsOzS':_0x1372df(0x1a7),'KNRvG':function(_0x20508d,_0x26d34b){return _0x20508d+_0x26d34b;},'VGrWa':_0x1372df(0x1b7),'xRnLk':function(_0x33be1a){return _0x33be1a();}};showLoader();try{const _0x10da1b={'exportDate':new Date()[_0x1372df(0x378)](),'scoringCriteria':a16_0xc61194['scoringCriteria'],'products':a16_0xc61194['products'],'machines':a16_0xc61194[_0x1372df(0x203)],'detergentIngredients':a16_0xc61194[_0x1372df(0x279)]},_0x3ec91a=JSON[_0x1372df(0x292)](_0x10da1b,null,0x2),_0x343f6e=new Blob([_0x3ec91a],{'type':_0x1f08c2[_0x1372df(0x36b)]}),_0x3fd574=URL['createObjectURL'](_0x343f6e),_0x56452a=document['createElement']('a');_0x56452a[_0x1372df(0x2ce)]=_0x3fd574,_0x56452a['download']=_0x1f08c2[_0x1372df(0x215)],document[_0x1372df(0x3e4)]['appendChild'](_0x56452a),_0x56452a[_0x1372df(0x2f1)](),document[_0x1372df(0x3e4)]['removeChild'](_0x56452a),URL[_0x1372df(0x32c)](_0x3fd574);}catch(_0x15d022){_0x1f08c2[_0x1372df(0x403)](showCustomAlert,_0x1f08c2['TsOzS'],_0x1f08c2[_0x1372df(0x3d8)](_0x1f08c2[_0x1372df(0x243)],_0x15d022[_0x1372df(0x212)]));}finally{_0x1f08c2[_0x1372df(0x31c)](hideLoader);}}export function importFromJson(_0x4e7efb){const _0x178c05=a16_0x500c1c,_0x1cf874={'Odtda':function(_0x29324a){return _0x29324a();},'ROsnD':function(_0x3660ba){return _0x3660ba();},'zLdmj':function(_0x38befe,_0x3feb22,_0x46cd3a){return _0x38befe(_0x3feb22,_0x46cd3a);},'ZJxfT':'Success','bSibn':'Data\x20imported\x20successfully.','VhcUg':_0x178c05(0x394),'hYMGM':_0x178c05(0x1a7),'qZcTm':_0x178c05(0x335)},_0x2aafbe=_0x4e7efb[_0x178c05(0x313)][_0x178c05(0x3ec)][0x0];if(!_0x2aafbe)return;const _0x2ecedc=new FileReader();_0x2ecedc[_0x178c05(0x1f9)]=function(_0x62e226){const _0x12ffdf=_0x178c05;try{const _0x389aff=JSON['parse'](_0x62e226['target'][_0x12ffdf(0x3e0)]);_0x389aff&&_0x389aff['products']&&_0x389aff[_0x12ffdf(0x2b7)]&&_0x389aff[_0x12ffdf(0x203)]?(a16_0xc61194['setProducts'](_0x389aff[_0x12ffdf(0x343)]),a16_0xc61194[_0x12ffdf(0x2df)](_0x389aff[_0x12ffdf(0x203)]),a16_0xc61194['setScoringCriteria'](_0x389aff[_0x12ffdf(0x2b7)]),_0x389aff[_0x12ffdf(0x279)]&&a16_0xc61194[_0x12ffdf(0x3a4)](_0x389aff[_0x12ffdf(0x279)]),_0x1cf874[_0x12ffdf(0x273)](saveStateForUndo),_0x1cf874[_0x12ffdf(0x390)](a16_0xa36d4e),_0x1cf874[_0x12ffdf(0x3ee)](showCustomAlert,_0x1cf874[_0x12ffdf(0x1da)],_0x1cf874['bSibn'])):_0x1cf874['zLdmj'](showCustomAlert,_0x12ffdf(0x1a7),_0x1cf874['VhcUg']);}catch(_0x329cc8){showCustomAlert(_0x1cf874[_0x12ffdf(0x39a)],_0x1cf874['qZcTm']);}finally{_0x4e7efb[_0x12ffdf(0x313)][_0x12ffdf(0x22e)]='';}},_0x2ecedc[_0x178c05(0x338)](_0x2aafbe);}export function toggleOtherProductType(_0x28628b,_0x5ee9f5){const _0x5e04f4=a16_0x500c1c,_0x2e047a={'DkiZb':_0x5e04f4(0x1d5),'EEbLw':function(_0x43769b,_0x28ada7){return _0x43769b===_0x28ada7;},'JqdOC':_0x5e04f4(0x379),'HcQTx':_0x5e04f4(0x321)},_0x284188=document[_0x5e04f4(0x3ca)](_0x5ee9f5),_0x539f70=_0x284188[_0x5e04f4(0x30e)](_0x2e047a[_0x5e04f4(0x287)]);_0x2e047a[_0x5e04f4(0x35e)](_0x2e047a[_0x5e04f4(0x3dd)],_0x28628b['value'])?(_0x284188[_0x5e04f4(0x29c)][_0x5e04f4(0x312)]=_0x2e047a['HcQTx'],_0x539f70[_0x5e04f4(0x32f)]=!0x0):(_0x284188['style']['display']=_0x5e04f4(0x219),_0x539f70['required']=!0x1,_0x539f70['value']='');}export function toggleOtherMachineStage(_0x505386,_0x2cb58d){const _0x2f6c7f=a16_0x500c1c,_0x18e36e={'VfAJR':'input','JPDpJ':_0x2f6c7f(0x219)},_0x25db33=document[_0x2f6c7f(0x3ca)](_0x2cb58d),_0x27670a=_0x25db33[_0x2f6c7f(0x30e)](_0x18e36e[_0x2f6c7f(0x200)]);'Other'===_0x505386[_0x2f6c7f(0x22e)]?(_0x25db33[_0x2f6c7f(0x29c)]['display']=_0x2f6c7f(0x321),_0x27670a[_0x2f6c7f(0x32f)]=!0x0):(_0x25db33[_0x2f6c7f(0x29c)][_0x2f6c7f(0x312)]=_0x18e36e[_0x2f6c7f(0x1a3)],_0x27670a[_0x2f6c7f(0x32f)]=!0x1,_0x27670a[_0x2f6c7f(0x22e)]='');}export function toggleOtherMachineGroup(_0x2b6ea8,_0x1bf6b8){const _0x3320fe=a16_0x500c1c,_0x24f419={'hfVJy':_0x3320fe(0x1d5),'WcotI':'Other','niGRH':_0x3320fe(0x219)},_0x52d80b=document[_0x3320fe(0x3ca)](_0x1bf6b8),_0x41d5c3=_0x52d80b['querySelector'](_0x24f419[_0x3320fe(0x2e0)]);_0x24f419[_0x3320fe(0x197)]===_0x2b6ea8[_0x3320fe(0x22e)]?(_0x52d80b[_0x3320fe(0x29c)]['display']=_0x3320fe(0x321),_0x41d5c3[_0x3320fe(0x32f)]=!0x0):(_0x52d80b[_0x3320fe(0x29c)][_0x3320fe(0x312)]=_0x24f419['niGRH'],_0x41d5c3['required']=!0x1,_0x41d5c3[_0x3320fe(0x22e)]='');}export function clampSafetyFactor(_0x412ece,_0x7311c5){const _0x494203=a16_0x500c1c,_0x16bc8a={'JirnQ':function(_0x1b989b,_0x1b5552){return _0x1b989b(_0x1b5552);},'NjnVl':function(_0x18d322,_0x4d4d7c){return _0x18d322(_0x4d4d7c);},'jOMVF':function(_0x2cf224,_0x10fd43){return _0x2cf224<_0x10fd43;},'xvRSu':function(_0x118fbe,_0x159cd7){return _0x118fbe!==_0x159cd7;},'xdNOi':_0x494203(0x1f4),'TGjrL':function(_0x37454b,_0x1fc098){return _0x37454b(_0x1fc098);},'ztwiN':_0x494203(0x2ca)},_0x2b7407=parseFloat(_0x412ece['min']),_0xe76502=_0x16bc8a[_0x494203(0x204)](parseFloat,_0x412ece[_0x494203(0x32e)]);let _0x194341=parseFloat(_0x412ece['value']);_0x16bc8a[_0x494203(0x1cd)](isNaN,_0x194341)&&(_0x194341=_0x2b7407),_0x16bc8a[_0x494203(0x2aa)](_0x194341,_0x2b7407)?_0x194341=_0x2b7407:_0x194341>_0xe76502&&(_0x194341=_0xe76502),_0x16bc8a[_0x494203(0x24a)](parseFloat(_0x412ece['value']),_0x194341)&&(_0x412ece[_0x494203(0x22e)]=_0x194341),_0x412ece['id'][_0x494203(0x1e1)](_0x16bc8a[_0x494203(0x27b)])?_0x16bc8a[_0x494203(0x274)](recalculateProductMacoForTrain,_0x7311c5):_0x412ece['id'][_0x494203(0x1e1)](_0x16bc8a['ztwiN'])&&_0x16bc8a[_0x494203(0x274)](recalculateDetergentMacoForTrain,_0x7311c5);}export function toggleTrain(_0x367ac0){const _0x71d327=a16_0x500c1c,_0x579563={'JWMSN':function(_0x4db243,_0x24f07e){return _0x4db243&&_0x24f07e;},'rDGsI':_0x71d327(0x1ab)},_0x45889d=document[_0x71d327(0x3ca)]('content-'+_0x367ac0),_0x514e37=document[_0x71d327(0x3ca)](_0x71d327(0x288)+_0x367ac0);_0x579563['JWMSN'](_0x45889d,_0x514e37)&&(_0x45889d[_0x71d327(0x1ef)][_0x71d327(0x1c0)](_0x579563[_0x71d327(0x397)])?(_0x45889d[_0x71d327(0x1ef)]['remove'](_0x579563['rDGsI']),_0x514e37['textContent']='▼'):(_0x45889d['classList']['add'](_0x579563[_0x71d327(0x397)]),_0x514e37[_0x71d327(0x39f)]='▶'));}export function toggleMacoBreakdown(_0x1de277){const _0x166dc8=a16_0x500c1c,_0x45e2c4={'LVDcH':'hidden','cIPGn':_0x166dc8(0x328),'szluL':'Show\x20MACO\x20Calculation\x20Breakdown'},_0x55182f=document['getElementById'](_0x166dc8(0x3d5)+_0x1de277),_0x55cdf2=document['getElementById'](_0x166dc8(0x19e)+_0x1de277);_0x55182f[_0x166dc8(0x1ef)][_0x166dc8(0x1c0)](_0x45e2c4[_0x166dc8(0x2c1)])?(_0x55182f[_0x166dc8(0x1ef)][_0x166dc8(0x294)](_0x45e2c4['LVDcH']),_0x55cdf2[_0x166dc8(0x39f)]=_0x45e2c4[_0x166dc8(0x31e)]):(_0x55182f['classList'][_0x166dc8(0x2e8)](_0x45e2c4['LVDcH']),_0x55cdf2[_0x166dc8(0x39f)]=_0x45e2c4[_0x166dc8(0x1c9)]);}export function exportWorstCaseToExcel(_0x1a612f=a16_0x500c1c(0x230)){const _0x5bdb8e=a16_0x500c1c,_0xdcca21={'MpKiE':function(_0x3805b6,_0x42aeaf){return _0x3805b6(_0x42aeaf);},'aNWTk':function(_0x5d8ce6,_0x44ad8d){return _0x5d8ce6!==_0x44ad8d;},'johHb':_0x5bdb8e(0x2ae),'GUOGv':_0x5bdb8e(0x35a),'OWTxD':function(_0x236196,_0x36a416){return _0x236196===_0x36a416;},'rFrVs':function(_0x1f3e29,_0x372585,_0x49fb5b){return _0x1f3e29(_0x372585,_0x49fb5b);},'wYBZQ':'There\x20are\x20no\x20products\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','gPkDq':'all','hIbgR':function(_0x9cf674,_0x323299){return _0x9cf674===_0x323299;},'NEyqH':function(_0x4bc5ce){return _0x4bc5ce();},'oXkjp':function(_0x4739eb,_0xf35ec8){return _0x4739eb===_0xf35ec8;},'vYefl':function(_0x476d74){return _0x476d74();},'awkqz':_0x5bdb8e(0x362),'kxwDK':_0x5bdb8e(0x3f6),'hQQPl':'!cols','bamGI':function(_0x19f17e){return _0x19f17e();},'fXLRr':_0x5bdb8e(0x3c1),'XZSdM':_0x5bdb8e(0x1a7),'imwhU':function(_0x1d602d){return _0x1d602d();},'EytlN':'./utils.js'};_0xdcca21['imwhU'](showLoader),import(_0xdcca21[_0x5bdb8e(0x406)])['then'](_0xd98808=>{const _0x148919=_0x5bdb8e,_0x2b5057={'nRbJV':_0xdcca21['GUOGv']},{getProductTrainId:_0x2cec4f,calculateScores:_0x4f5159,getToxicityPreference:_0x2567e2}=_0xd98808,_0x3e4445=[];let _0x19f15c=a16_0xc61194[_0x148919(0x354)]['worstCaseProducts']||a16_0xc61194[_0x148919(0x343)];if(_0xdcca21['OWTxD'](0x0,_0x19f15c[_0x148919(0x323)]))return hideLoader(),void _0xdcca21[_0x148919(0x231)](showCustomAlert,'No\x20Data',_0xdcca21[_0x148919(0x1bb)]);const _0x282440={};_0x19f15c[_0x148919(0x205)](_0x4116d8=>{const _0x4bffc8=_0x148919,_0x9f9f02=_0xdcca21[_0x4bffc8(0x32b)](a16_0x8e9379,_0x4116d8);_0xdcca21[_0x4bffc8(0x250)](_0xdcca21[_0x4bffc8(0x21b)],_0x9f9f02)&&(_0x282440[_0x9f9f02]||(_0x282440[_0x9f9f02]=[]),_0x282440[_0x9f9f02][_0x4bffc8(0x1cc)](_0x4116d8));});let _0x2e84b6=_0x282440;if(_0xdcca21[_0x148919(0x250)](_0xdcca21[_0x148919(0x32d)],_0x1a612f)&&(_0x2e84b6={},Array[_0x148919(0x276)](_0x1a612f)?_0x1a612f[_0x148919(0x205)](_0x579e66=>{_0x282440[_0x579e66]&&(_0x2e84b6[_0x579e66]=_0x282440[_0x579e66]);}):_0x282440[_0x1a612f]&&(_0x2e84b6={[_0x1a612f]:_0x282440[_0x1a612f]}),_0xdcca21[_0x148919(0x304)](0x0,Object['keys'](_0x2e84b6)[_0x148919(0x323)])))return hideLoader(),void _0xdcca21['rFrVs'](showCustomAlert,_0x148919(0x362),(Array[_0x148919(0x276)](_0x1a612f)?_0x148919(0x271)+_0x1a612f[_0x148919(0x1b5)](',\x20'):_0x148919(0x40a)+_0x1a612f)+_0x148919(0x233));const _0x11eda5=_0xdcca21[_0x148919(0x226)](_0x2567e2);if(Object[_0x148919(0x2d8)](_0x2e84b6)[_0x148919(0x3e6)]((_0x7b8afc,_0x380211)=>_0x7b8afc-_0x380211)[_0x148919(0x205)](_0x2bd528=>{const _0x13a604=_0x148919,_0x4c1c23={'ixNxa':_0xdcca21[_0x13a604(0x21b)]},_0x5aba48=_0x2e84b6[_0x2bd528];_0x3e4445[_0x13a604(0x1cc)]({'Train':_0x13a604(0x40a)+_0x2bd528+'\x20-\x20Worst\x20Case\x20Analysis','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),_0x5aba48[_0x13a604(0x205)](_0x121bdc=>{const _0x4b29a6=_0x13a604,_0xa80b0d=_0x121bdc[_0x4b29a6(0x2f7)][_0x4b29a6(0x307)](_0x4fb5ec=>_0x4f5159(_0x4fb5ec,_0x11eda5)[_0x4b29a6(0x3b3)]);_0x121bdc[_0x4b29a6(0x310)]=_0xa80b0d[_0x4b29a6(0x323)]>0x0?Math[_0x4b29a6(0x32e)](..._0xa80b0d):0x0;}),_0x5aba48[_0x13a604(0x3e6)]((_0x25e719,_0xf16530)=>_0xf16530['sortValue']-_0x25e719[_0x13a604(0x310)]),_0x5aba48[_0x13a604(0x205)](_0x13faf0=>{const _0x38edce=_0x13a604,_0x440cac=_0x13faf0[_0x38edce(0x35f)]?_0x2b5057[_0x38edce(0x327)]:'No';_0x3e4445['push']({'Train':'','Product\x20Code':_0x13faf0[_0x38edce(0x326)],'Product\x20Name':_0x13faf0[_0x38edce(0x3ed)],'Highest\x20RPN':_0x13faf0['sortValue'],'Special\x20Case\x20Product':_0x440cac,'Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),(_0x13faf0['activeIngredients']['sort']((_0x147176,_0x12dda5)=>_0x4f5159(_0x12dda5,_0x11eda5)['rpn']-_0x4f5159(_0x147176,_0x11eda5)['rpn'])['forEach'](_0x497a64=>{const _0x9380d3=_0x38edce,_0x1a6777=_0x4f5159(_0x497a64,_0x11eda5);_0x3e4445['push']({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':_0x497a64[_0x9380d3(0x3ed)],'TD\x20Score':_0x1a6777[_0x9380d3(0x2cd)],'Solubility\x20Score':_0x1a6777[_0x9380d3(0x1e3)],'Cleanability\x20Score':_0x1a6777[_0x9380d3(0x1ce)],'PDE\x20Score':_0x1a6777[_0x9380d3(0x2b2)]??_0x4c1c23[_0x9380d3(0x3a3)],'LD50\x20Score':_0x1a6777['ld50Score']??_0x4c1c23['ixNxa'],'RPN':_0x1a6777[_0x9380d3(0x3b3)],'Rating':_0x1a6777[_0x9380d3(0x36c)]});}),_0x3e4445['push']({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}));});}),_0xdcca21['oXkjp'](0x0,_0x3e4445[_0x148919(0x323)]))return _0xdcca21[_0x148919(0x3e9)](hideLoader),void _0xdcca21[_0x148919(0x231)](showCustomAlert,_0xdcca21[_0x148919(0x407)],_0xdcca21[_0x148919(0x2cf)]);const _0x41d4fd=XLSX['utils'][_0x148919(0x368)](_0x3e4445),_0x5028f5=XLSX[_0x148919(0x193)]['book_new']();XLSX[_0x148919(0x193)][_0x148919(0x3b8)](_0x5028f5,_0x41d4fd,_0x148919(0x3df));const _0x1f2434=Object[_0x148919(0x2d8)](_0x3e4445[0x0])[_0x148919(0x307)](_0x12d14a=>({'wch':Math[_0x148919(0x32e)](_0x12d14a[_0x148919(0x323)],..._0x3e4445['map'](_0x59f8fc=>String(_0x59f8fc[_0x12d14a]||'')['length']))+0x2}));_0x41d4fd[_0xdcca21[_0x148919(0x316)]]=_0x1f2434;const _0x151000=new Date()[_0x148919(0x378)]()[_0x148919(0x23b)]('T')[0x0];let _0x8181f7='';_0xdcca21['aNWTk'](_0xdcca21[_0x148919(0x32d)],_0x1a612f)&&(_0x8181f7=Array[_0x148919(0x276)](_0x1a612f)?_0x148919(0x401)+_0x1a612f[_0x148919(0x1b5)]('_'):_0x148919(0x3bc)+_0x1a612f),XLSX[_0x148919(0x1e5)](_0x5028f5,_0x148919(0x297)+_0x8181f7+'_'+_0x151000+_0x148919(0x3ae)),_0xdcca21[_0x148919(0x257)](hideLoader);})[_0x5bdb8e(0x1d0)](_0x35c1f3=>{const _0x5ddf49=_0x5bdb8e;console['error'](_0xdcca21[_0x5ddf49(0x38a)],_0x35c1f3),hideLoader(),showCustomAlert(_0xdcca21[_0x5ddf49(0x349)],_0x5ddf49(0x1a1));});}export function exportMachinesToExcel(){const _0x26ce71=a16_0x500c1c,_0x5b223e={'kFVne':'None','ZieZL':function(_0x4fd012,_0x297cff){return _0x4fd012===_0x297cff;},'oYkQn':function(_0x248e4a){return _0x248e4a();},'mNpAl':function(_0x5de75d,_0x3177ce,_0xdf1fb5){return _0x5de75d(_0x3177ce,_0xdf1fb5);},'LFfhI':_0x26ce71(0x362),'ZSuWP':'There\x20are\x20no\x20machines\x20to\x20export.','xnqjz':'Machines','gaRfY':_0x26ce71(0x388),'Ejzov':function(_0x3760a4,_0x4e2686,_0x1f1d5c){return _0x3760a4(_0x4e2686,_0x1f1d5c);},'QwygI':_0x26ce71(0x23c),'QpRhW':_0x26ce71(0x1e0),'rtwxe':function(_0x2e62cb){return _0x2e62cb();},'aZuVv':'Failed\x20to\x20export\x20machines\x20data\x20to\x20Excel.'};showLoader();try{if(_0x5b223e['ZieZL'](0x0,a16_0xc61194[_0x26ce71(0x203)][_0x26ce71(0x323)]))return _0x5b223e[_0x26ce71(0x309)](hideLoader),void _0x5b223e[_0x26ce71(0x26d)](showCustomAlert,_0x5b223e[_0x26ce71(0x2c5)],_0x5b223e[_0x26ce71(0x235)]);const _0x2ca1c0=[],_0x4b7ae8={};a16_0xc61194[_0x26ce71(0x203)][_0x26ce71(0x205)](_0x501b22=>{const _0x5a1c3b=_0x26ce71;_0x4b7ae8[_0x501b22[_0x5a1c3b(0x1a9)]]||(_0x4b7ae8[_0x501b22['stage']]=[]),_0x4b7ae8[_0x501b22[_0x5a1c3b(0x1a9)]]['push'](_0x501b22);}),a16_0xc61194[_0x26ce71(0x3de)]['forEach'](_0xa1cf16=>{const _0x2ee2ef=_0x26ce71,_0x42f69f={'nhpms':_0x5b223e[_0x2ee2ef(0x3a7)]};_0x4b7ae8[_0xa1cf16]&&_0x4b7ae8[_0xa1cf16][_0x2ee2ef(0x205)](_0x343ae4=>{const _0x556820=_0x2ee2ef,_0x8cb456=a16_0xc61194['products']['filter'](_0x4da838=>_0x4da838[_0x556820(0x404)]&&_0x4da838['machineIds'][_0x556820(0x2e5)](_0x343ae4['id'])),_0x1713e8=_0x8cb456[_0x556820(0x307)](_0x4a67fe=>_0x4a67fe[_0x556820(0x3ed)])[_0x556820(0x1b5)](',\x20')||_0x42f69f[_0x556820(0x1b3)],_0x57eb03=_0x8cb456[_0x556820(0x323)];_0x2ca1c0[_0x556820(0x1cc)]({'Machine\x20Number':_0x343ae4['machineNumber'],'Machine\x20Name':_0x343ae4['name'],'Stage':_0x343ae4[_0x556820(0x1a9)],'Area\x20(sq\x20cm)':_0x343ae4[_0x556820(0x1fc)],'Assigned\x20Products\x20Count':_0x57eb03,'Assigned\x20Products':_0x1713e8});});});const _0x3b21e8=XLSX[_0x26ce71(0x193)]['json_to_sheet'](_0x2ca1c0),_0x5f2889=XLSX[_0x26ce71(0x193)][_0x26ce71(0x206)]();XLSX['utils'][_0x26ce71(0x3b8)](_0x5f2889,_0x3b21e8,_0x5b223e['xnqjz']);const _0x4d6dd5=[{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0xf},{'wch':0x14},{'wch':0x32}];_0x3b21e8[_0x5b223e['gaRfY']]=_0x4d6dd5;const _0x534109=new Date()['toISOString']()[_0x26ce71(0x23b)]('T')[0x0];XLSX[_0x26ce71(0x1e5)](_0x5f2889,_0x26ce71(0x384)+_0x534109+_0x26ce71(0x3ae)),_0x5b223e[_0x26ce71(0x309)](hideLoader),_0x5b223e[_0x26ce71(0x1cf)](showCustomAlert,_0x5b223e[_0x26ce71(0x1c4)],_0x26ce71(0x1f6));}catch(_0x1b5b59){console['error'](_0x5b223e[_0x26ce71(0x22c)],_0x1b5b59),_0x5b223e[_0x26ce71(0x3c9)](hideLoader),_0x5b223e[_0x26ce71(0x26d)](showCustomAlert,_0x26ce71(0x1a7),_0x5b223e[_0x26ce71(0x3d0)]);}}export function exportProductMacoToExcel(_0x51d7e1=a16_0x500c1c(0x230)){const _0x646c8d=a16_0x500c1c,_0x189d4b={'qRVWa':function(_0x5bb0df,_0x461cdf){return _0x5bb0df||_0x461cdf;},'pOJkw':function(_0x5b66e5,_0x5d8c6c){return _0x5b66e5(_0x5d8c6c);},'aHtuh':function(_0x18943c,_0x2c4567){return _0x18943c*_0x2c4567;},'Ckbpe':function(_0x40c1d0,_0x291466){return _0x40c1d0*_0x291466;},'XiZHH':function(_0x165b69,_0x3b66c7){return _0x165b69/_0x3b66c7;},'hOWKs':function(_0x59e9b8,_0x4ad264){return _0x59e9b8/_0x4ad264;},'gdbRj':function(_0x42ba6b,_0xcb2d69){return _0x42ba6b===_0xcb2d69;},'kQKNf':_0x646c8d(0x296),'MGEya':_0x646c8d(0x3b1),'AnIpE':function(_0x73d6d5,_0xc98fc8){return _0x73d6d5/_0xc98fc8;},'gTlYH':function(_0x280297,_0x26a5d8){return _0x280297*_0x26a5d8;},'zAqtH':function(_0x1df90e,_0x5c2b54){return _0x1df90e/_0x5c2b54;},'aHDXf':function(_0x3ecc2c,_0x545b24){return _0x3ecc2c*_0x545b24;},'IQYxN':_0x646c8d(0x3b5),'erdQb':'Health-Based\x20Limit\x20(NOEL)','NQMwu':function(_0x51c1ff,_0xc9d963){return _0x51c1ff*_0xc9d963;},'uENvZ':_0x646c8d(0x2ae),'qEmPU':function(_0x5e5f4d){return _0x5e5f4d();},'xexPY':function(_0x264e97,_0xeffd61){return _0x264e97!==_0xeffd61;},'fUccm':function(_0x2ef7fe,_0x36dac9){return _0x2ef7fe==_0x36dac9;},'aAdZC':_0x646c8d(0x256),'iQbLL':function(_0x30b388){return _0x30b388();},'TYmTg':function(_0x286b52,_0x2fe89f){return _0x286b52===_0x2fe89f;},'rgJel':function(_0x143434,_0x35e3de,_0x19a126){return _0x143434(_0x35e3de,_0x19a126);},'izeEw':_0x646c8d(0x362),'kiUKG':_0x646c8d(0x3a1),'EjjgP':_0x646c8d(0x230),'dDokj':_0x646c8d(0x405),'DkzEf':'Product\x20MACO\x20Report','FSjps':_0x646c8d(0x388),'lHcJP':'Product_MACO_Report','ThEeD':function(_0x3972ea,_0x332c70){return _0x3972ea!==_0x332c70;},'ZUdFd':function(_0x428576,_0x2551ad,_0x154b93){return _0x428576(_0x2551ad,_0x154b93);},'mLJaL':_0x646c8d(0x23c),'arafs':_0x646c8d(0x29f),'hlcXM':_0x646c8d(0x20e),'xYDOB':function(_0xf8a9d5,_0x13d4fd,_0x11f4cd){return _0xf8a9d5(_0x13d4fd,_0x11f4cd);},'xBcam':_0x646c8d(0x1a7),'Xqyyy':_0x646c8d(0x295),'GNzBM':_0x646c8d(0x2d5)};showLoader(),import(_0x189d4b[_0x646c8d(0x2fe)])['then'](_0x30daca=>{const _0x264e56=_0x646c8d,{getTrainData:_0x2938a8,getWorstCaseProductType:_0x5c54ac,getMacoPerSwabForTrain:_0x33b42d,getLargestEssaForLineAndDosageForm:_0x722fec}=_0x30daca,_0x4df2a9=_0x189d4b[_0x264e56(0x3aa)](_0x2938a8);if(_0x189d4b[_0x264e56(0x365)](0x0,_0x4df2a9[_0x264e56(0x323)]))return hideLoader(),void _0x189d4b[_0x264e56(0x2bf)](showCustomAlert,_0x189d4b[_0x264e56(0x3e7)],_0x189d4b[_0x264e56(0x22d)]);let _0x4e5c34=_0x4df2a9;if(_0x189d4b[_0x264e56(0x3a0)](_0x189d4b[_0x264e56(0x3b6)],_0x51d7e1)&&(_0x4e5c34=Array['isArray'](_0x51d7e1)?_0x4df2a9['filter'](_0x1a3593=>_0x51d7e1['includes'](String(_0x1a3593['id']))):_0x4df2a9[_0x264e56(0x341)](_0x205ac4=>String(_0x205ac4['id'])===String(_0x51d7e1))),_0x189d4b[_0x264e56(0x365)](0x0,_0x4e5c34[_0x264e56(0x323)]))return _0x189d4b[_0x264e56(0x331)](hideLoader),void _0x189d4b[_0x264e56(0x2bf)](showCustomAlert,_0x189d4b[_0x264e56(0x3e7)],_0x189d4b['dDokj']);const _0x328175=[];_0x4e5c34[_0x264e56(0x205)](_0x18ce2d=>{const _0x45b7ce=_0x264e56,_0xaba12d={'GALvb':function(_0x2e61f5,_0x22841a){return _0x189d4b['qRVWa'](_0x2e61f5,_0x22841a);},'fAVbg':'N/A'},_0x2a989c=_0x189d4b[_0x45b7ce(0x1e9)](_0x5c54ac,_0x18ce2d[_0x45b7ce(0x343)][_0x45b7ce(0x307)](_0x7927d8=>_0x7927d8[_0x45b7ce(0x319)])),_0x38eea7=(a16_0xc61194['safetyFactorConfig'][_0x2a989c]||a16_0xc61194[_0x45b7ce(0x398)][_0x45b7ce(0x379)])[_0x45b7ce(0x32e)],_0x224cb2=_0x189d4b[_0x45b7ce(0x28b)](_0x18ce2d[_0x45b7ce(0x2e3)],_0x18ce2d[_0x45b7ce(0x1ee)])/_0x38eea7,_0x4cdcd4=_0x189d4b[_0x45b7ce(0x19f)](0xa,_0x18ce2d[_0x45b7ce(0x2cb)]);let _0x300428=_0x189d4b['XiZHH'](0x1,0x0),_0x278bde=_0x189d4b[_0x45b7ce(0x2b4)](0x1,0x0);const _0x190285=_0x189d4b[_0x45b7ce(0x2d9)](_0x189d4b['kQKNf'],localStorage[_0x45b7ce(0x3bb)]('productRegister-pdeHidden')),_0x5d21bc=_0x189d4b[_0x45b7ce(0x2a4)]===localStorage[_0x45b7ce(0x3bb)](_0x189d4b[_0x45b7ce(0x2a6)]);if(null===_0x18ce2d[_0x45b7ce(0x3fc)]||_0x190285||(_0x300428=_0x189d4b[_0x45b7ce(0x19f)](_0x18ce2d['lowestPde'],_0x18ce2d[_0x45b7ce(0x1ee)])),null!==_0x18ce2d[_0x45b7ce(0x3e5)]&&!_0x5d21bc){const _0x6e2759=_0x189d4b[_0x45b7ce(0x3f1)](_0x189d4b[_0x45b7ce(0x25b)](0x46,_0x18ce2d[_0x45b7ce(0x3e5)]),0x7d0),_0x49518c=_0x18ce2d['products'][_0x45b7ce(0x25a)](_0xacf0af=>_0xacf0af['activeIngredients'][_0x45b7ce(0x307)](_0x57aa4d=>_0x57aa4d[_0x45b7ce(0x314)]/0x3e8)),_0x94cf61=Math['min'](..._0x49518c);_0x278bde=_0x189d4b[_0x45b7ce(0x2f5)](_0x189d4b[_0x45b7ce(0x198)](_0x6e2759,_0x18ce2d['minMbsKg'])*0x3e8,_0x189d4b[_0x45b7ce(0x198)](_0x38eea7,_0x94cf61));}const _0x59effc=_0x722fec(_0x18ce2d,_0x4df2a9),_0x48608b=0.004*_0x59effc,_0x1601f7=[{'name':_0x189d4b['IQYxN'],'value':_0x224cb2},{'name':_0x45b7ce(0x199),'value':_0x4cdcd4}];null===_0x18ce2d[_0x45b7ce(0x3fc)]||_0x190285||_0x1601f7['push']({'name':_0x45b7ce(0x24e),'value':_0x300428}),_0x189d4b['gdbRj'](null,_0x18ce2d[_0x45b7ce(0x3e5)])||_0x5d21bc||_0x1601f7[_0x45b7ce(0x1cc)]({'name':_0x189d4b['erdQb'],'value':_0x278bde}),_0x1601f7[_0x45b7ce(0x1cc)]({'name':'Visual\x20Clean\x20Limit','value':_0x48608b});const _0x39761b=_0x1601f7[_0x45b7ce(0x3b2)]((_0x2c971d,_0x4dd613)=>_0x4dd613[_0x45b7ce(0x22e)]<_0x2c971d[_0x45b7ce(0x22e)]?_0x4dd613:_0x2c971d),_0x1e2f01=_0x39761b[_0x45b7ce(0x22e)],_0x3ab58d=_0x59effc>0x0?_0x189d4b[_0x45b7ce(0x2f5)](_0x1e2f01,_0x59effc):0x0,_0x88d423=_0x189d4b['NQMwu'](_0x3ab58d,_0x18ce2d[_0x45b7ce(0x246)]),_0x3f1dbb=_0x18ce2d[_0x45b7ce(0x404)]['map'](_0x2b8373=>{const _0x145eb0=_0x45b7ce,_0x5426f4=a16_0xc61194[_0x145eb0(0x203)]['find'](_0x53e031=>_0x53e031['id']===_0x2b8373);return _0xaba12d[_0x145eb0(0x20a)](_0x5426f4,{'name':'Unknown\x20(ID:\x20'+_0x2b8373+')','machineNumber':_0xaba12d[_0x145eb0(0x370)]});}),_0x463d03=_0x18ce2d[_0x45b7ce(0x404)][_0x45b7ce(0x307)](_0x5628d7=>{const _0x30c5ec=_0x45b7ce,_0x1a47ed=a16_0xc61194[_0x30c5ec(0x203)][_0x30c5ec(0x2bc)](_0x4ee147=>_0x4ee147['id']===_0x5628d7);return _0x1a47ed?_0x1a47ed[_0x30c5ec(0x3ed)]:'Unknown\x20(ID:\x20'+_0x5628d7+')';})['join'](',\x20'),_0x5148f3=_0x18ce2d[_0x45b7ce(0x343)][_0x45b7ce(0x307)](_0x4f61d0=>_0x4f61d0['productCode']+_0x45b7ce(0x23d)+_0x4f61d0['name'])['join'](';\x20'),_0x15f515=_0x18ce2d[_0x45b7ce(0x1a0)]?_0x18ce2d[_0x45b7ce(0x1a0)]['productName']+'\x20('+_0x18ce2d[_0x45b7ce(0x1a0)][_0x45b7ce(0x3a9)]+_0x45b7ce(0x37d)+_0x18ce2d[_0x45b7ce(0x1a0)][_0x45b7ce(0x3b3)]:_0x189d4b[_0x45b7ce(0x311)];_0x328175[_0x45b7ce(0x1cc)]({'Train':'T'+(_0x189d4b['qEmPU'](a16_0x92985a)['get'](_0x189d4b[_0x45b7ce(0x1e9)](String,_0x18ce2d['id']))?.['number']||_0x18ce2d['id']),'Total\x20Products':_0x18ce2d[_0x45b7ce(0x343)][_0x45b7ce(0x323)],'Total\x20Machines':_0x3f1dbb[_0x45b7ce(0x323)],'Total\x20Area\x20(ESSA)\x20cm²':_0x18ce2d[_0x45b7ce(0x21d)][_0x45b7ce(0x244)](),'Products':_0x5148f3,'Machines':_0x463d03,'Worst-Case\x20Dosage\x20Form':_0x2a989c,'Safety\x20Factor':_0x38eea7,'Lowest\x20LTD\x20(mg)':_0x18ce2d[_0x45b7ce(0x2e3)],'Min\x20Batch\x20Size\x20(kg)':_0x18ce2d[_0x45b7ce(0x2cb)],'Min\x20BS/MDD\x20Ratio':_0x18ce2d[_0x45b7ce(0x1ee)]['toFixed'](0x2),'Lowest\x20PDE\x20(mg)':_0x189d4b[_0x45b7ce(0x3a0)](null,_0x18ce2d[_0x45b7ce(0x3fc)])?_0x18ce2d['lowestPde']:_0x189d4b[_0x45b7ce(0x311)],'Worst-Case\x20Product\x20(by\x20RPN)':_0x15f515,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x224cb2[_0x45b7ce(0x1ff)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x4cdcd4[_0x45b7ce(0x1ff)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x189d4b[_0x45b7ce(0x266)](_0x189d4b[_0x45b7ce(0x1d3)],typeof _0x300428)?_0x300428['toFixed'](0x2):_0x189d4b['uENvZ'],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x48608b[_0x45b7ce(0x1ff)](0x2),'Selected\x20MACO\x20Method':_0x39761b[_0x45b7ce(0x3ed)],'Final\x20MACO\x20(mg)':_0x1e2f01['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x3ab58d[_0x45b7ce(0x3bd)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':i(_0x88d423)});});const _0x1d4b6e=XLSX[_0x264e56(0x193)][_0x264e56(0x368)](_0x328175),_0x3207de=XLSX[_0x264e56(0x193)]['book_new']();XLSX[_0x264e56(0x193)][_0x264e56(0x3b8)](_0x3207de,_0x1d4b6e,_0x189d4b['DkzEf']),_0x1d4b6e[_0x189d4b[_0x264e56(0x408)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0x12},{'wch':0xf},{'wch':0x12},{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0x12},{'wch':0x12}];const _0x41f2fb=new Date()['toISOString']()['split']('T')[0x0];let _0x2f33e0=_0x189d4b[_0x264e56(0x302)];if(_0x189d4b[_0x264e56(0x2c3)](_0x189d4b[_0x264e56(0x3b6)],_0x51d7e1)){if(Array[_0x264e56(0x276)](_0x51d7e1))_0x2f33e0+=_0x264e56(0x401)+_0x51d7e1[_0x264e56(0x3e6)]((_0x1c6b12,_0x1ec9d6)=>_0x1c6b12-_0x1ec9d6)[_0x264e56(0x1b5)]('_');else _0x2f33e0+=_0x264e56(0x3bc)+_0x51d7e1;}_0x2f33e0+='_'+_0x41f2fb+_0x264e56(0x3ae),XLSX[_0x264e56(0x1e5)](_0x3207de,_0x2f33e0),_0x189d4b[_0x264e56(0x3aa)](hideLoader),_0x189d4b[_0x264e56(0x2e9)](showCustomAlert,_0x189d4b[_0x264e56(0x2d2)],_0x189d4b[_0x264e56(0x37a)]);})['catch'](_0x184070=>{const _0x155fc5=_0x646c8d;console['error'](_0x189d4b[_0x155fc5(0x1fa)],_0x184070),hideLoader(),_0x189d4b['xYDOB'](showCustomAlert,_0x189d4b['xBcam'],_0x189d4b[_0x155fc5(0x1a2)]);});}export function exportDetergentMacoToExcel(_0x58dfa6=a16_0x500c1c(0x230)){const _0x3ff046=a16_0x500c1c,_0x5e2cd7={'ZBkug':function(_0x122394,_0x2d3f08){return _0x122394||_0x2d3f08;},'LKWDW':_0x3ff046(0x2ae),'wwOJV':function(_0x4b2bc8,_0x3e9f8f){return _0x4b2bc8(_0x3e9f8f);},'UkVWR':function(_0x3edac6,_0x3c09a7){return _0x3edac6(_0x3c09a7);},'zJNcK':function(_0x380855,_0x1ef4bc){return _0x380855/_0x1ef4bc;},'qmgPd':function(_0x6f6c07,_0x49ea07){return _0x6f6c07*_0x49ea07;},'VEUdz':function(_0x901ea7,_0x5d6f4b){return _0x901ea7*_0x5d6f4b;},'tBtFG':function(_0xe0c568,_0x320c88){return _0xe0c568>_0x320c88;},'qqKZO':function(_0x5be575){return _0x5be575();},'zybTS':function(_0x3c2ef0,_0x500bc1){return _0x3c2ef0!==_0x500bc1;},'AgfDY':function(_0x1acb29,_0x5caa4d){return _0x1acb29===_0x5caa4d;},'kwetC':'No\x20Data','XzakK':_0x3ff046(0x3a1),'EmYdm':function(_0x13fa9c,_0x2f60f5){return _0x13fa9c===_0x2f60f5;},'obSOi':function(_0x1067b6){return _0x1067b6();},'ImhfQ':function(_0x3cdeba,_0x580320,_0x606762){return _0x3cdeba(_0x580320,_0x606762);},'kSSWP':_0x3ff046(0x21e),'iiQuy':_0x3ff046(0x275),'ZthGZ':'Detergent\x20MACO\x20Report','qzKRY':function(_0xb8f742,_0x3907d1,_0x457c91){return _0xb8f742(_0x3907d1,_0x457c91);},'Lpnqu':_0x3ff046(0x23c),'JCLNd':_0x3ff046(0x3f7),'ggBIW':_0x3ff046(0x254),'MFVmx':'Error','qyQPl':_0x3ff046(0x2c2),'jifZM':_0x3ff046(0x2d5)};showLoader(),import(_0x5e2cd7['jifZM'])['then'](_0x4c1434=>{const _0xd980a7=_0x3ff046,{getTrainData:_0x171c8a,getWorstCaseProductType:_0x51603a}=_0x4c1434;let _0x277b93=_0x171c8a();if(_0x5e2cd7[_0xd980a7(0x30a)](_0xd980a7(0x230),_0x58dfa6)&&(_0x277b93=Array[_0xd980a7(0x276)](_0x58dfa6)?_0x277b93[_0xd980a7(0x341)](_0x5ab422=>_0x58dfa6[_0xd980a7(0x2e5)](String(_0x5ab422['id']))):_0x277b93['filter'](_0xa80555=>String(_0xa80555['id'])===String(_0x58dfa6))),_0x5e2cd7['AgfDY'](0x0,_0x277b93['length']))return hideLoader(),void showCustomAlert(_0x5e2cd7['kwetC'],_0x5e2cd7['XzakK']);if(_0x5e2cd7[_0xd980a7(0x1db)](0x0,a16_0xc61194['detergentIngredients'][_0xd980a7(0x323)]))return _0x5e2cd7['obSOi'](hideLoader),void _0x5e2cd7[_0xd980a7(0x1e7)](showCustomAlert,_0x5e2cd7[_0xd980a7(0x2f2)],_0x5e2cd7[_0xd980a7(0x31b)]);const _0x3178ec=[],_0x17767d=_0x5e2cd7['UkVWR'](parseFloat,document[_0xd980a7(0x3ca)](_0x5e2cd7[_0xd980a7(0x1d4)])?.['value'])||0x46,_0x25938e=a16_0xc61194['detergentIngredients'][_0xd980a7(0x307)](_0x2d87f5=>parseFloat(_0x2d87f5[_0xd980a7(0x268)]))[_0xd980a7(0x341)](_0x6f526c=>!isNaN(_0x6f526c)),_0x3dc21a=_0x25938e[_0xd980a7(0x323)]>0x0?Math[_0xd980a7(0x1c2)](..._0x25938e):0x0,_0x11d029=a16_0xc61194[_0xd980a7(0x279)][_0xd980a7(0x307)](_0x3002e6=>_0x3002e6[_0xd980a7(0x3ed)])[_0xd980a7(0x341)](_0x1a9f4b=>''!==_0x1a9f4b['trim']())[_0xd980a7(0x1b5)](',\x20');_0x277b93['forEach'](_0x3e236b=>{const _0x2b517b=_0xd980a7,_0xa19fb={'QSQoh':function(_0x2f7f07,_0x26393b){const _0x291b61=a16_0x4d99;return _0x5e2cd7[_0x291b61(0x2eb)](_0x2f7f07,_0x26393b);},'zxQdC':_0x5e2cd7['LKWDW']},_0x47dc85=_0x5e2cd7['wwOJV'](_0x51603a,_0x3e236b[_0x2b517b(0x343)][_0x2b517b(0x307)](_0x394e9d=>_0x394e9d[_0x2b517b(0x319)])),_0x42f77b=a16_0xc61194['safetyFactorConfig'][_0x47dc85]||a16_0xc61194[_0x2b517b(0x398)][_0x2b517b(0x379)],_0x492e98=document[_0x2b517b(0x3ca)](_0x2b517b(0x36f)+_0x3e236b['id']),_0x24377a=_0x492e98&&_0x5e2cd7[_0x2b517b(0x355)](parseFloat,_0x492e98['value'])||_0x42f77b[_0x2b517b(0x32e)],_0x4e5e4e=_0x5e2cd7['zJNcK'](_0x5e2cd7[_0x2b517b(0x283)](_0x5e2cd7[_0x2b517b(0x2af)](0.0005,_0x3dc21a),_0x17767d),_0x24377a),_0xaa72ee=_0x5e2cd7[_0x2b517b(0x2af)](_0x4e5e4e,_0x3e236b[_0x2b517b(0x1ee)]),_0x5f1d52=_0x4c1434['getLargestEssaForLineAndDosageForm'](_0x3e236b,_0x277b93),_0x2d8215=_0x5e2cd7[_0x2b517b(0x27f)](_0x5f1d52,0x0)?_0x5e2cd7[_0x2b517b(0x351)](_0xaa72ee,_0x5f1d52):0x0,_0x29b087=_0x2d8215*_0x3e236b['assumedSsa'],_0x5ed70b=_0x3e236b['machineIds'][_0x2b517b(0x307)](_0xa52bbf=>{const _0xd4e5ed=_0x2b517b,_0x265f45=a16_0xc61194[_0xd4e5ed(0x203)][_0xd4e5ed(0x2bc)](_0x164707=>_0x164707['id']===_0xa52bbf);return _0xa19fb[_0xd4e5ed(0x19d)](_0x265f45,{'name':'Unknown\x20(ID:\x20'+_0xa52bbf+')','machineNumber':_0xa19fb[_0xd4e5ed(0x352)]});}),_0x38ec9c=_0x3e236b['machineIds'][_0x2b517b(0x307)](_0x335243=>{const _0x452b72=_0x2b517b,_0x58828a=a16_0xc61194[_0x452b72(0x203)]['find'](_0x307295=>_0x307295['id']===_0x335243);return _0x58828a?_0x58828a['name']:_0x452b72(0x2a9)+_0x335243+')';})[_0x2b517b(0x1b5)](',\x20'),_0x5efb27=_0x3e236b[_0x2b517b(0x343)][_0x2b517b(0x307)](_0x221c49=>_0x221c49[_0x2b517b(0x326)]+'\x20-\x20'+_0x221c49['name'])[_0x2b517b(0x1b5)](';\x20'),_0x371f8c=_0x3e236b[_0x2b517b(0x1a0)]?_0x3e236b['worstProductRpn'][_0x2b517b(0x31d)]+'\x20('+_0x3e236b[_0x2b517b(0x1a0)][_0x2b517b(0x3a9)]+_0x2b517b(0x37d)+_0x3e236b[_0x2b517b(0x1a0)][_0x2b517b(0x3b3)]:_0x2b517b(0x2ae);_0x3178ec['push']({'Train':'T'+(_0x5e2cd7['qqKZO'](a16_0x92985a)['get'](_0x5e2cd7[_0x2b517b(0x195)](String,_0x3e236b['id']))?.[_0x2b517b(0x256)]||_0x3e236b['id']),'Total\x20Products':_0x3e236b[_0x2b517b(0x343)][_0x2b517b(0x323)],'Total\x20Machines':_0x5ed70b[_0x2b517b(0x323)],'Total\x20Area\x20(ESSA)\x20cm²':_0x3e236b['essa'][_0x2b517b(0x244)](),'Products':_0x5efb27,'Machines':_0x38ec9c,'Worst-Case\x20Dosage\x20Form':_0x47dc85,'Safety\x20Factor\x20Range':_0x42f77b['min']+'\x20-\x20'+_0x42f77b[_0x2b517b(0x32e)],'Applied\x20Safety\x20Factor':_0x24377a,'Detergent\x20Ingredients':_0x11d029,'Body\x20Weight\x20(kg)':_0x17767d,'Minimum\x20LD50\x20(mg/kg)':_0x3dc21a,'Min\x20Batch\x20Size\x20(kg)':_0x3e236b[_0x2b517b(0x2cb)],'Min\x20BS/MDD\x20Ratio':_0x3e236b['minBsMddRatio'][_0x2b517b(0x1ff)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x371f8c,'ADI\x20(mg)':_0x4e5e4e[_0x2b517b(0x1ff)](0x4),'MACO\x20(mg)':_0xaa72ee[_0x2b517b(0x1ff)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x2d8215[_0x2b517b(0x3bd)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x5e2cd7[_0x2b517b(0x195)](i,_0x29b087)});});const _0x6e6252=XLSX['utils'][_0xd980a7(0x368)](_0x3178ec),_0x82bd90=XLSX['utils'][_0xd980a7(0x206)]();XLSX[_0xd980a7(0x193)][_0xd980a7(0x3b8)](_0x82bd90,_0x6e6252,_0x5e2cd7[_0xd980a7(0x2c0)]),_0x6e6252[_0xd980a7(0x388)]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0x1e},{'wch':0xc},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0xc},{'wch':0xc},{'wch':0x12},{'wch':0x12}];const _0x5cdcec=new Date()['toISOString']()[_0xd980a7(0x23b)]('T')[0x0];XLSX[_0xd980a7(0x1e5)](_0x82bd90,_0xd980a7(0x28e)+_0x5cdcec+_0xd980a7(0x3ae)),hideLoader(),_0x5e2cd7[_0xd980a7(0x1f1)](showCustomAlert,_0x5e2cd7[_0xd980a7(0x3ea)],_0x5e2cd7[_0xd980a7(0x2e2)]);})['catch'](_0x10cff0=>{const _0x3dfe79=_0x3ff046;console[_0x3dfe79(0x3db)](_0x5e2cd7[_0x3dfe79(0x381)],_0x10cff0),hideLoader(),showCustomAlert(_0x5e2cd7[_0x3dfe79(0x3ba)],_0x5e2cd7[_0x3dfe79(0x1f8)]);});}export function exportTrainSummaryToExcel(_0x124aac='all'){const _0x4a1af8=a16_0x500c1c,_0x2c784d={'QnuTC':_0x4a1af8(0x2ae),'cRzYG':function(_0xcc591c){return _0xcc591c();},'JxoZo':function(_0x191180,_0x23c2e1){return _0x191180(_0x23c2e1);},'FaeNU':function(_0x35d4f4,_0x3eaf9b){return _0x35d4f4!==_0x3eaf9b;},'dxBch':function(_0xd5cd68){return _0xd5cd68();},'QZSJl':function(_0x2611ed,_0x18d05f){return _0x2611ed===_0x18d05f;},'xnYNp':function(_0x4f8ca2,_0xc0f52c,_0x45091b){return _0x4f8ca2(_0xc0f52c,_0x45091b);},'sCAqB':'There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','KVHig':function(_0x2a804f){return _0x2a804f();},'sdetV':function(_0x7ea6c2,_0x4614b5,_0x33d562){return _0x7ea6c2(_0x4614b5,_0x33d562);},'cECXz':_0x4a1af8(0x362),'eJEGg':_0x4a1af8(0x405),'OpDCa':_0x4a1af8(0x340),'KtFZu':_0x4a1af8(0x19c),'oKOwy':'all','oJGmA':function(_0x54e511){return _0x54e511();},'xiVdH':'Error\x20exporting\x20Train\x20Summary\x20to\x20Excel:','MtEoM':_0x4a1af8(0x1a7),'XugJM':_0x4a1af8(0x258)};_0x2c784d[_0x4a1af8(0x2d3)](showLoader),import('./utils.js')['then'](_0x57c1a0=>{const _0x382dbb=_0x4a1af8,{getTrainData:_0xb8bd7b}=_0x57c1a0,_0x2990f1=_0x2c784d[_0x382dbb(0x2f0)](_0xb8bd7b);if(_0x2c784d[_0x382dbb(0x264)](0x0,_0x2990f1[_0x382dbb(0x323)]))return _0x2c784d[_0x382dbb(0x2f0)](hideLoader),void _0x2c784d[_0x382dbb(0x213)](showCustomAlert,_0x382dbb(0x362),_0x2c784d['sCAqB']);let _0x2488b6=_0x2990f1;if(_0x2c784d[_0x382dbb(0x20b)]('all',_0x124aac)&&(_0x2488b6=Array[_0x382dbb(0x276)](_0x124aac)?_0x2990f1[_0x382dbb(0x341)](_0x1c11c3=>_0x124aac[_0x382dbb(0x2e5)](String(_0x1c11c3['id']))):_0x2990f1[_0x382dbb(0x341)](_0x17497d=>String(_0x17497d['id'])===String(_0x124aac))),0x0===_0x2488b6['length'])return _0x2c784d[_0x382dbb(0x2d3)](hideLoader),void _0x2c784d[_0x382dbb(0x2b3)](showCustomAlert,_0x2c784d[_0x382dbb(0x228)],_0x2c784d['eJEGg']);const _0x5f1118=[];_0x2488b6[_0x382dbb(0x205)](_0x55b897=>{const _0x7413de=_0x382dbb,_0x3acd7f={'vTWdp':_0x2c784d[_0x7413de(0x3d6)]},_0x4cf0a9=_0x55b897[_0x7413de(0x404)]['map'](_0x28f5b1=>{const _0x3404bc=_0x7413de,_0x4e7c12=a16_0xc61194[_0x3404bc(0x203)][_0x3404bc(0x2bc)](_0x4367df=>_0x4367df['id']===_0x28f5b1);return _0x4e7c12||{'id':_0x28f5b1,'name':_0x3404bc(0x2a9)+_0x28f5b1+')','machineNumber':_0x3acd7f['vTWdp']};}),_0x5442a2=_0x55b897[_0x7413de(0x404)]['map'](_0x33c27b=>{const _0x1a65cd=_0x7413de,_0x10c4ef=a16_0xc61194[_0x1a65cd(0x203)][_0x1a65cd(0x2bc)](_0x5640fa=>_0x5640fa['id']===_0x33c27b);return _0x10c4ef?_0x10c4ef['name']:_0x1a65cd(0x2a9)+_0x33c27b+')';})[_0x7413de(0x1b5)](',\x20'),_0x16b8a2=_0x55b897[_0x7413de(0x343)][_0x7413de(0x307)](_0x23b5e2=>_0x23b5e2[_0x7413de(0x326)]+_0x7413de(0x23d)+_0x23b5e2[_0x7413de(0x3ed)])[_0x7413de(0x1b5)](';\x20'),_0x23cc96=_0x55b897[_0x7413de(0x343)][_0x7413de(0x307)](_0x4e5e33=>_0x4e5e33[_0x7413de(0x326)]+':\x20'+_0x4e5e33['name'])[_0x7413de(0x1b5)]('\x0a'),_0x26c697=_0x4cf0a9[_0x7413de(0x307)](_0x4ac49a=>_0x4ac49a[_0x7413de(0x21a)]+':\x20'+_0x4ac49a['name'])[_0x7413de(0x1b5)]('\x0a');_0x5f1118[_0x7413de(0x1cc)]({'Train\x20ID':'T'+(_0x2c784d[_0x7413de(0x1d9)](a16_0x92985a)[_0x7413de(0x2f9)](_0x2c784d[_0x7413de(0x35d)](String,_0x55b897['id']))?.['number']||_0x55b897['id']),'Products\x20Count':_0x55b897['products'][_0x7413de(0x323)],'Machines\x20Count':_0x4cf0a9['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x55b897['essa'][_0x7413de(0x244)](),'Products\x20(Code\x20-\x20Name)':_0x16b8a2,'Machines\x20(Number\x20-\x20Name)':_0x5442a2,'Products\x20Detailed':_0x23cc96,'Machines\x20Detailed':_0x26c697,'Min\x20Batch\x20Size\x20(kg)':_0x55b897[_0x7413de(0x2cb)],'Min\x20BS/MDD\x20Ratio':_0x55b897['minBsMddRatio']['toFixed'](0x2),'Assumed\x20SSA\x20(cm²)':_0x55b897[_0x7413de(0x246)],'Lowest\x20LTD\x20(mg)':_0x55b897[_0x7413de(0x2e3)],'Lowest\x20PDE\x20(mg)':_0x2c784d[_0x7413de(0x20b)](null,_0x55b897['lowestPde'])?_0x55b897[_0x7413de(0x3fc)]:_0x7413de(0x2ae),'Worst\x20RPN\x20Product':_0x55b897[_0x7413de(0x1a0)]?_0x55b897[_0x7413de(0x1a0)][_0x7413de(0x31d)]+'\x20('+_0x55b897['worstProductRpn'][_0x7413de(0x3a9)]+')\x20-\x20RPN:\x20'+_0x55b897[_0x7413de(0x1a0)][_0x7413de(0x3b3)]:_0x2c784d['QnuTC']});});const _0x1d3cbc=XLSX[_0x382dbb(0x193)][_0x382dbb(0x368)](_0x5f1118),_0x2bd24a=XLSX['utils'][_0x382dbb(0x206)]();XLSX[_0x382dbb(0x193)][_0x382dbb(0x3b8)](_0x2bd24a,_0x1d3cbc,_0x2c784d[_0x382dbb(0x2e6)]),_0x1d3cbc['!cols']=[{'wch':0xa},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x3c},{'wch':0x3c},{'wch':0x28},{'wch':0x28},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32}];const _0x4b1832=new Date()[_0x382dbb(0x378)]()[_0x382dbb(0x23b)]('T')[0x0];let _0x19468c=_0x2c784d[_0x382dbb(0x2fa)];if(_0x2c784d[_0x382dbb(0x20b)](_0x2c784d['oKOwy'],_0x124aac)){if(Array[_0x382dbb(0x276)](_0x124aac))_0x19468c+=_0x382dbb(0x401)+_0x124aac['sort']((_0x347a61,_0x53b73c)=>_0x347a61-_0x53b73c)['join']('_');else _0x19468c+='_Train_'+_0x124aac;}_0x19468c+='_'+_0x4b1832+_0x382dbb(0x3ae),XLSX['writeFile'](_0x2bd24a,_0x19468c),_0x2c784d[_0x382dbb(0x380)](hideLoader),_0x2c784d[_0x382dbb(0x213)](showCustomAlert,'Success',_0x382dbb(0x3ef));})[_0x4a1af8(0x1d0)](_0x45c046=>{const _0x457a91=_0x4a1af8;console[_0x457a91(0x3db)](_0x2c784d[_0x457a91(0x3ab)],_0x45c046),_0x2c784d['oJGmA'](hideLoader),showCustomAlert(_0x2c784d[_0x457a91(0x225)],_0x2c784d['XugJM']);});}export function exportSummaryToExcel(){const _0x83c85=a16_0x500c1c,_0x5c52d7={'uOEHZ':function(_0x3a12fa,_0x385dc6){return _0x3a12fa(_0x385dc6);},'eEmlj':_0x83c85(0x2ae),'CtuZj':function(_0x1651d4,_0x558dd8){return _0x1651d4!==_0x558dd8;},'knCQW':_0x83c85(0x35a),'MBCcx':function(_0x1f3707,_0x430a09){return _0x1f3707===_0x430a09;},'CeeXC':function(_0x5dd731){return _0x5dd731();},'llarI':function(_0x383a65,_0x4b0b16,_0x4645c3){return _0x383a65(_0x4b0b16,_0x4645c3);},'yZWyb':'No\x20Data','EWWxo':_0x83c85(0x345),'iUeIt':'Top\x2010\x20RPN','FFhhr':_0x83c85(0x269),'clJiG':'!cols','rudob':_0x83c85(0x286),'zPwmv':_0x83c85(0x23c),'UwlCb':_0x83c85(0x363),'OPxTW':function(_0x54cb9d,_0x1f455e,_0x49507b){return _0x54cb9d(_0x1f455e,_0x49507b);},'IjMWH':'Failed\x20to\x20export\x20Summary\x20report\x20data\x20to\x20Excel.','rQtMh':_0x83c85(0x2d5)};showLoader(),import(_0x5c52d7[_0x83c85(0x367)])[_0x83c85(0x1ba)](_0x1dd924=>{const _0x1c75de=_0x83c85,{getProductTrainId:_0x4ab194,calculateScores:_0x466a6a}=_0x1dd924,_0x30f308=a16_0xc61194[_0x1c75de(0x343)][_0x1c75de(0x25a)](_0x1b953e=>{const _0x28e4f1=_0x1c75de,_0x1f54f7=_0x5c52d7[_0x28e4f1(0x3ac)](a16_0x8e9379,_0x1b953e);return _0x1b953e[_0x28e4f1(0x2f7)][_0x28e4f1(0x307)](_0x7f9605=>({'productName':_0x1b953e[_0x28e4f1(0x3ed)],'productCode':_0x1b953e[_0x28e4f1(0x326)],'ingredientName':_0x7f9605[_0x28e4f1(0x3ed)],'rpn':_0x466a6a(_0x7f9605)['rpn'],'trainId':_0x28e4f1(0x2ae)!==_0x1f54f7?'T'+_0x1f54f7:'N/A','scores':_0x466a6a(_0x7f9605)}));})[_0x1c75de(0x3e6)]((_0x49fed1,_0x29d643)=>_0x29d643[_0x1c75de(0x3b3)]-_0x49fed1[_0x1c75de(0x3b3)])[_0x1c75de(0x28c)](0x0,0xa),_0x2d6eeb=a16_0xc61194[_0x1c75de(0x343)]['filter'](_0x5210cd=>_0x5210cd[_0x1c75de(0x35f)]);if(0x0===_0x30f308[_0x1c75de(0x323)]&&_0x5c52d7[_0x1c75de(0x1dc)](0x0,_0x2d6eeb['length']))return _0x5c52d7[_0x1c75de(0x265)](hideLoader),void _0x5c52d7[_0x1c75de(0x29e)](showCustomAlert,_0x5c52d7[_0x1c75de(0x224)],_0x5c52d7['EWWxo']);const _0x239cb2=XLSX['utils']['book_new']();if(_0x30f308[_0x1c75de(0x323)]>0x0){const _0x308df0=_0x30f308['map']((_0x22954c,_0x2ff3af)=>({'Rank':_0x2ff3af+0x1,'Product\x20Code':_0x22954c[_0x1c75de(0x326)],'Product\x20Name':_0x22954c[_0x1c75de(0x31d)],'Train':_0x22954c[_0x1c75de(0x3bf)],'Ingredient':_0x22954c['ingredientName'],'RPN':_0x22954c['rpn']})),_0x23ac7a=XLSX[_0x1c75de(0x193)]['json_to_sheet'](_0x308df0),_0x20bcc6=[{'wch':0x8},{'wch':0xf},{'wch':0x1e},{'wch':0xa},{'wch':0x19},{'wch':0x8}];_0x23ac7a[_0x1c75de(0x388)]=_0x20bcc6,XLSX[_0x1c75de(0x193)][_0x1c75de(0x3b8)](_0x239cb2,_0x23ac7a,_0x5c52d7[_0x1c75de(0x3af)]);}if(_0x2d6eeb[_0x1c75de(0x323)]>0x0){const _0x594a34=_0x2d6eeb['map'](_0x1688d2=>({'Product\x20Code':_0x1688d2[_0x1c75de(0x326)],'Product\x20Name':_0x1688d2[_0x1c75de(0x3ed)],'Product\x20Type':_0x1688d2[_0x1c75de(0x319)],'Batch\x20Size\x20(kg)':_0x1688d2[_0x1c75de(0x386)],'MDD\x20(mg)':_0x1688d2[_0x1c75de(0x23f)],'Critical\x20Reason':_0x1688d2[_0x1c75de(0x284)]||_0x1c75de(0x33f),'Train':_0x1c75de(0x2ae)!==a16_0x8e9379(_0x1688d2)?'T'+a16_0x8e9379(_0x1688d2):_0x1c75de(0x2ae)})),_0xb68032=XLSX[_0x1c75de(0x193)]['json_to_sheet'](_0x594a34),_0x58458b=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32},{'wch':0xa}];_0xb68032['!cols']=_0x58458b,XLSX[_0x1c75de(0x193)][_0x1c75de(0x3b8)](_0x239cb2,_0xb68032,_0x5c52d7[_0x1c75de(0x25f)]);}const _0x474f62=a16_0xc61194[_0x1c75de(0x343)]['map'](_0x2e6316=>{const _0x3d1898=_0x1c75de,_0x1c1187={'glCla':function(_0x3df621,_0x178c59){const _0x4432b4=a16_0x4d99;return _0x5c52d7[_0x4432b4(0x3ac)](_0x3df621,_0x178c59);}},_0x1e248d=a16_0x8e9379(_0x2e6316),_0x9df741=_0x2e6316[_0x3d1898(0x2f7)]['reduce']((_0x51cfe5,_0x1bddc0)=>{const _0x23e38f=_0x3d1898,_0x31ecdf=_0x1c1187['glCla'](_0x466a6a,_0x1bddc0)[_0x23e38f(0x3b3)];return _0x31ecdf>_0x51cfe5['rpn']?{..._0x1bddc0,'rpn':_0x31ecdf}:_0x51cfe5;},{'rpn':0x0,'name':_0x5c52d7[_0x3d1898(0x1d1)]});return{'Product\x20Code':_0x2e6316[_0x3d1898(0x326)],'Product\x20Name':_0x2e6316[_0x3d1898(0x3ed)],'Product\x20Type':_0x2e6316[_0x3d1898(0x319)],'Batch\x20Size\x20(kg)':_0x2e6316[_0x3d1898(0x386)],'MDD\x20(mg)':_0x2e6316['mddMg'],'Train':_0x5c52d7['CtuZj'](_0x3d1898(0x2ae),_0x1e248d)?'T'+_0x1e248d:_0x5c52d7[_0x3d1898(0x1d1)],'Is\x20Critical':_0x2e6316[_0x3d1898(0x35f)]?_0x5c52d7[_0x3d1898(0x348)]:'No','Critical\x20Reason':_0x2e6316['criticalReason']||'N/A','Ingredients\x20Count':_0x2e6316[_0x3d1898(0x2f7)][_0x3d1898(0x323)],'Highest\x20RPN\x20Ingredient':_0x9df741[_0x3d1898(0x3ed)],'Highest\x20RPN\x20Value':_0x9df741[_0x3d1898(0x3b3)]||0x0};}),_0x564292=XLSX['utils'][_0x1c75de(0x368)](_0x474f62);_0x564292[_0x5c52d7[_0x1c75de(0x366)]]=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xa},{'wch':0xa},{'wch':0x28},{'wch':0xc},{'wch':0x19},{'wch':0xc}],XLSX[_0x1c75de(0x193)]['book_append_sheet'](_0x239cb2,_0x564292,_0x5c52d7[_0x1c75de(0x251)]);const _0x3cef78=new Date()[_0x1c75de(0x378)]()[_0x1c75de(0x23b)]('T')[0x0];XLSX[_0x1c75de(0x1e5)](_0x239cb2,_0x1c75de(0x1bf)+_0x3cef78+_0x1c75de(0x3ae)),_0x5c52d7[_0x1c75de(0x265)](hideLoader),_0x5c52d7['llarI'](showCustomAlert,_0x5c52d7['zPwmv'],_0x5c52d7['UwlCb']);})[_0x83c85(0x1d0)](_0x498855=>{const _0x2e8359=_0x83c85;console[_0x2e8359(0x3db)](_0x2e8359(0x300),_0x498855),hideLoader(),_0x5c52d7['OPxTW'](showCustomAlert,_0x2e8359(0x1a7),_0x5c52d7[_0x2e8359(0x2fb)]);});}export function exportAllTabsToExcel(){const _0x25134d=a16_0x500c1c,_0x415b90={'wnRRZ':function(_0x2d759b){return _0x2d759b();},'etqlI':function(_0x5b2a99,_0x28f656){return _0x5b2a99(_0x28f656);},'KpSZe':function(_0x461c71,_0x227f72){return _0x461c71!==_0x227f72;},'pjQfQ':_0x25134d(0x2ae),'SJckK':function(_0x396504,_0x434d3d){return _0x396504(_0x434d3d);},'xKMCX':function(_0x5a4d69,_0x51ec7f){return _0x5a4d69>_0x51ec7f;},'OjbZu':_0x25134d(0x35a),'slDYf':function(_0x514e52,_0x2066c9){return _0x514e52*_0x2066c9;},'oWHWp':function(_0x360265,_0x533d82){return _0x360265/_0x533d82;},'cwceJ':function(_0x28ba7e,_0x4ebb7c){return _0x28ba7e/_0x4ebb7c;},'ENuiC':function(_0x5381b4,_0x4d060e){return _0x5381b4===_0x4d060e;},'ETKzH':_0x25134d(0x296),'szive':_0x25134d(0x3b1),'RlSRw':function(_0x122cab,_0x3a158b){return _0x122cab/_0x3a158b;},'vJKcn':function(_0x2464b5,_0x27fa1a,_0x2a87c7){return _0x2464b5(_0x27fa1a,_0x2a87c7);},'zXeqq':'10\x20ppm\x20Criterion','rQLUM':function(_0x3cf660,_0x3a546a){return _0x3cf660*_0x3a546a;},'USqep':function(_0x3e8db5){return _0x3e8db5();},'gdIyZ':function(_0x417153,_0x47db8f){return _0x417153!==_0x47db8f;},'PZOQU':function(_0x512794,_0x5af2db){return _0x512794==_0x5af2db;},'aQtRg':function(_0x518fc0,_0x225a64){return _0x518fc0(_0x225a64);},'iiTxk':function(_0xc305a3,_0x4cbc49){return _0xc305a3*_0x4cbc49;},'ZvqET':function(_0x625da0,_0x4643b0){return _0x625da0(_0x4643b0);},'lQhuM':_0x25134d(0x322),'smpTb':function(_0x53a9ff,_0xc11270){return _0x53a9ff(_0xc11270);},'KuhOz':_0x25134d(0x3b4),'kKGQv':_0x25134d(0x3a1),'VTssa':_0x25134d(0x3f9),'udgkq':function(_0x504faa,_0x268c83){return _0x504faa>_0x268c83;},'bmBWU':_0x25134d(0x275),'gALIv':_0x25134d(0x33e),'VbgZM':_0x25134d(0x333),'yaPVV':_0x25134d(0x36a),'oBCFV':'Error\x20creating\x20Top\x2010\x20RPN\x20sheet:','zWBap':'Critical\x20Products','VfGbH':_0x25134d(0x220),'MkaYn':_0x25134d(0x240),'qwauE':function(_0x42a923,_0x809022,_0x21ffbb){return _0x42a923(_0x809022,_0x21ffbb);},'BjhfY':_0x25134d(0x23c),'QdfPc':_0x25134d(0x221),'KhWnK':_0x25134d(0x37e),'cBWuo':_0x25134d(0x1a7),'fhQip':_0x25134d(0x1b6),'KEbtO':_0x25134d(0x2d5)};_0x415b90[_0x25134d(0x2de)](showLoader),import(_0x415b90[_0x25134d(0x28d)])[_0x25134d(0x1ba)](_0x390be6=>{const _0x1e7faa=_0x25134d,_0x18c44d={'fYngq':function(_0x6838bc,_0xe29bb){return _0x6838bc||_0xe29bb;},'Yvedq':_0x415b90[_0x1e7faa(0x308)],'dFePM':function(_0x4310a4,_0x4a4620){return _0x4310a4/_0x4a4620;},'NXPkR':function(_0x5d5eda,_0x270f75){const _0xb487a=_0x1e7faa;return _0x415b90[_0xb487a(0x3f8)](_0x5d5eda,_0x270f75);},'YOnLB':function(_0x4e6fa,_0x3a5017){const _0x5d5085=_0x1e7faa;return _0x415b90[_0x5d5085(0x383)](_0x4e6fa,_0x3a5017);},'KfBAP':function(_0x48d160,_0xd1d9ca){const _0x3ac28d=_0x1e7faa;return _0x415b90[_0x3ac28d(0x267)](_0x48d160,_0xd1d9ca);},'jtVsF':function(_0x26abb0,_0x4e3216){return _0x415b90['ENuiC'](_0x26abb0,_0x4e3216);},'pHTsh':_0x1e7faa(0x3c8),'nnmSd':_0x415b90[_0x1e7faa(0x194)],'ETqFl':_0x415b90[_0x1e7faa(0x301)],'SaBum':function(_0x3ebff7,_0x2ab1ef){const _0x734c37=_0x1e7faa;return _0x415b90[_0x734c37(0x3c0)](_0x3ebff7,_0x2ab1ef);},'zawCc':function(_0x5933f4,_0x399c8){const _0x818136=_0x1e7faa;return _0x415b90[_0x818136(0x1d2)](_0x5933f4,_0x399c8);},'IaMXL':function(_0xfc8822,_0x139d41){return _0xfc8822*_0x139d41;},'HZPxh':function(_0x548856,_0x4cd737){const _0x55e78c=_0x1e7faa;return _0x415b90[_0x55e78c(0x3f8)](_0x548856,_0x4cd737);},'cgvZa':function(_0xbf7966,_0x32b57d,_0x29be65){const _0x28a620=_0x1e7faa;return _0x415b90[_0x28a620(0x3be)](_0xbf7966,_0x32b57d,_0x29be65);},'eslqj':_0x1e7faa(0x3b5),'mJeqr':_0x415b90[_0x1e7faa(0x285)],'mMYHb':function(_0x375ea9,_0x5da131){const _0x15bf3e=_0x1e7faa;return _0x415b90[_0x15bf3e(0x1aa)](_0x375ea9,_0x5da131);},'tTaPX':function(_0x54f5cc,_0xd085f3){return _0x54f5cc>_0xd085f3;},'kiphR':function(_0x4bdb4b,_0x34e5dc){const _0x3e041c=_0x1e7faa;return _0x415b90[_0x3e041c(0x383)](_0x4bdb4b,_0x34e5dc);},'gfwzg':function(_0x3b78ca,_0x1bcb2c){const _0x365887=_0x1e7faa;return _0x415b90[_0x365887(0x270)](_0x3b78ca,_0x1bcb2c);},'pcoYC':function(_0x38c981){const _0x312c0c=_0x1e7faa;return _0x415b90[_0x312c0c(0x2de)](_0x38c981);},'UGkEz':function(_0x3fc8b6,_0x2eac56){const _0x2bbe38=_0x1e7faa;return _0x415b90[_0x2bbe38(0x210)](_0x3fc8b6,_0x2eac56);},'hQsno':function(_0x81ee4c,_0x3660b4){const _0x38d450=_0x1e7faa;return _0x415b90[_0x38d450(0x1d6)](_0x81ee4c,_0x3660b4);},'bDXJP':function(_0x395546,_0x511644){const _0xabd3d2=_0x1e7faa;return _0x415b90[_0xabd3d2(0x3c5)](_0x395546,_0x511644);},'bKOts':function(_0x2afe38,_0x1da4cb){return _0x415b90['cwceJ'](_0x2afe38,_0x1da4cb);},'wjKrB':function(_0x46c38c,_0x3a6942){const _0x37a80b=_0x1e7faa;return _0x415b90[_0x37a80b(0x1a4)](_0x46c38c,_0x3a6942);},'UqEXZ':function(_0x2e1b31,_0x511932){return _0x415b90['iiTxk'](_0x2e1b31,_0x511932);},'nhJWp':function(_0xb12e7f,_0x10e654){const _0x16c309=_0x1e7faa;return _0x415b90[_0x16c309(0x3d1)](_0xb12e7f,_0x10e654);},'bwCXS':_0x415b90[_0x1e7faa(0x259)],'gXXDo':function(_0x16e8ba,_0x251de4){const _0xcc9f83=_0x1e7faa;return _0x415b90[_0xcc9f83(0x1c1)](_0x16e8ba,_0x251de4);},'poqUp':_0x415b90[_0x1e7faa(0x387)],'XPnfV':_0x415b90[_0x1e7faa(0x26f)]},{getTrainData:_0x4880c2,getWorstCaseProductType:_0x515b7f,getProductTrainId:_0x5962af,calculateScores:_0x534af5}=_0x390be6,_0x176725=_0x415b90[_0x1e7faa(0x2de)](_0x4880c2);if(0x0===_0x176725[_0x1e7faa(0x323)])return _0x415b90['USqep'](hideLoader),void _0x415b90['vJKcn'](showCustomAlert,'No\x20Data',_0x415b90[_0x1e7faa(0x2fc)]);const _0x41b30a=XLSX[_0x1e7faa(0x193)]['book_new']();try{const _0x14488a=[];_0x176725['forEach'](_0x212262=>{const _0x27437c=_0x1e7faa,_0x4131e4={'XuqeN':function(_0x3deb1c,_0x25e7d3){const _0xa50a71=a16_0x4d99;return _0x18c44d[_0xa50a71(0x306)](_0x3deb1c,_0x25e7d3);},'FRxCS':_0x18c44d[_0x27437c(0x3d7)]},_0x5324ff=_0x515b7f(_0x212262[_0x27437c(0x343)]['map'](_0x2fff32=>_0x2fff32[_0x27437c(0x319)])),_0x122e0b=(a16_0xc61194['safetyFactorConfig'][_0x5324ff]||a16_0xc61194['safetyFactorConfig'][_0x27437c(0x379)])[_0x27437c(0x32e)],_0xaa7a37=_0x18c44d[_0x27437c(0x3a5)](_0x18c44d[_0x27437c(0x1a8)](_0x212262[_0x27437c(0x2e3)],_0x212262[_0x27437c(0x1ee)]),_0x122e0b),_0x56af86=_0x18c44d['NXPkR'](0xa,_0x212262[_0x27437c(0x2cb)]);let _0x4f4b8a=_0x18c44d[_0x27437c(0x376)](0x1,0x0),_0x489e43=_0x18c44d['KfBAP'](0x1,0x0);const _0x108088=_0x18c44d['jtVsF'](_0x27437c(0x296),localStorage[_0x27437c(0x3bb)](_0x18c44d[_0x27437c(0x211)])),_0x190bfa=_0x18c44d['jtVsF'](_0x18c44d[_0x27437c(0x38f)],localStorage['getItem'](_0x18c44d[_0x27437c(0x299)]));if(_0x18c44d[_0x27437c(0x2ba)](null,_0x212262['lowestPde'])||_0x108088||(_0x4f4b8a=_0x212262[_0x27437c(0x3fc)]*_0x212262[_0x27437c(0x1ee)]),_0x18c44d['SaBum'](null,_0x212262[_0x27437c(0x3e5)])&&!_0x190bfa){const _0x78d46=_0x18c44d[_0x27437c(0x1a8)](0x46,_0x212262[_0x27437c(0x3e5)])/0x7d0,_0x3d45ea=_0x212262[_0x27437c(0x343)][_0x27437c(0x25a)](_0x514896=>_0x514896[_0x27437c(0x2f7)][_0x27437c(0x307)](_0x35c14f=>_0x35c14f[_0x27437c(0x314)]/0x3e8)),_0x24d981=Math['min'](..._0x3d45ea);_0x489e43=_0x18c44d[_0x27437c(0x3c4)](_0x18c44d[_0x27437c(0x2f8)](_0x78d46*_0x212262[_0x27437c(0x2cb)],0x3e8),_0x18c44d[_0x27437c(0x1ea)](_0x122e0b,_0x24d981));}const _0x391dad=_0x18c44d['cgvZa'](getLargestEssaForLineAndDosageForm,_0x212262,_0x176725),_0x528aac=0.004*_0x391dad,_0x26330a=[{'name':_0x18c44d[_0x27437c(0x393)],'value':_0xaa7a37},{'name':_0x18c44d[_0x27437c(0x38e)],'value':_0x56af86}];null===_0x212262[_0x27437c(0x3fc)]||_0x108088||_0x26330a[_0x27437c(0x1cc)]({'name':'Health-Based\x20Limit\x20(PDE)','value':_0x4f4b8a}),_0x18c44d[_0x27437c(0x3f3)](null,_0x212262['lowestLd50'])||_0x190bfa||_0x26330a[_0x27437c(0x1cc)]({'name':_0x27437c(0x2ef),'value':_0x489e43}),_0x26330a['push']({'name':_0x27437c(0x2d4),'value':_0x528aac});const _0x4a3410=_0x26330a['reduce']((_0x58050a,_0x4136b8)=>_0x4136b8[_0x27437c(0x22e)]<_0x58050a['value']?_0x4136b8:_0x58050a),_0x55feae=_0x4a3410[_0x27437c(0x22e)],_0x5025fa=_0x18c44d[_0x27437c(0x1b2)](_0x391dad,0x0)?_0x18c44d['kiphR'](_0x55feae,_0x391dad):0x0,_0x55dcdc=_0x18c44d[_0x27437c(0x26b)](_0x5025fa,_0x212262[_0x27437c(0x246)]),_0x2deb3b=_0x212262[_0x27437c(0x404)][_0x27437c(0x307)](_0x6d38a2=>{const _0x430f11=_0x27437c,_0x39e4ce=a16_0xc61194[_0x430f11(0x203)][_0x430f11(0x2bc)](_0x391712=>_0x391712['id']===_0x6d38a2);return _0x4131e4['XuqeN'](_0x39e4ce,{'name':_0x430f11(0x2a9)+_0x6d38a2+')','machineNumber':_0x4131e4['FRxCS']});}),_0x4d853a=_0x212262[_0x27437c(0x404)][_0x27437c(0x307)](_0x1d40c3=>{const _0x29083e=_0x27437c,_0x9a8c1b=a16_0xc61194[_0x29083e(0x203)][_0x29083e(0x2bc)](_0x534415=>_0x534415['id']===_0x1d40c3);return _0x9a8c1b?_0x9a8c1b[_0x29083e(0x3ed)]:'Unknown\x20(ID:\x20'+_0x1d40c3+')';})[_0x27437c(0x1b5)](',\x20'),_0x430485=_0x212262['products']['map'](_0x35aea4=>_0x35aea4[_0x27437c(0x326)]+_0x27437c(0x23d)+_0x35aea4[_0x27437c(0x3ed)])['join'](';\x20'),_0xf39567=_0x212262['worstProductRpn']?_0x212262[_0x27437c(0x1a0)]['productName']+'\x20('+_0x212262['worstProductRpn'][_0x27437c(0x3a9)]+_0x27437c(0x37d)+_0x212262['worstProductRpn']['rpn']:_0x18c44d[_0x27437c(0x3d7)];_0x14488a[_0x27437c(0x1cc)]({'Train':'T'+(_0x18c44d[_0x27437c(0x1b8)](a16_0x92985a)[_0x27437c(0x2f9)](String(_0x212262['id']))?.[_0x27437c(0x256)]||_0x212262['id']),'Total\x20Products':_0x212262[_0x27437c(0x343)][_0x27437c(0x323)],'Total\x20Machines':_0x2deb3b[_0x27437c(0x323)],'Total\x20Area\x20(ESSA)\x20cm²':_0x212262[_0x27437c(0x21d)][_0x27437c(0x244)](),'Products':_0x430485,'Machines':_0x4d853a,'Worst-Case\x20Dosage\x20Form':_0x5324ff,'Safety\x20Factor':_0x122e0b,'Lowest\x20LTD\x20(mg)':_0x212262[_0x27437c(0x2e3)],'Min\x20Batch\x20Size\x20(kg)':_0x212262['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x212262[_0x27437c(0x1ee)][_0x27437c(0x1ff)](0x2),'Lowest\x20PDE\x20(mg)':_0x18c44d[_0x27437c(0x342)](null,_0x212262[_0x27437c(0x3fc)])?_0x212262[_0x27437c(0x3fc)]:_0x18c44d['Yvedq'],'Worst-Case\x20Product\x20(by\x20RPN)':_0xf39567,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0xaa7a37['toFixed'](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x56af86[_0x27437c(0x1ff)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x18c44d['hQsno'](_0x27437c(0x256),typeof _0x4f4b8a)?_0x4f4b8a[_0x27437c(0x1ff)](0x2):_0x18c44d['Yvedq'],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x528aac['toFixed'](0x2),'Selected\x20MACO\x20Method':_0x4a3410[_0x27437c(0x3ed)],'Final\x20MACO\x20(mg)':_0x55feae[_0x27437c(0x1ff)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x5025fa['toExponential'](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':i(_0x55dcdc)});});const _0x8cfaec=XLSX['utils'][_0x1e7faa(0x368)](_0x14488a);XLSX[_0x1e7faa(0x193)][_0x1e7faa(0x3b8)](_0x41b30a,_0x8cfaec,_0x415b90['VTssa']);}catch(_0x440b01){console[_0x1e7faa(0x3db)](_0x1e7faa(0x315),_0x440b01);}try{if(_0x415b90[_0x1e7faa(0x2d6)](a16_0xc61194[_0x1e7faa(0x279)][_0x1e7faa(0x323)],0x0)){const _0x218bad=_0x415b90['etqlI'](parseFloat,document[_0x1e7faa(0x3ca)](_0x415b90[_0x1e7faa(0x364)])?.[_0x1e7faa(0x22e)])||0x46,_0x463ad6=a16_0xc61194[_0x1e7faa(0x279)][_0x1e7faa(0x307)](_0x4eda27=>parseFloat(_0x4eda27[_0x1e7faa(0x268)]))[_0x1e7faa(0x341)](_0x40ef96=>!isNaN(_0x40ef96)),_0x335a23=_0x415b90[_0x1e7faa(0x2d6)](_0x463ad6[_0x1e7faa(0x323)],0x0)?Math[_0x1e7faa(0x1c2)](..._0x463ad6):0x0,_0x918cde=a16_0xc61194[_0x1e7faa(0x279)][_0x1e7faa(0x307)](_0x28f6f6=>_0x28f6f6['name'])[_0x1e7faa(0x341)](_0x3e3043=>''!==_0x3e3043[_0x1e7faa(0x357)]())[_0x1e7faa(0x1b5)](',\x20'),_0x8af797=[];_0x176725['forEach'](_0xbeb61c=>{const _0x445911=_0x1e7faa,_0x1be066=_0x515b7f(_0xbeb61c[_0x445911(0x343)][_0x445911(0x307)](_0x79a6c6=>_0x79a6c6[_0x445911(0x319)])),_0x2cb18d=a16_0xc61194[_0x445911(0x398)][_0x1be066]||a16_0xc61194[_0x445911(0x398)][_0x445911(0x379)],_0x22fb80=document[_0x445911(0x3ca)](_0x445911(0x36f)+_0xbeb61c['id']),_0x34b3eb=_0x22fb80&&_0x18c44d[_0x445911(0x36d)](parseFloat,_0x22fb80[_0x445911(0x22e)])||_0x2cb18d['max'],_0x1c4fdc=_0x18c44d[_0x445911(0x29a)](0.0005*_0x335a23*_0x218bad,_0x34b3eb),_0x3e1d23=_0x1c4fdc*_0xbeb61c['minBsMddRatio'],_0x1faa67=getLargestEssaForLineAndDosageForm(_0xbeb61c,_0x176725),_0x162f0f=_0x18c44d[_0x445911(0x28f)](_0x1faa67,0x0)?_0x18c44d[_0x445911(0x3a5)](_0x3e1d23,_0x1faa67):0x0,_0x5cdfe5=_0x18c44d[_0x445911(0x34d)](_0x162f0f,_0xbeb61c[_0x445911(0x246)]),_0x2148b1=_0xbeb61c[_0x445911(0x404)][_0x445911(0x307)](_0x41f107=>{const _0x19e994=_0x445911,_0x31d837=a16_0xc61194[_0x19e994(0x203)][_0x19e994(0x2bc)](_0x48783f=>_0x48783f['id']===_0x41f107);return _0x31d837||{'name':'Unknown\x20(ID:\x20'+_0x41f107+')','machineNumber':_0x18c44d['Yvedq']};}),_0x2e0aec=_0xbeb61c['machineIds']['map'](_0x2bcc23=>{const _0xc73f1b=_0x445911,_0x5f1afe=a16_0xc61194['machines'][_0xc73f1b(0x2bc)](_0x588f2a=>_0x588f2a['id']===_0x2bcc23);return _0x5f1afe?_0x5f1afe['name']:_0xc73f1b(0x2a9)+_0x2bcc23+')';})[_0x445911(0x1b5)](',\x20'),_0x17e9f6=_0xbeb61c[_0x445911(0x343)]['map'](_0x469eba=>_0x469eba['productCode']+_0x445911(0x23d)+_0x469eba[_0x445911(0x3ed)])[_0x445911(0x1b5)](';\x20'),_0x142d9d=_0xbeb61c[_0x445911(0x1a0)]?_0xbeb61c['worstProductRpn'][_0x445911(0x31d)]+'\x20('+_0xbeb61c[_0x445911(0x1a0)][_0x445911(0x3a9)]+_0x445911(0x37d)+_0xbeb61c['worstProductRpn']['rpn']:_0x445911(0x2ae);_0x8af797[_0x445911(0x1cc)]({'Train':'T'+(a16_0x92985a()[_0x445911(0x2f9)](_0x18c44d[_0x445911(0x36d)](String,_0xbeb61c['id']))?.['number']||_0xbeb61c['id']),'Total\x20Products':_0xbeb61c[_0x445911(0x343)][_0x445911(0x323)],'Total\x20Machines':_0x2148b1['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0xbeb61c['essa'][_0x445911(0x244)](),'Products':_0x17e9f6,'Machines':_0x2e0aec,'Worst-Case\x20Dosage\x20Form':_0x1be066,'Safety\x20Factor\x20Range':_0x2cb18d[_0x445911(0x1c2)]+_0x445911(0x23d)+_0x2cb18d['max'],'Applied\x20Safety\x20Factor':_0x34b3eb,'Detergent\x20Ingredients':_0x918cde,'Body\x20Weight\x20(kg)':_0x218bad,'Minimum\x20LD50\x20(mg/kg)':_0x335a23,'Min\x20Batch\x20Size\x20(kg)':_0xbeb61c[_0x445911(0x2cb)],'Min\x20BS/MDD\x20Ratio':_0xbeb61c[_0x445911(0x1ee)][_0x445911(0x1ff)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x142d9d,'ADI\x20(mg)':_0x1c4fdc['toFixed'](0x4),'MACO\x20(mg)':_0x3e1d23[_0x445911(0x1ff)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x162f0f[_0x445911(0x3bd)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x18c44d['nhJWp'](i,_0x5cdfe5)});});const _0x4b3154=XLSX[_0x1e7faa(0x193)][_0x1e7faa(0x368)](_0x8af797);XLSX[_0x1e7faa(0x193)]['book_append_sheet'](_0x41b30a,_0x4b3154,_0x1e7faa(0x2a0));}}catch(_0x5c8fcf){console[_0x1e7faa(0x3db)](_0x415b90[_0x1e7faa(0x1d8)],_0x5c8fcf);}try{const _0x2d0e7e=[];_0x176725[_0x1e7faa(0x205)](_0x348aed=>{const _0x6c431c=_0x1e7faa,_0x2144b6=_0x348aed[_0x6c431c(0x404)]['map'](_0xfe9ddd=>{const _0x20815b=_0x6c431c,_0x544fe2=a16_0xc61194[_0x20815b(0x203)][_0x20815b(0x2bc)](_0x3b1f28=>_0x3b1f28['id']===_0xfe9ddd);return _0x18c44d['fYngq'](_0x544fe2,{'id':_0xfe9ddd,'name':'Unknown\x20(ID:\x20'+_0xfe9ddd+')','machineNumber':_0x20815b(0x2ae)});}),_0x437841=_0x348aed[_0x6c431c(0x404)][_0x6c431c(0x307)](_0x3715f4=>{const _0x10150c=_0x6c431c,_0x14b4f4=a16_0xc61194[_0x10150c(0x203)][_0x10150c(0x2bc)](_0x367513=>_0x367513['id']===_0x3715f4);return _0x14b4f4?_0x14b4f4['name']:'Unknown\x20(ID:\x20'+_0x3715f4+')';})[_0x6c431c(0x1b5)](',\x20'),_0x3698eb=_0x348aed[_0x6c431c(0x343)][_0x6c431c(0x307)](_0x4ddec2=>_0x4ddec2['productCode']+_0x6c431c(0x23d)+_0x4ddec2[_0x6c431c(0x3ed)])['join'](';\x20'),_0x417ea5=_0x348aed[_0x6c431c(0x343)][_0x6c431c(0x307)](_0x51f3ef=>_0x51f3ef['productCode']+':\x20'+_0x51f3ef[_0x6c431c(0x3ed)])[_0x6c431c(0x1b5)]('\x0a'),_0x33a0a2=_0x2144b6[_0x6c431c(0x307)](_0x487439=>_0x487439[_0x6c431c(0x21a)]+':\x20'+_0x487439[_0x6c431c(0x3ed)])['join']('\x0a');_0x2d0e7e[_0x6c431c(0x1cc)]({'Train\x20ID':'T'+(_0x415b90['wnRRZ'](a16_0x92985a)[_0x6c431c(0x2f9)](_0x415b90[_0x6c431c(0x29d)](String,_0x348aed['id']))?.[_0x6c431c(0x256)]||_0x348aed['id']),'Products\x20Count':_0x348aed[_0x6c431c(0x343)][_0x6c431c(0x323)],'Machines\x20Count':_0x2144b6[_0x6c431c(0x323)],'Total\x20Area\x20(ESSA)\x20cm²':_0x348aed[_0x6c431c(0x21d)][_0x6c431c(0x244)](),'Products\x20(Code\x20-\x20Name)':_0x3698eb,'Machines\x20(Number\x20-\x20Name)':_0x437841,'Products\x20Detailed':_0x417ea5,'Machines\x20Detailed':_0x33a0a2,'Min\x20Batch\x20Size\x20(kg)':_0x348aed['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x348aed[_0x6c431c(0x1ee)][_0x6c431c(0x1ff)](0x2),'Assumed\x20SSA\x20(cm²)':_0x348aed[_0x6c431c(0x246)],'Lowest\x20LTD\x20(mg)':_0x348aed[_0x6c431c(0x2e3)],'Lowest\x20PDE\x20(mg)':_0x415b90['KpSZe'](null,_0x348aed[_0x6c431c(0x3fc)])?_0x348aed[_0x6c431c(0x3fc)]:_0x415b90[_0x6c431c(0x308)],'Worst\x20RPN\x20Product':_0x348aed[_0x6c431c(0x1a0)]?_0x348aed[_0x6c431c(0x1a0)][_0x6c431c(0x31d)]+'\x20('+_0x348aed[_0x6c431c(0x1a0)][_0x6c431c(0x3a9)]+_0x6c431c(0x37d)+_0x348aed[_0x6c431c(0x1a0)][_0x6c431c(0x3b3)]:_0x6c431c(0x2ae)});});const _0x3a9197=XLSX['utils'][_0x1e7faa(0x368)](_0x2d0e7e);XLSX['utils'][_0x1e7faa(0x3b8)](_0x41b30a,_0x3a9197,_0x415b90[_0x1e7faa(0x242)]);}catch(_0x554b36){console[_0x1e7faa(0x3db)](_0x415b90[_0x1e7faa(0x3e2)],_0x554b36);}try{const _0xb5a3eb=a16_0xc61194[_0x1e7faa(0x343)][_0x1e7faa(0x25a)](_0xeecd77=>{const _0x5580c2=_0x1e7faa,_0x7d2950=_0x415b90[_0x5580c2(0x29d)](a16_0x8e9379,_0xeecd77);return _0xeecd77[_0x5580c2(0x2f7)]['map'](_0x325e52=>({'productName':_0xeecd77[_0x5580c2(0x3ed)],'productCode':_0xeecd77[_0x5580c2(0x326)],'ingredientName':_0x325e52[_0x5580c2(0x3ed)],'rpn':_0x534af5(_0x325e52)[_0x5580c2(0x3b3)],'trainId':_0x5580c2(0x2ae)!==_0x7d2950?'T'+_0x7d2950:_0x5580c2(0x2ae)}));})[_0x1e7faa(0x3e6)]((_0x17bed9,_0x1db5b6)=>_0x1db5b6[_0x1e7faa(0x3b3)]-_0x17bed9[_0x1e7faa(0x3b3)])['slice'](0x0,0xa);if(_0x415b90[_0x1e7faa(0x2d6)](_0xb5a3eb[_0x1e7faa(0x323)],0x0)){const _0x59aacf=_0xb5a3eb[_0x1e7faa(0x307)]((_0x1caaee,_0x793147)=>({'Rank':_0x793147+0x1,'Product\x20Code':_0x1caaee[_0x1e7faa(0x326)],'Product\x20Name':_0x1caaee[_0x1e7faa(0x31d)],'Train':_0x1caaee['trainId'],'Ingredient':_0x1caaee['ingredientName'],'RPN':_0x1caaee['rpn']})),_0x415f45=XLSX['utils']['json_to_sheet'](_0x59aacf);XLSX[_0x1e7faa(0x193)][_0x1e7faa(0x3b8)](_0x41b30a,_0x415f45,'Top\x2010\x20RPN');}}catch(_0x34a87b){console[_0x1e7faa(0x3db)](_0x415b90[_0x1e7faa(0x34a)],_0x34a87b);}try{const _0x478b35=a16_0xc61194[_0x1e7faa(0x343)][_0x1e7faa(0x341)](_0x1e2dd0=>_0x1e2dd0[_0x1e7faa(0x35f)]);if(_0x415b90[_0x1e7faa(0x1a4)](_0x478b35[_0x1e7faa(0x323)],0x0)){const _0x16c719=_0x478b35['map'](_0xadfdc=>({'Product\x20Code':_0xadfdc[_0x1e7faa(0x326)],'Product\x20Name':_0xadfdc[_0x1e7faa(0x3ed)],'Product\x20Type':_0xadfdc[_0x1e7faa(0x319)],'Batch\x20Size\x20(kg)':_0xadfdc[_0x1e7faa(0x386)],'MDD\x20(mg)':_0xadfdc[_0x1e7faa(0x23f)],'Critical\x20Reason':_0xadfdc['criticalReason']||_0x1e7faa(0x33f),'Train':_0x1e7faa(0x2ae)!==a16_0x8e9379(_0xadfdc)?'T'+a16_0x8e9379(_0xadfdc):'N/A'})),_0x451a74=XLSX['utils']['json_to_sheet'](_0x16c719);XLSX[_0x1e7faa(0x193)]['book_append_sheet'](_0x41b30a,_0x451a74,_0x415b90[_0x1e7faa(0x320)]);}}catch(_0x1b5851){console[_0x1e7faa(0x3db)](_0x1e7faa(0x318),_0x1b5851);}try{const _0x3edae4=a16_0xc61194['products'][_0x1e7faa(0x307)](_0x1d8685=>{const _0x25612b=_0x1e7faa,_0x54d04f={'WCqrl':function(_0x4093b4,_0x34ef90){const _0x3fddd6=a16_0x4d99;return _0x415b90[_0x3fddd6(0x361)](_0x4093b4,_0x34ef90);},'QyMPl':function(_0x552452,_0x29495c){const _0x208114=a16_0x4d99;return _0x415b90[_0x208114(0x1a4)](_0x552452,_0x29495c);}},_0x5b8aa4=_0x415b90[_0x25612b(0x29d)](a16_0x8e9379,_0x1d8685),_0x2e6c08=_0x1d8685[_0x25612b(0x2f7)][_0x25612b(0x3b2)]((_0x38dd4a,_0x37f8b4)=>{const _0x3f4d23=_0x25612b,_0x3c1c43=_0x54d04f[_0x3f4d23(0x3fd)](_0x534af5,_0x37f8b4)[_0x3f4d23(0x3b3)];return _0x54d04f[_0x3f4d23(0x1c3)](_0x3c1c43,_0x38dd4a[_0x3f4d23(0x3b3)])?{..._0x37f8b4,'rpn':_0x3c1c43}:_0x38dd4a;},{'rpn':0x0,'name':_0x415b90[_0x25612b(0x308)]});return{'Product\x20Code':_0x1d8685[_0x25612b(0x326)],'Product\x20Name':_0x1d8685[_0x25612b(0x3ed)],'Product\x20Type':_0x1d8685[_0x25612b(0x319)],'Batch\x20Size\x20(kg)':_0x1d8685[_0x25612b(0x386)],'MDD\x20(mg)':_0x1d8685['mddMg'],'Train':_0x415b90['KpSZe'](_0x415b90[_0x25612b(0x308)],_0x5b8aa4)?'T'+_0x5b8aa4:_0x25612b(0x2ae),'Is\x20Critical':_0x1d8685[_0x25612b(0x35f)]?_0x415b90[_0x25612b(0x387)]:'No','Critical\x20Reason':_0x1d8685[_0x25612b(0x284)]||_0x415b90[_0x25612b(0x308)],'Ingredients\x20Count':_0x1d8685[_0x25612b(0x2f7)]['length'],'Highest\x20RPN\x20Ingredient':_0x2e6c08['name'],'Highest\x20RPN\x20Value':_0x2e6c08['rpn']||0x0};}),_0x31c4e7=XLSX[_0x1e7faa(0x193)][_0x1e7faa(0x368)](_0x3edae4);XLSX[_0x1e7faa(0x193)][_0x1e7faa(0x3b8)](_0x41b30a,_0x31c4e7,'All\x20Products');}catch(_0x249b83){console[_0x1e7faa(0x3db)](_0x415b90['VfGbH'],_0x249b83);}try{const _0x5d9a69=[];a16_0xc61194[_0x1e7faa(0x343)][_0x1e7faa(0x205)](_0xd76b66=>{const _0x5b7d71=_0x1e7faa,_0x43b1aa=_0x18c44d[_0x5b7d71(0x2b8)](a16_0x8e9379,_0xd76b66),_0x49371f={'Product\x20Code':_0xd76b66['productCode'],'Product\x20Name':_0xd76b66[_0x5b7d71(0x3ed)],'Product\x20Type':_0xd76b66['productType'],'Batch\x20Size\x20(kg)':_0xd76b66['batchSizeKg'],'MDD\x20(mg)':_0xd76b66[_0x5b7d71(0x23f)],'Train':_0x18c44d[_0x5b7d71(0x342)](_0x18c44d[_0x5b7d71(0x3d7)],_0x43b1aa)?'T'+_0x43b1aa:_0x18c44d[_0x5b7d71(0x3d7)],'Is\x20Critical':_0xd76b66['isCritical']?_0x18c44d[_0x5b7d71(0x207)]:'No','Critical\x20Reason':_0xd76b66[_0x5b7d71(0x284)]||_0x5b7d71(0x2ae),'Ingredient\x20Type':_0x18c44d[_0x5b7d71(0x1b4)],'Ingredient\x20Name':'','LTD\x20(mg)':'','PDE\x20(mg)':'','LD50\x20(mg/kg)':'','Severity':'','Occurrence':'','Detection':'','RPN':''};_0x5d9a69[_0x5b7d71(0x1cc)](_0x49371f),_0xd76b66[_0x5b7d71(0x2f7)][_0x5b7d71(0x205)](_0x517781=>{const _0x26d756=_0x5b7d71,_0xc7cd77=_0x18c44d[_0x26d756(0x247)](_0x534af5,_0x517781);_0x5d9a69[_0x26d756(0x1cc)]({'Product\x20Code':'','Product\x20Name':'','Product\x20Type':'','Batch\x20Size\x20(kg)':'','MDD\x20(mg)':'','Train':'','Is\x20Critical':'','Critical\x20Reason':'','Ingredient\x20Type':_0x18c44d[_0x26d756(0x2d0)],'Ingredient\x20Name':_0x517781[_0x26d756(0x3ed)],'LTD\x20(mg)':_0x517781[_0x26d756(0x1cb)]||_0x18c44d[_0x26d756(0x3d7)],'PDE\x20(mg)':_0x517781[_0x26d756(0x19b)]||_0x18c44d[_0x26d756(0x3d7)],'LD50\x20(mg/kg)':_0x517781[_0x26d756(0x268)]||_0x26d756(0x2ae),'Severity':_0xc7cd77[_0x26d756(0x37f)],'Occurrence':_0xc7cd77[_0x26d756(0x1df)],'Detection':_0xc7cd77[_0x26d756(0x1de)],'RPN':_0xc7cd77[_0x26d756(0x3b3)]});});});const _0x308cff=XLSX[_0x1e7faa(0x193)][_0x1e7faa(0x368)](_0x5d9a69);XLSX[_0x1e7faa(0x193)][_0x1e7faa(0x3b8)](_0x41b30a,_0x308cff,_0x415b90[_0x1e7faa(0x396)]);}catch(_0x41f432){console[_0x1e7faa(0x3db)](_0x1e7faa(0x1b1),_0x41f432);}const _0x49d1a2=new Date()[_0x1e7faa(0x378)]()['split']('T')[0x0];XLSX[_0x1e7faa(0x1e5)](_0x41b30a,_0x1e7faa(0x2cc)+_0x49d1a2+_0x1e7faa(0x3ae)),hideLoader(),_0x415b90[_0x1e7faa(0x334)](showCustomAlert,_0x415b90[_0x1e7faa(0x281)],_0x415b90[_0x1e7faa(0x30c)]);})[_0x25134d(0x1d0)](_0x8ba37f=>{const _0x266c3c=_0x25134d;console['error'](_0x415b90[_0x266c3c(0x3e8)],_0x8ba37f),_0x415b90[_0x266c3c(0x2db)](hideLoader),showCustomAlert(_0x415b90[_0x266c3c(0x260)],_0x415b90[_0x266c3c(0x2f3)]);});}export function toggleStageSection(_0x4dd2e5){const _0xdddeca=a16_0x500c1c,_0x4d5ae4={'iSTVi':_0xdddeca(0x219),'FdhED':_0xdddeca(0x24f),'rExIM':_0xdddeca(0x2e1),'dZJnt':_0xdddeca(0x26e)},_0x415ec2=document[_0xdddeca(0x3ca)](_0xdddeca(0x1f7)+_0x4dd2e5),_0x50641e=_0x4d5ae4[_0xdddeca(0x3fe)]===_0x415ec2['style'][_0xdddeca(0x312)];_0x415ec2['style'][_0xdddeca(0x312)]=_0x50641e?'':_0x4d5ae4[_0xdddeca(0x3fe)],localStorage['setItem']('machineStage-'+_0x4dd2e5+_0xdddeca(0x344),!_0x50641e);const _0x5f3e12=_0x415ec2[_0xdddeca(0x31a)][_0xdddeca(0x30e)](_0x4d5ae4[_0xdddeca(0x27a)]);_0x5f3e12&&(_0x5f3e12[_0xdddeca(0x39f)]=_0x50641e?_0x4d5ae4['rExIM']:_0x4d5ae4['dZJnt']);}