const a13_0x128c95=a13_0x4551;(function(_0x1d8222,_0x854c00){const _0x5f6c6f=a13_0x4551,_0xe9b375=_0x1d8222();while(!![]){try{const _0x8a9eb=-parseInt(_0x5f6c6f(0x2ce))/0x1*(-parseInt(_0x5f6c6f(0xc9))/0x2)+parseInt(_0x5f6c6f(0x17c))/0x3*(parseInt(_0x5f6c6f(0x2a7))/0x4)+parseInt(_0x5f6c6f(0x1aa))/0x5*(-parseInt(_0x5f6c6f(0x2d4))/0x6)+parseInt(_0x5f6c6f(0x1ac))/0x7*(-parseInt(_0x5f6c6f(0x29d))/0x8)+-parseInt(_0x5f6c6f(0x20d))/0x9*(-parseInt(_0x5f6c6f(0x219))/0xa)+parseInt(_0x5f6c6f(0x27d))/0xb*(parseInt(_0x5f6c6f(0x103))/0xc)+parseInt(_0x5f6c6f(0x132))/0xd*(-parseInt(_0x5f6c6f(0x144))/0xe);if(_0x8a9eb===_0x854c00)break;else _0xe9b375['push'](_0xe9b375['shift']());}catch(_0x3f7bd7){_0xe9b375['push'](_0xe9b375['shift']());}}}(a13_0x3495,0x72d02));function a13_0x4551(_0x123637,_0x2bca37){const _0x349575=a13_0x3495();return a13_0x4551=function(_0x45513e,_0x1186b7){_0x45513e=_0x45513e-0x90;let _0x24667a=_0x349575[_0x45513e];return _0x24667a;},a13_0x4551(_0x123637,_0x2bca37);}import*as a13_0x53aebc from'./state.js';import{fullAppRender as a13_0x291cf1}from'./app.js';import{generateTrainMap as a13_0x379cfa}from'./utils.js';import{toggleScoringEditMode as a13_0x26a811}from'./scoringView.js';import{renderRpnChart as a13_0x5bdb49}from'./worstCaseView.js';import{renderMacoChart as a13_0x1cca07}from'./dashboardView.js';const s=document[a13_0x128c95(0xe9)](a13_0x128c95(0x1d9));export const showLoader=()=>s['style']['display']=a13_0x128c95(0x2c9);export const hideLoader=()=>s[a13_0x128c95(0x292)]['display']=a13_0x128c95(0x269);export function showCustomAlert(_0x3081b3,_0x3ef4a1){const _0x2e944e=a13_0x128c95,_0x32e36d={'hyyrL':_0x2e944e(0x260),'XyJVr':_0x2e944e(0x2bb),'pOSAF':'customAlertModal'};document[_0x2e944e(0xe9)](_0x32e36d[_0x2e944e(0x1fb)])[_0x2e944e(0x19a)]=_0x3081b3,document[_0x2e944e(0xe9)](_0x32e36d['XyJVr'])[_0x2e944e(0x19a)]=_0x3ef4a1,document[_0x2e944e(0xe9)](_0x32e36d['pOSAF'])[_0x2e944e(0x292)][_0x2e944e(0x270)]=_0x2e944e(0x2c9);}export const hideModal=_0x4421f6=>document[a13_0x128c95(0xe9)](_0x4421f6)['style'][a13_0x128c95(0x270)]=a13_0x128c95(0x269);export function saveAllDataToLocalStorage(){const _0x12c835=a13_0x128c95,_0x506e65={'lDDfX':_0x12c835(0x25d),'tnpWU':_0x12c835(0x253),'pNYyl':_0x12c835(0x1f1),'OhvhL':_0x12c835(0xb2),'yLBIz':_0x12c835(0x22e),'DxzQA':function(_0x3150ed,_0x344b29,_0x4289f9){return _0x3150ed(_0x344b29,_0x4289f9);},'pazfC':_0x12c835(0x228),'iCHSw':_0x12c835(0x136)};try{localStorage['setItem'](_0x506e65['lDDfX'],JSON[_0x12c835(0x127)](a13_0x53aebc[_0x12c835(0x28d)])),localStorage[_0x12c835(0xec)](_0x506e65[_0x12c835(0x10d)],JSON[_0x12c835(0x127)](a13_0x53aebc[_0x12c835(0x2d5)])),localStorage['setItem'](_0x506e65[_0x12c835(0xd6)],JSON[_0x12c835(0x127)](a13_0x53aebc['scoringCriteria'])),localStorage['setItem'](_0x506e65[_0x12c835(0xae)],JSON['stringify'](a13_0x53aebc[_0x12c835(0x2b0)])),localStorage['setItem'](_0x506e65[_0x12c835(0xf3)],JSON['stringify'](a13_0x53aebc['machineStageDisplayOrder']));}catch(_0x341978){console['error'](_0x12c835(0x195),_0x341978),_0x506e65[_0x12c835(0x128)](showCustomAlert,_0x506e65[_0x12c835(0xfc)],_0x506e65['iCHSw']);}}export function loadAllDataFromLocalStorage(){const _0x22d7a6=a13_0x128c95,_0x1de1e2={'oVpQw':_0x22d7a6(0x253),'WXGOu':_0x22d7a6(0xb2),'xHptA':_0x22d7a6(0x2d6),'WLuQx':_0x22d7a6(0x2d7),'PLTPV':_0x22d7a6(0x283),'SrUkJ':'Error\x20loading\x20detergent\x20ingredients','qtRnx':'Error\x20loading\x20machine\x20stage\x20order'},_0x57c272=localStorage['getItem'](_0x22d7a6(0x25d)),_0x2a3d18=localStorage[_0x22d7a6(0x22f)](_0x1de1e2[_0x22d7a6(0xa6)]),_0x26daf6=localStorage[_0x22d7a6(0x22f)]('macoScoringCriteria'),_0x464cdf=localStorage[_0x22d7a6(0x22f)](_0x1de1e2[_0x22d7a6(0x235)]),_0x3e41b7=localStorage[_0x22d7a6(0x22f)](_0x22d7a6(0x22e));if(_0x57c272)try{a13_0x53aebc[_0x22d7a6(0x1c7)](JSON[_0x22d7a6(0xfb)](_0x57c272));}catch(_0x9baee9){console['error'](_0x1de1e2['xHptA'],_0x9baee9);}if(_0x2a3d18)try{a13_0x53aebc[_0x22d7a6(0x148)](JSON['parse'](_0x2a3d18));}catch(_0xd87b2e){console[_0x22d7a6(0x93)](_0x1de1e2[_0x22d7a6(0x119)],_0xd87b2e);}if(_0x26daf6)try{a13_0x53aebc[_0x22d7a6(0x297)](JSON[_0x22d7a6(0xfb)](_0x26daf6));}catch(_0x4a6aff){console[_0x22d7a6(0x93)](_0x1de1e2['PLTPV'],_0x4a6aff);}if(_0x464cdf)try{a13_0x53aebc[_0x22d7a6(0x250)](JSON[_0x22d7a6(0xfb)](_0x464cdf));}catch(_0x4bdee2){console[_0x22d7a6(0x93)](_0x1de1e2[_0x22d7a6(0x282)],_0x4bdee2);}if(_0x3e41b7)try{a13_0x53aebc['setMachineStageDisplayOrder'](JSON[_0x22d7a6(0xfb)](_0x3e41b7));}catch(_0x36332f){console[_0x22d7a6(0x93)](_0x1de1e2['qtRnx'],_0x36332f);}}export function saveStateForUndo(){const _0x59fcee=a13_0x128c95,_0x55e803={'SDDkl':function(_0x460055){return _0x460055();},'WoKAF':function(_0x540686,_0x478cec){return _0x540686+_0x478cec;},'HcXub':function(_0xc2cabc,_0x81c9f9){return _0xc2cabc-_0x81c9f9;}};_0x55e803[_0x59fcee(0x296)](a13_0x379cfa);const _0x1c4b02=a13_0x53aebc['history'][_0x59fcee(0x12a)](0x0,_0x55e803[_0x59fcee(0x1b5)](a13_0x53aebc['historyIndex'],0x1)),_0x3cf768={'products':JSON['parse'](JSON['stringify'](a13_0x53aebc[_0x59fcee(0x28d)])),'machines':JSON[_0x59fcee(0xfb)](JSON[_0x59fcee(0x127)](a13_0x53aebc[_0x59fcee(0x2d5)])),'scoringCriteria':JSON['parse'](JSON[_0x59fcee(0x127)](a13_0x53aebc[_0x59fcee(0xad)])),'detergentIngredients':JSON[_0x59fcee(0xfb)](JSON[_0x59fcee(0x127)](a13_0x53aebc['detergentIngredients']))};_0x1c4b02[_0x59fcee(0x180)](_0x3cf768),a13_0x53aebc[_0x59fcee(0xf1)](_0x1c4b02,_0x55e803[_0x59fcee(0x172)](_0x1c4b02[_0x59fcee(0x2c3)],0x1)),updateUndoRedoButtons(),_0x55e803[_0x59fcee(0x296)](saveAllDataToLocalStorage);}export function updateUndoRedoButtons(){const _0x1a33fd=a13_0x128c95,_0xa0f823={'mvnmW':_0x1a33fd(0x10c),'HXNxn':_0x1a33fd(0x25a),'QrQPx':function(_0x9befeb,_0x3f10d6){return _0x9befeb<=_0x3f10d6;},'oZBPn':function(_0x24c140,_0x5ce54b){return _0x24c140-_0x5ce54b;}},_0xed3db1=document['getElementById'](_0xa0f823['mvnmW']),_0xc3afd7=document[_0x1a33fd(0xe9)](_0xa0f823[_0x1a33fd(0x1ea)]);_0xed3db1&&(_0xed3db1[_0x1a33fd(0x25c)]=_0xa0f823[_0x1a33fd(0x21b)](a13_0x53aebc[_0x1a33fd(0x22d)],0x0)),_0xc3afd7&&(_0xc3afd7[_0x1a33fd(0x25c)]=a13_0x53aebc[_0x1a33fd(0x22d)]>=_0xa0f823[_0x1a33fd(0x130)](a13_0x53aebc['history'][_0x1a33fd(0x2c3)],0x1));}export function undoChange(){const _0x5a85ce=a13_0x128c95,_0x1a8743={'nvRzF':function(_0xa51ee6,_0x3e17e1){return _0xa51ee6>_0x3e17e1;},'BNEbe':function(_0x34f697,_0x4b3484){return _0x34f697-_0x4b3484;},'NvYBK':function(_0x3dff2b,_0x4f1e41){return _0x3dff2b(_0x4f1e41);},'BINzi':function(_0x422012){return _0x422012();}};if(_0x1a8743['nvRzF'](a13_0x53aebc[_0x5a85ce(0x22d)],0x0)){const _0x147d62=_0x1a8743[_0x5a85ce(0x92)](a13_0x53aebc[_0x5a85ce(0x22d)],0x1),_0x5cd0c9=a13_0x53aebc[_0x5a85ce(0xed)][_0x147d62];a13_0x53aebc[_0x5a85ce(0x1c7)](JSON[_0x5a85ce(0xfb)](JSON[_0x5a85ce(0x127)](_0x5cd0c9[_0x5a85ce(0x28d)]))),a13_0x53aebc[_0x5a85ce(0x148)](JSON[_0x5a85ce(0xfb)](JSON[_0x5a85ce(0x127)](_0x5cd0c9['machines']))),a13_0x53aebc[_0x5a85ce(0x297)](JSON[_0x5a85ce(0xfb)](JSON['stringify'](_0x5cd0c9['scoringCriteria']))),a13_0x53aebc[_0x5a85ce(0x250)](JSON[_0x5a85ce(0xfb)](JSON[_0x5a85ce(0x127)](_0x5cd0c9[_0x5a85ce(0x2b0)]))),a13_0x53aebc['setHistory'](a13_0x53aebc[_0x5a85ce(0xed)],_0x147d62),a13_0x53aebc[_0x5a85ce(0x26e)]&&_0x1a8743[_0x5a85ce(0x1c4)](a13_0x26a811,!0x1),a13_0x291cf1(),_0x1a8743['BINzi'](updateUndoRedoButtons),saveAllDataToLocalStorage();}}export function redoChange(){const _0x16840d=a13_0x128c95,_0x350093={'BylgZ':function(_0x504126,_0x2d4842){return _0x504126-_0x2d4842;},'cNCcY':function(_0x8b02cb,_0x1bf71e){return _0x8b02cb+_0x1bf71e;},'KiDLW':function(_0x51efa2,_0x216c18){return _0x51efa2(_0x216c18);},'VXiAY':function(_0xee87){return _0xee87();}};if(a13_0x53aebc[_0x16840d(0x22d)]<_0x350093[_0x16840d(0x186)](a13_0x53aebc[_0x16840d(0xed)][_0x16840d(0x2c3)],0x1)){const _0x5c6079=_0x350093[_0x16840d(0x120)](a13_0x53aebc['historyIndex'],0x1),_0x533269=a13_0x53aebc[_0x16840d(0xed)][_0x5c6079];a13_0x53aebc[_0x16840d(0x1c7)](JSON[_0x16840d(0xfb)](JSON[_0x16840d(0x127)](_0x533269['products']))),a13_0x53aebc[_0x16840d(0x148)](JSON[_0x16840d(0xfb)](JSON[_0x16840d(0x127)](_0x533269[_0x16840d(0x2d5)]))),a13_0x53aebc['setScoringCriteria'](JSON['parse'](JSON[_0x16840d(0x127)](_0x533269[_0x16840d(0xad)]))),a13_0x53aebc['setDetergentIngredients'](JSON['parse'](JSON['stringify'](_0x533269[_0x16840d(0x2b0)]))),a13_0x53aebc['setHistory'](a13_0x53aebc[_0x16840d(0xed)],_0x5c6079),a13_0x53aebc[_0x16840d(0x26e)]&&_0x350093[_0x16840d(0x1cb)](a13_0x26a811,!0x1),_0x350093['VXiAY'](a13_0x291cf1),updateUndoRedoButtons(),_0x350093[_0x16840d(0x267)](saveAllDataToLocalStorage);}}export function toggleDarkMode(_0x45583f){const _0x5c28da=a13_0x128c95,_0x455d5c={'KTSAO':_0x5c28da(0x29c),'LwRyx':'theme-toggle-dark-icon','ILLaP':_0x5c28da(0x17d),'jArIF':_0x5c28da(0x1e6),'lQcdH':function(_0x19cb34){return _0x19cb34();}},_0x2bbeae=document[_0x5c28da(0xe9)](_0x455d5c[_0x5c28da(0xbc)]),_0x41253f=document[_0x5c28da(0xe9)](_0x455d5c[_0x5c28da(0xa8)]);_0x45583f?(document[_0x5c28da(0x279)][_0x5c28da(0x231)]['add'](_0x455d5c['ILLaP']),_0x2bbeae&&_0x2bbeae[_0x5c28da(0x231)]['add'](_0x455d5c['jArIF']),_0x41253f&&_0x41253f[_0x5c28da(0x231)]['remove'](_0x455d5c['jArIF'])):(document[_0x5c28da(0x279)][_0x5c28da(0x231)]['remove']('dark'),_0x2bbeae&&_0x2bbeae[_0x5c28da(0x231)][_0x5c28da(0x2a4)](_0x455d5c[_0x5c28da(0xe5)]),_0x41253f&&_0x41253f['classList'][_0x5c28da(0xf8)](_0x455d5c[_0x5c28da(0xe5)])),a13_0x53aebc[_0x5c28da(0x217)]&&_0x455d5c[_0x5c28da(0x10f)](a13_0x5bdb49),a13_0x53aebc['macoChartInstance']&&_0x455d5c['lQcdH'](a13_0x1cca07);}export function printCurrentView(_0xc6f1b8,_0x540569=a13_0x128c95(0x143)){const _0x189287=a13_0x128c95,_0x4112f9={'DFAYs':function(_0x4e80ec,_0x285ff5,_0xccb5dd){return _0x4e80ec(_0x285ff5,_0xccb5dd);},'MGqMY':function(_0x11dc91,_0x28dad3,_0x129cbc){return _0x11dc91(_0x28dad3,_0x129cbc);},'crnis':_0x189287(0x16a),'tueFK':_0x189287(0x237),'fpJGc':'#detergentMaco\x20.train-content.collapsed','HHOxk':function(_0x150348,_0x7c6d24,_0x438ff3){return _0x150348(_0x7c6d24,_0x438ff3);},'QaGiy':_0x189287(0x196),'HnWlH':_0x189287(0x13a),'aWSxf':function(_0x5950e0,_0xc8d98,_0x9516f6){return _0x5950e0(_0xc8d98,_0x9516f6);},'UrhHQ':'noTrainSummaryMessage','ncSuI':_0x189287(0xa7),'cvxMU':_0x189287(0x1df),'yOATd':'Container\x20has\x20content:','PBvvg':function(_0x2641bb,_0x5c6d18){return _0x2641bb>_0x5c6d18;},'ObjST':function(_0x1cd150,_0x5d1df9){return _0x1cd150===_0x5d1df9;},'wnCyo':'Train\x20summary\x20container\x20is\x20hidden\x20or\x20missing','MRDBV':function(_0x527263,_0xcb655a){return _0x527263(_0xcb655a);},'jaehv':_0x189287(0x1a3),'QmUFf':function(_0x42150f,_0x5f5384){return _0x42150f(_0x5f5384);},'UrcEt':function(_0x53781b,_0x35d6e1){return _0x53781b+_0x35d6e1;},'sBcvN':_0x189287(0x200),'dDzdS':function(_0x4cbb35,_0x14a816){return _0x4cbb35===_0x14a816;},'RpHMw':_0x189287(0x27f),'vvtkE':function(_0x17ab60,_0x22af78){return _0x17ab60(_0x22af78);},'HUqQR':_0x189287(0xf9),'XPMUo':_0x189287(0x137),'PHRty':function(_0x4cae04,_0x300a8c){return _0x4cae04===_0x300a8c;},'PXHNz':_0x189287(0x264),'BTElq':function(_0x163209,_0x4adce0){return _0x163209===_0x4adce0;},'PbWRk':_0x189287(0x28b),'LnHSS':_0x189287(0x213),'sdORi':_0x189287(0x173),'srohO':function(_0x519421,_0x9d5e90,_0x4d5560){return _0x519421(_0x9d5e90,_0x4d5560);}};_0x4112f9[_0x189287(0x115)](_0x4112f9[_0x189287(0x288)],_0xc6f1b8)&&a13_0x53aebc['scoringInEditMode']&&(a13_0x53aebc[_0x189287(0x248)](!0x0),_0x4112f9[_0x189287(0x2d9)](a13_0x26a811,!0x1)),console['log'](_0x189287(0x1c1),_0xc6f1b8,_0x189287(0xc4),_0x540569),document[_0x189287(0x232)][_0x189287(0x231)]['add'](_0x189287(0x9a)+_0xc6f1b8),_0x4112f9[_0x189287(0x115)](_0x4112f9[_0x189287(0x207)],_0xc6f1b8)?import(_0x4112f9[_0x189287(0x191)])[_0x189287(0x19f)](_0x202997=>{const _0x741d15=_0x189287;window[_0x741d15(0x15c)]=_0x540569,_0x202997['renderWorstCaseByTrain'](),_0x4112f9[_0x741d15(0x18e)](setTimeout,()=>{const _0x120bf3=_0x741d15;window[_0x120bf3(0x290)]();},0xc8);}):_0x4112f9['PHRty'](_0x4112f9[_0x189287(0xab)],_0xc6f1b8)?(window[_0x189287(0x15c)]=_0x540569,import(_0x189287(0x110))[_0x189287(0x19f)](_0x2d8af8=>{const _0x26ad34=_0x189287,_0x2677aa={'AALJV':_0x26ad34(0x1e6),'lTjGg':_0x26ad34(0x91),'dBRFV':function(_0x3205f5,_0x4ed857,_0x9f30f5){const _0x3fe5d5=_0x26ad34;return _0x4112f9[_0x3fe5d5(0xf4)](_0x3205f5,_0x4ed857,_0x9f30f5);}};_0x2d8af8['renderMacoForTrains']();const _0x56f5a7=document[_0x26ad34(0x16f)](_0x26ad34(0x22c)),_0x13393d=[];_0x56f5a7[_0x26ad34(0x185)](_0x30e74e=>{const _0x4a197d=_0x26ad34,_0x52b260=_0x30e74e['id'][_0x4a197d(0x1e8)](/content-pm-(\d+)/);if(_0x52b260){_0x13393d['push'](_0x52b260[0x1]),_0x30e74e[_0x4a197d(0x231)][_0x4a197d(0x2a4)](_0x4a197d(0x237));const _0xd9af51=document[_0x4a197d(0xe9)]('toggle-pm-'+_0x52b260[0x1]);_0xd9af51&&(_0xd9af51[_0x4a197d(0x19a)]='▼');}});const _0x473293=document[_0x26ad34(0x16f)](_0x4112f9['crnis']),_0x1f2e41=[];_0x473293[_0x26ad34(0x185)](_0x19dff9=>{const _0x5d94ea=_0x26ad34,_0x361202=_0x19dff9['id']['match'](/maco-breakdown-details-(\d+)/);if(_0x361202){_0x1f2e41[_0x5d94ea(0x180)](_0x361202[0x1]),_0x19dff9[_0x5d94ea(0x231)][_0x5d94ea(0x2a4)](_0x2677aa['AALJV']);const _0x3fd2ee=document[_0x5d94ea(0xe9)](_0x5d94ea(0x98)+_0x361202[0x1]);_0x3fd2ee&&(_0x3fd2ee[_0x5d94ea(0x19a)]=_0x2677aa['lTjGg']);}}),_0x4112f9[_0x26ad34(0xf4)](setTimeout,()=>{const _0x5e11ab=_0x26ad34,_0x22c01e={'ytNzb':_0x2677aa[_0x5e11ab(0x24c)]};window[_0x5e11ab(0x290)](),_0x2677aa[_0x5e11ab(0x291)](setTimeout,()=>{const _0x64d335=_0x5e11ab;_0x13393d[_0x64d335(0x185)](_0x33567e=>{const _0x31d200=_0x64d335,_0x1b530f=document[_0x31d200(0xe9)](_0x31d200(0x1b0)+_0x33567e),_0x41dab0=document[_0x31d200(0xe9)](_0x31d200(0x1b2)+_0x33567e);_0x1b530f&&_0x1b530f[_0x31d200(0x231)]['add'](_0x31d200(0x237)),_0x41dab0&&(_0x41dab0['textContent']='▶');}),_0x1f2e41['forEach'](_0x5e3116=>{const _0x8e1b15=_0x64d335,_0x51f70e=document[_0x8e1b15(0xe9)](_0x8e1b15(0x2cf)+_0x5e3116),_0x53012d=document[_0x8e1b15(0xe9)]('breakdown-toggle-btn-'+_0x5e3116);_0x51f70e&&_0x51f70e[_0x8e1b15(0x231)][_0x8e1b15(0xf8)](_0x22c01e[_0x8e1b15(0x1b4)]),_0x53012d&&(_0x53012d[_0x8e1b15(0x19a)]='Show\x20MACO\x20Calculation\x20Breakdown');});},0x3e8);},0xc8);})):_0x4112f9[_0x189287(0x2af)](_0x4112f9[_0x189287(0xe4)],_0xc6f1b8)?(window[_0x189287(0x15c)]=_0x540569,import('./macoDetergentView.js')[_0x189287(0x19f)](_0x30271d=>{const _0x1de256=_0x189287,_0x2cb0f2={'xjEwu':_0x4112f9['tueFK'],'WpMIM':function(_0x263e8b,_0x17cdc2,_0x84f31a){const _0x504320=a13_0x4551;return _0x4112f9[_0x504320(0x18e)](_0x263e8b,_0x17cdc2,_0x84f31a);}};_0x30271d[_0x1de256(0x2b4)]();const _0x10093b=document[_0x1de256(0x16f)](_0x4112f9['fpJGc']),_0x1be237=[];_0x10093b['forEach'](_0x333625=>{const _0x8b238e=_0x1de256,_0x31e163=_0x333625['id']['match'](/content-dm-(\d+)/);if(_0x31e163){_0x1be237[_0x8b238e(0x180)](_0x31e163[0x1]),_0x333625[_0x8b238e(0x231)][_0x8b238e(0x2a4)](_0x2cb0f2[_0x8b238e(0x256)]);const _0x51212b=document[_0x8b238e(0xe9)](_0x8b238e(0x1f0)+_0x31e163[0x1]);_0x51212b&&(_0x51212b[_0x8b238e(0x19a)]='▼');}}),_0x4112f9[_0x1de256(0x2a6)](setTimeout,()=>{const _0x18d608=_0x1de256;window[_0x18d608(0x290)](),_0x2cb0f2[_0x18d608(0x181)](setTimeout,()=>{const _0x5f2b99=_0x18d608,_0x289fa3={'KJGKT':_0x2cb0f2[_0x5f2b99(0x256)]};_0x1be237[_0x5f2b99(0x185)](_0x5bd681=>{const _0x3b001e=_0x5f2b99,_0x12a0bb=document[_0x3b001e(0xe9)](_0x3b001e(0x23e)+_0x5bd681),_0x1f5edd=document[_0x3b001e(0xe9)](_0x3b001e(0x1f0)+_0x5bd681);_0x12a0bb&&_0x12a0bb[_0x3b001e(0x231)][_0x3b001e(0xf8)](_0x289fa3[_0x3b001e(0xaa)]),_0x1f5edd&&(_0x1f5edd['textContent']='▶');});},0x3e8);},0xc8);})[_0x189287(0x134)](_0x579da6=>{const _0x472716=_0x189287;console[_0x472716(0x93)](_0x4112f9[_0x472716(0x140)],_0x579da6),window[_0x472716(0x290)]();})[_0x189287(0xc8)](()=>{const _0x4ac710=_0x189287;_0x4112f9[_0x4ac710(0x1b1)](setTimeout,()=>{const _0x4ded90=_0x4ac710;window[_0x4ded90(0x15c)]=null,import(_0x4112f9[_0x4ded90(0xd0)])[_0x4ded90(0x19f)](_0x45ca48=>_0x45ca48[_0x4ded90(0x2b4)]())[_0x4ded90(0x134)](()=>{});},0x4b0);})):_0x4112f9[_0x189287(0x2af)]('trainSummary',_0xc6f1b8)?(window[_0x189287(0x15c)]=_0x540569,console['log'](_0x4112f9[_0x189287(0xb7)],_0x540569),import(_0x4112f9[_0x189287(0x26c)])[_0x189287(0x19f)](_0x4c13e6=>{const _0x1b39e2=_0x189287;_0x4c13e6[_0x1b39e2(0xc5)](),_0x4112f9[_0x1b39e2(0x2a6)](setTimeout,()=>{const _0x1531ca=_0x1b39e2,_0x3de26e=document[_0x1531ca(0xe9)](_0x1531ca(0x28a)),_0x5ca39a=document['getElementById'](_0x4112f9[_0x1531ca(0xd1)]);if(console['log'](_0x1531ca(0x17b),_0x3de26e?_0x3de26e[_0x1531ca(0x292)][_0x1531ca(0x270)]:_0x4112f9[_0x1531ca(0x95)]),console[_0x1531ca(0xff)](_0x4112f9[_0x1531ca(0x278)],_0x5ca39a?_0x5ca39a[_0x1531ca(0x292)][_0x1531ca(0x270)]:_0x1531ca(0xa7)),console[_0x1531ca(0xff)](_0x4112f9['yOATd'],!!_0x3de26e&&_0x4112f9[_0x1531ca(0x1db)](_0x3de26e[_0x1531ca(0x2a3)][_0x1531ca(0x2c3)],0x0)),!_0x3de26e||_0x4112f9[_0x1531ca(0x239)](_0x1531ca(0x269),_0x3de26e[_0x1531ca(0x292)][_0x1531ca(0x270)]))return console['warn'](_0x4112f9['wnCyo']),void _0x4112f9['MRDBV'](alert,_0x4112f9['jaehv']);window[_0x1531ca(0x290)](),setTimeout(()=>{const _0x1743f2=_0x1531ca;window[_0x1743f2(0x15c)]=null,_0x4c13e6['renderTrainSummary']();},0x3e8);},0x1f4);})[_0x189287(0x134)](_0x597967=>{const _0x5247ee=_0x189287;console[_0x5247ee(0x93)]('Error\x20loading\x20train\x20summary\x20view:',_0x597967),_0x4112f9[_0x5247ee(0x11b)](alert,_0x4112f9[_0x5247ee(0xca)](_0x4112f9[_0x5247ee(0x28f)],_0x597967['message']));})):_0x4112f9[_0x189287(0xf7)](setTimeout,()=>{window['print']();},0x64);}export function toggleColumn(_0xf130c,_0x47a1c8){const _0x591d17=a13_0x128c95,_0x4b16e4={'zTZlB':function(_0x29be11,_0x337076){return _0x29be11===_0x337076;},'xeUJU':_0x591d17(0xa4),'TdVUO':_0x591d17(0xe2),'tsHlO':'productRegister','MivGi':'worstCaseProducts','fjDIj':function(_0x3f8d83,_0x41693e){return _0x3f8d83!==_0x41693e;},'YwtPJ':function(_0x43c2a9,_0x12e8c7){return _0x43c2a9(_0x12e8c7);},'wQAEK':_0x591d17(0x137),'NkTyE':function(_0x110d8b,_0x56fb65){return _0x110d8b(_0x56fb65);}};if(_0x4b16e4['zTZlB'](_0x4b16e4[_0x591d17(0x109)],_0xf130c)||_0x4b16e4[_0x591d17(0x276)]===_0xf130c){[_0x4b16e4[_0x591d17(0x23a)],_0x4b16e4[_0x591d17(0x1bf)]][_0x591d17(0x185)](_0x791aac=>{const _0x291871=_0x591d17;document[_0x291871(0x16f)]('#'+_0x791aac+_0x291871(0x102)+_0x791aac+_0x291871(0x160))[_0x291871(0x185)](_0x447e7c=>{const _0x7bde49=_0x291871;_0x447e7c[_0x7bde49(0x231)][_0x7bde49(0x14d)](_0x7bde49(0x21c)+_0xf130c);}),document[_0x291871(0x16f)]('#'+_0x791aac+_0x291871(0x17e)+_0x791aac+_0x291871(0x201))[_0x291871(0x185)](_0x2b7068=>{const _0xea82eb=_0x291871;_0x2b7068&&_0x2b7068['classList'][_0xea82eb(0x14d)](_0xea82eb(0x21c)+_0xf130c);});});const _0x2fe65d=_0x4b16e4[_0x591d17(0x113)](null,document[_0x591d17(0x187)](_0x591d17(0x19e)+_0xf130c));localStorage[_0x591d17(0xec)](_0x591d17(0x230)+_0xf130c+_0x591d17(0x1cd),_0x2fe65d),_0x4b16e4[_0x591d17(0x14f)](updateToggleIcons,_0x4b16e4[_0x591d17(0x23a)]),_0x4b16e4[_0x591d17(0x14f)](updateToggleIcons,_0x591d17(0xf9)),import(_0x4b16e4[_0x591d17(0x24b)])[_0x591d17(0x19f)](_0x2e0b7b=>{const _0x264cc4=_0x591d17;_0x2e0b7b[_0x264cc4(0x1d4)]();}),import(_0x4b16e4[_0x591d17(0x24b)])[_0x591d17(0x19f)](_0x21d57c=>{const _0x3a265e=_0x591d17;_0x21d57c[_0x3a265e(0x131)]&&_0x21d57c[_0x3a265e(0x131)]();});}else{document[_0x591d17(0x16f)]('#'+_0x47a1c8+'\x20.mainTable,\x20#'+_0x47a1c8+_0x591d17(0x160))[_0x591d17(0x185)](_0x12b5b0=>{const _0x4a95ae=_0x591d17;_0x12b5b0[_0x4a95ae(0x231)][_0x4a95ae(0x14d)](_0x4a95ae(0x21c)+_0xf130c);});const _0x1b8e68=_0x4b16e4['fjDIj'](null,document['querySelector']('#'+_0x47a1c8+_0x591d17(0x19c)+_0xf130c));localStorage[_0x591d17(0xec)](_0x47a1c8+'-'+_0xf130c+'Hidden',_0x1b8e68),_0x4b16e4[_0x591d17(0xaf)](updateToggleIcons,_0x47a1c8);}}export function toggleColumnVisibilityDropdown(){const _0x2bff04=a13_0x128c95,_0x339567={'RQrwQ':'#columnVisibilityDropdown','fTeFC':'button[onclick=\x22toggleColumnVisibilityDropdown()\x22]','lsBUC':_0x2bff04(0x1e6),'WFQZc':_0x2bff04(0x11d),'gjmmd':_0x2bff04(0x1fc)},_0x233917=document[_0x2bff04(0xe9)](_0x339567['WFQZc']);_0x233917[_0x2bff04(0x231)][_0x2bff04(0x14d)](_0x339567[_0x2bff04(0x11f)]),_0x233917['classList'][_0x2bff04(0x2bd)](_0x2bff04(0x1e6))||document[_0x2bff04(0x210)](_0x339567[_0x2bff04(0x1bd)],function _0x456f78(_0x57cff7){const _0x133e6b=_0x2bff04;_0x57cff7[_0x133e6b(0x11a)][_0x133e6b(0x1c5)](_0x339567['RQrwQ'])||_0x57cff7[_0x133e6b(0x11a)][_0x133e6b(0x1c5)](_0x339567[_0x133e6b(0x20b)])||(_0x233917['classList'][_0x133e6b(0xf8)](_0x339567[_0x133e6b(0x11f)]),document['removeEventListener'](_0x133e6b(0x1fc),_0x456f78));});}export function updateToggleIcons(_0x371914){const _0x15d314=a13_0x128c95,_0x277e08={'vmHMx':_0x15d314(0xf2),'wsOIN':_0x15d314(0x1e1),'jYvAE':function(_0x2d9d65,_0x391f51){return _0x2d9d65===_0x391f51;},'SVzWG':_0x15d314(0xf9),'aBXSE':_0x15d314(0x28c),'pAdXb':'productRegister-ld50Hidden','SwsSL':_0x15d314(0x226),'VFFEG':function(_0x723e55,_0x3b1807){return _0x723e55===_0x3b1807;},'IstYE':function(_0x1ac41e,_0x40eb8b){return _0x1ac41e&&_0x40eb8b;},'RXtRh':_0x15d314(0xa5),'hNHYW':'.toggle-ld50','Qmxzu':'Hide\x20LD50'},_0x69f77d=document[_0x15d314(0xe9)](_0x371914);if(!_0x69f77d)return;let _0x5dbb8e,_0xb6c807;if(_0x277e08[_0x15d314(0xa1)](_0x277e08[_0x15d314(0x146)],_0x371914)){const _0x4b4ff7=localStorage['getItem'](_0x277e08[_0x15d314(0x1ec)]),_0x4a2d59=localStorage[_0x15d314(0x22f)](_0x277e08[_0x15d314(0xa9)]);if(_0x277e08[_0x15d314(0xa1)](null,_0x4b4ff7)&&_0x277e08['jYvAE'](null,_0x4a2d59))_0x5dbb8e=!0x1,_0xb6c807=!0x1;else{const _0x4d6e7d=_0x277e08['jYvAE'](_0x277e08[_0x15d314(0x20e)],_0x4b4ff7),_0xd18d97=_0x277e08[_0x15d314(0x27b)]('true',_0x4a2d59);_0x277e08[_0x15d314(0x153)](_0x4d6e7d,_0xd18d97)?(_0x5dbb8e=!0x1,_0xb6c807=!0x0):(_0x5dbb8e=_0x4d6e7d,_0xb6c807=_0xd18d97);}}else{const _0x3e0785=localStorage[_0x15d314(0x22f)](_0x371914+'-pdeHidden'),_0x318628=localStorage['getItem'](_0x371914+_0x15d314(0x184));_0x5dbb8e=_0x277e08[_0x15d314(0xa1)](_0x277e08[_0x15d314(0x20e)],_0x3e0785),_0xb6c807=_0x277e08['jYvAE'](_0x277e08[_0x15d314(0x20e)],_0x318628);}const _0x33f07a=_0x69f77d['querySelector'](_0x277e08[_0x15d314(0x9e)]),_0x378e3a=_0x69f77d['querySelector'](_0x277e08[_0x15d314(0xe7)]);_0x33f07a&&(_0x33f07a['innerHTML']=_0x5dbb8e?_0x15d314(0xf5):_0x15d314(0x96)),_0x378e3a&&(_0x378e3a[_0x15d314(0x2a3)]=_0xb6c807?'Show\x20LD50':_0x277e08[_0x15d314(0x197)]),document['querySelectorAll']('#'+_0x371914+_0x15d314(0x102)+_0x371914+_0x15d314(0x160))[_0x15d314(0x185)](_0x49817a=>{const _0x1264b7=_0x15d314;_0x49817a&&(_0x49817a[_0x1264b7(0x231)][_0x1264b7(0x14d)](_0x1264b7(0x1e1),_0x5dbb8e),_0x49817a[_0x1264b7(0x231)][_0x1264b7(0x14d)](_0x277e08['vmHMx'],_0xb6c807));}),document[_0x15d314(0x16f)]('#'+_0x371914+',\x20#'+_0x371914+_0x15d314(0x201))['forEach'](_0x31bded=>{const _0x5f0524=_0x15d314;_0x31bded&&(_0x31bded[_0x5f0524(0x231)]['toggle'](_0x277e08[_0x5f0524(0xb6)],_0x5dbb8e),_0x31bded[_0x5f0524(0x231)]['toggle'](_0x277e08['vmHMx'],_0xb6c807));});}export function exportToExcel(){const _0x213f42=a13_0x128c95,_0x4c8dad={'FfJjW':_0x213f42(0x1b7),'tFOcb':function(_0x2b98a4,_0x3d1ce1){return _0x2b98a4===_0x3d1ce1;},'RUgKX':function(_0x4134b5){return _0x4134b5();},'uNNme':function(_0x111c3f,_0x8e6baf,_0x41d19a){return _0x111c3f(_0x8e6baf,_0x41d19a);},'FTPRC':_0x213f42(0x162),'bkwoW':function(_0x5baf3f){return _0x5baf3f();},'zbnqQ':_0x213f42(0x258),'QvgCL':'Failed\x20to\x20export\x20data\x20to\x20Excel.','XAcbF':function(_0x3db832){return _0x3db832();}};_0x4c8dad['XAcbF'](showLoader),import(_0x213f42(0x293))['then'](_0x317dd5=>{const _0x1fc524=_0x213f42,_0x32de77={'HSPvC':_0x4c8dad[_0x1fc524(0x27a)]},{getProductTrainId:_0x51d493,calculateScores:_0x45aa68}=_0x317dd5,_0x2d5f59=[];if(a13_0x53aebc[_0x1fc524(0x28d)][_0x1fc524(0x185)](_0x48d4e4=>{const _0x5afa22=_0x1fc524,_0x3883f7={'MSJuB':function(_0x1516f2,_0x2e32f1){return _0x1516f2(_0x2e32f1);}};let _0x55cb37='No';_0x48d4e4[_0x5afa22(0x147)]&&(_0x55cb37=_0x32de77[_0x5afa22(0x295)]+(_0x48d4e4[_0x5afa22(0x12f)]?':\x20'+_0x48d4e4[_0x5afa22(0x12f)]:''));const _0x194281=_0x51d493(_0x48d4e4),_0x41d4ab=_0x48d4e4[_0x5afa22(0xb5)]?new Date(_0x48d4e4[_0x5afa22(0xb5)])[_0x5afa22(0xbf)]():'';_0x2d5f59[_0x5afa22(0x180)]({'Date':_0x41d4ab,'Product\x20Code':_0x48d4e4['productCode'],'Product\x20Name':_0x48d4e4['name'],'Train\x20No.':_0x194281,'Dosage\x20Form':_0x48d4e4[_0x5afa22(0x10e)]||'','Batch\x20Size\x20(Kg)':_0x48d4e4[_0x5afa22(0x2c4)],'Special\x20Case\x20Product':_0x55cb37,'Active\x20Ingredient':'','Solubility':'','Therapeutic\x20Dose\x20(mg/day)':'','Cleanability':'','PDE\x20(µg/day)':'','LD50\x20(mg/kg)':'','Solubility\x20Score':'','Therapeutic\x20Dose\x20Score':'','Cleanability\x20Score':'','Toxicity\x20Score':'','RPN':'','RPN\x20Rating':''}),_0x48d4e4['activeIngredients'][_0x5afa22(0x185)](_0x3eb900=>{const _0x333283=_0x5afa22,_0x49054a=_0x3883f7[_0x333283(0xc1)](_0x45aa68,_0x3eb900);_0x2d5f59['push']({'Date':'','Product\x20Code':'','Product\x20Name':_0x333283(0x211)+_0x3eb900[_0x333283(0x13f)],'Train\x20No.':'','Dosage\x20Form':'','Batch\x20Size\x20(Kg)':'','Special\x20Case\x20Product':'','Active\x20Ingredient':_0x3eb900[_0x333283(0x13f)],'Solubility':_0x3eb900[_0x333283(0x246)]||'','Therapeutic\x20Dose\x20(mg/day)':_0x3eb900[_0x333283(0x15e)]||'','Cleanability':_0x3eb900['cleanability']||'','PDE\x20(µg/day)':_0x3eb900['pde']||'','LD50\x20(mg/kg)':_0x3eb900['ld50']||'','Solubility\x20Score':_0x49054a[_0x333283(0x1d8)]||'','Therapeutic\x20Dose\x20Score':_0x49054a[_0x333283(0x2c7)]||'','Cleanability\x20Score':_0x49054a[_0x333283(0x274)]||'','Toxicity\x20Score':_0x49054a['pdeScore']||_0x49054a['ld50Score']||'','RPN':_0x49054a[_0x333283(0x149)],'RPN\x20Rating':_0x49054a[_0x333283(0x272)]});});}),_0x4c8dad[_0x1fc524(0x193)](0x0,_0x2d5f59[_0x1fc524(0x2c3)]))return _0x4c8dad[_0x1fc524(0xe0)](hideLoader),void _0x4c8dad[_0x1fc524(0xd7)](showCustomAlert,_0x1fc524(0x1d6),_0x1fc524(0xee));const _0x4afd7a=XLSX[_0x1fc524(0x107)][_0x1fc524(0x101)](_0x2d5f59),_0x63e4b0=XLSX[_0x1fc524(0x107)]['book_new']();XLSX['utils'][_0x1fc524(0x2d2)](_0x63e4b0,_0x4afd7a,_0x4c8dad[_0x1fc524(0xce)]);const _0x352e8b=Object['keys'](_0x2d5f59[0x0])[_0x1fc524(0x252)](_0x5ce0f2=>({'wch':Math['max'](_0x5ce0f2[_0x1fc524(0x2c3)],..._0x2d5f59[_0x1fc524(0x252)](_0x906ac4=>String(_0x906ac4[_0x5ce0f2]||'')['length']))+0x2}));_0x4afd7a[_0x1fc524(0xc6)]=_0x352e8b,XLSX[_0x1fc524(0x165)](_0x63e4b0,_0x1fc524(0x14e)),_0x4c8dad[_0x1fc524(0x203)](hideLoader);})[_0x213f42(0x134)](_0x2d9d0c=>{const _0xe03b8a=_0x213f42;console['error'](_0x4c8dad[_0xe03b8a(0xdd)],_0x2d9d0c),_0x4c8dad[_0xe03b8a(0x203)](hideLoader),_0x4c8dad[_0xe03b8a(0xd7)](showCustomAlert,_0xe03b8a(0xa3),_0x4c8dad[_0xe03b8a(0xd2)]);});}export function exportAllToJson(){const _0x3f17cb=a13_0x128c95,_0x31b4f9={'XrGLV':_0x3f17cb(0x2a9),'XBRey':_0x3f17cb(0x1ee),'lgGpz':function(_0x2393dc,_0x5e8169,_0x163a18){return _0x2393dc(_0x5e8169,_0x163a18);},'Jksuz':_0x3f17cb(0xa3),'bEywl':function(_0x5ab5fe,_0x56f0bf){return _0x5ab5fe+_0x56f0bf;},'ujrIx':'Failed\x20to\x20export\x20data\x20to\x20JSON.'};showLoader();try{const _0x117843={'exportDate':new Date()['toISOString'](),'scoringCriteria':a13_0x53aebc[_0x3f17cb(0xad)],'products':a13_0x53aebc[_0x3f17cb(0x28d)],'machines':a13_0x53aebc[_0x3f17cb(0x2d5)],'detergentIngredients':a13_0x53aebc[_0x3f17cb(0x2b0)]},_0x43427d=JSON[_0x3f17cb(0x127)](_0x117843,null,0x2),_0x401b73=new Blob([_0x43427d],{'type':_0x31b4f9[_0x3f17cb(0x9b)]}),_0x47c131=URL[_0x3f17cb(0x23f)](_0x401b73),_0x1fb443=document[_0x3f17cb(0x198)]('a');_0x1fb443[_0x3f17cb(0xe1)]=_0x47c131,_0x1fb443[_0x3f17cb(0x26f)]=_0x31b4f9[_0x3f17cb(0x145)],document['body']['appendChild'](_0x1fb443),_0x1fb443[_0x3f17cb(0x1fc)](),document[_0x3f17cb(0x232)]['removeChild'](_0x1fb443),URL[_0x3f17cb(0x18d)](_0x47c131);}catch(_0x439758){_0x31b4f9[_0x3f17cb(0x204)](showCustomAlert,_0x31b4f9[_0x3f17cb(0x1d5)],_0x31b4f9[_0x3f17cb(0xb8)](_0x31b4f9['ujrIx'],_0x439758['message']));}finally{hideLoader();}}export function importFromJson(_0x5b5128){const _0x5305d6=a13_0x128c95,_0x7abd68={'IVpKi':function(_0xb34e1f){return _0xb34e1f();},'xtAzY':_0x5305d6(0x243),'ntrzv':_0x5305d6(0x1c2),'aNyyC':function(_0x4bc11e,_0x3eb276,_0x184e61){return _0x4bc11e(_0x3eb276,_0x184e61);},'jfKTD':_0x5305d6(0xd3),'jMMHb':_0x5305d6(0xa3),'cKtdt':_0x5305d6(0x14a)},_0x556071=_0x5b5128[_0x5305d6(0x11a)][_0x5305d6(0x164)][0x0];if(!_0x556071)return;const _0x4f52ee=new FileReader();_0x4f52ee[_0x5305d6(0x277)]=function(_0x3eb523){const _0x48bf26=_0x5305d6;try{const _0x19b78b=JSON[_0x48bf26(0xfb)](_0x3eb523[_0x48bf26(0x11a)][_0x48bf26(0x13c)]);_0x19b78b&&_0x19b78b[_0x48bf26(0x28d)]&&_0x19b78b['scoringCriteria']&&_0x19b78b[_0x48bf26(0x2d5)]?(a13_0x53aebc[_0x48bf26(0x1c7)](_0x19b78b[_0x48bf26(0x28d)]),a13_0x53aebc[_0x48bf26(0x148)](_0x19b78b[_0x48bf26(0x2d5)]),a13_0x53aebc['setScoringCriteria'](_0x19b78b[_0x48bf26(0xad)]),_0x19b78b[_0x48bf26(0x2b0)]&&a13_0x53aebc[_0x48bf26(0x250)](_0x19b78b[_0x48bf26(0x2b0)]),_0x7abd68[_0x48bf26(0xc3)](saveStateForUndo),_0x7abd68['IVpKi'](a13_0x291cf1),showCustomAlert(_0x7abd68['xtAzY'],_0x7abd68[_0x48bf26(0x20a)])):_0x7abd68[_0x48bf26(0x1e7)](showCustomAlert,'Error',_0x7abd68['jfKTD']);}catch(_0x59b63d){_0x7abd68[_0x48bf26(0x1e7)](showCustomAlert,_0x7abd68[_0x48bf26(0x2b1)],_0x7abd68['cKtdt']);}finally{_0x5b5128[_0x48bf26(0x11a)]['value']='';}},_0x4f52ee[_0x5305d6(0x2b3)](_0x556071);}export function toggleOtherProductType(_0x25a887,_0xf30927){const _0x222c23=a13_0x128c95,_0x10588a={'itAso':_0x222c23(0x166),'IHPjo':function(_0x2fbe1e,_0x226c44){return _0x2fbe1e===_0x226c44;},'kycFe':_0x222c23(0x2cc),'tAsEK':_0x222c23(0x20f),'WXzoP':_0x222c23(0x269)},_0x5f5c18=document[_0x222c23(0xe9)](_0xf30927),_0x381b8c=_0x5f5c18[_0x222c23(0x187)](_0x10588a[_0x222c23(0x2b6)]);_0x10588a['IHPjo'](_0x10588a['kycFe'],_0x25a887[_0x222c23(0x229)])?(_0x5f5c18['style']['display']=_0x10588a[_0x222c23(0x285)],_0x381b8c[_0x222c23(0x177)]=!0x0):(_0x5f5c18[_0x222c23(0x292)]['display']=_0x10588a[_0x222c23(0xef)],_0x381b8c[_0x222c23(0x177)]=!0x1,_0x381b8c[_0x222c23(0x229)]='');}export function toggleOtherMachineStage(_0x1b17d9,_0x27254e){const _0x49bc15=a13_0x128c95,_0x3e19f1={'eDElp':_0x49bc15(0x166),'XQFwi':_0x49bc15(0x2cc),'IrozK':_0x49bc15(0x20f)},_0x1a4108=document[_0x49bc15(0xe9)](_0x27254e),_0x146b96=_0x1a4108['querySelector'](_0x3e19f1[_0x49bc15(0x10a)]);_0x3e19f1[_0x49bc15(0x25b)]===_0x1b17d9[_0x49bc15(0x229)]?(_0x1a4108[_0x49bc15(0x292)]['display']=_0x3e19f1[_0x49bc15(0x1a0)],_0x146b96[_0x49bc15(0x177)]=!0x0):(_0x1a4108['style']['display']=_0x49bc15(0x269),_0x146b96[_0x49bc15(0x177)]=!0x1,_0x146b96['value']='');}export function toggleOtherMachineGroup(_0x53f604,_0x4cf41a){const _0x53449f=a13_0x128c95,_0x16f9ba={'VBRtu':'input','XTvuk':function(_0x318626,_0x2172a1){return _0x318626===_0x2172a1;},'dozvW':'Other','xAClU':_0x53449f(0x269)},_0x4188ee=document[_0x53449f(0xe9)](_0x4cf41a),_0x2a033b=_0x4188ee[_0x53449f(0x187)](_0x16f9ba[_0x53449f(0xb3)]);_0x16f9ba[_0x53449f(0x182)](_0x16f9ba['dozvW'],_0x53f604[_0x53449f(0x229)])?(_0x4188ee['style'][_0x53449f(0x270)]=_0x53449f(0x20f),_0x2a033b['required']=!0x0):(_0x4188ee[_0x53449f(0x292)]['display']=_0x16f9ba[_0x53449f(0x271)],_0x2a033b[_0x53449f(0x177)]=!0x1,_0x2a033b[_0x53449f(0x229)]='');}export function clampSafetyFactor(_0x3733df,_0x3325c5){const _0x22179f=a13_0x128c95,_0x27fcb2={'fovwr':function(_0x48d25f,_0x4a7c91){return _0x48d25f(_0x4a7c91);},'tSZBV':function(_0xf8cd9c,_0x218af6){return _0xf8cd9c(_0x218af6);},'ZwaTq':function(_0x3a3e11,_0x3e3d13){return _0x3a3e11(_0x3e3d13);},'NhRNP':function(_0x15e8ec,_0xfb9e6f){return _0x15e8ec<_0xfb9e6f;},'bVuba':function(_0xb06794,_0x4508b8){return _0xb06794!==_0x4508b8;},'mdMCH':_0x22179f(0x1b3),'sqMFu':'sf-input-train'},_0x6b37e4=_0x27fcb2[_0x22179f(0x2ba)](parseFloat,_0x3733df['min']),_0x2697df=_0x27fcb2['tSZBV'](parseFloat,_0x3733df[_0x22179f(0xeb)]);let _0x2af7da=_0x27fcb2[_0x22179f(0x135)](parseFloat,_0x3733df[_0x22179f(0x229)]);isNaN(_0x2af7da)&&(_0x2af7da=_0x6b37e4),_0x27fcb2[_0x22179f(0x116)](_0x2af7da,_0x6b37e4)?_0x2af7da=_0x6b37e4:_0x2af7da>_0x2697df&&(_0x2af7da=_0x2697df),_0x27fcb2[_0x22179f(0x27c)](_0x27fcb2[_0x22179f(0x2ba)](parseFloat,_0x3733df['value']),_0x2af7da)&&(_0x3733df['value']=_0x2af7da),_0x3733df['id']['startsWith'](_0x27fcb2[_0x22179f(0xe3)])?recalculateProductMacoForTrain(_0x3325c5):_0x3733df['id'][_0x22179f(0x24e)](_0x27fcb2[_0x22179f(0x273)])&&recalculateDetergentMacoForTrain(_0x3325c5);}export function toggleTrain(_0xae2194){const _0x35b737=a13_0x128c95,_0x911759={'efTfT':function(_0x568b51,_0x29915b){return _0x568b51&&_0x29915b;},'LpHVm':_0x35b737(0x237)},_0x219b27=document[_0x35b737(0xe9)](_0x35b737(0x1b9)+_0xae2194),_0x2d267a=document[_0x35b737(0xe9)](_0x35b737(0x112)+_0xae2194);_0x911759[_0x35b737(0x1ad)](_0x219b27,_0x2d267a)&&(_0x219b27['classList'][_0x35b737(0x2bd)](_0x911759[_0x35b737(0x26d)])?(_0x219b27[_0x35b737(0x231)][_0x35b737(0x2a4)](_0x911759[_0x35b737(0x26d)]),_0x2d267a['textContent']='▼'):(_0x219b27[_0x35b737(0x231)][_0x35b737(0xf8)](_0x911759[_0x35b737(0x26d)]),_0x2d267a[_0x35b737(0x19a)]='▶'));}export function toggleMacoBreakdown(_0x8c9144){const _0x71c3fb=a13_0x128c95,_0x7726e0={'JZjWz':'hidden','SjsEE':_0x71c3fb(0x91),'ByHUd':'Show\x20MACO\x20Calculation\x20Breakdown'},_0x712c69=document[_0x71c3fb(0xe9)](_0x71c3fb(0x2cf)+_0x8c9144),_0x51affc=document[_0x71c3fb(0xe9)](_0x71c3fb(0x98)+_0x8c9144);_0x712c69[_0x71c3fb(0x231)][_0x71c3fb(0x2bd)](_0x7726e0['JZjWz'])?(_0x712c69[_0x71c3fb(0x231)]['remove'](_0x7726e0['JZjWz']),_0x51affc[_0x71c3fb(0x19a)]=_0x7726e0[_0x71c3fb(0x24d)]):(_0x712c69[_0x71c3fb(0x231)][_0x71c3fb(0xf8)](_0x7726e0[_0x71c3fb(0x234)]),_0x51affc['textContent']=_0x7726e0['ByHUd']);}function a13_0x3495(){const _0xe2624a=['historyIndex','machineStageDisplayOrder','getItem','productRegister-','classList','body','There\x20is\x20no\x20data\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','JZjWz','WXGOu','consolidateMachinesByGroup','collapsed','VgVtb','ObjST','tsHlO','Error\x20exporting\x20Train\x20Summary\x20to\x20Excel:','activeIngredients','assumedSsa','content-dm-','createObjectURL','-hidden','YzKRt','IbNyb','Success','Keacw','ShXLO','solubility','area','setScoringWasInEditModeForPrint','VzBil','YwNKn','wQAEK','AALJV','SjsEE','startsWith','skuSr','setDetergentIngredients','Train_Summary_Report','map','macoMachines','10\x20ppm\x20Criterion','ALyCh','xjEwu','severity','Error\x20exporting\x20to\x20Excel:','OHetO','redo-btn','XQFwi','disabled','macoProducts','Failed\x20to\x20export\x20Detergent\x20MACO\x20data\x20to\x20Excel.','kpypP','customAlertTitle','iBAMd','wGGMc','_Train_','macoForTrains','button','MHltN','VXiAY','safetyFactorConfig','none','N/A','split','sdORi','LpHVm','scoringInEditMode','download','display','xAClU','rpnRatingText','sqMFu','cleanabilityScore','odpbF','TdVUO','onload','cvxMU','documentElement','FfJjW','VFFEG','bVuba','11IeuzrT','kppZa','scoring-system','trainId','join','SrUkJ','Error\x20loading\x20scoring\x20criteria','There\x20are\x20no\x20machines\x20to\x20export.','tAsEK','avaSS','Product\x20MACO\x20Report','RpHMw','yhDuz','trainSummaryContainer','detergentMaco','productRegister-pdeHidden','products','oqOLh','sBcvN','print','dBRFV','style','./utils.js','occurrence','HSPvC','SDDkl','setScoringCriteria','minBsMddRatio','Error\x20creating\x20All\x20Products\x20sheet:','jGnJp','ajGJH','theme-toggle-light-icon','855464gjfIPN','UxESj','zNozY','stage','kSdvJ','OXuut','innerHTML','remove','Summary\x20report\x20data\x20exported\x20to\x20Excel\x20successfully!','HHOxk','1858984AaqFca','.xlsx','application/json','None','Machines\x20data\x20exported\x20to\x20Excel\x20successfully!','ehcet','GpSRq','includes','BTElq','detergentIngredients','jMMHb','nHVax','readAsText','renderDetergentMaco','VZawt','itAso','NWxwX','viewProducts','isGroup','fovwr','customAlertMessage','Detergent\x20MACO\x20Report','contains','toExponential','fRFct','Hide','QKDkb','Worst\x20Case\x20Products','length','batchSizeKg','toLocaleString','_Trains_','therapeuticDoseScore','Top\x2010\x20RPN','flex','WQPDx','jmhPM','Other','Product\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','146TKBcKA','maco-breakdown-details-','machineCount','isArray','book_append_sheet','\x20-\x20','108198yEFyyq','machines','Error\x20loading\x20products','Error\x20loading\x20machines','Error\x20creating\x20Detergent\x20MACO\x20sheet:','vvtkE','tdcIU','cfdcZ','Hide\x20MACO\x20Calculation\x20Breakdown','BNEbe','error','Error\x20exporting\x20worst\x20case\x20to\x20Excel:','ncSuI','Hide\x20PDE','XWmxI','breakdown-toggle-btn-','zvbiT','printing-','XrGLV','minMbsKg','oBAwi','RXtRh','UDYiC','hyoMt','jYvAE','Error\x20exporting\x20Detergent\x20MACO\x20to\x20Excel:','Error','pde','.toggle-pde','oVpQw','not\x20found','LwRyx','pAdXb','KJGKT','PXHNz','zFNvy','scoringCriteria','OhvhL','NkTyE','FHrEg','ctYnd','macoDetergentIngredients','VBRtu','EySSw','date','wsOIN','LnHSS','bEywl','filter','scoxI','lowestPde','KTSAO','Product_MACO_Report','machineNumber','toLocaleDateString','productCode','MSJuB','cUdKO','IVpKi','Train:','renderTrainSummary','!cols','UOhUd','finally','7226XhrkNl','UrcEt','qpBCn','JeXsj','AptkH','FTPRC','VMdIM','HnWlH','UrhHQ','QvgCL','Invalid\x20JSON\x20file\x20structure.','WxIqF','Failed\x20to\x20export\x20worst\x20case\x20data\x20to\x20Excel.','pNYyl','uNNme','VVrsd','JxCgT','JsQwq','There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','pChqM','zbnqQ','Train\x20Summary\x20data\x20exported\x20to\x20Excel\x20successfully!','AniXI','RUgKX','href','ld50','mdMCH','PbWRk','jArIF','JYADh','hNHYW','MACO_Machines_','getElementById','trim','max','setItem','history','There\x20is\x20no\x20data\x20in\x20the\x20current\x20view\x20to\x20export.','WXzoP','AIFda','setHistory','hide-ld50','yLBIz','MGqMY','Show\x20PDE','sf-input-train-','srohO','add','worstCaseProducts','uopSu','parse','pazfC','Show','vxcMB','log','Nunix','json_to_sheet','\x20.mainTable,\x20#','3127524OOgYzu','bymQY','tUJvI','lowestLtd','utils','0.1%\x20Therapeutic\x20Dose','xeUJU','eDElp','KNSmA','undo-btn','tnpWU','productType','lQcdH','./macoProductView.js','Error\x20exporting\x20all\x20tabs\x20to\x20Excel:','toggle-','fjDIj','Train\x20','dDzdS','NhRNP','dzWrM','CEtoM','WLuQx','target','QmUFf','CVKNk','columnVisibilityDropdown','CgUOf','lsBUC','cNCcY','hqFNk','tWpvT','bhvQL','mbqUp','Detergent\x20MACO','kRhja','stringify','DxzQA','MACO_Summary_Report_','slice','LLiRw','Qnadk','find','Unknown\x20(ID:\x20','criticalReason','oZBPn','renderRpnChart','2805322aNrHQv','yIzHS','catch','ZwaTq','Could\x20not\x20save\x20data.\x20Storage\x20might\x20be\x20full.','./worstCaseView.js','Critical\x20Products','Detergent\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','./macoDetergentView.js','yDYLw','result','lReLT','lYnyy','name','QaGiy','Detergent_MACO_Report_','toISOString','all','14dpwTtP','XBRey','SVzWG','isCritical','setMachines','rpn','Failed\x20to\x20parse\x20JSON\x20file.','Health-Based\x20Limit\x20(ADE)','jxsRP','toggle','MACO_All_Products_Report.xlsx','YwtPJ','WQDXl','jCAml','Trains\x20','IstYE','machineIds','machineStage-','WyACD','otLks','MACO_Worst_Case_Products','bZveL','pdeScore','zanNV','printSelectedTrain','Visual\x20Clean\x20Limit','therapeuticDose','Machines','\x20.ingredients-sub-table','kezSP','MACO\x20Report','ZHoLx','files','writeFile','input','ZDrFF','YJKDC','worstProductRpn','#macoForTrains\x20[id^=\x22maco-breakdown-details-\x22].hidden','Failed\x20to\x20export\x20Product\x20MACO\x20data\x20to\x20Excel.','AdiRN','cZTYB','vGdak','querySelectorAll','kuNMn','wsZNe','HcXub','./trainSummaryView.js','TeCgm','bhvXD','ingredientName','required','book_new','Error\x20creating\x20Critical\x20Products\x20sheet:','parentElement','Container\x20display:','3IeuEUr','dark',',\x20#','hDuZL','push','WpMIM','XTvuk','RMWtK','-ld50Hidden','forEach','BylgZ','querySelector','yRUxU','fyPKO','ZGAuY','DzjYl','Failed\x20to\x20export\x20machines\x20data\x20to\x20Excel.','revokeObjectURL','DFAYs',')\x20-\x20RPN:\x20','NOGWd','XPMUo','Error\x20creating\x20Product\x20Register\x20sheet:','tFOcb','Error\x20creating\x20Train\x20Summary\x20sheet:','Failed\x20to\x20save\x20data\x20to\x20localStorage','Error\x20loading\x20detergent\x20view\x20for\x20print:','Qmxzu','createElement','PRODUCT','textContent','hkfyt','\x20.mainTable.hide-','Error\x20creating\x20Top\x2010\x20RPN\x20sheet:','#productRegister\x20.mainTable.hide-','then','IrozK','gulqG','Product\x20MACO','No\x20train\x20data\x20to\x20print.\x20Please\x20ensure\x20you\x20have\x20created\x20trains\x20first.','flatMap','ld50Score','\x20→\x20','Coasc','group','Error\x20exporting\x20Product\x20MACO\x20to\x20Excel:','210rCEjoU','Error\x20exporting\x20Summary\x20to\x20Excel:','28eaZvNn','efTfT','koJBT','MBXFk','content-pm-','aWSxf','toggle-pm-','product-sf-input','ytNzb','WoKAF','bodyWeight','Yes','LbIrL','content-','All\x20Products','keys','Product\x20Register','gjmmd','No\x20trains\x20match\x20the\x20selected\x20criteria.','MivGi','kzAMW','Printing\x20view:','Data\x20imported\x20successfully.','oghgN','NvYBK','closest','JHHBz','setProducts','DyMLb','JGHjp','gRZXG','KiDLW','essa','Hidden','aNYUF','aoZgM','gBdsT','RrFsb','Zyajy','qoywi','renderWorstCaseByTrain','Jksuz','No\x20Data','frZcJ','solubilityScore','loader','There\x20are\x20no\x20summary\x20data\x20to\x20export.\x20Add\x20products\x20and\x20ingredients\x20first.','PBvvg','There\x20are\x20no\x20products\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','sort','reduce','No\x20trains\x20message\x20display:','LdZkP','hide-pde','PUmrh','Failed\x20to\x20export\x20complete\x20report\x20to\x20Excel.','Train\x20Summary','INGREDIENT','hidden','aNyyC','match','FcLUw','HXNxn','YxSKY','aBXSE','Error\x20creating\x20Product\x20MACO\x20sheet:','maco_data_export.json','No\x20reason\x20provided','toggle-dm-','macoScoringCriteria','NYTKg','QRNWW','hPWtz','wYucN','XVZwl','sortValue','number','EbwDX','XUxeh','hyyrL','click','DrHgK','zaLNI','NeCVh','Error\x20loading\x20train\x20summary:\x20','\x20.train-content-inner','kxbKa','bkwoW','lgGpz','toFixed','lwpRV','HUqQR','productName','cnEWT','ntrzv','fTeFC','jeMZU','45kPSyio','SwsSL','block','addEventListener','\x20\x20└─\x20','SDSRr','Setting\x20printSelectedTrain\x20to:','YGXbR','Mtmgs','min','rpnChartInstance','Complete_MACO_Report_','1236630gwRynQ','bayNL','QrQPx','hide-','gSDLD','duMOW','QOLIM','AgKcx','mddMg','PXlzp','smeBI','PRpYZ','WBtcG','true','xUWOP','Save\x20Error','value','gcnBF','ZOXez','#macoForTrains\x20.train-content.collapsed'];a13_0x3495=function(){return _0xe2624a;};return a13_0x3495();}export function exportWorstCaseToExcel(_0xf8fbf0=a13_0x128c95(0x143)){const _0x3358a0=a13_0x128c95,_0x3be136={'tWpvT':function(_0x3a03fe,_0x423f1c){return _0x3a03fe!==_0x423f1c;},'UOhUd':_0x3358a0(0x26a),'avaSS':function(_0x48b7e0,_0x42a0c4){return _0x48b7e0===_0x42a0c4;},'DyMLb':function(_0xb4a41c,_0x86ec6e,_0x5ee2a1){return _0xb4a41c(_0x86ec6e,_0x5ee2a1);},'CEtoM':_0x3358a0(0x1d6),'gRZXG':_0x3358a0(0x1dc),'GpSRq':_0x3358a0(0x143),'zwZDX':function(_0x537f8e){return _0x537f8e();},'nHVax':function(_0x276f53,_0x3c0c29){return _0x276f53===_0x3c0c29;},'wYucN':function(_0x34f739){return _0x34f739();},'CVKNk':_0x3358a0(0x233),'MHltN':_0x3358a0(0x2c2),'qoywi':'!cols','MBXFk':_0x3358a0(0x94),'WQDXl':function(_0x185022){return _0x185022();},'aoZgM':function(_0x48235a,_0x328871,_0x18e3d1){return _0x48235a(_0x328871,_0x18e3d1);},'VVrsd':_0x3358a0(0xd5)};_0x3be136[_0x3358a0(0x150)](showLoader),import('./utils.js')[_0x3358a0(0x19f)](_0x1fb6e5=>{const _0x17c671=_0x3358a0,_0x3a49c2={'gGguu':function(_0x472892,_0x4d5c1a){return _0x472892>_0x4d5c1a;},'OHetO':_0x3be136['UOhUd']},{getProductTrainId:_0x11541c,calculateScores:_0x58ac22,getToxicityPreference:_0x46415b}=_0x1fb6e5,_0x59b97f=[];let _0x233c68=a13_0x53aebc[_0x17c671(0x2b8)][_0x17c671(0xf9)]||a13_0x53aebc[_0x17c671(0x28d)];if(_0x3be136['avaSS'](0x0,_0x233c68[_0x17c671(0x2c3)]))return hideLoader(),void _0x3be136[_0x17c671(0x1c8)](showCustomAlert,_0x3be136[_0x17c671(0x118)],_0x3be136[_0x17c671(0x1ca)]);const _0x3e1143={};_0x233c68[_0x17c671(0x185)](_0x36103a=>{const _0x3f98d8=_0x17c671,_0x330e0d=_0x11541c(_0x36103a);_0x3be136[_0x3f98d8(0x122)](_0x3be136[_0x3f98d8(0xc7)],_0x330e0d)&&(_0x3e1143[_0x330e0d]||(_0x3e1143[_0x330e0d]=[]),_0x3e1143[_0x330e0d][_0x3f98d8(0x180)](_0x36103a));});let _0x5894c7=_0x3e1143;if(_0x3be136['tWpvT'](_0x3be136['GpSRq'],_0xf8fbf0)&&(_0x5894c7={},Array[_0x17c671(0x2d1)](_0xf8fbf0)?_0xf8fbf0[_0x17c671(0x185)](_0x46597e=>{_0x3e1143[_0x46597e]&&(_0x5894c7[_0x46597e]=_0x3e1143[_0x46597e]);}):_0x3e1143[_0xf8fbf0]&&(_0x5894c7={[_0xf8fbf0]:_0x3e1143[_0xf8fbf0]}),_0x3be136[_0x17c671(0x286)](0x0,Object[_0x17c671(0x1bb)](_0x5894c7)['length'])))return _0x3be136['zwZDX'](hideLoader),void _0x3be136[_0x17c671(0x1c8)](showCustomAlert,_0x3be136[_0x17c671(0x118)],(Array['isArray'](_0xf8fbf0)?_0x17c671(0x152)+_0xf8fbf0[_0x17c671(0x281)](',\x20'):'Train\x20'+_0xf8fbf0)+'\x20not\x20found\x20or\x20has\x20no\x20products.');const _0x5cd264=_0x3be136['zwZDX'](_0x46415b);if(Object['keys'](_0x5894c7)['sort']((_0x349623,_0x3ff2e6)=>_0x349623-_0x3ff2e6)[_0x17c671(0x185)](_0x11dfec=>{const _0x1b0d42=_0x17c671,_0x1fc989=_0x5894c7[_0x11dfec];_0x59b97f[_0x1b0d42(0x180)]({'Train':_0x1b0d42(0x114)+_0x11dfec+'\x20-\x20Worst\x20Case\x20Analysis','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),_0x1fc989[_0x1b0d42(0x185)](_0x54656b=>{const _0x1f2dab=_0x1b0d42,_0x2b9161=_0x54656b['activeIngredients']['map'](_0x5861cf=>_0x58ac22(_0x5861cf,_0x5cd264)[_0x1f2dab(0x149)]);_0x54656b[_0x1f2dab(0x1f7)]=_0x3a49c2['gGguu'](_0x2b9161[_0x1f2dab(0x2c3)],0x0)?Math[_0x1f2dab(0xeb)](..._0x2b9161):0x0;}),_0x1fc989[_0x1b0d42(0x1dd)]((_0x181070,_0x2641ba)=>_0x2641ba[_0x1b0d42(0x1f7)]-_0x181070[_0x1b0d42(0x1f7)]),_0x1fc989[_0x1b0d42(0x185)](_0x33f440=>{const _0x3b93b5=_0x1b0d42,_0x268b66={'wsZNe':function(_0x83b5,_0x36f0a1,_0x3a80a1){return _0x83b5(_0x36f0a1,_0x3a80a1);},'smeBI':_0x3a49c2[_0x3b93b5(0x259)]},_0x1b95d7=_0x33f440['isCritical']?_0x3b93b5(0x1b7):'No';_0x59b97f['push']({'Train':'','Product\x20Code':_0x33f440[_0x3b93b5(0xc0)],'Product\x20Name':_0x33f440[_0x3b93b5(0x13f)],'Highest\x20RPN':_0x33f440['sortValue'],'Special\x20Case\x20Product':_0x1b95d7,'Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),(_0x33f440[_0x3b93b5(0x23c)][_0x3b93b5(0x1dd)]((_0x4240f3,_0x471c3a)=>_0x58ac22(_0x471c3a,_0x5cd264)[_0x3b93b5(0x149)]-_0x58ac22(_0x4240f3,_0x5cd264)[_0x3b93b5(0x149)])[_0x3b93b5(0x185)](_0x6021be=>{const _0x562a77=_0x3b93b5,_0x35855f=_0x268b66[_0x562a77(0x171)](_0x58ac22,_0x6021be,_0x5cd264);_0x59b97f[_0x562a77(0x180)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':_0x6021be[_0x562a77(0x13f)],'TD\x20Score':_0x35855f[_0x562a77(0x2c7)],'Solubility\x20Score':_0x35855f[_0x562a77(0x1d8)],'Cleanability\x20Score':_0x35855f[_0x562a77(0x274)],'PDE\x20Score':_0x35855f[_0x562a77(0x15a)]??_0x268b66[_0x562a77(0x223)],'LD50\x20Score':_0x35855f[_0x562a77(0x1a5)]??_0x562a77(0x26a),'RPN':_0x35855f[_0x562a77(0x149)],'Rating':_0x35855f[_0x562a77(0x272)]});}),_0x59b97f[_0x3b93b5(0x180)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}));});}),_0x3be136[_0x17c671(0x2b2)](0x0,_0x59b97f['length']))return _0x3be136[_0x17c671(0x1f5)](hideLoader),void _0x3be136[_0x17c671(0x1c8)](showCustomAlert,_0x3be136[_0x17c671(0x118)],_0x3be136[_0x17c671(0x11c)]);const _0x38d99a=XLSX[_0x17c671(0x107)][_0x17c671(0x101)](_0x59b97f),_0x2993a2=XLSX[_0x17c671(0x107)][_0x17c671(0x178)]();XLSX[_0x17c671(0x107)][_0x17c671(0x2d2)](_0x2993a2,_0x38d99a,_0x3be136[_0x17c671(0x266)]);const _0x1e08b6=Object[_0x17c671(0x1bb)](_0x59b97f[0x0])[_0x17c671(0x252)](_0x3c1d1e=>({'wch':Math['max'](_0x3c1d1e[_0x17c671(0x2c3)],..._0x59b97f['map'](_0x109a16=>String(_0x109a16[_0x3c1d1e]||'')[_0x17c671(0x2c3)]))+0x2}));_0x38d99a[_0x3be136[_0x17c671(0x1d3)]]=_0x1e08b6;const _0x43eb76=new Date()[_0x17c671(0x142)]()[_0x17c671(0x26b)]('T')[0x0];let _0x8e9071='';_0x3be136[_0x17c671(0x122)](_0x3be136[_0x17c671(0x2ad)],_0xf8fbf0)&&(_0x8e9071=Array[_0x17c671(0x2d1)](_0xf8fbf0)?_0x17c671(0x2c6)+_0xf8fbf0[_0x17c671(0x281)]('_'):_0x17c671(0x263)+_0xf8fbf0),XLSX['writeFile'](_0x2993a2,_0x17c671(0x158)+_0x8e9071+'_'+_0x43eb76+'.xlsx'),_0x3be136[_0x17c671(0x1f5)](hideLoader);})[_0x3358a0(0x134)](_0x5e7a13=>{const _0x322d2e=_0x3358a0;console['error'](_0x3be136[_0x322d2e(0x1af)],_0x5e7a13),_0x3be136[_0x322d2e(0x150)](hideLoader),_0x3be136[_0x322d2e(0x1cf)](showCustomAlert,_0x322d2e(0xa3),_0x3be136[_0x322d2e(0xd8)]);});}export function exportMachinesToExcel(){const _0x12d1dd=a13_0x128c95,_0x38fe41={'JYADh':_0x12d1dd(0x2aa),'hDuZL':function(_0x29be8a){return _0x29be8a();},'PXlzp':function(_0x148e39,_0x5d77a7){return _0x148e39===_0x5d77a7;},'XLDhq':function(_0x17a950){return _0x17a950();},'zaLNI':function(_0x59685e,_0x567e4c,_0x5d8159){return _0x59685e(_0x567e4c,_0x5d8159);},'UGIJS':'No\x20Data','RMWtK':_0x12d1dd(0x15f),'FcLUw':_0x12d1dd(0xc6),'yRUxU':function(_0x39d944,_0x161535,_0x55535d){return _0x39d944(_0x161535,_0x55535d);},'PUmrh':_0x12d1dd(0xa3)};_0x38fe41[_0x12d1dd(0x17f)](showLoader);try{if(_0x38fe41[_0x12d1dd(0x222)](0x0,a13_0x53aebc['machines'][_0x12d1dd(0x2c3)]))return _0x38fe41['XLDhq'](hideLoader),void _0x38fe41[_0x12d1dd(0x1fe)](showCustomAlert,_0x38fe41['UGIJS'],_0x12d1dd(0x284));const _0xbd4d0c=[],_0x49e93b={};a13_0x53aebc['machines'][_0x12d1dd(0x185)](_0x494e87=>{const _0x1c7153=_0x12d1dd;_0x49e93b[_0x494e87[_0x1c7153(0x2a0)]]||(_0x49e93b[_0x494e87['stage']]=[]),_0x49e93b[_0x494e87[_0x1c7153(0x2a0)]]['push'](_0x494e87);}),a13_0x53aebc[_0x12d1dd(0x22e)][_0x12d1dd(0x185)](_0xeaf970=>{const _0x8b310e=_0x12d1dd;_0x49e93b[_0xeaf970]&&_0x49e93b[_0xeaf970][_0x8b310e(0x185)](_0x264454=>{const _0x27f799=_0x8b310e,_0x4bfff6=a13_0x53aebc[_0x27f799(0x28d)][_0x27f799(0xb9)](_0xfae702=>_0xfae702[_0x27f799(0x154)]&&_0xfae702[_0x27f799(0x154)][_0x27f799(0x2ae)](_0x264454['id'])),_0x338df9=_0x4bfff6[_0x27f799(0x252)](_0x1065b1=>_0x1065b1[_0x27f799(0x13f)])[_0x27f799(0x281)](',\x20')||_0x38fe41[_0x27f799(0xe6)],_0x1ef6ec=_0x4bfff6[_0x27f799(0x2c3)];_0xbd4d0c[_0x27f799(0x180)]({'Machine\x20Number':_0x264454['machineNumber'],'Machine\x20Name':_0x264454[_0x27f799(0x13f)],'Stage':_0x264454['stage'],'Area\x20(sq\x20cm)':_0x264454[_0x27f799(0x247)],'Assigned\x20Products\x20Count':_0x1ef6ec,'Assigned\x20Products':_0x338df9});});});const _0x155f7e=XLSX[_0x12d1dd(0x107)][_0x12d1dd(0x101)](_0xbd4d0c),_0x357cac=XLSX['utils']['book_new']();XLSX[_0x12d1dd(0x107)][_0x12d1dd(0x2d2)](_0x357cac,_0x155f7e,_0x38fe41[_0x12d1dd(0x183)]);const _0x1cc9a2=[{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0xf},{'wch':0x14},{'wch':0x32}];_0x155f7e[_0x38fe41[_0x12d1dd(0x1e9)]]=_0x1cc9a2;const _0x33813f=new Date()['toISOString']()[_0x12d1dd(0x26b)]('T')[0x0];XLSX['writeFile'](_0x357cac,_0x12d1dd(0xe8)+_0x33813f+_0x12d1dd(0x2a8)),_0x38fe41[_0x12d1dd(0x17f)](hideLoader),_0x38fe41[_0x12d1dd(0x188)](showCustomAlert,_0x12d1dd(0x243),_0x12d1dd(0x2ab));}catch(_0x4bdad1){console[_0x12d1dd(0x93)]('Error\x20exporting\x20machines\x20to\x20Excel:',_0x4bdad1),hideLoader(),_0x38fe41[_0x12d1dd(0x188)](showCustomAlert,_0x38fe41[_0x12d1dd(0x1e2)],_0x12d1dd(0x18c));}}export function exportProductMacoToExcel(_0x4b6477=a13_0x128c95(0x143)){const _0x495459=a13_0x128c95,_0x584d13={'abFei':function(_0x313257,_0x354df9){return _0x313257||_0x354df9;},'TeCgm':'N/A','Nunix':function(_0x5b01e2,_0x290658){return _0x5b01e2(_0x290658);},'kxbKa':function(_0x32c3c2,_0x4e7412){return _0x32c3c2/_0x4e7412;},'Zyajy':function(_0x2756ba,_0x3a39e6){return _0x2756ba*_0x3a39e6;},'AptkH':function(_0x51b94b,_0x2ebcf7){return _0x51b94b*_0x2ebcf7;},'lReLT':_0x495459(0x108),'scoxI':_0x495459(0x254),'KNSmA':_0x495459(0x14b),'XWmxI':function(_0x5f2da9,_0xada118){return _0x5f2da9==_0xada118;},'NYTKg':_0x495459(0x1f8),'hqFNk':function(_0x286ccb,_0xb1d1ff){return _0x286ccb/_0xb1d1ff;},'SDSRr':_0x495459(0x15d),'IbNyb':function(_0x3ad2ba,_0x274fc4){return _0x3ad2ba>_0x274fc4;},'hPWtz':_0x495459(0x1a6),'jxsRP':function(_0x322a91,_0xeca154){return _0x322a91!==_0xeca154;},'kzAMW':function(_0x382fd0){return _0x382fd0();},'FHrEg':function(_0x4244a0,_0x43c21a){return _0x4244a0===_0x43c21a;},'koJBT':function(_0x3e477c,_0x1f8ffb){return _0x3e477c!==_0x1f8ffb;},'fyPKO':function(_0x4fa51f){return _0x4fa51f();},'uopSu':_0x495459(0x1d6),'nqJQA':_0x495459(0x1be),'QRNWW':_0x495459(0x287),'BdQRF':_0x495459(0xc6),'Mtmgs':_0x495459(0x143),'JeXsj':function(_0x5ef3c7,_0x2498de,_0xa8ef8d){return _0x5ef3c7(_0x2498de,_0xa8ef8d);},'wGGMc':_0x495459(0x243),'VMdIM':_0x495459(0x1a9),'yDYLw':_0x495459(0xa3),'zvbiT':_0x495459(0x16b),'ajGJH':function(_0x1b8cbf){return _0x1b8cbf();},'rnDxP':_0x495459(0x293)};_0x584d13[_0x495459(0x29b)](showLoader),import(_0x584d13['rnDxP'])[_0x495459(0x19f)](_0x31bf70=>{const _0x1a76ae=_0x495459,{getTrainData:_0xbec801,getWorstCaseProductType:_0x55121e,getMacoPerSwabForTrain:_0x195213}=_0x31bf70,_0x32bd50=_0x584d13['kzAMW'](_0xbec801);if(_0x584d13[_0x1a76ae(0xb0)](0x0,_0x32bd50['length']))return _0x584d13[_0x1a76ae(0x1c0)](hideLoader),void showCustomAlert(_0x1a76ae(0x1d6),'There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.');let _0x424b72=_0x32bd50;if(_0x584d13[_0x1a76ae(0x1ae)](_0x1a76ae(0x143),_0x4b6477)&&(_0x424b72=Array[_0x1a76ae(0x2d1)](_0x4b6477)?_0x32bd50[_0x1a76ae(0xb9)](_0x5ce67a=>_0x4b6477[_0x1a76ae(0x2ae)](String(_0x5ce67a['id']))):_0x32bd50[_0x1a76ae(0xb9)](_0x2872fc=>String(_0x2872fc['id'])===String(_0x4b6477))),0x0===_0x424b72['length'])return _0x584d13[_0x1a76ae(0x189)](hideLoader),void showCustomAlert(_0x584d13[_0x1a76ae(0xfa)],_0x584d13['nqJQA']);const _0x182ae8=[],_0x1e1baf=_0x32bd50[_0x1a76ae(0x1de)]((_0x841280,_0x2e6256)=>_0x2e6256[_0x1a76ae(0x1cc)]>_0x841280[_0x1a76ae(0x1cc)]?_0x2e6256:_0x841280)['essa'];_0x424b72[_0x1a76ae(0x185)](_0x2f4060=>{const _0x2a8b1c=_0x1a76ae,_0x4ed4a7={'lXzfz':function(_0x93ce8,_0x26080c){return _0x584d13['abFei'](_0x93ce8,_0x26080c);},'zNozY':_0x584d13[_0x2a8b1c(0x174)]},_0x5d4fe6=_0x584d13[_0x2a8b1c(0x100)](_0x55121e,_0x2f4060[_0x2a8b1c(0x28d)][_0x2a8b1c(0x252)](_0x4b1225=>_0x4b1225[_0x2a8b1c(0x10e)])),_0x1157f5=(a13_0x53aebc['safetyFactorConfig'][_0x5d4fe6]||a13_0x53aebc[_0x2a8b1c(0x268)][_0x2a8b1c(0x2cc)])[_0x2a8b1c(0xeb)],_0x48745b=_0x584d13[_0x2a8b1c(0x202)](_0x584d13[_0x2a8b1c(0x1d2)](_0x2f4060[_0x2a8b1c(0x106)],_0x2f4060[_0x2a8b1c(0x298)]),_0x1157f5),_0x5023df=_0x584d13[_0x2a8b1c(0xcd)](0xa,_0x2f4060[_0x2a8b1c(0x9c)]);let _0xf92f0=_0x584d13[_0x2a8b1c(0x174)];null!==_0x2f4060['lowestPde']&&(_0xf92f0=_0x584d13[_0x2a8b1c(0xcd)](_0x2f4060[_0x2a8b1c(0xbb)],_0x2f4060[_0x2a8b1c(0x298)]));const _0x44af81=0.004*_0x1e1baf,_0x3fbab1=[{'name':_0x584d13[_0x2a8b1c(0x13d)],'value':_0x48745b},{'name':_0x584d13[_0x2a8b1c(0xba)],'value':_0x5023df},{'name':_0x584d13[_0x2a8b1c(0x10b)],'value':_0x584d13[_0x2a8b1c(0x97)](_0x584d13[_0x2a8b1c(0x1f2)],typeof _0xf92f0)?_0xf92f0:_0x584d13[_0x2a8b1c(0x121)](0x1,0x0)},{'name':_0x584d13[_0x2a8b1c(0x212)],'value':_0x44af81}][_0x2a8b1c(0x1de)]((_0x3ac6d2,_0x593c64)=>_0x593c64[_0x2a8b1c(0x229)]<_0x3ac6d2[_0x2a8b1c(0x229)]?_0x593c64:_0x3ac6d2),_0x3978b3=_0x3fbab1[_0x2a8b1c(0x229)],_0x915a46=_0x584d13[_0x2a8b1c(0x242)](_0x1e1baf,0x0)?_0x3978b3/_0x1e1baf:0x0,_0x313812=_0x915a46*_0x2f4060['assumedSsa'],_0x50c8f6=_0x2f4060[_0x2a8b1c(0x154)][_0x2a8b1c(0x252)](_0x5d4d7d=>{const _0x2ea8be=_0x2a8b1c,_0xeb0c3d=a13_0x53aebc['machines'][_0x2ea8be(0x12d)](_0x5d0e18=>_0x5d0e18['id']===_0x5d4d7d);return _0x4ed4a7['lXzfz'](_0xeb0c3d,{'name':_0x2ea8be(0x12e)+_0x5d4d7d+')','machineNumber':_0x4ed4a7[_0x2ea8be(0x29f)]});}),_0x2389da=_0x31bf70['consolidateMachinesByGroup'](_0x2f4060['machineIds'])[_0x2a8b1c(0x252)](_0x331dbd=>_0x331dbd[_0x2a8b1c(0x2b9)]?_0x331dbd['group']+'\x20('+_0x331dbd[_0x2a8b1c(0x2d0)]+'x)':_0x331dbd[_0x2a8b1c(0x13f)])[_0x2a8b1c(0x281)](_0x584d13[_0x2a8b1c(0x1f4)]),_0x58e5be=_0x2f4060['products'][_0x2a8b1c(0x252)](_0x4163e0=>_0x4163e0['productCode']+_0x2a8b1c(0x2d3)+_0x4163e0[_0x2a8b1c(0x13f)])[_0x2a8b1c(0x281)](';\x20'),_0x4bab56=_0x2f4060[_0x2a8b1c(0x169)]?_0x2f4060[_0x2a8b1c(0x169)][_0x2a8b1c(0x208)]+'\x20('+_0x2f4060['worstProductRpn'][_0x2a8b1c(0x176)]+_0x2a8b1c(0x18f)+_0x2f4060[_0x2a8b1c(0x169)][_0x2a8b1c(0x149)]:_0x584d13['TeCgm'];_0x182ae8[_0x2a8b1c(0x180)]({'Train':'T'+_0x2f4060['id'],'Total\x20Products':_0x2f4060['products'][_0x2a8b1c(0x2c3)],'Total\x20Machines':_0x50c8f6[_0x2a8b1c(0x2c3)],'Total\x20Area\x20(ESSA)\x20cm²':_0x2f4060[_0x2a8b1c(0x1cc)][_0x2a8b1c(0x2c5)](),'Products':_0x58e5be,'Machines':_0x2389da,'Worst-Case\x20Dosage\x20Form':_0x5d4fe6,'Safety\x20Factor':_0x1157f5,'Lowest\x20LTD\x20(mg)':_0x2f4060[_0x2a8b1c(0x106)],'Min\x20Batch\x20Size\x20(kg)':_0x2f4060[_0x2a8b1c(0x9c)],'Min\x20BS/MDD\x20Ratio':_0x2f4060['minBsMddRatio'][_0x2a8b1c(0x205)](0x2),'Lowest\x20PDE\x20(mg)':_0x584d13[_0x2a8b1c(0x14c)](null,_0x2f4060[_0x2a8b1c(0xbb)])?_0x2f4060['lowestPde']:_0x584d13[_0x2a8b1c(0x174)],'Worst-Case\x20Product\x20(by\x20RPN)':_0x4bab56,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x48745b['toFixed'](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x5023df[_0x2a8b1c(0x205)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x2a8b1c(0x1f8)==typeof _0xf92f0?_0xf92f0[_0x2a8b1c(0x205)](0x2):_0x2a8b1c(0x26a),'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x44af81[_0x2a8b1c(0x205)](0x2),'Selected\x20MACO\x20Method':_0x3fbab1[_0x2a8b1c(0x13f)],'Final\x20MACO\x20(mg)':_0x3978b3['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x915a46[_0x2a8b1c(0x2be)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x313812['toFixed'](0x4)});});const _0x5db381=XLSX[_0x1a76ae(0x107)][_0x1a76ae(0x101)](_0x182ae8),_0x244592=XLSX[_0x1a76ae(0x107)][_0x1a76ae(0x178)]();XLSX[_0x1a76ae(0x107)][_0x1a76ae(0x2d2)](_0x244592,_0x5db381,_0x584d13[_0x1a76ae(0x1f3)]),_0x5db381[_0x584d13['BdQRF']]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0x12},{'wch':0xf},{'wch':0x12},{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0x12},{'wch':0x12}];const _0x5f2410=new Date()[_0x1a76ae(0x142)]()[_0x1a76ae(0x26b)]('T')[0x0];let _0x23ffc8=_0x1a76ae(0xbd);if(_0x584d13[_0x1a76ae(0x1ae)](_0x584d13[_0x1a76ae(0x215)],_0x4b6477)){if(Array[_0x1a76ae(0x2d1)](_0x4b6477))_0x23ffc8+='_Trains_'+_0x4b6477[_0x1a76ae(0x1dd)]((_0x3daba1,_0x2bce4d)=>_0x3daba1-_0x2bce4d)[_0x1a76ae(0x281)]('_');else _0x23ffc8+=_0x1a76ae(0x263)+_0x4b6477;}_0x23ffc8+='_'+_0x5f2410+_0x1a76ae(0x2a8),XLSX[_0x1a76ae(0x165)](_0x244592,_0x23ffc8),_0x584d13['kzAMW'](hideLoader),_0x584d13[_0x1a76ae(0xcc)](showCustomAlert,_0x584d13[_0x1a76ae(0x262)],_0x1a76ae(0x2cd));})['catch'](_0x1b6568=>{const _0xa27f8a=_0x495459;console[_0xa27f8a(0x93)](_0x584d13[_0xa27f8a(0xcf)],_0x1b6568),_0x584d13['kzAMW'](hideLoader),_0x584d13[_0xa27f8a(0xcc)](showCustomAlert,_0x584d13[_0xa27f8a(0x13b)],_0x584d13[_0xa27f8a(0x99)]);});}export function exportDetergentMacoToExcel(_0x15dfa7=a13_0x128c95(0x143)){const _0x505d3c=a13_0x128c95,_0x3dea04={'kppZa':function(_0x2b989e,_0x4c434d){return _0x2b989e(_0x4c434d);},'UxESj':function(_0x5436b5,_0x3574c2){return _0x5436b5/_0x3574c2;},'vxcMB':function(_0x4b15a1,_0x3804be){return _0x4b15a1*_0x3804be;},'TnKyJ':function(_0x78c2eb,_0x4fb82e){return _0x78c2eb*_0x4fb82e;},'pDaKV':_0x505d3c(0x1a6),'jeMZU':'N/A','hvJcl':function(_0x11b65d,_0x15cf2d){return _0x11b65d||_0x15cf2d;},'Keacw':function(_0x4aaf60){return _0x4aaf60();},'cnEWT':function(_0x4f15b2,_0x3213fd){return _0x4f15b2!==_0x3213fd;},'DzjYl':function(_0x616743,_0x273431){return _0x616743===_0x273431;},'YzKRt':function(_0x4d6568,_0x341255,_0x324623){return _0x4d6568(_0x341255,_0x324623);},'xUWOP':_0x505d3c(0x1d6),'OXuut':function(_0x116d7f,_0x1e40e3){return _0x116d7f===_0x1e40e3;},'kezSP':'There\x20are\x20no\x20detergent\x20ingredients\x20configured.\x20Add\x20detergent\x20ingredients\x20first.','AIFda':function(_0x41fcc2,_0x559a82){return _0x41fcc2>_0x559a82;},'ShXLO':function(_0x588991,_0x4242d4){return _0x588991(_0x4242d4);},'ikNST':_0x505d3c(0x1b6),'jRxJR':function(_0x2fc0ff,_0x2265ad){return _0x2fc0ff>_0x2265ad;},'tdcIU':_0x505d3c(0xc6),'NWxwX':_0x505d3c(0x139),'WyACD':_0x505d3c(0xa2),'kpypP':function(_0x121b1c){return _0x121b1c();},'qagJg':_0x505d3c(0xa3),'kRhja':_0x505d3c(0x25e),'XrXwq':_0x505d3c(0x293)};_0x3dea04[_0x505d3c(0x244)](showLoader),import(_0x3dea04['XrXwq'])[_0x505d3c(0x19f)](_0x5d6634=>{const _0x5f324f=_0x505d3c,_0x4cd87f={'fRFct':function(_0x23dc8d,_0x48cb0d){return _0x3dea04['hvJcl'](_0x23dc8d,_0x48cb0d);}},{getTrainData:_0x49cf8f,getWorstCaseProductType:_0x164668}=_0x5d6634;let _0x4864cc=_0x3dea04[_0x5f324f(0x244)](_0x49cf8f);if(_0x3dea04[_0x5f324f(0x209)](_0x5f324f(0x143),_0x15dfa7)&&(_0x4864cc=Array['isArray'](_0x15dfa7)?_0x4864cc[_0x5f324f(0xb9)](_0x54e877=>_0x15dfa7[_0x5f324f(0x2ae)](String(_0x54e877['id']))):_0x4864cc[_0x5f324f(0xb9)](_0x5b4a9c=>String(_0x5b4a9c['id'])===String(_0x15dfa7))),_0x3dea04[_0x5f324f(0x18b)](0x0,_0x4864cc[_0x5f324f(0x2c3)]))return hideLoader(),void _0x3dea04['YzKRt'](showCustomAlert,_0x3dea04[_0x5f324f(0x227)],_0x5f324f(0xdb));if(_0x3dea04[_0x5f324f(0x2a2)](0x0,a13_0x53aebc['detergentIngredients']['length']))return hideLoader(),void _0x3dea04['YzKRt'](showCustomAlert,_0x3dea04[_0x5f324f(0x227)],_0x3dea04[_0x5f324f(0x161)]);const _0x1fa84a=[],_0x5991fb=_0x3dea04[_0x5f324f(0xf0)](_0x4864cc[_0x5f324f(0x2c3)],0x0)?Math[_0x5f324f(0xeb)](..._0x4864cc[_0x5f324f(0x252)](_0x18911a=>_0x18911a[_0x5f324f(0x1cc)])):0x0,_0x59f7ff=_0x3dea04[_0x5f324f(0x245)](parseFloat,document['getElementById'](_0x3dea04['ikNST'])?.[_0x5f324f(0x229)])||0x46,_0x419be9=a13_0x53aebc[_0x5f324f(0x2b0)]['map'](_0x16d254=>parseFloat(_0x16d254[_0x5f324f(0xe2)]))[_0x5f324f(0xb9)](_0x531148=>!isNaN(_0x531148)),_0x22f96e=_0x3dea04['jRxJR'](_0x419be9[_0x5f324f(0x2c3)],0x0)?Math[_0x5f324f(0x216)](..._0x419be9):0x0,_0xb84c9d=a13_0x53aebc[_0x5f324f(0x2b0)]['map'](_0x3354a8=>_0x3354a8[_0x5f324f(0x13f)])[_0x5f324f(0xb9)](_0x41c0a2=>''!==_0x41c0a2[_0x5f324f(0xea)]())[_0x5f324f(0x281)](',\x20');_0x4864cc[_0x5f324f(0x185)](_0x1d1fd5=>{const _0x4f07b4=_0x5f324f,_0x4cd7dd=_0x3dea04[_0x4f07b4(0x27e)](_0x164668,_0x1d1fd5[_0x4f07b4(0x28d)][_0x4f07b4(0x252)](_0x28fd4e=>_0x28fd4e[_0x4f07b4(0x10e)])),_0x2311af=a13_0x53aebc[_0x4f07b4(0x268)][_0x4cd7dd]||a13_0x53aebc[_0x4f07b4(0x268)]['Other'],_0x1fb316=document[_0x4f07b4(0xe9)]('sf-input-train-'+_0x1d1fd5['id']),_0x45d8d1=_0x1fb316&&_0x3dea04[_0x4f07b4(0x27e)](parseFloat,_0x1fb316[_0x4f07b4(0x229)])||_0x2311af[_0x4f07b4(0xeb)],_0x1a640b=_0x3dea04['UxESj'](_0x3dea04[_0x4f07b4(0xfe)](0.0005*_0x22f96e,_0x59f7ff),_0x45d8d1),_0x439e29=_0x1a640b*_0x1d1fd5[_0x4f07b4(0x298)],_0x164c5f=_0x5991fb>0x0?_0x3dea04[_0x4f07b4(0x29e)](_0x439e29,_0x5991fb):0x0,_0x56666a=_0x3dea04['TnKyJ'](_0x164c5f,_0x1d1fd5[_0x4f07b4(0x23d)]),_0x55751a=_0x1d1fd5['machineIds'][_0x4f07b4(0x252)](_0x1468a8=>{const _0x4a48fd=_0x4f07b4,_0xe6c542=a13_0x53aebc[_0x4a48fd(0x2d5)][_0x4a48fd(0x12d)](_0x6cfb1b=>_0x6cfb1b['id']===_0x1468a8);return _0x4cd87f[_0x4a48fd(0x2bf)](_0xe6c542,{'name':_0x4a48fd(0x12e)+_0x1468a8+')','machineNumber':_0x4a48fd(0x26a)});}),_0x19bc88=_0x5d6634[_0x4f07b4(0x236)](_0x1d1fd5[_0x4f07b4(0x154)])[_0x4f07b4(0x252)](_0x449810=>_0x449810['isGroup']?_0x449810[_0x4f07b4(0x1a8)]+'\x20('+_0x449810[_0x4f07b4(0x2d0)]+'x)':_0x449810['name'])[_0x4f07b4(0x281)](_0x3dea04['pDaKV']),_0xec97ef=_0x1d1fd5[_0x4f07b4(0x28d)][_0x4f07b4(0x252)](_0x3a2e0d=>_0x3a2e0d[_0x4f07b4(0xc0)]+_0x4f07b4(0x2d3)+_0x3a2e0d[_0x4f07b4(0x13f)])[_0x4f07b4(0x281)](';\x20'),_0x4d8b77=_0x1d1fd5[_0x4f07b4(0x169)]?_0x1d1fd5[_0x4f07b4(0x169)][_0x4f07b4(0x208)]+'\x20('+_0x1d1fd5[_0x4f07b4(0x169)][_0x4f07b4(0x176)]+_0x4f07b4(0x18f)+_0x1d1fd5[_0x4f07b4(0x169)][_0x4f07b4(0x149)]:_0x3dea04[_0x4f07b4(0x20c)];_0x1fa84a[_0x4f07b4(0x180)]({'Train':'T'+_0x1d1fd5['id'],'Total\x20Products':_0x1d1fd5[_0x4f07b4(0x28d)][_0x4f07b4(0x2c3)],'Total\x20Machines':_0x55751a[_0x4f07b4(0x2c3)],'Total\x20Area\x20(ESSA)\x20cm²':_0x1d1fd5[_0x4f07b4(0x1cc)]['toLocaleString'](),'Products':_0xec97ef,'Machines':_0x19bc88,'Worst-Case\x20Dosage\x20Form':_0x4cd7dd,'Safety\x20Factor\x20Range':_0x2311af[_0x4f07b4(0x216)]+_0x4f07b4(0x2d3)+_0x2311af[_0x4f07b4(0xeb)],'Applied\x20Safety\x20Factor':_0x45d8d1,'Detergent\x20Ingredients':_0xb84c9d,'Body\x20Weight\x20(kg)':_0x59f7ff,'Minimum\x20LD50\x20(mg/kg)':_0x22f96e,'Min\x20Batch\x20Size\x20(kg)':_0x1d1fd5[_0x4f07b4(0x9c)],'Min\x20BS/MDD\x20Ratio':_0x1d1fd5[_0x4f07b4(0x298)][_0x4f07b4(0x205)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x4d8b77,'ADI\x20(mg)':_0x1a640b['toFixed'](0x4),'MACO\x20(mg)':_0x439e29[_0x4f07b4(0x205)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x164c5f['toExponential'](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x56666a[_0x4f07b4(0x205)](0x4)});});const _0x62eade=XLSX[_0x5f324f(0x107)][_0x5f324f(0x101)](_0x1fa84a),_0x6fb871=XLSX[_0x5f324f(0x107)][_0x5f324f(0x178)]();XLSX['utils'][_0x5f324f(0x2d2)](_0x6fb871,_0x62eade,_0x5f324f(0x2bc)),_0x62eade[_0x3dea04[_0x5f324f(0x2da)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0x1e},{'wch':0xc},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0xc},{'wch':0xc},{'wch':0x12},{'wch':0x12}];const _0x248dcb=new Date()[_0x5f324f(0x142)]()[_0x5f324f(0x26b)]('T')[0x0];XLSX[_0x5f324f(0x165)](_0x6fb871,_0x5f324f(0x141)+_0x248dcb+_0x5f324f(0x2a8)),hideLoader(),showCustomAlert('Success',_0x3dea04[_0x5f324f(0x2b7)]);})[_0x505d3c(0x134)](_0x211901=>{const _0x3d1270=_0x505d3c;console[_0x3d1270(0x93)](_0x3dea04[_0x3d1270(0x156)],_0x211901),_0x3dea04[_0x3d1270(0x25f)](hideLoader),_0x3dea04[_0x3d1270(0x241)](showCustomAlert,_0x3dea04['qagJg'],_0x3dea04[_0x3d1270(0x126)]);});}export function exportTrainSummaryToExcel(_0x30b576=a13_0x128c95(0x143)){const _0x3d8995=a13_0x128c95,_0x432731={'Iakox':'\x20→\x20','XUxeh':function(_0x43ec66,_0x5a0542){return _0x43ec66!==_0x5a0542;},'duMOW':_0x3d8995(0x26a),'bymQY':function(_0x51c887,_0x2d1f4b){return _0x51c887===_0x2d1f4b;},'jCAml':function(_0x193c97){return _0x193c97();},'JxCgT':function(_0x1d5a74,_0x126552,_0x314fca){return _0x1d5a74(_0x126552,_0x314fca);},'dzWrM':_0x3d8995(0x143),'bhvXD':function(_0x219def,_0x3d5804){return _0x219def===_0x3d5804;},'cfdcZ':function(_0x1a2514){return _0x1a2514();},'iBAMd':'No\x20trains\x20match\x20the\x20selected\x20criteria.','cZTYB':'Train\x20Summary\x20Report','Qnadk':'!cols','odpbF':_0x3d8995(0x251),'qpBCn':function(_0xd43c6f,_0x273fea){return _0xd43c6f!==_0x273fea;},'UDYiC':_0x3d8995(0x243),'LSDIF':_0x3d8995(0xa3),'WQPDx':'Failed\x20to\x20export\x20Train\x20Summary\x20data\x20to\x20Excel.','NpFKV':function(_0x47c0aa){return _0x47c0aa();},'JsQwq':_0x3d8995(0x293)};_0x432731['NpFKV'](showLoader),import(_0x432731[_0x3d8995(0xda)])[_0x3d8995(0x19f)](_0x98c013=>{const _0x5b9e8d=_0x3d8995,_0x3908ee={'LdZkP':_0x432731['duMOW']},{getTrainData:_0x2c85ff}=_0x98c013,_0x339a92=_0x2c85ff();if(_0x432731[_0x5b9e8d(0x104)](0x0,_0x339a92['length']))return _0x432731[_0x5b9e8d(0x151)](hideLoader),void _0x432731[_0x5b9e8d(0xd9)](showCustomAlert,_0x5b9e8d(0x1d6),_0x5b9e8d(0xdb));let _0x55927e=_0x339a92;if(_0x432731[_0x5b9e8d(0x1fa)](_0x432731[_0x5b9e8d(0x117)],_0x30b576)&&(_0x55927e=Array['isArray'](_0x30b576)?_0x339a92[_0x5b9e8d(0xb9)](_0x1f7993=>_0x30b576[_0x5b9e8d(0x2ae)](String(_0x1f7993['id']))):_0x339a92[_0x5b9e8d(0xb9)](_0xac4d53=>String(_0xac4d53['id'])===String(_0x30b576))),_0x432731[_0x5b9e8d(0x175)](0x0,_0x55927e[_0x5b9e8d(0x2c3)]))return _0x432731[_0x5b9e8d(0x90)](hideLoader),void _0x432731[_0x5b9e8d(0xd9)](showCustomAlert,'No\x20Data',_0x432731[_0x5b9e8d(0x261)]);const _0x4b14e0=[];_0x55927e[_0x5b9e8d(0x185)](_0x137168=>{const _0x48fca8=_0x5b9e8d,_0x2288a3=_0x137168[_0x48fca8(0x154)][_0x48fca8(0x252)](_0x46fd8c=>{const _0x4c387e=_0x48fca8,_0x323139=a13_0x53aebc[_0x4c387e(0x2d5)]['find'](_0x1978d4=>_0x1978d4['id']===_0x46fd8c);return _0x323139||{'id':_0x46fd8c,'name':_0x4c387e(0x12e)+_0x46fd8c+')','machineNumber':_0x3908ee[_0x4c387e(0x1e0)]};}),_0x53be85=_0x98c013[_0x48fca8(0x236)](_0x137168[_0x48fca8(0x154)])[_0x48fca8(0x252)](_0x45ca88=>_0x45ca88[_0x48fca8(0x2b9)]?_0x45ca88['group']+'\x20('+_0x45ca88[_0x48fca8(0x2d0)]+'x)':_0x45ca88['name'])[_0x48fca8(0x281)](_0x432731['Iakox']),_0x928341=_0x137168[_0x48fca8(0x28d)]['map'](_0x10fa08=>_0x10fa08[_0x48fca8(0xc0)]+_0x48fca8(0x2d3)+_0x10fa08['name'])[_0x48fca8(0x281)](';\x20'),_0x5ab871=_0x137168[_0x48fca8(0x28d)][_0x48fca8(0x252)](_0x20853e=>_0x20853e[_0x48fca8(0xc0)]+':\x20'+_0x20853e[_0x48fca8(0x13f)])[_0x48fca8(0x281)]('\x0a'),_0xfdaa16=_0x2288a3[_0x48fca8(0x252)](_0x107d6b=>_0x107d6b['machineNumber']+':\x20'+_0x107d6b[_0x48fca8(0x13f)])[_0x48fca8(0x281)]('\x0a');_0x4b14e0[_0x48fca8(0x180)]({'Train\x20ID':'T'+_0x137168['id'],'Products\x20Count':_0x137168[_0x48fca8(0x28d)][_0x48fca8(0x2c3)],'Machines\x20Count':_0x2288a3[_0x48fca8(0x2c3)],'Total\x20Area\x20(ESSA)\x20cm²':_0x137168[_0x48fca8(0x1cc)][_0x48fca8(0x2c5)](),'Products\x20(Code\x20-\x20Name)':_0x928341,'Machines\x20(Number\x20-\x20Name)':_0x53be85,'Products\x20Detailed':_0x5ab871,'Machines\x20Detailed':_0xfdaa16,'Min\x20Batch\x20Size\x20(kg)':_0x137168[_0x48fca8(0x9c)],'Min\x20BS/MDD\x20Ratio':_0x137168[_0x48fca8(0x298)]['toFixed'](0x2),'Assumed\x20SSA\x20(cm²)':_0x137168[_0x48fca8(0x23d)],'Lowest\x20LTD\x20(mg)':_0x137168[_0x48fca8(0x106)],'Lowest\x20PDE\x20(mg)':_0x432731[_0x48fca8(0x1fa)](null,_0x137168[_0x48fca8(0xbb)])?_0x137168[_0x48fca8(0xbb)]:_0x432731['duMOW'],'Worst\x20RPN\x20Product':_0x137168[_0x48fca8(0x169)]?_0x137168[_0x48fca8(0x169)][_0x48fca8(0x208)]+'\x20('+_0x137168[_0x48fca8(0x169)][_0x48fca8(0x176)]+')\x20-\x20RPN:\x20'+_0x137168[_0x48fca8(0x169)][_0x48fca8(0x149)]:_0x432731[_0x48fca8(0x21e)]});});const _0x48e74a=XLSX[_0x5b9e8d(0x107)][_0x5b9e8d(0x101)](_0x4b14e0),_0x75d0d5=XLSX['utils']['book_new']();XLSX[_0x5b9e8d(0x107)][_0x5b9e8d(0x2d2)](_0x75d0d5,_0x48e74a,_0x432731[_0x5b9e8d(0x16d)]),_0x48e74a[_0x432731[_0x5b9e8d(0x12c)]]=[{'wch':0xa},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x3c},{'wch':0x3c},{'wch':0x28},{'wch':0x28},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32}];const _0x53eed4=new Date()['toISOString']()['split']('T')[0x0];let _0x3cff86=_0x432731[_0x5b9e8d(0x275)];if(_0x432731[_0x5b9e8d(0xcb)](_0x432731[_0x5b9e8d(0x117)],_0x30b576)){if(Array[_0x5b9e8d(0x2d1)](_0x30b576))_0x3cff86+=_0x5b9e8d(0x2c6)+_0x30b576[_0x5b9e8d(0x1dd)]((_0x59f374,_0x5309c9)=>_0x59f374-_0x5309c9)[_0x5b9e8d(0x281)]('_');else _0x3cff86+=_0x5b9e8d(0x263)+_0x30b576;}_0x3cff86+='_'+_0x53eed4+'.xlsx',XLSX[_0x5b9e8d(0x165)](_0x75d0d5,_0x3cff86),_0x432731['cfdcZ'](hideLoader),showCustomAlert(_0x432731[_0x5b9e8d(0x9f)],_0x5b9e8d(0xde));})[_0x3d8995(0x134)](_0x5cf0a8=>{const _0x46f862=_0x3d8995;console['error'](_0x46f862(0x23b),_0x5cf0a8),_0x432731[_0x46f862(0x90)](hideLoader),showCustomAlert(_0x432731['LSDIF'],_0x432731[_0x46f862(0x2ca)]);});}export function exportSummaryToExcel(){const _0x5e5093=a13_0x128c95,_0x35e91d={'mbqUp':function(_0x13609c,_0x21b15b){return _0x13609c(_0x21b15b);},'bayNL':function(_0xa29ea6,_0x1316fd){return _0xa29ea6>_0x1316fd;},'odMRW':_0x5e5093(0x26a),'ASNaB':'Yes','skuSr':function(_0x13e97b,_0x2764f0){return _0x13e97b===_0x2764f0;},'vGdak':function(_0x561692){return _0x561692();},'zanNV':function(_0x4ef866,_0x12e9f2,_0x3c52ee){return _0x4ef866(_0x12e9f2,_0x3c52ee);},'xOSVZ':'No\x20Data','VzBil':'!cols','JEzcc':_0x5e5093(0x2c8),'cUdKO':_0x5e5093(0x138),'kSdvJ':'Success','ZOXez':_0x5e5093(0x2a5),'ZDrFF':_0x5e5093(0x1ab),'RMcUF':function(_0x298f90){return _0x298f90();},'mzPmX':'Error','VgVtb':'Failed\x20to\x20export\x20Summary\x20report\x20data\x20to\x20Excel.','oqOLh':_0x5e5093(0x293)};_0x35e91d['vGdak'](showLoader),import(_0x35e91d[_0x5e5093(0x28e)])['then'](_0x19f3d3=>{const _0x2df2b3=_0x5e5093,_0x4a5feb={'ehcet':function(_0x3a5f74,_0x554363){const _0x3d4d74=a13_0x4551;return _0x35e91d[_0x3d4d74(0x124)](_0x3a5f74,_0x554363);},'oBAwi':function(_0x337304,_0x3d8053){const _0x101582=a13_0x4551;return _0x35e91d[_0x101582(0x21a)](_0x337304,_0x3d8053);},'lYnyy':function(_0x4fe625,_0x5b4eaa){return _0x4fe625!==_0x5b4eaa;},'EySSw':_0x35e91d['odMRW'],'WxIqF':_0x35e91d['ASNaB']},{getProductTrainId:_0x256077,calculateScores:_0x3357fb}=_0x19f3d3,_0x5dca2c=a13_0x53aebc[_0x2df2b3(0x28d)][_0x2df2b3(0x1a4)](_0x105cbf=>{const _0x516c7f=_0x2df2b3,_0x5ad7f5=_0x35e91d[_0x516c7f(0x124)](_0x256077,_0x105cbf);return _0x105cbf[_0x516c7f(0x23c)][_0x516c7f(0x252)](_0x339261=>({'productName':_0x105cbf['name'],'productCode':_0x105cbf['productCode'],'ingredientName':_0x339261[_0x516c7f(0x13f)],'rpn':_0x3357fb(_0x339261)[_0x516c7f(0x149)],'trainId':'N/A'!==_0x5ad7f5?'T'+_0x5ad7f5:'N/A','scores':_0x3357fb(_0x339261)}));})[_0x2df2b3(0x1dd)]((_0x546bef,_0x48c84f)=>_0x48c84f['rpn']-_0x546bef[_0x2df2b3(0x149)])[_0x2df2b3(0x12a)](0x0,0xa),_0x282071=a13_0x53aebc[_0x2df2b3(0x28d)][_0x2df2b3(0xb9)](_0x184172=>_0x184172[_0x2df2b3(0x147)]);if(_0x35e91d[_0x2df2b3(0x24f)](0x0,_0x5dca2c[_0x2df2b3(0x2c3)])&&_0x35e91d[_0x2df2b3(0x24f)](0x0,_0x282071[_0x2df2b3(0x2c3)]))return _0x35e91d[_0x2df2b3(0x16e)](hideLoader),void _0x35e91d[_0x2df2b3(0x15b)](showCustomAlert,_0x35e91d['xOSVZ'],_0x2df2b3(0x1da));const _0x958aba=XLSX[_0x2df2b3(0x107)][_0x2df2b3(0x178)]();if(_0x35e91d[_0x2df2b3(0x21a)](_0x5dca2c['length'],0x0)){const _0x179ceb=_0x5dca2c[_0x2df2b3(0x252)]((_0x43982a,_0x1b1d34)=>({'Rank':_0x1b1d34+0x1,'Product\x20Code':_0x43982a[_0x2df2b3(0xc0)],'Product\x20Name':_0x43982a[_0x2df2b3(0x208)],'Train':_0x43982a[_0x2df2b3(0x280)],'Ingredient':_0x43982a[_0x2df2b3(0x176)],'RPN':_0x43982a[_0x2df2b3(0x149)]})),_0x579a60=XLSX[_0x2df2b3(0x107)][_0x2df2b3(0x101)](_0x179ceb),_0x152a47=[{'wch':0x8},{'wch':0xf},{'wch':0x1e},{'wch':0xa},{'wch':0x19},{'wch':0x8}];_0x579a60[_0x35e91d[_0x2df2b3(0x249)]]=_0x152a47,XLSX[_0x2df2b3(0x107)][_0x2df2b3(0x2d2)](_0x958aba,_0x579a60,_0x35e91d['JEzcc']);}if(_0x282071[_0x2df2b3(0x2c3)]>0x0){const _0x33104f=_0x282071['map'](_0x182441=>({'Product\x20Code':_0x182441[_0x2df2b3(0xc0)],'Product\x20Name':_0x182441[_0x2df2b3(0x13f)],'Product\x20Type':_0x182441[_0x2df2b3(0x10e)],'Batch\x20Size\x20(kg)':_0x182441['batchSizeKg'],'MDD\x20(mg)':_0x182441[_0x2df2b3(0x221)],'Critical\x20Reason':_0x182441[_0x2df2b3(0x12f)]||_0x2df2b3(0x1ef),'Train':_0x2df2b3(0x26a)!==_0x256077(_0x182441)?'T'+_0x256077(_0x182441):_0x2df2b3(0x26a)})),_0x3e562c=XLSX[_0x2df2b3(0x107)][_0x2df2b3(0x101)](_0x33104f),_0x501b4c=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32},{'wch':0xa}];_0x3e562c[_0x2df2b3(0xc6)]=_0x501b4c,XLSX[_0x2df2b3(0x107)][_0x2df2b3(0x2d2)](_0x958aba,_0x3e562c,_0x35e91d[_0x2df2b3(0xc2)]);}const _0xba09df=a13_0x53aebc['products'][_0x2df2b3(0x252)](_0xadcf12=>{const _0x4d6ae1=_0x2df2b3,_0x2b941e={'bZveL':function(_0x3691fb,_0x4e4d20){const _0x12527b=a13_0x4551;return _0x4a5feb[_0x12527b(0x2ac)](_0x3691fb,_0x4e4d20);},'AgKcx':function(_0x28dc83,_0x3623a2){const _0x5396d2=a13_0x4551;return _0x4a5feb[_0x5396d2(0x9d)](_0x28dc83,_0x3623a2);}},_0x3e6f8c=_0x4a5feb[_0x4d6ae1(0x2ac)](_0x256077,_0xadcf12),_0x188a47=_0xadcf12[_0x4d6ae1(0x23c)][_0x4d6ae1(0x1de)]((_0x3a609f,_0x505ad7)=>{const _0xa0b9d0=_0x4d6ae1,_0x19827d=_0x2b941e[_0xa0b9d0(0x159)](_0x3357fb,_0x505ad7)[_0xa0b9d0(0x149)];return _0x2b941e[_0xa0b9d0(0x220)](_0x19827d,_0x3a609f['rpn'])?{..._0x505ad7,'rpn':_0x19827d}:_0x3a609f;},{'rpn':0x0,'name':'N/A'});return{'Product\x20Code':_0xadcf12[_0x4d6ae1(0xc0)],'Product\x20Name':_0xadcf12['name'],'Product\x20Type':_0xadcf12['productType'],'Batch\x20Size\x20(kg)':_0xadcf12[_0x4d6ae1(0x2c4)],'MDD\x20(mg)':_0xadcf12[_0x4d6ae1(0x221)],'Train':_0x4a5feb[_0x4d6ae1(0x13e)](_0x4a5feb[_0x4d6ae1(0xb4)],_0x3e6f8c)?'T'+_0x3e6f8c:_0x4a5feb[_0x4d6ae1(0xb4)],'Is\x20Critical':_0xadcf12['isCritical']?_0x4a5feb[_0x4d6ae1(0xd4)]:'No','Critical\x20Reason':_0xadcf12[_0x4d6ae1(0x12f)]||_0x4a5feb[_0x4d6ae1(0xb4)],'Ingredients\x20Count':_0xadcf12['activeIngredients'][_0x4d6ae1(0x2c3)],'Highest\x20RPN\x20Ingredient':_0x188a47[_0x4d6ae1(0x13f)],'Highest\x20RPN\x20Value':_0x188a47[_0x4d6ae1(0x149)]||0x0};}),_0x5822dc=XLSX[_0x2df2b3(0x107)][_0x2df2b3(0x101)](_0xba09df);_0x5822dc[_0x35e91d[_0x2df2b3(0x249)]]=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xa},{'wch':0xa},{'wch':0x28},{'wch':0xc},{'wch':0x19},{'wch':0xc}],XLSX[_0x2df2b3(0x107)][_0x2df2b3(0x2d2)](_0x958aba,_0x5822dc,_0x2df2b3(0x1ba));const _0x28037c=new Date()[_0x2df2b3(0x142)]()['split']('T')[0x0];XLSX[_0x2df2b3(0x165)](_0x958aba,_0x2df2b3(0x129)+_0x28037c+_0x2df2b3(0x2a8)),_0x35e91d[_0x2df2b3(0x16e)](hideLoader),_0x35e91d[_0x2df2b3(0x15b)](showCustomAlert,_0x35e91d[_0x2df2b3(0x2a1)],_0x35e91d[_0x2df2b3(0x22b)]);})[_0x5e5093(0x134)](_0x1f8a42=>{const _0x533a52=_0x5e5093;console[_0x533a52(0x93)](_0x35e91d[_0x533a52(0x167)],_0x1f8a42),_0x35e91d['RMcUF'](hideLoader),_0x35e91d[_0x533a52(0x15b)](showCustomAlert,_0x35e91d['mzPmX'],_0x35e91d[_0x533a52(0x238)]);});}export function exportAllTabsToExcel(){const _0x216d9f=a13_0x128c95,_0x119fac={'TTIEQ':function(_0x4bf48c,_0x12a3d7){return _0x4bf48c(_0x12a3d7);},'jGnJp':function(_0x2d0555,_0x1d5153){return _0x2d0555/_0x1d5153;},'LLiRw':function(_0x418ca8,_0x4840a1){return _0x418ca8*_0x4840a1;},'ctYnd':function(_0xcd882b,_0x4e1d5b){return _0xcd882b!==_0x4e1d5b;},'ZGAuY':_0x216d9f(0x254),'TdJIe':_0x216d9f(0x14b),'AdiRN':function(_0x3cd2c5,_0x3c73b2){return _0x3cd2c5==_0x3c73b2;},'IggsK':_0x216d9f(0x1f8),'jmhPM':_0x216d9f(0x15d),'bhvQL':function(_0x891a1d,_0x410591){return _0x891a1d/_0x410591;},'VZawt':_0x216d9f(0x1a6),'Coasc':_0x216d9f(0x26a),'AOWUj':function(_0x52281e,_0x37c05b){return _0x52281e||_0x37c05b;},'pChqM':function(_0x388f3d,_0x1f8b75){return _0x388f3d*_0x1f8b75;},'CgUOf':function(_0x25d141,_0x3798e0){return _0x25d141/_0x3798e0;},'gulqG':function(_0x55521f,_0x1b077e){return _0x55521f*_0x1b077e;},'webgh':function(_0x3af4b0,_0x6f8bb5){return _0x3af4b0||_0x6f8bb5;},'KRdXn':function(_0x5047bb,_0x143ae2){return _0x5047bb(_0x143ae2);},'DrHgK':_0x216d9f(0x1b7),'frZcJ':_0x216d9f(0x199),'kuNMn':function(_0x21b69d){return _0x21b69d();},'ALyCh':function(_0x392597){return _0x392597();},'yIzHS':'No\x20Data','VvQDG':'There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','JGHjp':_0x216d9f(0x1a2),'zFNvy':_0x216d9f(0x1ed),'JHHBz':function(_0x146f71,_0x4878d4){return _0x146f71>_0x4878d4;},'QKDkb':function(_0x40193a,_0x346294){return _0x40193a(_0x346294);},'gcnBF':_0x216d9f(0x1b6),'YwNKn':_0x216d9f(0x2d8),'YGXbR':_0x216d9f(0x194),'aNYUF':function(_0x3c0cfd,_0x258deb){return _0x3c0cfd>_0x258deb;},'yhDuz':_0x216d9f(0x138),'NeCVh':_0x216d9f(0x179),'oghgN':_0x216d9f(0x1ba),'ZbBes':_0x216d9f(0x1bc),'gSDLD':function(_0x1b484c){return _0x1b484c();},'iiady':'Complete\x20report\x20with\x20all\x20tabs\x20exported\x20to\x20Excel\x20successfully!','XVZwl':_0x216d9f(0x111),'YxSKY':function(_0x4597c0,_0x4d2d47,_0x586f40){return _0x4597c0(_0x4d2d47,_0x586f40);},'ZHoLx':_0x216d9f(0xa3),'AniXI':_0x216d9f(0x1e3)};showLoader(),import('./utils.js')[_0x216d9f(0x19f)](_0x2d6e54=>{const _0x188dff=_0x216d9f,_0x238e9b={'EbwDX':function(_0x37ca01,_0x55dbc6){return _0x37ca01||_0x55dbc6;},'NOGWd':_0x188dff(0x26a),'gBdsT':function(_0x2b2a4d,_0x39e173){return _0x119fac['KRdXn'](_0x2b2a4d,_0x39e173);},'hyoMt':function(_0x31ebaa,_0x4ce6e0){return _0x31ebaa>_0x4ce6e0;},'tUJvI':function(_0x839b98,_0x37cb94){const _0x274d62=_0x188dff;return _0x119fac[_0x274d62(0xb1)](_0x839b98,_0x37cb94);},'RrFsb':_0x119fac[_0x188dff(0x1fd)],'otLks':_0x119fac[_0x188dff(0x1d7)]},{getTrainData:_0x11cdd5,getWorstCaseProductType:_0x497d36,getProductTrainId:_0x4064af,calculateScores:_0x245ffa}=_0x2d6e54,_0x30a682=_0x119fac[_0x188dff(0x170)](_0x11cdd5);if(0x0===_0x30a682[_0x188dff(0x2c3)])return _0x119fac[_0x188dff(0x255)](hideLoader),void showCustomAlert(_0x119fac[_0x188dff(0x133)],_0x119fac['VvQDG']);const _0x2f267e=XLSX[_0x188dff(0x107)]['book_new']();try{const _0x22a529=_0x30a682[_0x188dff(0x1de)]((_0x270324,_0x48b345)=>_0x48b345[_0x188dff(0x1cc)]>_0x270324[_0x188dff(0x1cc)]?_0x48b345:_0x270324)[_0x188dff(0x1cc)],_0x5d4971=[];_0x30a682['forEach'](_0x595d34=>{const _0x594092=_0x188dff,_0x1553a6=_0x119fac['TTIEQ'](_0x497d36,_0x595d34['products']['map'](_0xbff5ce=>_0xbff5ce[_0x594092(0x10e)])),_0x47a9f9=(a13_0x53aebc[_0x594092(0x268)][_0x1553a6]||a13_0x53aebc[_0x594092(0x268)][_0x594092(0x2cc)])['max'],_0x4daae6=_0x119fac[_0x594092(0x29a)](_0x119fac['LLiRw'](_0x595d34['lowestLtd'],_0x595d34[_0x594092(0x298)]),_0x47a9f9),_0x25fc6b=0xa*_0x595d34[_0x594092(0x9c)];let _0x143f86=_0x594092(0x26a);_0x119fac[_0x594092(0xb1)](null,_0x595d34[_0x594092(0xbb)])&&(_0x143f86=_0x595d34[_0x594092(0xbb)]*_0x595d34['minBsMddRatio']);const _0x50afb3=0.004*_0x22a529,_0x244702=[{'name':_0x594092(0x108),'value':_0x4daae6},{'name':_0x119fac[_0x594092(0x18a)],'value':_0x25fc6b},{'name':_0x119fac['TdJIe'],'value':_0x119fac[_0x594092(0x16c)](_0x119fac['IggsK'],typeof _0x143f86)?_0x143f86:0x1/0x0},{'name':_0x119fac[_0x594092(0x2cb)],'value':_0x50afb3}][_0x594092(0x1de)]((_0x50fab6,_0x177970)=>_0x177970[_0x594092(0x229)]<_0x50fab6[_0x594092(0x229)]?_0x177970:_0x50fab6),_0x1faa69=_0x244702[_0x594092(0x229)],_0x2a7d05=_0x22a529>0x0?_0x119fac[_0x594092(0x123)](_0x1faa69,_0x22a529):0x0,_0xd71f1e=_0x119fac['LLiRw'](_0x2a7d05,_0x595d34['assumedSsa']),_0x206030=_0x595d34[_0x594092(0x154)][_0x594092(0x252)](_0x260c35=>{const _0x2bc203=_0x594092,_0x1a9f92=a13_0x53aebc[_0x2bc203(0x2d5)][_0x2bc203(0x12d)](_0x5dafb2=>_0x5dafb2['id']===_0x260c35);return _0x238e9b[_0x2bc203(0x1f9)](_0x1a9f92,{'name':_0x2bc203(0x12e)+_0x260c35+')','machineNumber':_0x238e9b[_0x2bc203(0x190)]});}),_0x1968a6=_0x2d6e54[_0x594092(0x236)](_0x595d34['machineIds'])[_0x594092(0x252)](_0x56462d=>_0x56462d['isGroup']?_0x56462d[_0x594092(0x1a8)]+'\x20('+_0x56462d[_0x594092(0x2d0)]+'x)':_0x56462d[_0x594092(0x13f)])['join'](_0x119fac[_0x594092(0x2b5)]),_0x4ae44a=_0x595d34['products']['map'](_0x55efd8=>_0x55efd8[_0x594092(0xc0)]+_0x594092(0x2d3)+_0x55efd8[_0x594092(0x13f)])['join'](';\x20'),_0x18b3b1=_0x595d34['worstProductRpn']?_0x595d34[_0x594092(0x169)]['productName']+'\x20('+_0x595d34['worstProductRpn'][_0x594092(0x176)]+')\x20-\x20RPN:\x20'+_0x595d34[_0x594092(0x169)][_0x594092(0x149)]:_0x119fac[_0x594092(0x1a7)];_0x5d4971[_0x594092(0x180)]({'Train':'T'+_0x595d34['id'],'Total\x20Products':_0x595d34['products'][_0x594092(0x2c3)],'Total\x20Machines':_0x206030[_0x594092(0x2c3)],'Total\x20Area\x20(ESSA)\x20cm²':_0x595d34[_0x594092(0x1cc)][_0x594092(0x2c5)](),'Products':_0x4ae44a,'Machines':_0x1968a6,'Worst-Case\x20Dosage\x20Form':_0x1553a6,'Safety\x20Factor':_0x47a9f9,'Lowest\x20LTD\x20(mg)':_0x595d34['lowestLtd'],'Min\x20Batch\x20Size\x20(kg)':_0x595d34[_0x594092(0x9c)],'Min\x20BS/MDD\x20Ratio':_0x595d34[_0x594092(0x298)][_0x594092(0x205)](0x2),'Lowest\x20PDE\x20(mg)':null!==_0x595d34['lowestPde']?_0x595d34[_0x594092(0xbb)]:_0x594092(0x26a),'Worst-Case\x20Product\x20(by\x20RPN)':_0x18b3b1,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x4daae6[_0x594092(0x205)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x25fc6b[_0x594092(0x205)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x119fac[_0x594092(0x16c)](_0x119fac['IggsK'],typeof _0x143f86)?_0x143f86[_0x594092(0x205)](0x2):_0x119fac['Coasc'],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x50afb3[_0x594092(0x205)](0x2),'Selected\x20MACO\x20Method':_0x244702['name'],'Final\x20MACO\x20(mg)':_0x1faa69[_0x594092(0x205)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x2a7d05['toExponential'](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0xd71f1e[_0x594092(0x205)](0x4)});});const _0x56cc27=XLSX[_0x188dff(0x107)][_0x188dff(0x101)](_0x5d4971);XLSX[_0x188dff(0x107)][_0x188dff(0x2d2)](_0x2f267e,_0x56cc27,_0x119fac[_0x188dff(0x1c9)]);}catch(_0xf928c8){console[_0x188dff(0x93)](_0x119fac[_0x188dff(0xac)],_0xf928c8);}try{if(a13_0x53aebc[_0x188dff(0x2b0)][_0x188dff(0x2c3)]>0x0){const _0x48ac6c=_0x119fac[_0x188dff(0x1c6)](_0x30a682[_0x188dff(0x2c3)],0x0)?Math[_0x188dff(0xeb)](..._0x30a682[_0x188dff(0x252)](_0x33ba44=>_0x33ba44[_0x188dff(0x1cc)])):0x0,_0x176ca2=_0x119fac[_0x188dff(0x2c1)](parseFloat,document['getElementById'](_0x119fac[_0x188dff(0x22a)])?.[_0x188dff(0x229)])||0x46,_0xb96018=a13_0x53aebc[_0x188dff(0x2b0)][_0x188dff(0x252)](_0x31a6bb=>parseFloat(_0x31a6bb[_0x188dff(0xe2)]))[_0x188dff(0xb9)](_0x3f7381=>!isNaN(_0x3f7381)),_0x3a2f84=_0xb96018[_0x188dff(0x2c3)]>0x0?Math['min'](..._0xb96018):0x0,_0x5ef9d5=a13_0x53aebc['detergentIngredients'][_0x188dff(0x252)](_0x426342=>_0x426342['name'])[_0x188dff(0xb9)](_0x434e33=>''!==_0x434e33[_0x188dff(0xea)]())['join'](',\x20'),_0x1a13e2=[];_0x30a682['forEach'](_0x348e39=>{const _0x3a0ee5=_0x188dff,_0x4e0c25={'QOLIM':function(_0x115b48,_0x408d1d){return _0x119fac['AOWUj'](_0x115b48,_0x408d1d);},'YJKDC':_0x119fac[_0x3a0ee5(0x1a7)]},_0x455aef=_0x497d36(_0x348e39[_0x3a0ee5(0x28d)]['map'](_0x361c5f=>_0x361c5f[_0x3a0ee5(0x10e)])),_0x2ac63e=a13_0x53aebc[_0x3a0ee5(0x268)][_0x455aef]||a13_0x53aebc['safetyFactorConfig'][_0x3a0ee5(0x2cc)],_0x3eae71=document[_0x3a0ee5(0xe9)](_0x3a0ee5(0xf6)+_0x348e39['id']),_0x4cc471=_0x3eae71&&parseFloat(_0x3eae71['value'])||_0x2ac63e[_0x3a0ee5(0xeb)],_0x53a6fb=_0x119fac[_0x3a0ee5(0x29a)](_0x119fac[_0x3a0ee5(0xdc)](0.0005,_0x3a2f84)*_0x176ca2,_0x4cc471),_0x16e08c=_0x119fac[_0x3a0ee5(0x12b)](_0x53a6fb,_0x348e39[_0x3a0ee5(0x298)]),_0x43d558=_0x48ac6c>0x0?_0x119fac[_0x3a0ee5(0x11e)](_0x16e08c,_0x48ac6c):0x0,_0x59393c=_0x119fac[_0x3a0ee5(0x1a1)](_0x43d558,_0x348e39['assumedSsa']),_0x313b27=_0x348e39[_0x3a0ee5(0x154)][_0x3a0ee5(0x252)](_0x2f4ab8=>{const _0xe38087=_0x3a0ee5,_0x156bbc=a13_0x53aebc[_0xe38087(0x2d5)]['find'](_0x4e5b8a=>_0x4e5b8a['id']===_0x2f4ab8);return _0x4e0c25[_0xe38087(0x21f)](_0x156bbc,{'name':_0xe38087(0x12e)+_0x2f4ab8+')','machineNumber':_0x4e0c25[_0xe38087(0x168)]});}),_0x3ec1f7=_0x2d6e54['consolidateMachinesByGroup'](_0x348e39[_0x3a0ee5(0x154)])[_0x3a0ee5(0x252)](_0xe40747=>_0xe40747[_0x3a0ee5(0x2b9)]?_0xe40747[_0x3a0ee5(0x1a8)]+'\x20('+_0xe40747[_0x3a0ee5(0x2d0)]+'x)':_0xe40747[_0x3a0ee5(0x13f)])[_0x3a0ee5(0x281)](_0x119fac[_0x3a0ee5(0x2b5)]),_0x5e7474=_0x348e39[_0x3a0ee5(0x28d)][_0x3a0ee5(0x252)](_0x5c6642=>_0x5c6642[_0x3a0ee5(0xc0)]+_0x3a0ee5(0x2d3)+_0x5c6642[_0x3a0ee5(0x13f)])[_0x3a0ee5(0x281)](';\x20'),_0x1bb596=_0x348e39['worstProductRpn']?_0x348e39[_0x3a0ee5(0x169)][_0x3a0ee5(0x208)]+'\x20('+_0x348e39[_0x3a0ee5(0x169)][_0x3a0ee5(0x176)]+')\x20-\x20RPN:\x20'+_0x348e39['worstProductRpn']['rpn']:_0x119fac[_0x3a0ee5(0x1a7)];_0x1a13e2['push']({'Train':'T'+_0x348e39['id'],'Total\x20Products':_0x348e39[_0x3a0ee5(0x28d)]['length'],'Total\x20Machines':_0x313b27[_0x3a0ee5(0x2c3)],'Total\x20Area\x20(ESSA)\x20cm²':_0x348e39['essa'][_0x3a0ee5(0x2c5)](),'Products':_0x5e7474,'Machines':_0x3ec1f7,'Worst-Case\x20Dosage\x20Form':_0x455aef,'Safety\x20Factor\x20Range':_0x2ac63e[_0x3a0ee5(0x216)]+_0x3a0ee5(0x2d3)+_0x2ac63e[_0x3a0ee5(0xeb)],'Applied\x20Safety\x20Factor':_0x4cc471,'Detergent\x20Ingredients':_0x5ef9d5,'Body\x20Weight\x20(kg)':_0x176ca2,'Minimum\x20LD50\x20(mg/kg)':_0x3a2f84,'Min\x20Batch\x20Size\x20(kg)':_0x348e39[_0x3a0ee5(0x9c)],'Min\x20BS/MDD\x20Ratio':_0x348e39['minBsMddRatio'][_0x3a0ee5(0x205)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x1bb596,'ADI\x20(mg)':_0x53a6fb[_0x3a0ee5(0x205)](0x4),'MACO\x20(mg)':_0x16e08c['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x43d558['toExponential'](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x59393c[_0x3a0ee5(0x205)](0x4)});});const _0x27924e=XLSX[_0x188dff(0x107)]['json_to_sheet'](_0x1a13e2);XLSX[_0x188dff(0x107)][_0x188dff(0x2d2)](_0x2f267e,_0x27924e,_0x188dff(0x125));}}catch(_0x484af8){console[_0x188dff(0x93)](_0x119fac[_0x188dff(0x24a)],_0x484af8);}try{const _0x297928=[];_0x30a682['forEach'](_0x2d3f8d=>{const _0x445aac=_0x188dff,_0x297dd7={'lwpRV':function(_0x2d9460,_0x4366b5){return _0x119fac['webgh'](_0x2d9460,_0x4366b5);}},_0x2087a2=_0x2d3f8d[_0x445aac(0x154)][_0x445aac(0x252)](_0x1478f1=>{const _0x1561db=_0x445aac,_0x579d2f=a13_0x53aebc[_0x1561db(0x2d5)][_0x1561db(0x12d)](_0x49a688=>_0x49a688['id']===_0x1478f1);return _0x297dd7[_0x1561db(0x206)](_0x579d2f,{'id':_0x1478f1,'name':_0x1561db(0x12e)+_0x1478f1+')','machineNumber':'N/A'});}),_0x4ed036=_0x2d6e54[_0x445aac(0x236)](_0x2d3f8d['machineIds'])[_0x445aac(0x252)](_0x3f7f27=>_0x3f7f27[_0x445aac(0x2b9)]?_0x3f7f27[_0x445aac(0x1a8)]+'\x20('+_0x3f7f27['machineCount']+'x)':_0x3f7f27['name'])[_0x445aac(0x281)](_0x445aac(0x1a6)),_0x3a2e0b=_0x2d3f8d['products'][_0x445aac(0x252)](_0x70077d=>_0x70077d[_0x445aac(0xc0)]+_0x445aac(0x2d3)+_0x70077d['name'])[_0x445aac(0x281)](';\x20'),_0x31cdf3=_0x2d3f8d[_0x445aac(0x28d)][_0x445aac(0x252)](_0x482e7a=>_0x482e7a[_0x445aac(0xc0)]+':\x20'+_0x482e7a[_0x445aac(0x13f)])['join']('\x0a'),_0x30b031=_0x2087a2[_0x445aac(0x252)](_0x507596=>_0x507596[_0x445aac(0xbe)]+':\x20'+_0x507596[_0x445aac(0x13f)])[_0x445aac(0x281)]('\x0a');_0x297928[_0x445aac(0x180)]({'Train\x20ID':'T'+_0x2d3f8d['id'],'Products\x20Count':_0x2d3f8d[_0x445aac(0x28d)][_0x445aac(0x2c3)],'Machines\x20Count':_0x2087a2[_0x445aac(0x2c3)],'Total\x20Area\x20(ESSA)\x20cm²':_0x2d3f8d[_0x445aac(0x1cc)][_0x445aac(0x2c5)](),'Products\x20(Code\x20-\x20Name)':_0x3a2e0b,'Machines\x20(Number\x20-\x20Name)':_0x4ed036,'Products\x20Detailed':_0x31cdf3,'Machines\x20Detailed':_0x30b031,'Min\x20Batch\x20Size\x20(kg)':_0x2d3f8d[_0x445aac(0x9c)],'Min\x20BS/MDD\x20Ratio':_0x2d3f8d['minBsMddRatio'][_0x445aac(0x205)](0x2),'Assumed\x20SSA\x20(cm²)':_0x2d3f8d[_0x445aac(0x23d)],'Lowest\x20LTD\x20(mg)':_0x2d3f8d[_0x445aac(0x106)],'Lowest\x20PDE\x20(mg)':_0x119fac[_0x445aac(0xb1)](null,_0x2d3f8d[_0x445aac(0xbb)])?_0x2d3f8d[_0x445aac(0xbb)]:_0x445aac(0x26a),'Worst\x20RPN\x20Product':_0x2d3f8d['worstProductRpn']?_0x2d3f8d['worstProductRpn'][_0x445aac(0x208)]+'\x20('+_0x2d3f8d[_0x445aac(0x169)][_0x445aac(0x176)]+_0x445aac(0x18f)+_0x2d3f8d[_0x445aac(0x169)][_0x445aac(0x149)]:_0x119fac[_0x445aac(0x1a7)]});});const _0x38777d=XLSX['utils'][_0x188dff(0x101)](_0x297928);XLSX[_0x188dff(0x107)][_0x188dff(0x2d2)](_0x2f267e,_0x38777d,_0x188dff(0x1e4));}catch(_0x44fe36){console[_0x188dff(0x93)](_0x119fac[_0x188dff(0x214)],_0x44fe36);}try{const _0x2913e3=a13_0x53aebc['products']['flatMap'](_0x935343=>{const _0x157367=_0x188dff,_0x547bd8=_0x238e9b[_0x157367(0x1d0)](_0x4064af,_0x935343);return _0x935343[_0x157367(0x23c)]['map'](_0x7e70de=>({'productName':_0x935343['name'],'productCode':_0x935343[_0x157367(0xc0)],'ingredientName':_0x7e70de[_0x157367(0x13f)],'rpn':_0x245ffa(_0x7e70de)[_0x157367(0x149)],'trainId':_0x157367(0x26a)!==_0x547bd8?'T'+_0x547bd8:_0x157367(0x26a)}));})[_0x188dff(0x1dd)]((_0x1e236c,_0x3fe68d)=>_0x3fe68d[_0x188dff(0x149)]-_0x1e236c[_0x188dff(0x149)])[_0x188dff(0x12a)](0x0,0xa);if(_0x119fac[_0x188dff(0x1ce)](_0x2913e3[_0x188dff(0x2c3)],0x0)){const _0x4f7718=_0x2913e3['map']((_0x317b7d,_0x5a105c)=>({'Rank':_0x5a105c+0x1,'Product\x20Code':_0x317b7d[_0x188dff(0xc0)],'Product\x20Name':_0x317b7d[_0x188dff(0x208)],'Train':_0x317b7d[_0x188dff(0x280)],'Ingredient':_0x317b7d[_0x188dff(0x176)],'RPN':_0x317b7d['rpn']})),_0x1aefbd=XLSX['utils']['json_to_sheet'](_0x4f7718);XLSX['utils'][_0x188dff(0x2d2)](_0x2f267e,_0x1aefbd,_0x188dff(0x2c8));}}catch(_0x3363fe){console[_0x188dff(0x93)](_0x188dff(0x19d),_0x3363fe);}try{const _0x588c9a=a13_0x53aebc[_0x188dff(0x28d)]['filter'](_0x1b1140=>_0x1b1140[_0x188dff(0x147)]);if(_0x119fac[_0x188dff(0x1ce)](_0x588c9a[_0x188dff(0x2c3)],0x0)){const _0xf32f3f=_0x588c9a[_0x188dff(0x252)](_0x5d61d5=>({'Product\x20Code':_0x5d61d5['productCode'],'Product\x20Name':_0x5d61d5[_0x188dff(0x13f)],'Product\x20Type':_0x5d61d5[_0x188dff(0x10e)],'Batch\x20Size\x20(kg)':_0x5d61d5[_0x188dff(0x2c4)],'MDD\x20(mg)':_0x5d61d5[_0x188dff(0x221)],'Critical\x20Reason':_0x5d61d5[_0x188dff(0x12f)]||'No\x20reason\x20provided','Train':_0x188dff(0x26a)!==_0x4064af(_0x5d61d5)?'T'+_0x4064af(_0x5d61d5):_0x188dff(0x26a)})),_0x5db042=XLSX[_0x188dff(0x107)][_0x188dff(0x101)](_0xf32f3f);XLSX[_0x188dff(0x107)]['book_append_sheet'](_0x2f267e,_0x5db042,_0x119fac[_0x188dff(0x289)]);}}catch(_0x14461d){console[_0x188dff(0x93)](_0x119fac[_0x188dff(0x1ff)],_0x14461d);}try{const _0x3f885d=a13_0x53aebc['products'][_0x188dff(0x252)](_0x2e84d5=>{const _0x8a3fc6=_0x188dff,_0x1984ba=_0x238e9b[_0x8a3fc6(0x1d0)](_0x4064af,_0x2e84d5),_0x103ff7=_0x2e84d5[_0x8a3fc6(0x23c)][_0x8a3fc6(0x1de)]((_0x2a5776,_0x5baf2f)=>{const _0x385c1a=_0x8a3fc6,_0x5a26c4=_0x238e9b[_0x385c1a(0x1d0)](_0x245ffa,_0x5baf2f)[_0x385c1a(0x149)];return _0x238e9b[_0x385c1a(0xa0)](_0x5a26c4,_0x2a5776['rpn'])?{..._0x5baf2f,'rpn':_0x5a26c4}:_0x2a5776;},{'rpn':0x0,'name':_0x238e9b[_0x8a3fc6(0x190)]});return{'Product\x20Code':_0x2e84d5[_0x8a3fc6(0xc0)],'Product\x20Name':_0x2e84d5[_0x8a3fc6(0x13f)],'Product\x20Type':_0x2e84d5['productType'],'Batch\x20Size\x20(kg)':_0x2e84d5['batchSizeKg'],'MDD\x20(mg)':_0x2e84d5[_0x8a3fc6(0x221)],'Train':_0x238e9b[_0x8a3fc6(0x105)](_0x8a3fc6(0x26a),_0x1984ba)?'T'+_0x1984ba:_0x238e9b['NOGWd'],'Is\x20Critical':_0x2e84d5[_0x8a3fc6(0x147)]?_0x238e9b[_0x8a3fc6(0x1d1)]:'No','Critical\x20Reason':_0x2e84d5[_0x8a3fc6(0x12f)]||_0x8a3fc6(0x26a),'Ingredients\x20Count':_0x2e84d5[_0x8a3fc6(0x23c)][_0x8a3fc6(0x2c3)],'Highest\x20RPN\x20Ingredient':_0x103ff7['name'],'Highest\x20RPN\x20Value':_0x103ff7['rpn']||0x0};}),_0x51a35e=XLSX['utils'][_0x188dff(0x101)](_0x3f885d);XLSX['utils'][_0x188dff(0x2d2)](_0x2f267e,_0x51a35e,_0x119fac[_0x188dff(0x1c3)]);}catch(_0x4ec473){console[_0x188dff(0x93)](_0x188dff(0x299),_0x4ec473);}try{const _0x4412d0=[];a13_0x53aebc['products']['forEach'](_0x21806d=>{const _0x2036ac=_0x188dff,_0x20e2b0={'hkfyt':_0x238e9b[_0x2036ac(0x190)]},_0x188bcc=_0x238e9b[_0x2036ac(0x1d0)](_0x4064af,_0x21806d),_0x1310a1={'Product\x20Code':_0x21806d[_0x2036ac(0xc0)],'Product\x20Name':_0x21806d[_0x2036ac(0x13f)],'Product\x20Type':_0x21806d[_0x2036ac(0x10e)],'Batch\x20Size\x20(kg)':_0x21806d[_0x2036ac(0x2c4)],'MDD\x20(mg)':_0x21806d[_0x2036ac(0x221)],'Train':_0x238e9b['tUJvI'](_0x238e9b['NOGWd'],_0x188bcc)?'T'+_0x188bcc:_0x238e9b['NOGWd'],'Is\x20Critical':_0x21806d['isCritical']?_0x238e9b[_0x2036ac(0x1d1)]:'No','Critical\x20Reason':_0x21806d[_0x2036ac(0x12f)]||_0x238e9b[_0x2036ac(0x190)],'Ingredient\x20Type':_0x238e9b[_0x2036ac(0x157)],'Ingredient\x20Name':'','LTD\x20(mg)':'','PDE\x20(mg)':'','LD50\x20(mg/kg)':'','Severity':'','Occurrence':'','Detection':'','RPN':''};_0x4412d0['push'](_0x1310a1),_0x21806d['activeIngredients'][_0x2036ac(0x185)](_0x50d917=>{const _0x23223c=_0x2036ac,_0x10a667=_0x245ffa(_0x50d917);_0x4412d0['push']({'Product\x20Code':'','Product\x20Name':'','Product\x20Type':'','Batch\x20Size\x20(kg)':'','MDD\x20(mg)':'','Train':'','Is\x20Critical':'','Critical\x20Reason':'','Ingredient\x20Type':_0x23223c(0x1e5),'Ingredient\x20Name':_0x50d917[_0x23223c(0x13f)],'LTD\x20(mg)':_0x50d917['ltdMg']||'N/A','PDE\x20(mg)':_0x50d917['pdeMg']||_0x20e2b0[_0x23223c(0x19b)],'LD50\x20(mg/kg)':_0x50d917[_0x23223c(0xe2)]||_0x23223c(0x26a),'Severity':_0x10a667[_0x23223c(0x257)],'Occurrence':_0x10a667[_0x23223c(0x294)],'Detection':_0x10a667['detection'],'RPN':_0x10a667[_0x23223c(0x149)]});});});const _0x1a2110=XLSX['utils'][_0x188dff(0x101)](_0x4412d0);XLSX[_0x188dff(0x107)]['book_append_sheet'](_0x2f267e,_0x1a2110,_0x119fac['ZbBes']);}catch(_0x41c803){console[_0x188dff(0x93)](_0x188dff(0x192),_0x41c803);}const _0x27568a=new Date()['toISOString']()[_0x188dff(0x26b)]('T')[0x0];XLSX['writeFile'](_0x2f267e,_0x188dff(0x218)+_0x27568a+_0x188dff(0x2a8)),_0x119fac[_0x188dff(0x21d)](hideLoader),showCustomAlert(_0x188dff(0x243),_0x119fac['iiady']);})[_0x216d9f(0x134)](_0x2084e6=>{const _0x32b793=_0x216d9f;console[_0x32b793(0x93)](_0x119fac[_0x32b793(0x1f6)],_0x2084e6),_0x119fac[_0x32b793(0x21d)](hideLoader),_0x119fac[_0x32b793(0x1eb)](showCustomAlert,_0x119fac[_0x32b793(0x163)],_0x119fac[_0x32b793(0xdf)]);});}export function toggleStageSection(_0x4922ad){const _0x5d688a=a13_0x128c95,_0x2163bf={'PRpYZ':_0x5d688a(0x269),'LbIrL':_0x5d688a(0x265),'WBtcG':_0x5d688a(0x2c0)},_0x1dfb2c=document['getElementById']('stage-'+_0x4922ad),_0x34959b=_0x2163bf[_0x5d688a(0x224)]===_0x1dfb2c['style']['display'];_0x1dfb2c[_0x5d688a(0x292)][_0x5d688a(0x270)]=_0x34959b?'':_0x2163bf[_0x5d688a(0x224)],localStorage[_0x5d688a(0xec)](_0x5d688a(0x155)+_0x4922ad+_0x5d688a(0x240),!_0x34959b);const _0x428f01=_0x1dfb2c[_0x5d688a(0x17a)][_0x5d688a(0x187)](_0x2163bf[_0x5d688a(0x1b8)]);_0x428f01&&(_0x428f01[_0x5d688a(0x19a)]=_0x34959b?_0x2163bf[_0x5d688a(0x225)]:_0x5d688a(0xfd));}