const a13_0x17be56=a13_0xd75d;(function(_0x2c3385,_0x1ec931){const _0x2fcc89=a13_0xd75d,_0x2b5388=_0x2c3385();while(!![]){try{const _0x2cf0b6=parseInt(_0x2fcc89(0x2e9))/0x1*(-parseInt(_0x2fcc89(0x240))/0x2)+-parseInt(_0x2fcc89(0x33c))/0x3+parseInt(_0x2fcc89(0x1e5))/0x4+-parseInt(_0x2fcc89(0x1b3))/0x5*(parseInt(_0x2fcc89(0x1a6))/0x6)+parseInt(_0x2fcc89(0x22e))/0x7*(-parseInt(_0x2fcc89(0x165))/0x8)+parseInt(_0x2fcc89(0x337))/0x9+parseInt(_0x2fcc89(0x377))/0xa;if(_0x2cf0b6===_0x1ec931)break;else _0x2b5388['push'](_0x2b5388['shift']());}catch(_0x1d766b){_0x2b5388['push'](_0x2b5388['shift']());}}}(a13_0x5d7d,0x6e29a));import*as a13_0x26f094 from'./state.js';import{fullAppRender as a13_0x34d913}from'./app.js';import{generateTrainMap as a13_0x2ae3dc}from'./utils.js';import{toggleScoringEditMode as a13_0x2a5664}from'./scoringView.js';import{renderRpnChart as a13_0x3f940f}from'./worstCaseView.js';import{renderMacoChart as a13_0x2b905b}from'./dashboardView.js';const s=document[a13_0x17be56(0x3bb)](a13_0x17be56(0x24b));export const showLoader=()=>s[a13_0x17be56(0x2b4)][a13_0x17be56(0x36a)]=a13_0x17be56(0x24e);export const hideLoader=()=>s[a13_0x17be56(0x2b4)][a13_0x17be56(0x36a)]=a13_0x17be56(0x22d);export function showCustomAlert(_0x3f46dc,_0x1d6a0c){const _0x317d5d=a13_0x17be56,_0x3bfc5d={'hXaTn':_0x317d5d(0x23b),'WAmTO':_0x317d5d(0x320),'FnhAy':_0x317d5d(0x2a2)};document[_0x317d5d(0x3bb)](_0x3bfc5d[_0x317d5d(0x22b)])[_0x317d5d(0x2a7)]=_0x3f46dc,document[_0x317d5d(0x3bb)](_0x3bfc5d[_0x317d5d(0x2b3)])['textContent']=_0x1d6a0c,document[_0x317d5d(0x3bb)](_0x3bfc5d[_0x317d5d(0x1c4)])['style'][_0x317d5d(0x36a)]=_0x317d5d(0x24e);}export const hideModal=_0x687d69=>document[a13_0x17be56(0x3bb)](_0x687d69)[a13_0x17be56(0x2b4)]['display']=a13_0x17be56(0x22d);export const showModal=_0x53f17d=>document[a13_0x17be56(0x3bb)](_0x53f17d)[a13_0x17be56(0x2b4)]['display']=a13_0x17be56(0x24e);export function saveAllDataToLocalStorage(){const _0x55dab8=a13_0x17be56,_0x3489f3={'XHOve':_0x55dab8(0x1cf),'XHXCO':_0x55dab8(0x32e),'vHolm':_0x55dab8(0x297),'bbxVT':_0x55dab8(0x2fa),'gLMgQ':'Failed\x20to\x20save\x20data\x20to\x20localStorage','KaQfs':function(_0x312d6c,_0x53f58b,_0x2aba7f){return _0x312d6c(_0x53f58b,_0x2aba7f);},'qPQSa':_0x55dab8(0x354)};try{localStorage[_0x55dab8(0x35b)](_0x3489f3[_0x55dab8(0x1bd)],JSON['stringify'](a13_0x26f094[_0x55dab8(0x21b)])),localStorage[_0x55dab8(0x35b)](_0x3489f3[_0x55dab8(0x3ac)],JSON[_0x55dab8(0x2b1)](a13_0x26f094[_0x55dab8(0x1b2)])),localStorage[_0x55dab8(0x35b)](_0x3489f3['vHolm'],JSON[_0x55dab8(0x2b1)](a13_0x26f094[_0x55dab8(0x3bd)])),localStorage['setItem'](_0x3489f3[_0x55dab8(0x31a)],JSON[_0x55dab8(0x2b1)](a13_0x26f094[_0x55dab8(0x28b)])),localStorage[_0x55dab8(0x35b)](_0x55dab8(0x398),JSON[_0x55dab8(0x2b1)](a13_0x26f094['machineStageDisplayOrder']));}catch(_0x38b06f){console[_0x55dab8(0x345)](_0x3489f3[_0x55dab8(0x33a)],_0x38b06f),_0x3489f3['KaQfs'](showCustomAlert,_0x55dab8(0x37d),_0x3489f3[_0x55dab8(0x305)]);}}export function loadAllDataFromLocalStorage(){const _0x36c61f=a13_0x17be56,_0x10f05b={'BwAbS':_0x36c61f(0x1cf),'dOKNB':_0x36c61f(0x32e),'qtzrE':_0x36c61f(0x297),'WrWkF':_0x36c61f(0x2fa),'kHJbS':_0x36c61f(0x398),'XViMw':_0x36c61f(0x34e),'iYDfF':_0x36c61f(0x2fd),'kwXgU':_0x36c61f(0x2b5),'EeQci':_0x36c61f(0x2d6),'ytYgz':'Error\x20loading\x20machine\x20stage\x20order'},_0x42f8ac=localStorage[_0x36c61f(0x225)](_0x10f05b[_0x36c61f(0x316)]),_0x2d3208=localStorage[_0x36c61f(0x225)](_0x10f05b[_0x36c61f(0x384)]),_0x3eb468=localStorage['getItem'](_0x10f05b[_0x36c61f(0x1ac)]),_0x4d4a8a=localStorage[_0x36c61f(0x225)](_0x10f05b[_0x36c61f(0x151)]),_0x1ea820=localStorage[_0x36c61f(0x225)](_0x10f05b[_0x36c61f(0x1d1)]);if(_0x42f8ac)try{a13_0x26f094[_0x36c61f(0x341)](JSON[_0x36c61f(0x26d)](_0x42f8ac));}catch(_0xe6dcb7){console[_0x36c61f(0x345)](_0x10f05b[_0x36c61f(0x1d0)],_0xe6dcb7);}if(_0x2d3208)try{a13_0x26f094['setMachines'](JSON[_0x36c61f(0x26d)](_0x2d3208));}catch(_0x228d32){console['error'](_0x10f05b[_0x36c61f(0x3a3)],_0x228d32);}if(_0x3eb468)try{a13_0x26f094[_0x36c61f(0x1e0)](JSON['parse'](_0x3eb468));}catch(_0x102c31){console[_0x36c61f(0x345)](_0x10f05b[_0x36c61f(0x167)],_0x102c31);}if(_0x4d4a8a)try{a13_0x26f094[_0x36c61f(0x224)](JSON['parse'](_0x4d4a8a));}catch(_0x54921a){console[_0x36c61f(0x345)](_0x10f05b[_0x36c61f(0x218)],_0x54921a);}if(_0x1ea820)try{a13_0x26f094['setMachineStageDisplayOrder'](JSON[_0x36c61f(0x26d)](_0x1ea820));}catch(_0x20967f){console[_0x36c61f(0x345)](_0x10f05b[_0x36c61f(0x2d5)],_0x20967f);}}export function saveStateForUndo(){const _0x114894=a13_0x17be56,_0x125baf={'rQqOE':function(_0x5c9dad){return _0x5c9dad();},'WkmNp':function(_0x27bbce){return _0x27bbce();}};_0x125baf[_0x114894(0x358)](a13_0x2ae3dc);const _0x472f69=a13_0x26f094[_0x114894(0x29a)][_0x114894(0x1fb)](0x0,a13_0x26f094[_0x114894(0x220)]+0x1),_0x478a70={'products':JSON['parse'](JSON[_0x114894(0x2b1)](a13_0x26f094[_0x114894(0x21b)])),'machines':JSON[_0x114894(0x26d)](JSON['stringify'](a13_0x26f094[_0x114894(0x1b2)])),'scoringCriteria':JSON[_0x114894(0x26d)](JSON[_0x114894(0x2b1)](a13_0x26f094[_0x114894(0x3bd)])),'detergentIngredients':JSON['parse'](JSON[_0x114894(0x2b1)](a13_0x26f094[_0x114894(0x28b)]))};_0x472f69['push'](_0x478a70),a13_0x26f094[_0x114894(0x261)](_0x472f69,_0x472f69[_0x114894(0x22a)]-0x1),updateUndoRedoButtons(),_0x125baf[_0x114894(0x322)](saveAllDataToLocalStorage);}export function updateUndoRedoButtons(){const _0x1fa906=a13_0x17be56,_0x3d5bc7={'iiWsK':_0x1fa906(0x2f6),'oSwcM':function(_0x13993d,_0x53184c){return _0x13993d-_0x53184c;}},_0x1253d4=document[_0x1fa906(0x3bb)](_0x1fa906(0x286)),_0x5e0bef=document['getElementById'](_0x3d5bc7['iiWsK']);_0x1253d4&&(_0x1253d4[_0x1fa906(0x394)]=a13_0x26f094[_0x1fa906(0x220)]<=0x0),_0x5e0bef&&(_0x5e0bef[_0x1fa906(0x394)]=a13_0x26f094['historyIndex']>=_0x3d5bc7['oSwcM'](a13_0x26f094[_0x1fa906(0x29a)][_0x1fa906(0x22a)],0x1));}function a13_0x5d7d(){const _0x43903a=['toFixed','date','detergentIngredients','NUlXv','YLMhM','VpDDv','yrHhf','Train\x20Summary','oZEuP','stage','RLSDz','MACO_Summary_Report_','xsfmF','ZEaod','macoScoringCriteria','Detergent_MACO_Report_','#columnVisibilityDropdown','history','flatMap','book_new','all',')\x20-\x20RPN:\x20','gbRQL','add','IfHsJ','customAlertModal','mkylM','Failed\x20to\x20export\x20Summary\x20report\x20data\x20to\x20Excel.','xafTO','xGbZn','textContent','QbiqX','sortValue','nlZEj','required','href','productName','OrVeN','MHbHH','KrAZj','stringify','eCWIv','WAmTO','style','Error\x20loading\x20scoring\x20criteria','ingredientName','min','UVovU','mZjpI','hLUSW','KBCpS','IUIxh','./worstCaseView.js','PtNDQ','SDOKz','xPCsH','blyRQ','revokeObjectURL','LbWAf','N/A','eUQLi','\x20.mainTable,\x20#','dwsoi','neafl','readAsText','wyZJu','yfuKX','audml','vWinA','content-','MACO\x20Report','Health-Based\x20Limit\x20(PDE)','maAap','qjlBk','catch','tllxg','ytYgz','Error\x20loading\x20detergent\x20ingredients','Failed\x20to\x20export\x20data\x20to\x20Excel.','EkyAn','Yes','CfteG','All\x20Products','HthHd','Error\x20loading\x20detergent\x20view\x20for\x20print:','toExponential','eJyTX','yWjaP','createElement','closest','parentElement','UIThz','body','noTrainSummaryMessage','message','ogmmg','42byVQHQ','Kiqev','rjmsd','writeFile','Train:','Error\x20exporting\x20Detergent\x20MACO\x20to\x20Excel:','OcXSK','MLkcu','UOkvN','ObazM','Worst\x20Case\x20Products','euxnQ','piNSI','redo-btn','FvJLz','mfGhV','UcuwS','macoDetergentIngredients','cLhOz','HogBo','Error\x20loading\x20machines','Failed\x20to\x20parse\x20JSON\x20file.','INGREDIENT','znQxI','productCode','minMbsKg','xkFmb','owIeu','qPQSa','removeEventListener','pde','Other',',\x20#','wysTu','scoringInEditMode','block','area','NbYeY','mURyF','machineStage-','uOtFx','uDZHz','maco-breakdown-details-','Invalid\x20JSON\x20file\x20structure.','#macoForTrains\x20[id^=\x22maco-breakdown-details-\x22].hidden','BwAbS','MACO_Machines_','#detergentMaco\x20.train-content.collapsed','json_to_sheet','bbxVT','VOhEg','breakdown-toggle-btn-','LAWdU','scoring-system','eadZf','customAlertMessage','BTCOk','WkmNp','ybuQv','vhesj','DWuBD','eSAdX','QqsXg','GnDoT','SWBOi','\x20-\x20','sf-input-train-','ARzfs','xonHR','macoMachines','Error\x20creating\x20Train\x20Summary\x20sheet:','bkjIf','onload','Top\x2010\x20RPN','mdd','Product\x20MACO\x20Report','nmpXG','CFGBL','7672158ZpyRJx','No\x20Data','then','gLMgQ','occurrence','1158357YGiclr','DlkBF','Miuuc','ppgzl','afbCE','setProducts','.toggle-pde','collapsed','Success','error','usCgZ','tzYHh','content-pm-','-pdeHidden','viewProducts','AuftH','xFZiT','ZgGOC','Error\x20loading\x20products','Ncglc','BNouQ','uYCGz','Unknown\x20(ID:\x20','Complete\x20report\x20with\x20all\x20tabs\x20exported\x20to\x20Excel\x20successfully!','Could\x20not\x20save\x20data.\x20Storage\x20might\x20be\x20full.','dark','renderTrainSummary','.xlsx','rQqOE','.toggle-ld50','FkBeZ','setItem','productRegister','Error\x20loading\x20train\x20summary:\x20','ltdMg','bfqFk','nlFnT','rpn','Setting\x20printSelectedTrain\x20to:','lUbHC','UcaVx','Ipqep','includes','Hide\x20MACO\x20Calculation\x20Breakdown','LwRqq','cleanability','display','activeIngredients','ObiEU','log','CEpdE','TxAXV','tnStF','EYzSE','UiIvt','FxDLJ','PHAxj','productType','zqpGD','5700950KDTDLt','Train\x20Summary\x20Report','\x20\x20└─\x20','criticalReason','JFYMC','VRyGf','Save\x20Error','Failed\x20to\x20export\x20data\x20to\x20JSON.','value','machineNumber','None','0.1%\x20Therapeutic\x20Dose','ZWxhg','dOKNB','classList','VYeLF','files','There\x20is\x20no\x20data\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','FCeJp','Xdeur','UQtMf','NApqQ','toggle-pm-','button','trainId','Failed\x20to\x20export\x20complete\x20report\x20to\x20Excel.','GxpMh','CMmFN','detergentMaco','disabled','qJhdb','jbkZz','Error\x20exporting\x20machines\x20to\x20Excel:','machineStageDisplayOrder','HVNFD','join','Error\x20exporting\x20worst\x20case\x20to\x20Excel:','IBNus','zUSnX','bodyWeight','lowestPde','therapeuticDose','FFqBF','Error','iYDfF','button[onclick=\x22toggleColumnVisibilityDropdown()\x22]','\x20.mainTable.hide-','KMtPD','LfrjM','zydOW','fZMVy','FtjqN','tehXe','XHXCO','TTlew','zgoJJ','TLnol','pLCye','Error\x20creating\x20Detergent\x20MACO\x20sheet:','Train_Summary_Report','qccGA','eZjcV','utils','querySelector','uHZKu','startsWith','maco_data_export.json','jSsqF','getElementById','JdZaG','scoringCriteria','./utils.js','Tlzui','Complete_MACO_Report_','ukvEV','Failed\x20to\x20export\x20Train\x20Summary\x20data\x20to\x20Excel.','BxIFy','WrWkF','xNQro','Error\x20creating\x20All\x20Products\x20sheet:','Lbjam','gmppC','#productRegister\x20.mainTable.hide-','\x20.ingredients-sub-table','product-sf-input','kvBUW','HdIcW','UOTvM','gYhJE','_Train_','rQrVf','macoChartInstance','assumedSsa','iLOmc','WgqDy','Machines\x20data\x20exported\x20to\x20Excel\x20successfully!','SmMnq','38968xpqZoo','MACO_Worst_Case_Products','kwXgU','Product\x20MACO','QaSue','ld50Score','BSZSo','KPySR','TdMEb','wpnFV','ycZCo','filter','bLBHD','therapeuticDoseScore','eDlce','finally','ykRmy','NaMjY','hide-pde','vNbMk','yGlgw','eicvj','keys','KZWqp','CXcmw','DhJkk','push','solubility','pdeMg','ZQqKj','lHYUp','ZLNlW','Error\x20creating\x20Top\x2010\x20RPN\x20sheet:','There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','srMyU','FdPRO','There\x20are\x20no\x20detergent\x20ingredients\x20configured.\x20Add\x20detergent\x20ingredients\x20first.','toLocaleString','max','map','Zjsoj','Auqan','split','LHxaZ','productRegister-','click','Product_MACO_Report','DjUMP','book_append_sheet','ewQDk','YpsHq','SYTXO','SBZvo','warn','xznPz','Show\x20PDE','trainSummaryContainer','hide-','Machines','uhiUY','WBDui','lowestLtd','\x20.train-content-inner','batchSizeKg','tBKVV','1130934HfOOyl','content-dm-','Hidden','QCtkv','Visual\x20Clean\x20Limit','MmBeR','qtzrE','TlhAv','fppUv','toISOString','Qhqwr','Error\x20exporting\x20to\x20Excel:','machines','5zJZICa','JKEEk','MjVjx','fxsKP','Summary\x20report\x20data\x20exported\x20to\x20Excel\x20successfully!','vvZpz','isCritical','renderWorstCaseByTrain','toLocaleDateString','rpnChartInstance','XHOve','Failed\x20to\x20export\x20Product\x20MACO\x20data\x20to\x20Excel.','osvsR','dqowE','pdeScore','qTLwT','DyMCB','FnhAy','Error\x20creating\x20Product\x20Register\x20sheet:','solubilityScore','true','reduce','WgBcK','CCqtX','QlZbM','pfSaP','WPMfm','querySelectorAll','macoProducts','XViMw','kHJbS','fdzwv','Xhiur','qdOhL','tKZzY','Train\x20','tMlNz','isAIV','YDlxF','pLbJQ','iqQCv','There\x20are\x20no\x20products\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','dJigL','SmBbE','application/json','setScoringCriteria','roZvN','NRtYT','bdztL','hidden','1617968AUjJix','innerHTML','GVlGi','productRegister-ld50Hidden','Failed\x20to\x20export\x20worst\x20case\x20data\x20to\x20Excel.','./macoDetergentView.js','GWbaR','fxzks','ZnwtF','Jxpmc','IjcWB','essa','Error\x20exporting\x20Train\x20Summary\x20to\x20Excel:','xtsRz','azUXK','cleanabilityScore','print','PZXki','Failed\x20to\x20export\x20machines\x20data\x20to\x20Excel.','Trains\x20','10\x20ppm\x20Criterion','AQMAo','slice','worstProductRpn','forEach','xiEzj','odSrV','Detergent\x20MACO\x20Report','lNGVz','Mjjpx','name','Detergent\x20MACO','Train\x20summary\x20container\x20is\x20hidden\x20or\x20missing','minBsMddRatio','Hide\x20PDE','Show\x20MACO\x20Calculation\x20Breakdown','IuHIe','match','YbOZA','SkIIm','appendChild','JReAb','contains','Error\x20creating\x20Product\x20MACO\x20sheet:','lJjXj','isArray','toggle-','OXVAo','wOkiC','EpmsT','target','EeQci','hide-ld50','qdjVD','products','Error\x20exporting\x20Product\x20MACO\x20to\x20Excel:','ognEo','CDnYe','HGyiz','historyIndex','PRODUCT','MACO_All_Products_Report.xlsx','OtAGh','setDetergentIngredients','getItem','beAnr','remove','trainSummary','createObjectURL','length','hXaTn','zVEFM','none','1015lxjlBl','setMachines','input','XuLEE','TtARP','toNeZ','KymrF','toggle','lHYxK','documentElement','ihQtK','EOWIj','QFDWY','customAlertTitle','No\x20reason\x20provided','DOBur','nElLT','renderDetergentMaco','4520ATybAZ','machineIds','mFOhh','qfFyV','printSelectedTrain','lJSuh','KruYN','renderRpnChart','rpnRatingText','nqoGL','removeChild','loader','Show','qgLwb','flex','Container\x20display:','wKbUL','GRNXV','MEwwu','productRegister-pdeHidden','zJUSX','nVUBb','vRgLf','AFNHH','giowq','UUEuC','worstCaseProducts','ISZBj','Health-Based\x20Limit\x20(NOEL)','No\x20train\x20data\x20to\x20print.\x20Please\x20ensure\x20you\x20have\x20created\x20trains\x20first.','eKwqv','-ld50Hidden','!cols','setHistory','ld50','safetyFactorConfig','qcPxR','YFhMl','CdAXp','sIFmI','EjJnc','ddNGe','number','There\x20are\x20no\x20machines\x20to\x20export.','mddMg','parse','BZtnn','vSnyK','sort','LQcYD','oNgXE','nndlV','trim','oyYUH','ixqyD','lowestLd50','tgypi','Vgito','vKJWj','cTpYW','Rcvsr','Critical\x20Products','AOeSS','kLsmf','ywyNU','Zqpmj','find','eZNas','AKsKC','severity','undo-btn','PbBSc','toggle-dm-'];a13_0x5d7d=function(){return _0x43903a;};return a13_0x5d7d();}export function undoChange(){const _0x4303f1=a13_0x17be56,_0x3af704={'FdPRO':function(_0x1313ab,_0x53daf7){return _0x1313ab>_0x53daf7;},'WyleK':function(_0x2db399,_0x6db420){return _0x2db399(_0x6db420);},'jbkZz':function(_0x5be552){return _0x5be552();}};if(_0x3af704[_0x4303f1(0x188)](a13_0x26f094['historyIndex'],0x0)){const _0xf0f2d5=a13_0x26f094['historyIndex']-0x1,_0x75f08b=a13_0x26f094[_0x4303f1(0x29a)][_0xf0f2d5];a13_0x26f094[_0x4303f1(0x341)](JSON['parse'](JSON[_0x4303f1(0x2b1)](_0x75f08b[_0x4303f1(0x21b)]))),a13_0x26f094[_0x4303f1(0x22f)](JSON[_0x4303f1(0x26d)](JSON[_0x4303f1(0x2b1)](_0x75f08b[_0x4303f1(0x1b2)]))),a13_0x26f094[_0x4303f1(0x1e0)](JSON[_0x4303f1(0x26d)](JSON[_0x4303f1(0x2b1)](_0x75f08b[_0x4303f1(0x3bd)]))),a13_0x26f094['setDetergentIngredients'](JSON[_0x4303f1(0x26d)](JSON[_0x4303f1(0x2b1)](_0x75f08b[_0x4303f1(0x28b)]))),a13_0x26f094[_0x4303f1(0x261)](a13_0x26f094['history'],_0xf0f2d5),a13_0x26f094[_0x4303f1(0x30b)]&&_0x3af704['WyleK'](a13_0x2a5664,!0x1),a13_0x34d913(),_0x3af704[_0x4303f1(0x396)](updateUndoRedoButtons),saveAllDataToLocalStorage();}}export function redoChange(){const _0x1eee70=a13_0x17be56,_0x496bb8={'HexfX':function(_0x1ab738,_0x47bb80){return _0x1ab738(_0x47bb80);},'mFOhh':function(_0x292d5b){return _0x292d5b();},'XPffc':function(_0x31c00c){return _0x31c00c();}};if(a13_0x26f094[_0x1eee70(0x220)]<a13_0x26f094['history']['length']-0x1){const _0x113db8=a13_0x26f094['historyIndex']+0x1,_0x844e32=a13_0x26f094[_0x1eee70(0x29a)][_0x113db8];a13_0x26f094[_0x1eee70(0x341)](JSON[_0x1eee70(0x26d)](JSON[_0x1eee70(0x2b1)](_0x844e32[_0x1eee70(0x21b)]))),a13_0x26f094['setMachines'](JSON[_0x1eee70(0x26d)](JSON['stringify'](_0x844e32['machines']))),a13_0x26f094[_0x1eee70(0x1e0)](JSON[_0x1eee70(0x26d)](JSON[_0x1eee70(0x2b1)](_0x844e32[_0x1eee70(0x3bd)]))),a13_0x26f094[_0x1eee70(0x224)](JSON[_0x1eee70(0x26d)](JSON[_0x1eee70(0x2b1)](_0x844e32[_0x1eee70(0x28b)]))),a13_0x26f094[_0x1eee70(0x261)](a13_0x26f094['history'],_0x113db8),a13_0x26f094[_0x1eee70(0x30b)]&&_0x496bb8['HexfX'](a13_0x2a5664,!0x1),_0x496bb8[_0x1eee70(0x242)](a13_0x34d913),_0x496bb8[_0x1eee70(0x242)](updateUndoRedoButtons),_0x496bb8['XPffc'](saveAllDataToLocalStorage);}}export function toggleDarkMode(_0x25f725){const _0x27113f=a13_0x17be56,_0x1a1d2e={'Qoaoe':'theme-toggle-light-icon','DkhBl':'theme-toggle-dark-icon','fxzks':_0x27113f(0x355),'KPySR':'hidden','igwgO':function(_0x5dc440){return _0x5dc440();}},_0x2558fc=document[_0x27113f(0x3bb)](_0x1a1d2e['Qoaoe']),_0x1003c9=document['getElementById'](_0x1a1d2e['DkhBl']);_0x25f725?(document[_0x27113f(0x237)][_0x27113f(0x385)][_0x27113f(0x2a0)](_0x1a1d2e[_0x27113f(0x1ec)]),_0x2558fc&&_0x2558fc[_0x27113f(0x385)][_0x27113f(0x2a0)](_0x1a1d2e['KPySR']),_0x1003c9&&_0x1003c9[_0x27113f(0x385)]['remove'](_0x1a1d2e['KPySR'])):(document[_0x27113f(0x237)][_0x27113f(0x385)]['remove'](_0x27113f(0x355)),_0x2558fc&&_0x2558fc[_0x27113f(0x385)][_0x27113f(0x227)](_0x1a1d2e[_0x27113f(0x16c)]),_0x1003c9&&_0x1003c9[_0x27113f(0x385)]['add'](_0x1a1d2e['KPySR'])),a13_0x26f094[_0x27113f(0x1bc)]&&_0x1a1d2e['igwgO'](a13_0x3f940f),a13_0x26f094[_0x27113f(0x15f)]&&a13_0x2b905b();}export function printCurrentView(_0x762bbb,_0x3e91b7=a13_0x17be56(0x29d)){const _0x173238=a13_0x17be56,_0x154acf={'nVUBb':function(_0x245189,_0x5d93ac,_0xdf959d){return _0x245189(_0x5d93ac,_0xdf959d);},'mfGhV':_0x173238(0x343),'azUXK':_0x173238(0x367),'AFNHH':_0x173238(0x1e4),'ZQqKj':'#macoForTrains\x20.train-content.collapsed','tzYHh':function(_0x519500,_0x4b2844,_0x9646b7){return _0x519500(_0x4b2844,_0x9646b7);},'BSZSo':_0x173238(0x318),'zqpGD':function(_0x2e6a79,_0x1bf77c,_0x32f98a){return _0x2e6a79(_0x1bf77c,_0x32f98a);},'vWinA':_0x173238(0x2dd),'SDOKz':_0x173238(0x1ea),'KBCpS':_0x173238(0x19d),'TqUHa':_0x173238(0x2e6),'kOjvb':_0x173238(0x24f),'OXVAo':'not\x20found','uJGIg':'No\x20trains\x20message\x20display:','ZEaod':'Container\x20has\x20content:','zJUSX':function(_0x5aea68,_0x1ba16d){return _0x5aea68>_0x1ba16d;},'PZXki':function(_0x56e25f,_0x14f376){return _0x56e25f===_0x14f376;},'fZMVy':_0x173238(0x22d),'srMyU':function(_0x558b5d,_0x2d6e95,_0x2b6d5d){return _0x558b5d(_0x2d6e95,_0x2b6d5d);},'pLbJQ':_0x173238(0x35d),'usCgZ':function(_0x4ecd48,_0x474972){return _0x4ecd48===_0x474972;},'PkSja':_0x173238(0x31e),'lUbHC':function(_0xb69d67,_0x4e3f75){return _0xb69d67(_0x4e3f75);},'Tlzui':'Printing\x20view:','xFZiT':function(_0x21f729,_0x11fb40){return _0x21f729===_0x11fb40;},'TxAXV':_0x173238(0x25a),'MLkcu':_0x173238(0x2bd),'yWjaP':'macoForTrains','IFMcM':_0x173238(0x393),'JKEEk':_0x173238(0x228),'OPcZp':'./trainSummaryView.js'};_0x154acf[_0x173238(0x346)](_0x154acf['PkSja'],_0x762bbb)&&a13_0x26f094[_0x173238(0x30b)]&&(a13_0x26f094['setScoringWasInEditModeForPrint'](!0x0),_0x154acf[_0x173238(0x363)](a13_0x2a5664,!0x1)),console['log'](_0x154acf[_0x173238(0x14c)],_0x762bbb,_0x173238(0x2ed),_0x3e91b7),document[_0x173238(0x2e5)][_0x173238(0x385)][_0x173238(0x2a0)]('printing-'+_0x762bbb),_0x154acf[_0x173238(0x34c)](_0x154acf[_0x173238(0x36f)],_0x762bbb)?import(_0x154acf[_0x173238(0x2f0)])['then'](_0x252c92=>{const _0x261583=_0x173238;window[_0x261583(0x244)]=_0x3e91b7,_0x252c92['renderWorstCaseByTrain'](),_0x154acf[_0x261583(0x255)](setTimeout,()=>{const _0x15994d=_0x261583;window[_0x15994d(0x1f5)]();},0xc8);}):_0x154acf[_0x173238(0x2e0)]===_0x762bbb?(window[_0x173238(0x244)]=_0x3e91b7,import('./macoProductView.js')[_0x173238(0x339)](_0x5d7c1f=>{const _0x460dff=_0x173238,_0x342936={'JgBQg':_0x154acf[_0x460dff(0x1f3)],'DhJkk':_0x154acf['mfGhV'],'OtAGh':_0x154acf[_0x460dff(0x257)],'bfqFk':_0x460dff(0x208)};_0x5d7c1f['renderMacoForTrains']();const _0x512fbc=document[_0x460dff(0x1ce)](_0x154acf[_0x460dff(0x182)]),_0x49b613=[];_0x512fbc[_0x460dff(0x1fd)](_0x50f503=>{const _0x32993e=_0x460dff,_0x2913ef=_0x50f503['id']['match'](/content-pm-(\d+)/);if(_0x2913ef){_0x49b613[_0x32993e(0x17f)](_0x2913ef[0x1]),_0x50f503[_0x32993e(0x385)][_0x32993e(0x227)](_0x154acf[_0x32993e(0x2f8)]);const _0x28cd92=document['getElementById'](_0x32993e(0x38d)+_0x2913ef[0x1]);_0x28cd92&&(_0x28cd92[_0x32993e(0x2a7)]='▼');}});const _0x151935=document[_0x460dff(0x1ce)](_0x460dff(0x315)),_0x414db1=[];_0x151935[_0x460dff(0x1fd)](_0x51566f=>{const _0x52ee24=_0x460dff,_0x57fc40=_0x51566f['id'][_0x52ee24(0x20a)](/maco-breakdown-details-(\d+)/);if(_0x57fc40){_0x414db1[_0x52ee24(0x17f)](_0x57fc40[0x1]),_0x51566f[_0x52ee24(0x385)][_0x52ee24(0x227)](_0x52ee24(0x1e4));const _0x147858=document[_0x52ee24(0x3bb)](_0x52ee24(0x31c)+_0x57fc40[0x1]);_0x147858&&(_0x147858['textContent']=_0x342936['JgBQg']);}}),_0x154acf[_0x460dff(0x347)](setTimeout,()=>{const _0x55f4d1=_0x460dff,_0x5311a7={'JlDKC':_0x342936[_0x55f4d1(0x223)],'iLOmc':_0x342936[_0x55f4d1(0x35f)]};window[_0x55f4d1(0x1f5)](),setTimeout(()=>{const _0x71b4d3=_0x55f4d1,_0x3c1682={'qccGA':_0x342936[_0x71b4d3(0x17e)]};_0x49b613[_0x71b4d3(0x1fd)](_0x209726=>{const _0x578728=_0x71b4d3,_0x5505b9=document[_0x578728(0x3bb)](_0x578728(0x348)+_0x209726),_0x1c6c66=document['getElementById']('toggle-pm-'+_0x209726);_0x5505b9&&_0x5505b9[_0x578728(0x385)]['add'](_0x3c1682[_0x578728(0x3b3)]),_0x1c6c66&&(_0x1c6c66[_0x578728(0x2a7)]='▶');}),_0x414db1['forEach'](_0x95b39d=>{const _0x47c57c=_0x71b4d3,_0x7ae0c0=document[_0x47c57c(0x3bb)]('maco-breakdown-details-'+_0x95b39d),_0x51f1e9=document[_0x47c57c(0x3bb)](_0x47c57c(0x31c)+_0x95b39d);_0x7ae0c0&&_0x7ae0c0['classList'][_0x47c57c(0x2a0)](_0x5311a7['JlDKC']),_0x51f1e9&&(_0x51f1e9[_0x47c57c(0x2a7)]=_0x5311a7[_0x47c57c(0x161)]);});},0x3e8);},0xc8);})):_0x154acf['IFMcM']===_0x762bbb?(window['printSelectedTrain']=_0x3e91b7,import('./macoDetergentView.js')[_0x173238(0x339)](_0x19f044=>{const _0x547664=_0x173238,_0x159aeb={'giowq':_0x154acf[_0x547664(0x2f8)],'pJOMt':function(_0x37321f,_0x2ba063,_0x4124a5){return _0x37321f(_0x2ba063,_0x4124a5);}};_0x19f044[_0x547664(0x23f)]();const _0x577210=document[_0x547664(0x1ce)](_0x154acf[_0x547664(0x16b)]),_0x39c882=[];_0x577210[_0x547664(0x1fd)](_0x37b860=>{const _0x320f10=_0x547664,_0x413e03=_0x37b860['id']['match'](/content-dm-(\d+)/);if(_0x413e03){_0x39c882['push'](_0x413e03[0x1]),_0x37b860[_0x320f10(0x385)][_0x320f10(0x227)](_0x154acf['mfGhV']);const _0x439679=document[_0x320f10(0x3bb)](_0x320f10(0x288)+_0x413e03[0x1]);_0x439679&&(_0x439679[_0x320f10(0x2a7)]='▼');}}),_0x154acf[_0x547664(0x376)](setTimeout,()=>{const _0x37639d=_0x547664,_0x531de0={'FCeJp':_0x159aeb[_0x37639d(0x258)]};window['print'](),_0x159aeb['pJOMt'](setTimeout,()=>{_0x39c882['forEach'](_0x49be54=>{const _0x2b9a09=a13_0xd75d,_0x42af87=document[_0x2b9a09(0x3bb)](_0x2b9a09(0x1a7)+_0x49be54),_0x374618=document[_0x2b9a09(0x3bb)](_0x2b9a09(0x288)+_0x49be54);_0x42af87&&_0x42af87[_0x2b9a09(0x385)][_0x2b9a09(0x2a0)](_0x531de0[_0x2b9a09(0x389)]),_0x374618&&(_0x374618[_0x2b9a09(0x2a7)]='▶');});},0x3e8);},0xc8);})['catch'](_0x512fd4=>{const _0x423f46=_0x173238;console[_0x423f46(0x345)](_0x154acf[_0x423f46(0x2cd)],_0x512fd4),window[_0x423f46(0x1f5)]();})[_0x173238(0x174)](()=>{const _0x2811fb=_0x173238;_0x154acf[_0x2811fb(0x255)](setTimeout,()=>{const _0x389201=_0x2811fb;window['printSelectedTrain']=null,import(_0x154acf[_0x389201(0x2bf)])[_0x389201(0x339)](_0x11bdb3=>_0x11bdb3['renderDetergentMaco']())[_0x389201(0x2d3)](()=>{});},0x4b0);})):_0x154acf[_0x173238(0x346)](_0x154acf[_0x173238(0x1b4)],_0x762bbb)?(window[_0x173238(0x244)]=_0x3e91b7,console[_0x173238(0x36d)](_0x173238(0x362),_0x3e91b7),import(_0x154acf['OPcZp'])['then'](_0x238928=>{const _0x3d3a3b=_0x173238;_0x238928[_0x3d3a3b(0x356)](),setTimeout(()=>{const _0x2a73da=_0x3d3a3b,_0x245a71=document['getElementById'](_0x154acf[_0x2a73da(0x2bb)]),_0x42d475=document[_0x2a73da(0x3bb)](_0x154acf['TqUHa']);if(console[_0x2a73da(0x36d)](_0x154acf['kOjvb'],_0x245a71?_0x245a71[_0x2a73da(0x2b4)][_0x2a73da(0x36a)]:_0x154acf['OXVAo']),console['log'](_0x154acf['uJGIg'],_0x42d475?_0x42d475[_0x2a73da(0x2b4)][_0x2a73da(0x36a)]:_0x154acf[_0x2a73da(0x214)]),console[_0x2a73da(0x36d)](_0x154acf[_0x2a73da(0x296)],!!_0x245a71&&_0x154acf[_0x2a73da(0x254)](_0x245a71[_0x2a73da(0x1e6)][_0x2a73da(0x22a)],0x0)),!_0x245a71||_0x154acf[_0x2a73da(0x1f6)](_0x154acf[_0x2a73da(0x3a9)],_0x245a71[_0x2a73da(0x2b4)][_0x2a73da(0x36a)]))return console[_0x2a73da(0x19a)](_0x2a73da(0x205)),void alert(_0x2a73da(0x25d));window[_0x2a73da(0x1f5)](),_0x154acf[_0x2a73da(0x187)](setTimeout,()=>{const _0x168449=_0x2a73da;window['printSelectedTrain']=null,_0x238928[_0x168449(0x356)]();},0x3e8);},0x1f4);})[_0x173238(0x2d3)](_0x14d264=>{const _0x9f8dd9=_0x173238;console[_0x9f8dd9(0x345)]('Error\x20loading\x20train\x20summary\x20view:',_0x14d264),alert(_0x154acf[_0x9f8dd9(0x1da)]+_0x14d264[_0x9f8dd9(0x2e7)]);})):_0x154acf[_0x173238(0x187)](setTimeout,()=>{window['print']();},0x64);}export function toggleColumn(_0x248993,_0x1c2932){const _0x18edf6=a13_0x17be56,_0x262a77={'lNGVz':function(_0x1a5a57,_0x141f63){return _0x1a5a57===_0x141f63;},'SmMnq':function(_0x4b2eb8,_0xc09c38){return _0x4b2eb8===_0xc09c38;},'lJjXj':'ld50','eicvj':_0x18edf6(0x35c),'qLuXb':_0x18edf6(0x25a),'ognEo':function(_0x57887a,_0x33a915){return _0x57887a!==_0x33a915;},'ZLNlW':function(_0x4302a1,_0x4a8907){return _0x4302a1(_0x4a8907);},'JdZaG':_0x18edf6(0x2bd),'IzbcF':function(_0x2ef5d5,_0x1a78ed){return _0x2ef5d5(_0x1a78ed);}};if(_0x262a77[_0x18edf6(0x201)](_0x18edf6(0x307),_0x248993)||_0x262a77[_0x18edf6(0x164)](_0x262a77[_0x18edf6(0x211)],_0x248993)){[_0x262a77[_0x18edf6(0x17a)],_0x262a77['qLuXb']]['forEach'](_0x30a6e9=>{const _0x41477b=_0x18edf6;document[_0x41477b(0x1ce)]('#'+_0x30a6e9+_0x41477b(0x2c6)+_0x30a6e9+_0x41477b(0x157))[_0x41477b(0x1fd)](_0x499e35=>{_0x499e35['classList']['toggle']('hide-'+_0x248993);}),document[_0x41477b(0x1ce)]('#'+_0x30a6e9+_0x41477b(0x309)+_0x30a6e9+_0x41477b(0x1a3))[_0x41477b(0x1fd)](_0x41704b=>{const _0x461fab=_0x41477b;_0x41704b&&_0x41704b[_0x461fab(0x385)][_0x461fab(0x235)]('hide-'+_0x248993);});});const _0x107988=_0x262a77[_0x18edf6(0x21d)](null,document['querySelector'](_0x18edf6(0x156)+_0x248993));localStorage['setItem'](_0x18edf6(0x191)+_0x248993+_0x18edf6(0x1a8),_0x107988),_0x262a77[_0x18edf6(0x184)](updateToggleIcons,_0x262a77[_0x18edf6(0x17a)]),updateToggleIcons(_0x262a77['qLuXb']),import(_0x262a77[_0x18edf6(0x3bc)])[_0x18edf6(0x339)](_0xf97629=>{const _0x1c62ba=_0x18edf6;_0xf97629[_0x1c62ba(0x1ba)]();}),import(_0x262a77[_0x18edf6(0x3bc)])['then'](_0x2115f2=>{const _0x397edc=_0x18edf6;_0x2115f2['renderRpnChart']&&_0x2115f2[_0x397edc(0x247)]();});}else{document[_0x18edf6(0x1ce)]('#'+_0x1c2932+_0x18edf6(0x2c6)+_0x1c2932+_0x18edf6(0x157))['forEach'](_0x4cd8ce=>{const _0x245591=_0x18edf6;_0x4cd8ce[_0x245591(0x385)]['toggle'](_0x245591(0x19e)+_0x248993);});const _0x1d431e=null!==document[_0x18edf6(0x3b6)]('#'+_0x1c2932+_0x18edf6(0x3a5)+_0x248993);localStorage[_0x18edf6(0x35b)](_0x1c2932+'-'+_0x248993+_0x18edf6(0x1a8),_0x1d431e),_0x262a77['IzbcF'](updateToggleIcons,_0x1c2932);}}export function toggleColumnVisibilityDropdown(){const _0x1f44bd=a13_0x17be56,_0x37e25c={'uYCGz':_0x1f44bd(0x299),'sIFmI':_0x1f44bd(0x3a4),'Vgito':'hidden','RdhoY':_0x1f44bd(0x192),'BkLjC':'columnVisibilityDropdown'},_0x4cc96f=document[_0x1f44bd(0x3bb)](_0x37e25c['BkLjC']);_0x4cc96f['classList'][_0x1f44bd(0x235)](_0x37e25c[_0x1f44bd(0x279)]),_0x4cc96f[_0x1f44bd(0x385)][_0x1f44bd(0x20f)]('hidden')||document['addEventListener'](_0x37e25c['RdhoY'],function _0x208753(_0xc066cb){const _0x33849d=_0x1f44bd;_0xc066cb['target'][_0x33849d(0x2e2)](_0x37e25c[_0x33849d(0x351)])||_0xc066cb[_0x33849d(0x217)]['closest'](_0x37e25c[_0x33849d(0x267)])||(_0x4cc96f[_0x33849d(0x385)]['add'](_0x37e25c[_0x33849d(0x279)]),document[_0x33849d(0x306)](_0x37e25c['RdhoY'],_0x208753));});}export function updateToggleIcons(_0x19dcaa){const _0x1459c2=a13_0x17be56,_0x10f879={'TTlew':_0x1459c2(0x177),'QaSue':_0x1459c2(0x219),'KrAZj':function(_0x27af78,_0x5e0d11){return _0x27af78===_0x5e0d11;},'xPCsH':_0x1459c2(0x25a),'qdOhL':_0x1459c2(0x253),'JXwBF':'productRegister-ld50Hidden','uDZHz':function(_0x264b60,_0x349a95){return _0x264b60===_0x349a95;},'DyMCB':function(_0x5dc428,_0x4a8148){return _0x5dc428===_0x4a8148;},'Xhiur':'true','Miuuc':function(_0x20414e,_0x5847f7){return _0x20414e&&_0x5847f7;},'hzsSY':_0x1459c2(0x342),'NbYeY':_0x1459c2(0x359),'Ncglc':_0x1459c2(0x19c),'PtNDQ':_0x1459c2(0x207),'CMmFN':'Hide\x20LD50'},_0xef3409=document[_0x1459c2(0x3bb)](_0x19dcaa);if(!_0xef3409)return;let _0x4646fa,_0x33e5f5;if(_0x10f879[_0x1459c2(0x2b0)](_0x10f879[_0x1459c2(0x2c0)],_0x19dcaa)){const _0x316db6=localStorage[_0x1459c2(0x225)](_0x10f879[_0x1459c2(0x1d4)]),_0x3bcd67=localStorage[_0x1459c2(0x225)](_0x10f879['JXwBF']);if(null===_0x316db6&&_0x10f879[_0x1459c2(0x312)](null,_0x3bcd67))_0x4646fa=!0x1,_0x33e5f5=!0x1;else{const _0x205737=_0x10f879[_0x1459c2(0x1c3)](_0x10f879[_0x1459c2(0x1d3)],_0x316db6),_0x5cc7ae=_0x10f879[_0x1459c2(0x312)](_0x10f879['Xhiur'],_0x3bcd67);_0x10f879[_0x1459c2(0x33e)](_0x205737,_0x5cc7ae)?(_0x4646fa=!0x1,_0x33e5f5=!0x0):(_0x4646fa=_0x205737,_0x33e5f5=_0x5cc7ae);}}else{const _0x5c4045=localStorage[_0x1459c2(0x225)](_0x19dcaa+_0x1459c2(0x349)),_0x43c4ba=localStorage[_0x1459c2(0x225)](_0x19dcaa+_0x1459c2(0x25f));_0x4646fa=_0x1459c2(0x1c7)===_0x5c4045,_0x33e5f5='true'===_0x43c4ba;}const _0x2d1070=_0xef3409[_0x1459c2(0x3b6)](_0x10f879['hzsSY']),_0x3e4cbd=_0xef3409[_0x1459c2(0x3b6)](_0x10f879[_0x1459c2(0x30e)]);_0x2d1070&&(_0x2d1070[_0x1459c2(0x1e6)]=_0x4646fa?_0x10f879[_0x1459c2(0x34f)]:_0x10f879[_0x1459c2(0x2be)]),_0x3e4cbd&&(_0x3e4cbd[_0x1459c2(0x1e6)]=_0x33e5f5?'Show\x20LD50':_0x10f879[_0x1459c2(0x392)]),document[_0x1459c2(0x1ce)]('#'+_0x19dcaa+_0x1459c2(0x2c6)+_0x19dcaa+_0x1459c2(0x157))[_0x1459c2(0x1fd)](_0xecbf8d=>{const _0x16966d=_0x1459c2;_0xecbf8d&&(_0xecbf8d['classList']['toggle'](_0x10f879[_0x16966d(0x3ad)],_0x4646fa),_0xecbf8d['classList'][_0x16966d(0x235)](_0x10f879[_0x16966d(0x169)],_0x33e5f5));}),document[_0x1459c2(0x1ce)]('#'+_0x19dcaa+',\x20#'+_0x19dcaa+_0x1459c2(0x1a3))[_0x1459c2(0x1fd)](_0x4a171c=>{const _0x32b3ca=_0x1459c2;_0x4a171c&&(_0x4a171c[_0x32b3ca(0x385)]['toggle'](_0x10f879['TTlew'],_0x4646fa),_0x4a171c[_0x32b3ca(0x385)][_0x32b3ca(0x235)]('hide-ld50',_0x33e5f5));});}export function exportToExcel(){const _0x41e8c2=a13_0x17be56,_0x54098d={'qgLwb':function(_0x47ee53,_0x3d3cec){return _0x47ee53(_0x3d3cec);},'eZNas':_0x41e8c2(0x2d9),'euxnQ':function(_0x16254c,_0x2a6c1a){return _0x16254c===_0x2a6c1a;},'gDMEK':function(_0x5db4b6,_0x1385af,_0x33b084){return _0x5db4b6(_0x1385af,_0x33b084);},'OrVeN':'There\x20is\x20no\x20data\x20in\x20the\x20current\x20view\x20to\x20export.','ZclHg':_0x41e8c2(0x222),'uOtFx':function(_0x2e1196){return _0x2e1196();},'DWuBD':_0x41e8c2(0x1b1),'audml':function(_0x4edf1f,_0x19c22d,_0xff242d){return _0x4edf1f(_0x19c22d,_0xff242d);},'UQtMf':_0x41e8c2(0x3a2),'hjbcw':_0x41e8c2(0x2d7),'VTXYH':_0x41e8c2(0x3be)};showLoader(),import(_0x54098d['VTXYH'])[_0x41e8c2(0x339)](_0x154f96=>{const _0x5d72ad=_0x41e8c2,{getProductTrainId:_0xbd378a,calculateScores:_0x288e6f}=_0x154f96,_0x40e45a=[];if(a13_0x26f094[_0x5d72ad(0x21b)][_0x5d72ad(0x1fd)](_0x4cfee3=>{const _0x2221a8=_0x5d72ad,_0x42389b={'dJigL':function(_0x31164e,_0x2e71f7){const _0x545c5a=a13_0xd75d;return _0x54098d[_0x545c5a(0x24d)](_0x31164e,_0x2e71f7);}};let _0xf69818='No';_0x4cfee3[_0x2221a8(0x1b9)]&&(_0xf69818=_0x54098d[_0x2221a8(0x283)]+(_0x4cfee3[_0x2221a8(0x37a)]?':\x20'+_0x4cfee3[_0x2221a8(0x37a)]:''));const _0x886462=_0x54098d[_0x2221a8(0x24d)](_0xbd378a,_0x4cfee3),_0x1f0f9c=_0x4cfee3[_0x2221a8(0x28a)]?new Date(_0x4cfee3[_0x2221a8(0x28a)])[_0x2221a8(0x1bb)]():'';_0x40e45a['push']({'Date':_0x1f0f9c,'Product\x20Code':_0x4cfee3[_0x2221a8(0x301)],'Product\x20Name':_0x4cfee3[_0x2221a8(0x203)],'Train\x20No.':_0x886462,'Dosage\x20Form':_0x4cfee3[_0x2221a8(0x375)]||'','Batch\x20Size\x20(Kg)':_0x4cfee3[_0x2221a8(0x1a4)],'Special\x20Case\x20Product':_0xf69818,'Active\x20Ingredient':'','Solubility':'','Therapeutic\x20Dose\x20(mg/day)':'','Cleanability':'','PDE\x20(µg/day)':'','LD50\x20(mg/kg)':'','Solubility\x20Score':'','Therapeutic\x20Dose\x20Score':'','Cleanability\x20Score':'','Toxicity\x20Score':'','RPN':'','RPN\x20Rating':''}),_0x4cfee3['activeIngredients'][_0x2221a8(0x1fd)](_0x44561a=>{const _0x1da729=_0x2221a8,_0x3f6b58=_0x42389b[_0x1da729(0x1dd)](_0x288e6f,_0x44561a);_0x40e45a[_0x1da729(0x17f)]({'Date':'','Product\x20Code':'','Product\x20Name':_0x1da729(0x379)+_0x44561a[_0x1da729(0x203)],'Train\x20No.':'','Dosage\x20Form':'','Batch\x20Size\x20(Kg)':'','Special\x20Case\x20Product':'','Active\x20Ingredient':_0x44561a[_0x1da729(0x203)],'Solubility':_0x44561a[_0x1da729(0x180)]||'','Therapeutic\x20Dose\x20(mg/day)':_0x44561a[_0x1da729(0x3a0)]||'','Cleanability':_0x44561a[_0x1da729(0x369)]||'','PDE\x20(µg/day)':_0x44561a['pde']||'','LD50\x20(mg/kg)':_0x44561a[_0x1da729(0x262)]||'','Solubility\x20Score':_0x3f6b58[_0x1da729(0x1c6)]||'','Therapeutic\x20Dose\x20Score':_0x3f6b58[_0x1da729(0x172)]||'','Cleanability\x20Score':_0x3f6b58[_0x1da729(0x1f4)]||'','Toxicity\x20Score':_0x3f6b58[_0x1da729(0x1c1)]||_0x3f6b58['ld50Score']||'','RPN':_0x3f6b58[_0x1da729(0x361)],'RPN\x20Rating':_0x3f6b58[_0x1da729(0x248)]});});}),_0x54098d[_0x5d72ad(0x2f4)](0x0,_0x40e45a[_0x5d72ad(0x22a)]))return hideLoader(),void _0x54098d['gDMEK'](showCustomAlert,_0x5d72ad(0x338),_0x54098d[_0x5d72ad(0x2ae)]);const _0x2d49f1=XLSX[_0x5d72ad(0x3b5)]['json_to_sheet'](_0x40e45a),_0xe43721=XLSX['utils'][_0x5d72ad(0x29c)]();XLSX[_0x5d72ad(0x3b5)]['book_append_sheet'](_0xe43721,_0x2d49f1,_0x5d72ad(0x2cf));const _0x2ffe32=Object[_0x5d72ad(0x17b)](_0x40e45a[0x0])['map'](_0x242404=>({'wch':Math['max'](_0x242404[_0x5d72ad(0x22a)],..._0x40e45a[_0x5d72ad(0x18c)](_0x3f608d=>String(_0x3f608d[_0x242404]||'')[_0x5d72ad(0x22a)]))+0x2}));_0x2d49f1[_0x5d72ad(0x260)]=_0x2ffe32,XLSX[_0x5d72ad(0x2ec)](_0xe43721,_0x54098d['ZclHg']),_0x54098d[_0x5d72ad(0x311)](hideLoader);})[_0x41e8c2(0x2d3)](_0x26408c=>{const _0x41b394=_0x41e8c2;console['error'](_0x54098d[_0x41b394(0x325)],_0x26408c),_0x54098d[_0x41b394(0x311)](hideLoader),_0x54098d[_0x41b394(0x2cc)](showCustomAlert,_0x54098d[_0x41b394(0x38b)],_0x54098d['hjbcw']);});}export function exportAllToJson(){const _0x17a03d=a13_0x17be56,_0x363c2f={'UcuwS':function(_0x16745c){return _0x16745c();},'HVNFD':function(_0x1cc754,_0xd334a3,_0x374740){return _0x1cc754(_0xd334a3,_0x374740);},'CeTFO':'Error','KruYN':function(_0x424a0e,_0x311e3e){return _0x424a0e+_0x311e3e;},'blyRQ':_0x17a03d(0x37e)};_0x363c2f[_0x17a03d(0x2f9)](showLoader);try{const _0x14786f={'exportDate':new Date()[_0x17a03d(0x1af)](),'scoringCriteria':a13_0x26f094[_0x17a03d(0x3bd)],'products':a13_0x26f094[_0x17a03d(0x21b)],'machines':a13_0x26f094['machines'],'detergentIngredients':a13_0x26f094['detergentIngredients']},_0x22ef1b=JSON[_0x17a03d(0x2b1)](_0x14786f,null,0x2),_0x2857e=new Blob([_0x22ef1b],{'type':_0x17a03d(0x1df)}),_0x188fa4=URL[_0x17a03d(0x229)](_0x2857e),_0x4c42ba=document[_0x17a03d(0x2e1)]('a');_0x4c42ba[_0x17a03d(0x2ac)]=_0x188fa4,_0x4c42ba['download']=_0x17a03d(0x3b9),document['body'][_0x17a03d(0x20d)](_0x4c42ba),_0x4c42ba['click'](),document[_0x17a03d(0x2e5)][_0x17a03d(0x24a)](_0x4c42ba),URL[_0x17a03d(0x2c2)](_0x188fa4);}catch(_0x44689e){_0x363c2f[_0x17a03d(0x399)](showCustomAlert,_0x363c2f['CeTFO'],_0x363c2f[_0x17a03d(0x246)](_0x363c2f[_0x17a03d(0x2c1)],_0x44689e[_0x17a03d(0x2e7)]));}finally{_0x363c2f[_0x17a03d(0x2f9)](hideLoader);}}export function importFromJson(_0x55a0a0){const _0x8611fb=a13_0x17be56,_0x23c845={'mZjpI':function(_0x51ce7e){return _0x51ce7e();},'zVEFM':function(_0x3a88fb,_0x1a16ef,_0x5035f5){return _0x3a88fb(_0x1a16ef,_0x5035f5);},'tMlNz':_0x8611fb(0x344),'YNboK':'Data\x20imported\x20successfully.','bdztL':function(_0x261770,_0x299e36,_0x5ca892){return _0x261770(_0x299e36,_0x5ca892);},'oNgXE':'Error','hLUSW':_0x8611fb(0x314)},_0x4668db=_0x55a0a0['target'][_0x8611fb(0x387)][0x0];if(!_0x4668db)return;const _0x19e0a4=new FileReader();_0x19e0a4[_0x8611fb(0x331)]=function(_0x5b074e){const _0x3f56c5=_0x8611fb;try{const _0x2d2a44=JSON[_0x3f56c5(0x26d)](_0x5b074e['target']['result']);_0x2d2a44&&_0x2d2a44[_0x3f56c5(0x21b)]&&_0x2d2a44['scoringCriteria']&&_0x2d2a44[_0x3f56c5(0x1b2)]?(a13_0x26f094[_0x3f56c5(0x341)](_0x2d2a44[_0x3f56c5(0x21b)]),a13_0x26f094[_0x3f56c5(0x22f)](_0x2d2a44[_0x3f56c5(0x1b2)]),a13_0x26f094['setScoringCriteria'](_0x2d2a44[_0x3f56c5(0x3bd)]),_0x2d2a44['detergentIngredients']&&a13_0x26f094['setDetergentIngredients'](_0x2d2a44[_0x3f56c5(0x28b)]),_0x23c845[_0x3f56c5(0x2b9)](saveStateForUndo),a13_0x34d913(),_0x23c845[_0x3f56c5(0x22c)](showCustomAlert,_0x23c845[_0x3f56c5(0x1d7)],_0x23c845['YNboK'])):_0x23c845[_0x3f56c5(0x1e3)](showCustomAlert,_0x23c845[_0x3f56c5(0x272)],_0x23c845[_0x3f56c5(0x2ba)]);}catch(_0x399793){_0x23c845[_0x3f56c5(0x22c)](showCustomAlert,_0x23c845['oNgXE'],_0x3f56c5(0x2fe));}finally{_0x55a0a0[_0x3f56c5(0x217)][_0x3f56c5(0x37f)]='';}},_0x19e0a4[_0x8611fb(0x2c9)](_0x4668db);}function a13_0xd75d(_0x53e49b,_0x46ffa8){const _0x5d7dcb=a13_0x5d7d();return a13_0xd75d=function(_0xd75d9f,_0x30b736){_0xd75d9f=_0xd75d9f-0x14c;let _0x215c4d=_0x5d7dcb[_0xd75d9f];return _0x215c4d;},a13_0xd75d(_0x53e49b,_0x46ffa8);}export function toggleOtherProductType(_0x1bef92,_0x543a1e){const _0x1c2e4b=a13_0x17be56,_0x14a894={'ZnwtF':'input','yrHhf':function(_0x397017,_0x1d7ee8){return _0x397017===_0x1d7ee8;},'Qhqwr':_0x1c2e4b(0x308),'MjVjx':_0x1c2e4b(0x30c),'HogBo':_0x1c2e4b(0x22d)},_0x5b6371=document['getElementById'](_0x543a1e),_0x4802f5=_0x5b6371[_0x1c2e4b(0x3b6)](_0x14a894[_0x1c2e4b(0x1ed)]);_0x14a894[_0x1c2e4b(0x28f)](_0x14a894[_0x1c2e4b(0x1b0)],_0x1bef92[_0x1c2e4b(0x37f)])?(_0x5b6371[_0x1c2e4b(0x2b4)][_0x1c2e4b(0x36a)]=_0x14a894[_0x1c2e4b(0x1b5)],_0x4802f5[_0x1c2e4b(0x2ab)]=!0x0):(_0x5b6371[_0x1c2e4b(0x2b4)][_0x1c2e4b(0x36a)]=_0x14a894[_0x1c2e4b(0x2fc)],_0x4802f5[_0x1c2e4b(0x2ab)]=!0x1,_0x4802f5[_0x1c2e4b(0x37f)]='');}export function toggleOtherMachineStage(_0x33f2ce,_0x382c3f){const _0x4200e5=a13_0x17be56,_0x2a0814={'CRKbs':_0x4200e5(0x230),'ZgGOC':_0x4200e5(0x308),'GxpMh':_0x4200e5(0x30c)},_0x6dbdbf=document[_0x4200e5(0x3bb)](_0x382c3f),_0x9af8e8=_0x6dbdbf[_0x4200e5(0x3b6)](_0x2a0814['CRKbs']);_0x2a0814[_0x4200e5(0x34d)]===_0x33f2ce[_0x4200e5(0x37f)]?(_0x6dbdbf['style'][_0x4200e5(0x36a)]=_0x2a0814[_0x4200e5(0x391)],_0x9af8e8[_0x4200e5(0x2ab)]=!0x0):(_0x6dbdbf[_0x4200e5(0x2b4)][_0x4200e5(0x36a)]=_0x4200e5(0x22d),_0x9af8e8[_0x4200e5(0x2ab)]=!0x1,_0x9af8e8[_0x4200e5(0x37f)]='');}export function toggleOtherMachineGroup(_0x35b83e,_0x5378ab){const _0x1ed90c=a13_0x17be56,_0x28b006={'xiEzj':function(_0x464b00,_0x4dec8a){return _0x464b00===_0x4dec8a;},'qJhdb':'none'},_0x5ec454=document[_0x1ed90c(0x3bb)](_0x5378ab),_0x3cf760=_0x5ec454[_0x1ed90c(0x3b6)](_0x1ed90c(0x230));_0x28b006[_0x1ed90c(0x1fe)](_0x1ed90c(0x308),_0x35b83e[_0x1ed90c(0x37f)])?(_0x5ec454[_0x1ed90c(0x2b4)][_0x1ed90c(0x36a)]='block',_0x3cf760['required']=!0x0):(_0x5ec454['style'][_0x1ed90c(0x36a)]=_0x28b006[_0x1ed90c(0x395)],_0x3cf760[_0x1ed90c(0x2ab)]=!0x1,_0x3cf760['value']='');}export function clampSafetyFactor(_0x5e3ba9,_0x3c6fac){const _0x3b24c8=a13_0x17be56,_0x1ec0e1={'FtjqN':function(_0x934f80,_0x5406b3){return _0x934f80(_0x5406b3);},'ixqyD':function(_0xe07ddd,_0x238e56){return _0xe07ddd<_0x238e56;},'pRLTs':function(_0x2dd7c0,_0x1909d3){return _0x2dd7c0>_0x1909d3;},'xonHR':function(_0x3a72cc,_0x3e7ee9){return _0x3a72cc!==_0x3e7ee9;},'ukvEV':_0x3b24c8(0x158),'Rcvsr':'sf-input-train','HGyiz':function(_0x477140,_0x1477af){return _0x477140(_0x1477af);}},_0x2f7792=_0x1ec0e1[_0x3b24c8(0x3aa)](parseFloat,_0x5e3ba9[_0x3b24c8(0x2b7)]),_0x456eb2=parseFloat(_0x5e3ba9[_0x3b24c8(0x18b)]);let _0x2bb371=parseFloat(_0x5e3ba9['value']);isNaN(_0x2bb371)&&(_0x2bb371=_0x2f7792),_0x1ec0e1[_0x3b24c8(0x276)](_0x2bb371,_0x2f7792)?_0x2bb371=_0x2f7792:_0x1ec0e1['pRLTs'](_0x2bb371,_0x456eb2)&&(_0x2bb371=_0x456eb2),_0x1ec0e1[_0x3b24c8(0x32d)](parseFloat(_0x5e3ba9['value']),_0x2bb371)&&(_0x5e3ba9[_0x3b24c8(0x37f)]=_0x2bb371),_0x5e3ba9['id'][_0x3b24c8(0x3b8)](_0x1ec0e1[_0x3b24c8(0x14e)])?recalculateProductMacoForTrain(_0x3c6fac):_0x5e3ba9['id']['startsWith'](_0x1ec0e1[_0x3b24c8(0x27c)])&&_0x1ec0e1[_0x3b24c8(0x21f)](recalculateDetergentMacoForTrain,_0x3c6fac);}export function toggleTrain(_0x5d746d){const _0x5f2b6f=a13_0x17be56,_0x711511={'CFGBL':function(_0x2df762,_0x2d3726){return _0x2df762&&_0x2d3726;},'vvZpz':'collapsed'},_0x57153e=document[_0x5f2b6f(0x3bb)](_0x5f2b6f(0x2ce)+_0x5d746d),_0x23adbd=document['getElementById'](_0x5f2b6f(0x213)+_0x5d746d);_0x711511[_0x5f2b6f(0x336)](_0x57153e,_0x23adbd)&&(_0x57153e[_0x5f2b6f(0x385)][_0x5f2b6f(0x20f)](_0x711511[_0x5f2b6f(0x1b8)])?(_0x57153e[_0x5f2b6f(0x385)][_0x5f2b6f(0x227)](_0x5f2b6f(0x343)),_0x23adbd[_0x5f2b6f(0x2a7)]='▼'):(_0x57153e[_0x5f2b6f(0x385)]['add'](_0x711511[_0x5f2b6f(0x1b8)]),_0x23adbd[_0x5f2b6f(0x2a7)]='▶'));}export function toggleMacoBreakdown(_0x38aacf){const _0x3c1ef4=a13_0x17be56,_0x1577d1={'KZWqp':_0x3c1ef4(0x1e4),'ZXBfc':'Hide\x20MACO\x20Calculation\x20Breakdown','xOAdY':_0x3c1ef4(0x208)},_0xc298af=document[_0x3c1ef4(0x3bb)](_0x3c1ef4(0x313)+_0x38aacf),_0x2f42e8=document['getElementById'](_0x3c1ef4(0x31c)+_0x38aacf);_0xc298af[_0x3c1ef4(0x385)][_0x3c1ef4(0x20f)](_0x1577d1['KZWqp'])?(_0xc298af[_0x3c1ef4(0x385)][_0x3c1ef4(0x227)](_0x1577d1[_0x3c1ef4(0x17c)]),_0x2f42e8[_0x3c1ef4(0x2a7)]=_0x1577d1['ZXBfc']):(_0xc298af[_0x3c1ef4(0x385)][_0x3c1ef4(0x2a0)](_0x1577d1[_0x3c1ef4(0x17c)]),_0x2f42e8['textContent']=_0x1577d1['xOAdY']);}export function exportWorstCaseToExcel(_0x4105b8=a13_0x17be56(0x29d)){const _0x4fb484=a13_0x17be56,_0x12a6d8={'ObiEU':function(_0x49f341,_0x5653b8){return _0x49f341!==_0x5653b8;},'wysTu':'N/A','NApqQ':function(_0x3f11a6,_0x23f1f0){return _0x3f11a6>_0x23f1f0;},'BTCOk':function(_0x278e44,_0x11affe,_0x54d808){return _0x278e44(_0x11affe,_0x54d808);},'ZvzBo':_0x4fb484(0x338),'SBZvo':_0x4fb484(0x29d),'QFDWY':function(_0x171d0b,_0x44fc97){return _0x171d0b===_0x44fc97;},'WBDui':function(_0x951f0e){return _0x951f0e();},'QCtkv':function(_0x417f57){return _0x417f57();},'iCiZP':_0x4fb484(0x388),'vNbMk':_0x4fb484(0x2f3),'dfDPp':function(_0x5ed177,_0x313255){return _0x5ed177!==_0x313255;},'SmBbE':_0x4fb484(0x39b),'eDlce':function(_0x305f9b){return _0x305f9b();},'mURyF':function(_0x5077bb,_0x3812f9,_0x3ffd17){return _0x5077bb(_0x3812f9,_0x3ffd17);},'gmppC':'Error','ZWxhg':_0x4fb484(0x1e9),'rjmsd':function(_0x5be427){return _0x5be427();},'SBlmV':_0x4fb484(0x3be)};_0x12a6d8[_0x4fb484(0x2eb)](showLoader),import(_0x12a6d8['SBlmV'])[_0x4fb484(0x339)](_0x5d450c=>{const _0x22affb=_0x4fb484,_0x1f0807={'oWjWb':function(_0x50a5f2,_0x41f7c8){const _0x542d6d=a13_0xd75d;return _0x12a6d8[_0x542d6d(0x38c)](_0x50a5f2,_0x41f7c8);},'NbVIJ':function(_0x25a518,_0xd95b28,_0xa98006){const _0x1328c3=a13_0xd75d;return _0x12a6d8[_0x1328c3(0x321)](_0x25a518,_0xd95b28,_0xa98006);},'SeebR':_0x22affb(0x2d9)},{getProductTrainId:_0x29392c,calculateScores:_0xb721b2,getToxicityPreference:_0x1d31dc}=_0x5d450c,_0x374f77=[];let _0x13d50a=a13_0x26f094[_0x22affb(0x34a)][_0x22affb(0x25a)]||a13_0x26f094[_0x22affb(0x21b)];if(0x0===_0x13d50a['length'])return hideLoader(),void _0x12a6d8[_0x22affb(0x321)](showCustomAlert,_0x12a6d8['ZvzBo'],_0x22affb(0x1dc));const _0xbc5a0b={};_0x13d50a[_0x22affb(0x1fd)](_0xe81e87=>{const _0x565b62=_0x22affb,_0x5752df=_0x29392c(_0xe81e87);_0x12a6d8[_0x565b62(0x36c)](_0x12a6d8[_0x565b62(0x30a)],_0x5752df)&&(_0xbc5a0b[_0x5752df]||(_0xbc5a0b[_0x5752df]=[]),_0xbc5a0b[_0x5752df]['push'](_0xe81e87));});let _0x5b9879=_0xbc5a0b;if(_0x12a6d8[_0x22affb(0x199)]!==_0x4105b8&&(_0x5b9879={},Array['isArray'](_0x4105b8)?_0x4105b8[_0x22affb(0x1fd)](_0x2b7152=>{_0xbc5a0b[_0x2b7152]&&(_0x5b9879[_0x2b7152]=_0xbc5a0b[_0x2b7152]);}):_0xbc5a0b[_0x4105b8]&&(_0x5b9879={[_0x4105b8]:_0xbc5a0b[_0x4105b8]}),_0x12a6d8[_0x22affb(0x23a)](0x0,Object[_0x22affb(0x17b)](_0x5b9879)[_0x22affb(0x22a)])))return hideLoader(),void showCustomAlert(_0x22affb(0x338),(Array[_0x22affb(0x212)](_0x4105b8)?_0x22affb(0x1f8)+_0x4105b8['join'](',\x20'):'Train\x20'+_0x4105b8)+'\x20not\x20found\x20or\x20has\x20no\x20products.');const _0x4198e3=_0x12a6d8[_0x22affb(0x1a1)](_0x1d31dc);if(Object['keys'](_0x5b9879)[_0x22affb(0x270)]((_0x3bb318,_0x1713fd)=>_0x3bb318-_0x1713fd)[_0x22affb(0x1fd)](_0x43cdc9=>{const _0x5e1f7e=_0x22affb,_0x5e7592={'Auqan':function(_0x3e3d07,_0x26ea75,_0xa5e7f3){return _0x1f0807['NbVIJ'](_0x3e3d07,_0x26ea75,_0xa5e7f3);},'aNHcd':_0x1f0807['SeebR']},_0x323d05=_0x5b9879[_0x43cdc9];_0x374f77[_0x5e1f7e(0x17f)]({'Train':_0x5e1f7e(0x1d6)+_0x43cdc9+'\x20-\x20Worst\x20Case\x20Analysis','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),_0x323d05['forEach'](_0x193d4b=>{const _0x19a736=_0x5e1f7e,_0x569318=_0x193d4b[_0x19a736(0x36b)][_0x19a736(0x18c)](_0x562c7a=>_0xb721b2(_0x562c7a,_0x4198e3)[_0x19a736(0x361)]);_0x193d4b[_0x19a736(0x2a9)]=_0x1f0807['oWjWb'](_0x569318[_0x19a736(0x22a)],0x0)?Math[_0x19a736(0x18b)](..._0x569318):0x0;}),_0x323d05[_0x5e1f7e(0x270)]((_0x1d929c,_0x1ca7e5)=>_0x1ca7e5['sortValue']-_0x1d929c['sortValue']),_0x323d05[_0x5e1f7e(0x1fd)](_0x2378e9=>{const _0x598d21=_0x5e1f7e,_0xa84217={'uHZKu':function(_0xe0632d,_0x5c877c,_0x3bca06){const _0x374e27=a13_0xd75d;return _0x5e7592[_0x374e27(0x18e)](_0xe0632d,_0x5c877c,_0x3bca06);},'FaMBY':'N/A'},_0x3b7474=_0x2378e9[_0x598d21(0x1b9)]?_0x5e7592['aNHcd']:'No';_0x374f77[_0x598d21(0x17f)]({'Train':'','Product\x20Code':_0x2378e9[_0x598d21(0x301)],'Product\x20Name':_0x2378e9['name'],'Highest\x20RPN':_0x2378e9['sortValue'],'Special\x20Case\x20Product':_0x3b7474,'Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),(_0x2378e9[_0x598d21(0x36b)]['sort']((_0x4f6266,_0x45e777)=>_0xb721b2(_0x45e777,_0x4198e3)[_0x598d21(0x361)]-_0xb721b2(_0x4f6266,_0x4198e3)[_0x598d21(0x361)])[_0x598d21(0x1fd)](_0x170a85=>{const _0x424b32=_0x598d21,_0x316dd3=_0xa84217[_0x424b32(0x3b7)](_0xb721b2,_0x170a85,_0x4198e3);_0x374f77[_0x424b32(0x17f)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':_0x170a85[_0x424b32(0x203)],'TD\x20Score':_0x316dd3[_0x424b32(0x172)],'Solubility\x20Score':_0x316dd3[_0x424b32(0x1c6)],'Cleanability\x20Score':_0x316dd3[_0x424b32(0x1f4)],'PDE\x20Score':_0x316dd3['pdeScore']??_0xa84217['FaMBY'],'LD50\x20Score':_0x316dd3[_0x424b32(0x16a)]??_0xa84217['FaMBY'],'RPN':_0x316dd3['rpn'],'Rating':_0x316dd3['rpnRatingText']});}),_0x374f77['push']({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}));});}),_0x12a6d8[_0x22affb(0x23a)](0x0,_0x374f77[_0x22affb(0x22a)]))return _0x12a6d8[_0x22affb(0x1a9)](hideLoader),void showCustomAlert(_0x12a6d8['ZvzBo'],_0x12a6d8['iCiZP']);const _0x3e62be=XLSX['utils'][_0x22affb(0x319)](_0x374f77),_0x413cf6=XLSX[_0x22affb(0x3b5)][_0x22affb(0x29c)]();XLSX[_0x22affb(0x3b5)][_0x22affb(0x195)](_0x413cf6,_0x3e62be,_0x12a6d8[_0x22affb(0x178)]);const _0x4dffb8=Object[_0x22affb(0x17b)](_0x374f77[0x0])[_0x22affb(0x18c)](_0x216800=>({'wch':Math[_0x22affb(0x18b)](_0x216800[_0x22affb(0x22a)],..._0x374f77[_0x22affb(0x18c)](_0xd2e2fe=>String(_0xd2e2fe[_0x216800]||'')[_0x22affb(0x22a)]))+0x2}));_0x3e62be[_0x22affb(0x260)]=_0x4dffb8;const _0x75fb92=new Date()[_0x22affb(0x1af)]()[_0x22affb(0x18f)]('T')[0x0];let _0x1fff74='';_0x12a6d8['dfDPp'](_0x12a6d8[_0x22affb(0x199)],_0x4105b8)&&(_0x1fff74=Array[_0x22affb(0x212)](_0x4105b8)?'_Trains_'+_0x4105b8[_0x22affb(0x39a)]('_'):_0x22affb(0x15d)+_0x4105b8),XLSX[_0x22affb(0x2ec)](_0x413cf6,_0x22affb(0x166)+_0x1fff74+'_'+_0x75fb92+'.xlsx'),_0x12a6d8[_0x22affb(0x1a9)](hideLoader);})[_0x4fb484(0x2d3)](_0x5b8cf4=>{const _0x235f77=_0x4fb484;console[_0x235f77(0x345)](_0x12a6d8[_0x235f77(0x1de)],_0x5b8cf4),_0x12a6d8[_0x235f77(0x173)](hideLoader),_0x12a6d8[_0x235f77(0x30f)](showCustomAlert,_0x12a6d8[_0x235f77(0x155)],_0x12a6d8[_0x235f77(0x383)]);});}export function exportMachinesToExcel(){const _0x20b2f6=a13_0x17be56,_0x4e65dc={'KxYMG':_0x20b2f6(0x381),'tBKVV':function(_0x4c5c69){return _0x4c5c69();},'xafTO':function(_0x528c32,_0xa0cf53){return _0x528c32===_0xa0cf53;},'Jxpmc':_0x20b2f6(0x338),'sdbat':_0x20b2f6(0x26b),'PTjwT':_0x20b2f6(0x19f),'tllxg':'!cols','beAnr':function(_0x3087a3,_0x3b18eb,_0x506b5e){return _0x3087a3(_0x3b18eb,_0x506b5e);},'WmRSR':_0x20b2f6(0x344),'yGlgw':_0x20b2f6(0x163),'avAbw':_0x20b2f6(0x397),'ppgzl':_0x20b2f6(0x3a2),'sBKwt':_0x20b2f6(0x1f7)};_0x4e65dc[_0x20b2f6(0x1a5)](showLoader);try{if(_0x4e65dc[_0x20b2f6(0x2a5)](0x0,a13_0x26f094[_0x20b2f6(0x1b2)][_0x20b2f6(0x22a)]))return _0x4e65dc[_0x20b2f6(0x1a5)](hideLoader),void showCustomAlert(_0x4e65dc[_0x20b2f6(0x1ee)],_0x4e65dc['sdbat']);const _0x16fefe=[],_0xb8da25={};a13_0x26f094[_0x20b2f6(0x1b2)][_0x20b2f6(0x1fd)](_0x5a7202=>{const _0xc0712f=_0x20b2f6;_0xb8da25[_0x5a7202[_0xc0712f(0x292)]]||(_0xb8da25[_0x5a7202[_0xc0712f(0x292)]]=[]),_0xb8da25[_0x5a7202[_0xc0712f(0x292)]][_0xc0712f(0x17f)](_0x5a7202);}),a13_0x26f094['machineStageDisplayOrder'][_0x20b2f6(0x1fd)](_0x3c34b5=>{_0xb8da25[_0x3c34b5]&&_0xb8da25[_0x3c34b5]['forEach'](_0x45ff38=>{const _0x415836=a13_0xd75d,_0x161e75=a13_0x26f094['products'][_0x415836(0x170)](_0xab79aa=>_0xab79aa[_0x415836(0x241)]&&_0xab79aa[_0x415836(0x241)][_0x415836(0x366)](_0x45ff38['id'])),_0x279e4f=_0x161e75['map'](_0x26e23c=>_0x26e23c['name'])['join'](',\x20')||_0x4e65dc['KxYMG'],_0x29af78=_0x161e75['length'];_0x16fefe[_0x415836(0x17f)]({'Machine\x20Number':_0x45ff38['machineNumber'],'Machine\x20Name':_0x45ff38['name'],'Stage':_0x45ff38['stage'],'Area\x20(sq\x20cm)':_0x45ff38[_0x415836(0x30d)],'Assigned\x20Products\x20Count':_0x29af78,'Assigned\x20Products':_0x279e4f});});});const _0x58d8c9=XLSX['utils'][_0x20b2f6(0x319)](_0x16fefe),_0x1ee613=XLSX[_0x20b2f6(0x3b5)][_0x20b2f6(0x29c)]();XLSX[_0x20b2f6(0x3b5)]['book_append_sheet'](_0x1ee613,_0x58d8c9,_0x4e65dc['PTjwT']);const _0x3da628=[{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0xf},{'wch':0x14},{'wch':0x32}];_0x58d8c9[_0x4e65dc[_0x20b2f6(0x2d4)]]=_0x3da628;const _0x2a570d=new Date()[_0x20b2f6(0x1af)]()[_0x20b2f6(0x18f)]('T')[0x0];XLSX['writeFile'](_0x1ee613,_0x20b2f6(0x317)+_0x2a570d+'.xlsx'),_0x4e65dc[_0x20b2f6(0x1a5)](hideLoader),_0x4e65dc[_0x20b2f6(0x226)](showCustomAlert,_0x4e65dc['WmRSR'],_0x4e65dc[_0x20b2f6(0x179)]);}catch(_0x209092){console['error'](_0x4e65dc['avAbw'],_0x209092),hideLoader(),_0x4e65dc['beAnr'](showCustomAlert,_0x4e65dc[_0x20b2f6(0x33f)],_0x4e65dc['sBKwt']);}}export function exportProductMacoToExcel(_0x5fac42='all'){const _0x5c1092=a13_0x17be56,_0x50a1b4={'AuftH':_0x5c1092(0x2c4),'GnDoT':function(_0x1991ab,_0xe1e802){return _0x1991ab(_0xe1e802);},'VOhEg':function(_0x43f73c,_0x559955){return _0x43f73c/_0x559955;},'qcPxR':function(_0x206f8d,_0x4feaf5){return _0x206f8d*_0x4feaf5;},'ObazM':'true','WPMfm':function(_0x411ceb,_0x2043df,_0x2e0300){return _0x411ceb(_0x2043df,_0x2e0300);},'BLSCq':_0x5c1092(0x1f9),'eFlxq':'Health-Based\x20Limit\x20(PDE)','EYzSE':function(_0x5f2115,_0x572c1a){return _0x5f2115===_0x572c1a;},'eJyTX':'Health-Based\x20Limit\x20(NOEL)','SYTXO':_0x5c1092(0x1aa),'TdMEb':function(_0x378da9,_0x37762a){return _0x378da9>_0x37762a;},'QnAuf':function(_0x3f5eec,_0x5a67ab){return _0x3f5eec/_0x5a67ab;},'UVovU':function(_0x29030a,_0x3cb8e4){return _0x29030a==_0x3cb8e4;},'ihQtK':_0x5c1092(0x26a),'LfrjM':function(_0x3be1d9){return _0x3be1d9();},'LbWAf':_0x5c1092(0x338),'tehXe':function(_0x2f9893,_0x5b454d,_0x56241e){return _0x2f9893(_0x5b454d,_0x56241e);},'QlZbM':'No\x20trains\x20match\x20the\x20selected\x20criteria.','YLMhM':_0x5c1092(0x334),'WgBcK':_0x5c1092(0x260),'JOQpO':_0x5c1092(0x193),'Kiqev':function(_0x5c63cc,_0x33cf05){return _0x5c63cc!==_0x33cf05;},'HthHd':_0x5c1092(0x29d),'vSnyK':function(_0x21d529,_0x5858a6,_0x4cbd6a){return _0x21d529(_0x5858a6,_0x4cbd6a);},'aweEb':'Success','SkIIm':_0x5c1092(0x21c),'IUIxh':function(_0x13438f){return _0x13438f();},'xkFmb':'Error','vhesj':_0x5c1092(0x1be),'WgqDy':_0x5c1092(0x3be)};_0x50a1b4['LfrjM'](showLoader),import(_0x50a1b4[_0x5c1092(0x162)])[_0x5c1092(0x339)](_0x5bcfcc=>{const _0x395e8f=_0x5c1092,_0x3a7ba6={'XLKcv':function(_0x2a5aee,_0x2a0c9d){return _0x2a5aee||_0x2a0c9d;},'GVlGi':_0x50a1b4[_0x395e8f(0x34b)],'CDnYe':function(_0x111b30,_0x46a8d9){const _0x186b37=_0x395e8f;return _0x50a1b4[_0x186b37(0x328)](_0x111b30,_0x46a8d9);},'bLBHD':function(_0x5c8a6c,_0x3960d9){const _0x5abd76=_0x395e8f;return _0x50a1b4[_0x5abd76(0x31b)](_0x5c8a6c,_0x3960d9);},'qTLwT':function(_0x4bbf60,_0x2b4519){const _0x287b51=_0x395e8f;return _0x50a1b4[_0x287b51(0x264)](_0x4bbf60,_0x2b4519);},'UcaVx':function(_0x49eb87,_0x2ab504){return _0x50a1b4['VOhEg'](_0x49eb87,_0x2ab504);},'VYeLF':_0x50a1b4[_0x395e8f(0x2f2)],'SWBOi':_0x395e8f(0x253),'Zqpmj':function(_0x147911,_0x5ba556){const _0x305b72=_0x395e8f;return _0x50a1b4[_0x305b72(0x264)](_0x147911,_0x5ba556);},'prEfN':function(_0x194229,_0x2ab695){return _0x194229!==_0x2ab695;},'XuLEE':function(_0x2f22c0,_0x5a1cf7,_0x4892b4){const _0x5de79d=_0x395e8f;return _0x50a1b4[_0x5de79d(0x1cd)](_0x2f22c0,_0x5a1cf7,_0x4892b4);},'qdjVD':_0x50a1b4['BLSCq'],'nndlV':_0x50a1b4['eFlxq'],'vKJWj':function(_0x37e2a4,_0x517deb){const _0x3ede5d=_0x395e8f;return _0x50a1b4[_0x3ede5d(0x371)](_0x37e2a4,_0x517deb);},'afbCE':_0x50a1b4[_0x395e8f(0x2df)],'GXUaE':_0x50a1b4[_0x395e8f(0x198)],'eUQLi':function(_0x1390e7,_0x18715c){const _0x120bff=_0x395e8f;return _0x50a1b4[_0x120bff(0x16d)](_0x1390e7,_0x18715c);},'QvzXR':function(_0x25699a,_0x2b2337){return _0x50a1b4['QnAuf'](_0x25699a,_0x2b2337);},'Zjsoj':function(_0xf010c5,_0x1018fb){const _0x45b352=_0x395e8f;return _0x50a1b4[_0x45b352(0x2b8)](_0xf010c5,_0x1018fb);},'Vcvra':_0x50a1b4[_0x395e8f(0x238)]},{getTrainData:_0x489db0,getWorstCaseProductType:_0x401680,getMacoPerSwabForTrain:_0x1ef068,getLargestEssaForLineAndDosageForm:_0x79d8ef}=_0x5bcfcc,_0xb47e06=_0x489db0();if(0x0===_0xb47e06['length'])return _0x50a1b4[_0x395e8f(0x3a7)](hideLoader),void showCustomAlert(_0x50a1b4[_0x395e8f(0x2c3)],_0x395e8f(0x186));let _0x5cef28=_0xb47e06;if(_0x395e8f(0x29d)!==_0x5fac42&&(_0x5cef28=Array[_0x395e8f(0x212)](_0x5fac42)?_0xb47e06[_0x395e8f(0x170)](_0x331804=>_0x5fac42[_0x395e8f(0x366)](String(_0x331804['id']))):_0xb47e06[_0x395e8f(0x170)](_0x2b82be=>String(_0x2b82be['id'])===String(_0x5fac42))),_0x50a1b4[_0x395e8f(0x371)](0x0,_0x5cef28['length']))return hideLoader(),void _0x50a1b4[_0x395e8f(0x3ab)](showCustomAlert,_0x50a1b4['LbWAf'],_0x50a1b4[_0x395e8f(0x1cb)]);const _0x149279=[];_0x5cef28[_0x395e8f(0x1fd)](_0x564a6d=>{const _0x113a02=_0x395e8f,_0x352c65={'ZfmmL':function(_0x4bba9a,_0x343e67){return _0x3a7ba6['XLKcv'](_0x4bba9a,_0x343e67);},'JReAb':_0x3a7ba6[_0x113a02(0x1e7)]},_0x5c8af9=_0x3a7ba6[_0x113a02(0x21e)](_0x401680,_0x564a6d[_0x113a02(0x21b)][_0x113a02(0x18c)](_0x5c52af=>_0x5c52af[_0x113a02(0x375)])),_0x2a5aea=(a13_0x26f094[_0x113a02(0x263)][_0x5c8af9]||a13_0x26f094[_0x113a02(0x263)][_0x113a02(0x308)])['max'],_0x3e7f95=_0x3a7ba6[_0x113a02(0x171)](_0x3a7ba6[_0x113a02(0x1c2)](_0x564a6d[_0x113a02(0x1a2)],_0x564a6d[_0x113a02(0x206)]),_0x2a5aea),_0x4e2342=_0x3a7ba6[_0x113a02(0x1c2)](0xa,_0x564a6d['minMbsKg']);let _0x1dc6dc=0x1/0x0,_0x2c1f7c=_0x3a7ba6[_0x113a02(0x364)](0x1,0x0);const _0x270495=_0x3a7ba6[_0x113a02(0x386)]===localStorage[_0x113a02(0x225)](_0x3a7ba6[_0x113a02(0x329)]),_0x27d1d4=_0x3a7ba6[_0x113a02(0x386)]===localStorage['getItem']('productRegister-ld50Hidden');if(null===_0x564a6d['lowestPde']||_0x270495||(_0x1dc6dc=_0x3a7ba6['Zqpmj'](_0x564a6d['lowestPde'],_0x564a6d['minBsMddRatio'])),_0x3a7ba6['prEfN'](null,_0x564a6d[_0x113a02(0x277)])&&!_0x27d1d4){const _0x469d21=_0x3a7ba6[_0x113a02(0x364)](_0x3a7ba6['Zqpmj'](0x46,_0x564a6d['lowestLd50']),0x7d0),_0x5e2a38=_0x564a6d[_0x113a02(0x21b)][_0x113a02(0x29b)](_0x5982db=>_0x5982db[_0x113a02(0x36b)][_0x113a02(0x18c)](_0x118e84=>_0x118e84[_0x113a02(0x333)]/0x3e8)),_0x477ef3=Math[_0x113a02(0x2b7)](..._0x5e2a38);_0x2c1f7c=_0x3a7ba6[_0x113a02(0x364)](_0x3a7ba6[_0x113a02(0x1c2)](_0x3a7ba6[_0x113a02(0x281)](_0x469d21,_0x564a6d[_0x113a02(0x302)]),0x3e8),_0x3a7ba6['qTLwT'](_0x2a5aea,_0x477ef3));}const _0x43b134=_0x3a7ba6[_0x113a02(0x231)](_0x79d8ef,_0x564a6d,_0xb47e06),_0x572d33=_0x3a7ba6[_0x113a02(0x1c2)](0.004,_0x43b134),_0x58cdbe=[{'name':_0x113a02(0x382),'value':_0x3e7f95},{'name':_0x3a7ba6[_0x113a02(0x21a)],'value':_0x4e2342}];null===_0x564a6d[_0x113a02(0x39f)]||_0x270495||_0x58cdbe[_0x113a02(0x17f)]({'name':_0x3a7ba6[_0x113a02(0x273)],'value':_0x1dc6dc}),_0x3a7ba6[_0x113a02(0x27a)](null,_0x564a6d['lowestLd50'])||_0x27d1d4||_0x58cdbe[_0x113a02(0x17f)]({'name':_0x3a7ba6[_0x113a02(0x340)],'value':_0x2c1f7c}),_0x58cdbe['push']({'name':_0x3a7ba6['GXUaE'],'value':_0x572d33});const _0x2bd28c=_0x58cdbe[_0x113a02(0x1c8)]((_0x4cfd3d,_0x8e4d95)=>_0x8e4d95[_0x113a02(0x37f)]<_0x4cfd3d[_0x113a02(0x37f)]?_0x8e4d95:_0x4cfd3d),_0x4aad22=_0x2bd28c[_0x113a02(0x37f)],_0x522926=_0x3a7ba6[_0x113a02(0x2c5)](_0x43b134,0x0)?_0x3a7ba6['QvzXR'](_0x4aad22,_0x43b134):0x0,_0x3bcf6e=_0x522926*_0x564a6d[_0x113a02(0x160)],_0xc5f348=_0x564a6d[_0x113a02(0x241)]['map'](_0x4f3a87=>{const _0x508577=_0x113a02,_0x52390d=a13_0x26f094[_0x508577(0x1b2)][_0x508577(0x282)](_0x34db18=>_0x34db18['id']===_0x4f3a87);return _0x352c65['ZfmmL'](_0x52390d,{'name':_0x508577(0x352)+_0x4f3a87+')','machineNumber':_0x352c65[_0x508577(0x20e)]});}),_0x58840b=_0x564a6d[_0x113a02(0x241)]['map'](_0x4a8314=>{const _0xd83e2f=_0x113a02,_0x3e9ff8=a13_0x26f094[_0xd83e2f(0x1b2)][_0xd83e2f(0x282)](_0x51952d=>_0x51952d['id']===_0x4a8314);return _0x3e9ff8?_0x3e9ff8['name']:_0xd83e2f(0x352)+_0x4a8314+')';})['join'](',\x20'),_0x3e9895=_0x564a6d[_0x113a02(0x21b)][_0x113a02(0x18c)](_0x1d7e6a=>_0x1d7e6a[_0x113a02(0x301)]+_0x113a02(0x32a)+_0x1d7e6a[_0x113a02(0x203)])[_0x113a02(0x39a)](';\x20'),_0x3033c0=_0x564a6d[_0x113a02(0x1fc)]?_0x564a6d[_0x113a02(0x1fc)][_0x113a02(0x2ad)]+'\x20('+_0x564a6d['worstProductRpn']['ingredientName']+_0x113a02(0x29e)+_0x564a6d['worstProductRpn'][_0x113a02(0x361)]:_0x3a7ba6[_0x113a02(0x1e7)];_0x149279[_0x113a02(0x17f)]({'Train':'T'+_0x564a6d['id'],'Total\x20Products':_0x564a6d[_0x113a02(0x21b)][_0x113a02(0x22a)],'Total\x20Machines':_0xc5f348[_0x113a02(0x22a)],'Total\x20Area\x20(ESSA)\x20cm²':_0x564a6d['essa'][_0x113a02(0x18a)](),'Products':_0x3e9895,'Machines':_0x58840b,'Worst-Case\x20Dosage\x20Form':_0x5c8af9,'Safety\x20Factor':_0x2a5aea,'Lowest\x20LTD\x20(mg)':_0x564a6d[_0x113a02(0x1a2)],'Min\x20Batch\x20Size\x20(kg)':_0x564a6d[_0x113a02(0x302)],'Min\x20BS/MDD\x20Ratio':_0x564a6d[_0x113a02(0x206)][_0x113a02(0x289)](0x2),'Lowest\x20PDE\x20(mg)':_0x3a7ba6['prEfN'](null,_0x564a6d[_0x113a02(0x39f)])?_0x564a6d[_0x113a02(0x39f)]:_0x3a7ba6[_0x113a02(0x1e7)],'Worst-Case\x20Product\x20(by\x20RPN)':_0x3033c0,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x3e7f95[_0x113a02(0x289)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x4e2342[_0x113a02(0x289)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x3a7ba6[_0x113a02(0x18d)](_0x3a7ba6['Vcvra'],typeof _0x1dc6dc)?_0x1dc6dc[_0x113a02(0x289)](0x2):_0x113a02(0x2c4),'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x572d33['toFixed'](0x2),'Selected\x20MACO\x20Method':_0x2bd28c[_0x113a02(0x203)],'Final\x20MACO\x20(mg)':_0x4aad22[_0x113a02(0x289)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x522926['toExponential'](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x3bcf6e[_0x113a02(0x289)](0x4)});});const _0x592527=XLSX[_0x395e8f(0x3b5)][_0x395e8f(0x319)](_0x149279),_0x5a8b6f=XLSX['utils'][_0x395e8f(0x29c)]();XLSX[_0x395e8f(0x3b5)][_0x395e8f(0x195)](_0x5a8b6f,_0x592527,_0x50a1b4[_0x395e8f(0x28d)]),_0x592527[_0x50a1b4[_0x395e8f(0x1c9)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0x12},{'wch':0xf},{'wch':0x12},{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0x12},{'wch':0x12}];const _0x519b80=new Date()['toISOString']()[_0x395e8f(0x18f)]('T')[0x0];let _0x5550aa=_0x50a1b4['JOQpO'];if(_0x50a1b4[_0x395e8f(0x2ea)](_0x50a1b4[_0x395e8f(0x2dc)],_0x5fac42)){if(Array[_0x395e8f(0x212)](_0x5fac42))_0x5550aa+='_Trains_'+_0x5fac42[_0x395e8f(0x270)]((_0x1dbbe6,_0x30067b)=>_0x1dbbe6-_0x30067b)['join']('_');else _0x5550aa+=_0x395e8f(0x15d)+_0x5fac42;}_0x5550aa+='_'+_0x519b80+_0x395e8f(0x357),XLSX['writeFile'](_0x5a8b6f,_0x5550aa),_0x50a1b4[_0x395e8f(0x3a7)](hideLoader),_0x50a1b4[_0x395e8f(0x26f)](showCustomAlert,_0x50a1b4['aweEb'],'Product\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!');})[_0x5c1092(0x2d3)](_0x4440f9=>{const _0x1028e7=_0x5c1092;console[_0x1028e7(0x345)](_0x50a1b4[_0x1028e7(0x20c)],_0x4440f9),_0x50a1b4[_0x1028e7(0x2bc)](hideLoader),showCustomAlert(_0x50a1b4[_0x1028e7(0x303)],_0x50a1b4[_0x1028e7(0x324)]);});}export function exportDetergentMacoToExcel(_0x5d4e8='all'){const _0x467c7e=a13_0x17be56,_0x4281ed={'cOOtt':function(_0xacb335,_0x48c4a9){return _0xacb335||_0x48c4a9;},'isAIV':function(_0x3ed797,_0x58ccac){return _0x3ed797(_0x58ccac);},'BNouQ':function(_0x1637c0,_0x143ae7){return _0x1637c0/_0x143ae7;},'yylMu':function(_0x175055,_0x172ac3){return _0x175055*_0x172ac3;},'BZtnn':function(_0x15506c,_0x3cac55){return _0x15506c>_0x3cac55;},'FjGuO':function(_0x4029d4,_0x10e2d0){return _0x4029d4/_0x10e2d0;},'LQcYD':function(_0x33d65,_0x4436e5){return _0x33d65*_0x4436e5;},'Xdeur':function(_0x3f85eb){return _0x3f85eb();},'TLnol':function(_0x183646,_0x382df3){return _0x183646!==_0x382df3;},'FkBeZ':_0x467c7e(0x29d),'LxlJM':function(_0x1020f8,_0x16c342){return _0x1020f8===_0x16c342;},'CXcmw':function(_0x43c391){return _0x43c391();},'ddNGe':function(_0x5e723a,_0x40a596,_0x30ba31){return _0x5e723a(_0x40a596,_0x30ba31);},'eKwqv':'No\x20Data','MEwwu':_0x467c7e(0x186),'LwRqq':function(_0x52c7c8){return _0x52c7c8();},'AKsKC':_0x467c7e(0x189),'TtARP':function(_0x2d053c,_0x22e867){return _0x2d053c(_0x22e867);},'zydOW':_0x467c7e(0x39e),'nElLT':_0x467c7e(0x200),'xNQro':'!cols','VRyGf':'Detergent\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','CYFai':_0x467c7e(0x2ee),'QtYNc':'Failed\x20to\x20export\x20Detergent\x20MACO\x20data\x20to\x20Excel.','lJSuh':function(_0x1c6de2){return _0x1c6de2();},'qjlBk':_0x467c7e(0x3be)};_0x4281ed[_0x467c7e(0x245)](showLoader),import(_0x4281ed[_0x467c7e(0x2d2)])[_0x467c7e(0x339)](_0x1ac228=>{const _0x3ea03c=_0x467c7e,_0x14cac6={'yVKJz':function(_0x5c4927,_0x35d985){return _0x4281ed['cOOtt'](_0x5c4927,_0x35d985);},'lHYxK':_0x3ea03c(0x2c4),'qfFyV':function(_0x505a86,_0x57ba2d){const _0x550ce0=_0x3ea03c;return _0x4281ed[_0x550ce0(0x1d8)](_0x505a86,_0x57ba2d);},'FFqBF':function(_0x5107d4,_0x3e6a14){const _0x2fc495=_0x3ea03c;return _0x4281ed[_0x2fc495(0x350)](_0x5107d4,_0x3e6a14);},'pfSaP':function(_0x1bb87e,_0x230b23){return _0x4281ed['yylMu'](_0x1bb87e,_0x230b23);},'Lbjam':function(_0xf7b805,_0x1dcb32){return _0x4281ed['yylMu'](_0xf7b805,_0x1dcb32);},'twAif':function(_0xe3f61a,_0x24f331){const _0x51682f=_0x3ea03c;return _0x4281ed[_0x51682f(0x26e)](_0xe3f61a,_0x24f331);},'iknjH':function(_0x302ee1,_0x41f7a3){return _0x4281ed['FjGuO'](_0x302ee1,_0x41f7a3);},'CfteG':function(_0x144c90,_0x339383){const _0x192716=_0x3ea03c;return _0x4281ed[_0x192716(0x271)](_0x144c90,_0x339383);}},{getTrainData:_0x17adf4,getWorstCaseProductType:_0x3561d3}=_0x1ac228;let _0x121f76=_0x4281ed[_0x3ea03c(0x38a)](_0x17adf4);if(_0x4281ed[_0x3ea03c(0x3af)](_0x4281ed[_0x3ea03c(0x35a)],_0x5d4e8)&&(_0x121f76=Array[_0x3ea03c(0x212)](_0x5d4e8)?_0x121f76['filter'](_0xa8c982=>_0x5d4e8['includes'](String(_0xa8c982['id']))):_0x121f76['filter'](_0x3077d6=>String(_0x3077d6['id'])===String(_0x5d4e8))),_0x4281ed['LxlJM'](0x0,_0x121f76['length']))return _0x4281ed['CXcmw'](hideLoader),void _0x4281ed[_0x3ea03c(0x269)](showCustomAlert,_0x4281ed[_0x3ea03c(0x25e)],_0x4281ed[_0x3ea03c(0x252)]);if(_0x4281ed['LxlJM'](0x0,a13_0x26f094[_0x3ea03c(0x28b)][_0x3ea03c(0x22a)]))return _0x4281ed[_0x3ea03c(0x368)](hideLoader),void showCustomAlert(_0x4281ed['eKwqv'],_0x4281ed[_0x3ea03c(0x284)]);const _0x3520c4=[],_0x588cd6=_0x4281ed[_0x3ea03c(0x232)](parseFloat,document[_0x3ea03c(0x3bb)](_0x4281ed[_0x3ea03c(0x3a8)])?.['value'])||0x46,_0x40bec6=a13_0x26f094[_0x3ea03c(0x28b)]['map'](_0xe9cdfe=>parseFloat(_0xe9cdfe[_0x3ea03c(0x262)]))[_0x3ea03c(0x170)](_0x26e75f=>!isNaN(_0x26e75f)),_0x1614b5=_0x40bec6[_0x3ea03c(0x22a)]>0x0?Math[_0x3ea03c(0x2b7)](..._0x40bec6):0x0,_0x20b7c6=a13_0x26f094[_0x3ea03c(0x28b)][_0x3ea03c(0x18c)](_0x36205c=>_0x36205c[_0x3ea03c(0x203)])['filter'](_0x5c1f6e=>''!==_0x5c1f6e[_0x3ea03c(0x274)]())[_0x3ea03c(0x39a)](',\x20');_0x121f76[_0x3ea03c(0x1fd)](_0x2d54d4=>{const _0x2b1e16=_0x3ea03c,_0x2c2d77=_0x3561d3(_0x2d54d4[_0x2b1e16(0x21b)]['map'](_0x37b64=>_0x37b64[_0x2b1e16(0x375)])),_0x4676b5=a13_0x26f094[_0x2b1e16(0x263)][_0x2c2d77]||a13_0x26f094[_0x2b1e16(0x263)][_0x2b1e16(0x308)],_0x405324=document['getElementById'](_0x2b1e16(0x32b)+_0x2d54d4['id']),_0x3f4313=_0x405324&&_0x14cac6[_0x2b1e16(0x243)](parseFloat,_0x405324['value'])||_0x4676b5[_0x2b1e16(0x18b)],_0xac9b61=_0x14cac6[_0x2b1e16(0x3a1)](_0x14cac6[_0x2b1e16(0x1cc)](_0x14cac6[_0x2b1e16(0x1cc)](0.0005,_0x1614b5),_0x588cd6),_0x3f4313),_0x2abd1a=_0x14cac6[_0x2b1e16(0x154)](_0xac9b61,_0x2d54d4[_0x2b1e16(0x206)]),_0x1cdc33=_0x1ac228['getLargestEssaForLineAndDosageForm'](_0x2d54d4,_0x121f76),_0x41f298=_0x14cac6['twAif'](_0x1cdc33,0x0)?_0x14cac6['iknjH'](_0x2abd1a,_0x1cdc33):0x0,_0xbfc740=_0x14cac6[_0x2b1e16(0x2da)](_0x41f298,_0x2d54d4[_0x2b1e16(0x160)]),_0x41e77a=_0x2d54d4['machineIds'][_0x2b1e16(0x18c)](_0x3deeda=>{const _0x3736ac=_0x2b1e16,_0x498bb0=a13_0x26f094[_0x3736ac(0x1b2)][_0x3736ac(0x282)](_0x9d682=>_0x9d682['id']===_0x3deeda);return _0x14cac6['yVKJz'](_0x498bb0,{'name':_0x3736ac(0x352)+_0x3deeda+')','machineNumber':_0x14cac6[_0x3736ac(0x236)]});}),_0x44bf46=_0x2d54d4[_0x2b1e16(0x241)][_0x2b1e16(0x18c)](_0x17f1a8=>{const _0x122467=_0x2b1e16,_0x4aabea=a13_0x26f094[_0x122467(0x1b2)][_0x122467(0x282)](_0x5862a4=>_0x5862a4['id']===_0x17f1a8);return _0x4aabea?_0x4aabea[_0x122467(0x203)]:_0x122467(0x352)+_0x17f1a8+')';})[_0x2b1e16(0x39a)](',\x20'),_0x5910a1=_0x2d54d4[_0x2b1e16(0x21b)]['map'](_0x47d8b0=>_0x47d8b0[_0x2b1e16(0x301)]+'\x20-\x20'+_0x47d8b0[_0x2b1e16(0x203)])[_0x2b1e16(0x39a)](';\x20'),_0x5eaa0f=_0x2d54d4[_0x2b1e16(0x1fc)]?_0x2d54d4['worstProductRpn'][_0x2b1e16(0x2ad)]+'\x20('+_0x2d54d4[_0x2b1e16(0x1fc)][_0x2b1e16(0x2b6)]+')\x20-\x20RPN:\x20'+_0x2d54d4[_0x2b1e16(0x1fc)]['rpn']:_0x2b1e16(0x2c4);_0x3520c4[_0x2b1e16(0x17f)]({'Train':'T'+_0x2d54d4['id'],'Total\x20Products':_0x2d54d4[_0x2b1e16(0x21b)][_0x2b1e16(0x22a)],'Total\x20Machines':_0x41e77a['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x2d54d4[_0x2b1e16(0x1f0)][_0x2b1e16(0x18a)](),'Products':_0x5910a1,'Machines':_0x44bf46,'Worst-Case\x20Dosage\x20Form':_0x2c2d77,'Safety\x20Factor\x20Range':_0x4676b5['min']+_0x2b1e16(0x32a)+_0x4676b5[_0x2b1e16(0x18b)],'Applied\x20Safety\x20Factor':_0x3f4313,'Detergent\x20Ingredients':_0x20b7c6,'Body\x20Weight\x20(kg)':_0x588cd6,'Minimum\x20LD50\x20(mg/kg)':_0x1614b5,'Min\x20Batch\x20Size\x20(kg)':_0x2d54d4[_0x2b1e16(0x302)],'Min\x20BS/MDD\x20Ratio':_0x2d54d4['minBsMddRatio']['toFixed'](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x5eaa0f,'ADI\x20(mg)':_0xac9b61[_0x2b1e16(0x289)](0x4),'MACO\x20(mg)':_0x2abd1a[_0x2b1e16(0x289)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x41f298['toExponential'](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0xbfc740[_0x2b1e16(0x289)](0x4)});});const _0x1988cc=XLSX[_0x3ea03c(0x3b5)][_0x3ea03c(0x319)](_0x3520c4),_0x45159a=XLSX[_0x3ea03c(0x3b5)]['book_new']();XLSX['utils'][_0x3ea03c(0x195)](_0x45159a,_0x1988cc,_0x4281ed[_0x3ea03c(0x23e)]),_0x1988cc[_0x4281ed[_0x3ea03c(0x152)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0x1e},{'wch':0xc},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0xc},{'wch':0xc},{'wch':0x12},{'wch':0x12}];const _0x9f56ee=new Date()['toISOString']()[_0x3ea03c(0x18f)]('T')[0x0];XLSX[_0x3ea03c(0x2ec)](_0x45159a,_0x3ea03c(0x298)+_0x9f56ee+'.xlsx'),_0x4281ed[_0x3ea03c(0x17d)](hideLoader),_0x4281ed[_0x3ea03c(0x269)](showCustomAlert,_0x3ea03c(0x344),_0x4281ed[_0x3ea03c(0x37c)]);})[_0x467c7e(0x2d3)](_0x167e85=>{const _0x47587d=_0x467c7e;console['error'](_0x4281ed['CYFai'],_0x167e85),hideLoader(),_0x4281ed[_0x47587d(0x269)](showCustomAlert,_0x47587d(0x3a2),_0x4281ed['QtYNc']);});}export function exportTrainSummaryToExcel(_0x424c59=a13_0x17be56(0x29d)){const _0x61296c=a13_0x17be56,_0x10c15d={'BRyNu':function(_0x37bbc7,_0x3d0add){return _0x37bbc7!==_0x3d0add;},'xsfmF':'N/A','VpDDv':function(_0x2d52a0){return _0x2d52a0();},'NRtYT':function(_0x461dd0,_0x165cae,_0x5bc378){return _0x461dd0(_0x165cae,_0x5bc378);},'fppUv':'No\x20Data','MmBeR':function(_0x518890,_0x1b4032){return _0x518890!==_0x1b4032;},'znQxI':_0x61296c(0x29d),'jSsqF':function(_0x1d4713){return _0x1d4713();},'oZEuP':'No\x20trains\x20match\x20the\x20selected\x20criteria.','fxsKP':_0x61296c(0x378),'fdzwv':_0x61296c(0x260),'lHYUp':_0x61296c(0x3b2),'GRNXV':_0x61296c(0x344),'lXafA':'Train\x20Summary\x20data\x20exported\x20to\x20Excel\x20successfully!','KymrF':function(_0x44873b,_0x19b6f1,_0x45997b){return _0x44873b(_0x19b6f1,_0x45997b);},'UiIvt':_0x61296c(0x3a2),'Ilyea':_0x61296c(0x14f),'Ghemh':function(_0x543aee){return _0x543aee();}};_0x10c15d['Ghemh'](showLoader),import(_0x61296c(0x3be))[_0x61296c(0x339)](_0x31eb8c=>{const _0x4cad3b=_0x61296c,{getTrainData:_0x16b7e9}=_0x31eb8c,_0xd8b39a=_0x10c15d[_0x4cad3b(0x28e)](_0x16b7e9);if(0x0===_0xd8b39a['length'])return hideLoader(),void _0x10c15d[_0x4cad3b(0x1e2)](showCustomAlert,_0x10c15d[_0x4cad3b(0x1ae)],'There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.');let _0x43b786=_0xd8b39a;if(_0x10c15d[_0x4cad3b(0x1ab)](_0x10c15d['znQxI'],_0x424c59)&&(_0x43b786=Array[_0x4cad3b(0x212)](_0x424c59)?_0xd8b39a[_0x4cad3b(0x170)](_0x39af55=>_0x424c59[_0x4cad3b(0x366)](String(_0x39af55['id']))):_0xd8b39a[_0x4cad3b(0x170)](_0x57a656=>String(_0x57a656['id'])===String(_0x424c59))),0x0===_0x43b786[_0x4cad3b(0x22a)])return _0x10c15d[_0x4cad3b(0x3ba)](hideLoader),void _0x10c15d[_0x4cad3b(0x1e2)](showCustomAlert,_0x10c15d['fppUv'],_0x10c15d[_0x4cad3b(0x291)]);const _0x47da59=[];_0x43b786[_0x4cad3b(0x1fd)](_0x3aa982=>{const _0x454dfe=_0x4cad3b,_0x2d229d=_0x3aa982[_0x454dfe(0x241)][_0x454dfe(0x18c)](_0x4d5fab=>{const _0x5c3b9f=_0x454dfe,_0x48505f=a13_0x26f094[_0x5c3b9f(0x1b2)][_0x5c3b9f(0x282)](_0x789a17=>_0x789a17['id']===_0x4d5fab);return _0x48505f||{'id':_0x4d5fab,'name':_0x5c3b9f(0x352)+_0x4d5fab+')','machineNumber':_0x5c3b9f(0x2c4)};}),_0x2e5f56=_0x3aa982['machineIds'][_0x454dfe(0x18c)](_0x1e8366=>{const _0x4ccf94=_0x454dfe,_0x3b9d8f=a13_0x26f094[_0x4ccf94(0x1b2)][_0x4ccf94(0x282)](_0x569dca=>_0x569dca['id']===_0x1e8366);return _0x3b9d8f?_0x3b9d8f[_0x4ccf94(0x203)]:_0x4ccf94(0x352)+_0x1e8366+')';})[_0x454dfe(0x39a)](',\x20'),_0x397490=_0x3aa982[_0x454dfe(0x21b)][_0x454dfe(0x18c)](_0xb4f8fa=>_0xb4f8fa['productCode']+_0x454dfe(0x32a)+_0xb4f8fa[_0x454dfe(0x203)])[_0x454dfe(0x39a)](';\x20'),_0xb76903=_0x3aa982[_0x454dfe(0x21b)][_0x454dfe(0x18c)](_0x2bffee=>_0x2bffee['productCode']+':\x20'+_0x2bffee[_0x454dfe(0x203)])[_0x454dfe(0x39a)]('\x0a'),_0x12c254=_0x2d229d['map'](_0x323be4=>_0x323be4['machineNumber']+':\x20'+_0x323be4[_0x454dfe(0x203)])['join']('\x0a');_0x47da59['push']({'Train\x20ID':'T'+_0x3aa982['id'],'Products\x20Count':_0x3aa982[_0x454dfe(0x21b)][_0x454dfe(0x22a)],'Machines\x20Count':_0x2d229d['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x3aa982[_0x454dfe(0x1f0)]['toLocaleString'](),'Products\x20(Code\x20-\x20Name)':_0x397490,'Machines\x20(Number\x20-\x20Name)':_0x2e5f56,'Products\x20Detailed':_0xb76903,'Machines\x20Detailed':_0x12c254,'Min\x20Batch\x20Size\x20(kg)':_0x3aa982[_0x454dfe(0x302)],'Min\x20BS/MDD\x20Ratio':_0x3aa982[_0x454dfe(0x206)][_0x454dfe(0x289)](0x2),'Assumed\x20SSA\x20(cm²)':_0x3aa982[_0x454dfe(0x160)],'Lowest\x20LTD\x20(mg)':_0x3aa982['lowestLtd'],'Lowest\x20PDE\x20(mg)':_0x10c15d['BRyNu'](null,_0x3aa982[_0x454dfe(0x39f)])?_0x3aa982[_0x454dfe(0x39f)]:_0x10c15d[_0x454dfe(0x295)],'Worst\x20RPN\x20Product':_0x3aa982[_0x454dfe(0x1fc)]?_0x3aa982[_0x454dfe(0x1fc)][_0x454dfe(0x2ad)]+'\x20('+_0x3aa982['worstProductRpn']['ingredientName']+_0x454dfe(0x29e)+_0x3aa982[_0x454dfe(0x1fc)]['rpn']:_0x10c15d[_0x454dfe(0x295)]});});const _0x451d1f=XLSX['utils'][_0x4cad3b(0x319)](_0x47da59),_0x5b7910=XLSX[_0x4cad3b(0x3b5)][_0x4cad3b(0x29c)]();XLSX[_0x4cad3b(0x3b5)][_0x4cad3b(0x195)](_0x5b7910,_0x451d1f,_0x10c15d[_0x4cad3b(0x1b6)]),_0x451d1f[_0x10c15d[_0x4cad3b(0x1d2)]]=[{'wch':0xa},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x3c},{'wch':0x3c},{'wch':0x28},{'wch':0x28},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32}];const _0x518799=new Date()[_0x4cad3b(0x1af)]()[_0x4cad3b(0x18f)]('T')[0x0];let _0x3d9d79=_0x10c15d[_0x4cad3b(0x183)];if(_0x10c15d['BRyNu'](_0x10c15d[_0x4cad3b(0x300)],_0x424c59)){if(Array[_0x4cad3b(0x212)](_0x424c59))_0x3d9d79+='_Trains_'+_0x424c59['sort']((_0x19cafb,_0x18dc6a)=>_0x19cafb-_0x18dc6a)['join']('_');else _0x3d9d79+=_0x4cad3b(0x15d)+_0x424c59;}_0x3d9d79+='_'+_0x518799+_0x4cad3b(0x357),XLSX[_0x4cad3b(0x2ec)](_0x5b7910,_0x3d9d79),_0x10c15d[_0x4cad3b(0x28e)](hideLoader),showCustomAlert(_0x10c15d[_0x4cad3b(0x251)],_0x10c15d['lXafA']);})['catch'](_0x33a7a1=>{const _0x4b67c7=_0x61296c;console[_0x4b67c7(0x345)](_0x4b67c7(0x1f1),_0x33a7a1),_0x10c15d[_0x4b67c7(0x28e)](hideLoader),_0x10c15d[_0x4b67c7(0x234)](showCustomAlert,_0x10c15d[_0x4b67c7(0x372)],_0x10c15d['Ilyea']);});}export function exportSummaryToExcel(){const _0x469a8c=a13_0x17be56,_0x26f03c={'DjUMP':function(_0x18fce2,_0x16fed7){return _0x18fce2(_0x16fed7);},'zgoJJ':function(_0x4c94ae,_0x8c9b9c){return _0x4c94ae>_0x8c9b9c;},'UOkvN':function(_0x134791,_0x22793b){return _0x134791(_0x22793b);},'LHxaZ':_0x469a8c(0x2c4),'ogmmg':function(_0x3f4267,_0x55a5de){return _0x3f4267!==_0x55a5de;},'TlhAv':_0x469a8c(0x2d9),'QqsXg':function(_0x6522c4,_0x211e0e){return _0x6522c4===_0x211e0e;},'vRgLf':function(_0x1a9b59,_0x2ba990){return _0x1a9b59===_0x2ba990;},'yfuKX':function(_0x10bfb0){return _0x10bfb0();},'YFhMl':function(_0x265029,_0x14ce4c,_0x2263d8){return _0x265029(_0x14ce4c,_0x2263d8);},'ewQDk':'There\x20are\x20no\x20summary\x20data\x20to\x20export.\x20Add\x20products\x20and\x20ingredients\x20first.','DlkBF':function(_0x53a837,_0x309b2c){return _0x53a837>_0x309b2c;},'Fsyuo':_0x469a8c(0x332),'cTpYW':_0x469a8c(0x27d),'mTDxB':'!cols','cLhOz':_0x469a8c(0x2db),'FvJLz':'Success','AQMAo':_0x469a8c(0x1b7),'eSAdX':'Error\x20exporting\x20Summary\x20to\x20Excel:','ARzfs':function(_0x79bc81){return _0x79bc81();},'ywyNU':function(_0x40f404,_0xbd8f23,_0x4d194a){return _0x40f404(_0xbd8f23,_0x4d194a);},'wpnFV':_0x469a8c(0x3a2),'hooJD':_0x469a8c(0x2a4)};_0x26f03c[_0x469a8c(0x32c)](showLoader),import(_0x469a8c(0x3be))[_0x469a8c(0x339)](_0x499887=>{const _0x337c13=_0x469a8c,{getProductTrainId:_0x1f3767,calculateScores:_0x1f549a}=_0x499887,_0x2201de=a13_0x26f094[_0x337c13(0x21b)][_0x337c13(0x29b)](_0x409574=>{const _0x5260eb=_0x337c13,_0x22b9bc=_0x26f03c[_0x5260eb(0x194)](_0x1f3767,_0x409574);return _0x409574[_0x5260eb(0x36b)][_0x5260eb(0x18c)](_0x323d32=>({'productName':_0x409574['name'],'productCode':_0x409574['productCode'],'ingredientName':_0x323d32[_0x5260eb(0x203)],'rpn':_0x1f549a(_0x323d32)['rpn'],'trainId':_0x5260eb(0x2c4)!==_0x22b9bc?'T'+_0x22b9bc:'N/A','scores':_0x1f549a(_0x323d32)}));})['sort']((_0x342811,_0x1dfaea)=>_0x1dfaea[_0x337c13(0x361)]-_0x342811[_0x337c13(0x361)])[_0x337c13(0x1fb)](0x0,0xa),_0x15f182=a13_0x26f094[_0x337c13(0x21b)][_0x337c13(0x170)](_0x3d95b1=>_0x3d95b1[_0x337c13(0x1b9)]);if(_0x26f03c[_0x337c13(0x327)](0x0,_0x2201de[_0x337c13(0x22a)])&&_0x26f03c[_0x337c13(0x256)](0x0,_0x15f182['length']))return _0x26f03c['yfuKX'](hideLoader),void _0x26f03c['YFhMl'](showCustomAlert,'No\x20Data',_0x26f03c[_0x337c13(0x196)]);const _0x518d3b=XLSX[_0x337c13(0x3b5)][_0x337c13(0x29c)]();if(_0x26f03c[_0x337c13(0x33d)](_0x2201de['length'],0x0)){const _0x3ae52b=_0x2201de['map']((_0x1f17f2,_0x2190f8)=>({'Rank':_0x2190f8+0x1,'Product\x20Code':_0x1f17f2[_0x337c13(0x301)],'Product\x20Name':_0x1f17f2[_0x337c13(0x2ad)],'Train':_0x1f17f2[_0x337c13(0x38f)],'Ingredient':_0x1f17f2['ingredientName'],'RPN':_0x1f17f2[_0x337c13(0x361)]})),_0x30d9cf=XLSX['utils']['json_to_sheet'](_0x3ae52b),_0x4c8a8=[{'wch':0x8},{'wch':0xf},{'wch':0x1e},{'wch':0xa},{'wch':0x19},{'wch':0x8}];_0x30d9cf[_0x337c13(0x260)]=_0x4c8a8,XLSX[_0x337c13(0x3b5)]['book_append_sheet'](_0x518d3b,_0x30d9cf,_0x26f03c['Fsyuo']);}if(_0x26f03c[_0x337c13(0x3ae)](_0x15f182[_0x337c13(0x22a)],0x0)){const _0xd09528=_0x15f182[_0x337c13(0x18c)](_0x2fe7b3=>({'Product\x20Code':_0x2fe7b3['productCode'],'Product\x20Name':_0x2fe7b3[_0x337c13(0x203)],'Product\x20Type':_0x2fe7b3[_0x337c13(0x375)],'Batch\x20Size\x20(kg)':_0x2fe7b3['batchSizeKg'],'MDD\x20(mg)':_0x2fe7b3['mddMg'],'Critical\x20Reason':_0x2fe7b3['criticalReason']||_0x337c13(0x23c),'Train':_0x337c13(0x2c4)!==_0x1f3767(_0x2fe7b3)?'T'+_0x1f3767(_0x2fe7b3):'N/A'})),_0x5ef8cc=XLSX[_0x337c13(0x3b5)][_0x337c13(0x319)](_0xd09528),_0x11fa8f=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32},{'wch':0xa}];_0x5ef8cc[_0x337c13(0x260)]=_0x11fa8f,XLSX[_0x337c13(0x3b5)][_0x337c13(0x195)](_0x518d3b,_0x5ef8cc,_0x26f03c[_0x337c13(0x27b)]);}const _0x1a3be3=a13_0x26f094['products'][_0x337c13(0x18c)](_0xee195=>{const _0x315a76=_0x337c13,_0x1eff9d={'EOWIj':function(_0x85b19c,_0x5191f0){return _0x26f03c['DjUMP'](_0x85b19c,_0x5191f0);},'ybuQv':function(_0x2bdd8b,_0x375756){return _0x26f03c['zgoJJ'](_0x2bdd8b,_0x375756);}},_0x357691=_0x26f03c[_0x315a76(0x2f1)](_0x1f3767,_0xee195),_0x56d8bc=_0xee195[_0x315a76(0x36b)][_0x315a76(0x1c8)]((_0x416cac,_0x391443)=>{const _0x5ee2d8=_0x315a76,_0x30e477=_0x1eff9d[_0x5ee2d8(0x239)](_0x1f549a,_0x391443)[_0x5ee2d8(0x361)];return _0x1eff9d[_0x5ee2d8(0x323)](_0x30e477,_0x416cac[_0x5ee2d8(0x361)])?{..._0x391443,'rpn':_0x30e477}:_0x416cac;},{'rpn':0x0,'name':_0x26f03c['LHxaZ']});return{'Product\x20Code':_0xee195[_0x315a76(0x301)],'Product\x20Name':_0xee195['name'],'Product\x20Type':_0xee195['productType'],'Batch\x20Size\x20(kg)':_0xee195[_0x315a76(0x1a4)],'MDD\x20(mg)':_0xee195[_0x315a76(0x26c)],'Train':_0x26f03c[_0x315a76(0x2e8)](_0x26f03c[_0x315a76(0x190)],_0x357691)?'T'+_0x357691:_0x26f03c[_0x315a76(0x190)],'Is\x20Critical':_0xee195[_0x315a76(0x1b9)]?_0x26f03c[_0x315a76(0x1ad)]:'No','Critical\x20Reason':_0xee195[_0x315a76(0x37a)]||_0x315a76(0x2c4),'Ingredients\x20Count':_0xee195[_0x315a76(0x36b)][_0x315a76(0x22a)],'Highest\x20RPN\x20Ingredient':_0x56d8bc[_0x315a76(0x203)],'Highest\x20RPN\x20Value':_0x56d8bc[_0x315a76(0x361)]||0x0};}),_0x45b8db=XLSX[_0x337c13(0x3b5)][_0x337c13(0x319)](_0x1a3be3);_0x45b8db[_0x26f03c['mTDxB']]=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xa},{'wch':0xa},{'wch':0x28},{'wch':0xc},{'wch':0x19},{'wch':0xc}],XLSX[_0x337c13(0x3b5)][_0x337c13(0x195)](_0x518d3b,_0x45b8db,_0x26f03c[_0x337c13(0x2fb)]);const _0x4527ce=new Date()['toISOString']()['split']('T')[0x0];XLSX[_0x337c13(0x2ec)](_0x518d3b,_0x337c13(0x294)+_0x4527ce+_0x337c13(0x357)),_0x26f03c[_0x337c13(0x2cb)](hideLoader),_0x26f03c[_0x337c13(0x265)](showCustomAlert,_0x26f03c[_0x337c13(0x2f7)],_0x26f03c[_0x337c13(0x1fa)]);})[_0x469a8c(0x2d3)](_0x27753b=>{const _0x35aa2c=_0x469a8c;console[_0x35aa2c(0x345)](_0x26f03c[_0x35aa2c(0x326)],_0x27753b),_0x26f03c[_0x35aa2c(0x32c)](hideLoader),_0x26f03c[_0x35aa2c(0x280)](showCustomAlert,_0x26f03c[_0x35aa2c(0x16e)],_0x26f03c['hooJD']);});}export function exportAllTabsToExcel(){const _0x105c0d=a13_0x17be56,_0x99030f={'EjJnc':function(_0x2ab9a3,_0x3729aa){return _0x2ab9a3||_0x3729aa;},'mkylM':function(_0x56f1b9,_0x235638){return _0x56f1b9(_0x235638);},'gbRQL':function(_0x8eb4da,_0x322d62){return _0x8eb4da/_0x322d62;},'EkyAn':function(_0xd178b0,_0x37b3ea){return _0xd178b0*_0x37b3ea;},'kvBUW':function(_0x18c237,_0x267b74,_0x1d9fa1){return _0x18c237(_0x267b74,_0x1d9fa1);},'AOeSS':function(_0x423fcb,_0x34038b){return _0x423fcb(_0x34038b);},'xznPz':_0x105c0d(0x2c4),'UUEuC':function(_0x13ac3e,_0x2f9eb6){return _0x13ac3e!==_0x2f9eb6;},'zUSnX':function(_0x4265ac,_0x279227){return _0x4265ac||_0x279227;},'OcolR':function(_0x4d6e04,_0x545543){return _0x4d6e04/_0x545543;},'EpmsT':function(_0x3d6c67,_0x2be0b9){return _0x3d6c67*_0x2be0b9;},'YpsHq':function(_0x3aa9b7,_0x28749f){return _0x3aa9b7===_0x28749f;},'kLsmf':'true','BxIFy':_0x105c0d(0x253),'RLSDz':_0x105c0d(0x1e8),'gYhJE':function(_0x532405,_0x2a7355){return _0x532405===_0x2a7355;},'OcXSK':_0x105c0d(0x1f9),'bkjIf':function(_0xbd3c57,_0xdd8109){return _0xbd3c57===_0xdd8109;},'tnStF':_0x105c0d(0x2d0),'nlZEj':function(_0x558cca,_0x7530fb){return _0x558cca===_0x7530fb;},'JFYMC':_0x105c0d(0x25c),'LAWdU':function(_0x338ccb,_0x301821){return _0x338ccb>_0x301821;},'piNSI':function(_0x46153c,_0x38d651){return _0x46153c==_0x38d651;},'PHAxj':_0x105c0d(0x26a),'MHbHH':function(_0x468ee8,_0x33b488){return _0x468ee8===_0x33b488;},'IuHIe':function(_0x16bad3){return _0x16bad3();},'pLCye':_0x105c0d(0x338),'PbBSc':_0x105c0d(0x186),'nlFnT':_0x105c0d(0x168),'ISZBj':_0x105c0d(0x210),'DOBur':_0x105c0d(0x39e),'eZjcV':_0x105c0d(0x204),'NUlXv':_0x105c0d(0x3b1),'xGbZn':_0x105c0d(0x290),'eadZf':_0x105c0d(0x32f),'HdIcW':function(_0x5d0826,_0x43b8ca){return _0x5d0826>_0x43b8ca;},'ceoak':_0x105c0d(0x332),'CCqtX':_0x105c0d(0x185),'nqoGL':_0x105c0d(0x2db),'KMtPD':_0x105c0d(0x153),'YDlxF':'Product\x20Register','xsNsY':_0x105c0d(0x1c5),'tgypi':function(_0x1081da,_0x23cc4c,_0xf4aad0){return _0x1081da(_0x23cc4c,_0xf4aad0);},'dwsoi':'Success','Ipqep':_0x105c0d(0x353),'YbOZA':'Error\x20exporting\x20all\x20tabs\x20to\x20Excel:','OdFqP':function(_0x241f68){return _0x241f68();},'IjcWB':_0x105c0d(0x3be)};_0x99030f['OdFqP'](showLoader),import(_0x99030f[_0x105c0d(0x1ef)])[_0x105c0d(0x339)](_0x5c7f9c=>{const _0x56fdf3=_0x105c0d,_0x37dc78={'ykRmy':function(_0x2d81a1,_0x30f659){const _0x2faa82=a13_0xd75d;return _0x99030f[_0x2faa82(0x39d)](_0x2d81a1,_0x30f659);},'QbiqX':_0x99030f['xznPz'],'dyVIP':function(_0x163a8f,_0x1a6544){return _0x99030f['OcolR'](_0x163a8f,_0x1a6544);},'NaMjY':function(_0xde3fd7,_0x3f73a1){return _0x99030f['EpmsT'](_0xde3fd7,_0x3f73a1);},'maAap':function(_0x403727,_0x3bdf52){return _0x403727/_0x3bdf52;},'xtsRz':function(_0x4bca35,_0x122ccb){return _0x4bca35/_0x122ccb;},'iqQCv':function(_0xd2a432,_0x46097e){const _0x4dcf8c=a13_0xd75d;return _0x99030f[_0x4dcf8c(0x197)](_0xd2a432,_0x46097e);},'FxDLJ':_0x99030f[_0x56fdf3(0x27f)],'owIeu':_0x99030f[_0x56fdf3(0x150)],'CEpdE':function(_0x431e6e,_0x7a4c50){const _0xb0a38c=_0x56fdf3;return _0x99030f[_0xb0a38c(0x197)](_0x431e6e,_0x7a4c50);},'IfHsJ':_0x99030f[_0x56fdf3(0x293)],'eCWIv':function(_0x3e1c70,_0x551947){const _0x5c7bee=_0x56fdf3;return _0x99030f[_0x5c7bee(0x15c)](_0x3e1c70,_0x551947);},'rQrVf':function(_0x5790ab,_0x49615a){const _0x2eff5d=_0x56fdf3;return _0x99030f[_0x2eff5d(0x216)](_0x5790ab,_0x49615a);},'odSrV':function(_0x2e9056,_0x3e4dfe){const _0x1bee83=_0x56fdf3;return _0x99030f[_0x1bee83(0x2d8)](_0x2e9056,_0x3e4dfe);},'IBNus':'0.1%\x20Therapeutic\x20Dose','dqowE':_0x99030f[_0x56fdf3(0x2ef)],'lLjqg':function(_0x21e621,_0x415be5){const _0x56964f=_0x56fdf3;return _0x99030f[_0x56964f(0x330)](_0x21e621,_0x415be5);},'neafl':_0x99030f[_0x56fdf3(0x370)],'wyZJu':function(_0x532d0a,_0x523d40){const _0x487aa8=_0x56fdf3;return _0x99030f[_0x487aa8(0x2aa)](_0x532d0a,_0x523d40);},'nmpXG':_0x99030f[_0x56fdf3(0x37b)],'tKZzY':function(_0x2ce070,_0x572af7){const _0x67ebec=_0x56fdf3;return _0x99030f[_0x67ebec(0x31d)](_0x2ce070,_0x572af7);},'eYpxL':function(_0x1e5cb6,_0x50a81b){return _0x99030f['UUEuC'](_0x1e5cb6,_0x50a81b);},'ycZCo':function(_0x398b8b,_0x19a6d5){const _0x1073bc=_0x56fdf3;return _0x99030f[_0x1073bc(0x2f5)](_0x398b8b,_0x19a6d5);},'uhiUY':_0x99030f[_0x56fdf3(0x374)],'UIThz':function(_0x24a2bd,_0x1a60a3){const _0x1a68d3=_0x56fdf3;return _0x99030f[_0x1a68d3(0x2a3)](_0x24a2bd,_0x1a60a3);},'CdAXp':_0x56fdf3(0x2ff),'GWbaR':function(_0x5ebcce,_0x53b5c9){const _0x480f6c=_0x56fdf3;return _0x99030f[_0x480f6c(0x259)](_0x5ebcce,_0x53b5c9);},'roZvN':_0x56fdf3(0x221)},{getTrainData:_0x308fcc,getWorstCaseProductType:_0x52a366,getProductTrainId:_0x5923d0,calculateScores:_0x106a67}=_0x5c7f9c,_0xf015dc=_0x308fcc();if(_0x99030f[_0x56fdf3(0x2af)](0x0,_0xf015dc[_0x56fdf3(0x22a)]))return _0x99030f[_0x56fdf3(0x209)](hideLoader),void _0x99030f[_0x56fdf3(0x159)](showCustomAlert,_0x99030f[_0x56fdf3(0x3b0)],_0x99030f[_0x56fdf3(0x287)]);const _0x36390b=XLSX['utils'][_0x56fdf3(0x29c)]();try{const _0x10c4b6=[];_0xf015dc[_0x56fdf3(0x1fd)](_0x2e6b02=>{const _0x4d25ef=_0x56fdf3,_0x5937ba=_0x52a366(_0x2e6b02[_0x4d25ef(0x21b)][_0x4d25ef(0x18c)](_0x34a7d8=>_0x34a7d8[_0x4d25ef(0x375)])),_0xac239d=(a13_0x26f094['safetyFactorConfig'][_0x5937ba]||a13_0x26f094[_0x4d25ef(0x263)]['Other'])[_0x4d25ef(0x18b)],_0x53e2c9=_0x37dc78['dyVIP'](_0x2e6b02[_0x4d25ef(0x1a2)]*_0x2e6b02[_0x4d25ef(0x206)],_0xac239d),_0x4d27fd=_0x37dc78[_0x4d25ef(0x176)](0xa,_0x2e6b02['minMbsKg']);let _0x2e4375=_0x37dc78[_0x4d25ef(0x2d1)](0x1,0x0),_0x57790b=_0x37dc78['xtsRz'](0x1,0x0);const _0x3f9490=_0x37dc78[_0x4d25ef(0x1db)](_0x37dc78['FxDLJ'],localStorage[_0x4d25ef(0x225)](_0x37dc78[_0x4d25ef(0x304)])),_0x54eb81=_0x37dc78[_0x4d25ef(0x36e)](_0x37dc78[_0x4d25ef(0x373)],localStorage[_0x4d25ef(0x225)](_0x37dc78[_0x4d25ef(0x2a1)]));if(_0x37dc78[_0x4d25ef(0x2b2)](null,_0x2e6b02[_0x4d25ef(0x39f)])||_0x3f9490||(_0x2e4375=_0x37dc78[_0x4d25ef(0x176)](_0x2e6b02[_0x4d25ef(0x39f)],_0x2e6b02['minBsMddRatio'])),null!==_0x2e6b02[_0x4d25ef(0x277)]&&!_0x54eb81){const _0x1d26f0=_0x37dc78[_0x4d25ef(0x15e)](0x46,_0x2e6b02['lowestLd50'])/0x7d0,_0x19ab9e=_0x2e6b02[_0x4d25ef(0x21b)][_0x4d25ef(0x29b)](_0x28f5b8=>_0x28f5b8[_0x4d25ef(0x36b)][_0x4d25ef(0x18c)](_0x32ac89=>_0x32ac89[_0x4d25ef(0x333)]/0x3e8)),_0x5ce148=Math['min'](..._0x19ab9e);_0x57790b=_0x37dc78[_0x4d25ef(0x1ff)](_0x37dc78[_0x4d25ef(0x1ff)](_0x1d26f0,_0x2e6b02[_0x4d25ef(0x302)]),0x3e8)/(_0xac239d*_0x5ce148);}const _0x5084a8=getLargestEssaForLineAndDosageForm(_0x2e6b02,_0xf015dc),_0x25c818=_0x37dc78[_0x4d25ef(0x1ff)](0.004,_0x5084a8),_0x45445d=[{'name':_0x37dc78[_0x4d25ef(0x39c)],'value':_0x53e2c9},{'name':_0x37dc78[_0x4d25ef(0x1c0)],'value':_0x4d27fd}];_0x37dc78['lLjqg'](null,_0x2e6b02['lowestPde'])||_0x3f9490||_0x45445d[_0x4d25ef(0x17f)]({'name':_0x37dc78[_0x4d25ef(0x2c8)],'value':_0x2e4375}),_0x37dc78[_0x4d25ef(0x2ca)](null,_0x2e6b02[_0x4d25ef(0x277)])||_0x54eb81||_0x45445d['push']({'name':_0x37dc78[_0x4d25ef(0x335)],'value':_0x57790b}),_0x45445d[_0x4d25ef(0x17f)]({'name':'Visual\x20Clean\x20Limit','value':_0x25c818});const _0x37f4ce=_0x45445d[_0x4d25ef(0x1c8)]((_0x2277f5,_0x492fa3)=>_0x492fa3['value']<_0x2277f5[_0x4d25ef(0x37f)]?_0x492fa3:_0x2277f5),_0x257847=_0x37f4ce[_0x4d25ef(0x37f)],_0x28eb2f=_0x37dc78[_0x4d25ef(0x1d5)](_0x5084a8,0x0)?_0x37dc78[_0x4d25ef(0x1f2)](_0x257847,_0x5084a8):0x0,_0x47fda4=_0x28eb2f*_0x2e6b02[_0x4d25ef(0x160)],_0x2b9c52=_0x2e6b02[_0x4d25ef(0x241)][_0x4d25ef(0x18c)](_0xa68c9f=>{const _0x32ef90=_0x4d25ef,_0x2b36ce=a13_0x26f094[_0x32ef90(0x1b2)][_0x32ef90(0x282)](_0x1e557d=>_0x1e557d['id']===_0xa68c9f);return _0x37dc78[_0x32ef90(0x175)](_0x2b36ce,{'name':_0x32ef90(0x352)+_0xa68c9f+')','machineNumber':_0x37dc78['QbiqX']});}),_0x51bcfc=_0x2e6b02[_0x4d25ef(0x241)][_0x4d25ef(0x18c)](_0x496439=>{const _0x1813d0=_0x4d25ef,_0x237473=a13_0x26f094[_0x1813d0(0x1b2)][_0x1813d0(0x282)](_0x319e5b=>_0x319e5b['id']===_0x496439);return _0x237473?_0x237473[_0x1813d0(0x203)]:_0x1813d0(0x352)+_0x496439+')';})[_0x4d25ef(0x39a)](',\x20'),_0x48aa6f=_0x2e6b02[_0x4d25ef(0x21b)][_0x4d25ef(0x18c)](_0x4c6e31=>_0x4c6e31[_0x4d25ef(0x301)]+'\x20-\x20'+_0x4c6e31[_0x4d25ef(0x203)])['join'](';\x20'),_0x4d8fe7=_0x2e6b02[_0x4d25ef(0x1fc)]?_0x2e6b02[_0x4d25ef(0x1fc)][_0x4d25ef(0x2ad)]+'\x20('+_0x2e6b02[_0x4d25ef(0x1fc)][_0x4d25ef(0x2b6)]+_0x4d25ef(0x29e)+_0x2e6b02[_0x4d25ef(0x1fc)][_0x4d25ef(0x361)]:'N/A';_0x10c4b6[_0x4d25ef(0x17f)]({'Train':'T'+_0x2e6b02['id'],'Total\x20Products':_0x2e6b02[_0x4d25ef(0x21b)][_0x4d25ef(0x22a)],'Total\x20Machines':_0x2b9c52['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x2e6b02[_0x4d25ef(0x1f0)]['toLocaleString'](),'Products':_0x48aa6f,'Machines':_0x51bcfc,'Worst-Case\x20Dosage\x20Form':_0x5937ba,'Safety\x20Factor':_0xac239d,'Lowest\x20LTD\x20(mg)':_0x2e6b02[_0x4d25ef(0x1a2)],'Min\x20Batch\x20Size\x20(kg)':_0x2e6b02[_0x4d25ef(0x302)],'Min\x20BS/MDD\x20Ratio':_0x2e6b02['minBsMddRatio']['toFixed'](0x2),'Lowest\x20PDE\x20(mg)':_0x37dc78['eYpxL'](null,_0x2e6b02['lowestPde'])?_0x2e6b02[_0x4d25ef(0x39f)]:_0x37dc78['QbiqX'],'Worst-Case\x20Product\x20(by\x20RPN)':_0x4d8fe7,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x53e2c9[_0x4d25ef(0x289)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x4d27fd[_0x4d25ef(0x289)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x37dc78[_0x4d25ef(0x16f)](_0x37dc78[_0x4d25ef(0x1a0)],typeof _0x2e4375)?_0x2e4375[_0x4d25ef(0x289)](0x2):_0x37dc78[_0x4d25ef(0x2a8)],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x25c818[_0x4d25ef(0x289)](0x2),'Selected\x20MACO\x20Method':_0x37f4ce[_0x4d25ef(0x203)],'Final\x20MACO\x20(mg)':_0x257847[_0x4d25ef(0x289)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x28eb2f['toExponential'](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x47fda4[_0x4d25ef(0x289)](0x4)});});const _0x19836a=XLSX[_0x56fdf3(0x3b5)][_0x56fdf3(0x319)](_0x10c4b6);XLSX[_0x56fdf3(0x3b5)][_0x56fdf3(0x195)](_0x36390b,_0x19836a,_0x99030f[_0x56fdf3(0x360)]);}catch(_0x21656d){console['error'](_0x99030f[_0x56fdf3(0x25b)],_0x21656d);}try{if(_0x99030f[_0x56fdf3(0x31d)](a13_0x26f094[_0x56fdf3(0x28b)][_0x56fdf3(0x22a)],0x0)){const _0x4ef556=parseFloat(document[_0x56fdf3(0x3bb)](_0x99030f[_0x56fdf3(0x23d)])?.[_0x56fdf3(0x37f)])||0x46,_0x591051=a13_0x26f094[_0x56fdf3(0x28b)]['map'](_0x2b8759=>parseFloat(_0x2b8759[_0x56fdf3(0x262)]))[_0x56fdf3(0x170)](_0x416f03=>!isNaN(_0x416f03)),_0x1eb902=_0x99030f[_0x56fdf3(0x31d)](_0x591051[_0x56fdf3(0x22a)],0x0)?Math[_0x56fdf3(0x2b7)](..._0x591051):0x0,_0x394080=a13_0x26f094[_0x56fdf3(0x28b)][_0x56fdf3(0x18c)](_0x58d1c0=>_0x58d1c0['name'])[_0x56fdf3(0x170)](_0xcf0a2c=>''!==_0xcf0a2c[_0x56fdf3(0x274)]())[_0x56fdf3(0x39a)](',\x20'),_0x51eb48=[];_0xf015dc[_0x56fdf3(0x1fd)](_0x20ded7=>{const _0x33ccb0=_0x56fdf3,_0x359d9d={'wOkiC':function(_0x24dc60,_0x191655){const _0xcbfd1b=a13_0xd75d;return _0x99030f[_0xcbfd1b(0x268)](_0x24dc60,_0x191655);}},_0x5d5736=_0x99030f[_0x33ccb0(0x2a3)](_0x52a366,_0x20ded7['products']['map'](_0x2d4235=>_0x2d4235[_0x33ccb0(0x375)])),_0x2562a3=a13_0x26f094[_0x33ccb0(0x263)][_0x5d5736]||a13_0x26f094[_0x33ccb0(0x263)]['Other'],_0x22cf91=document[_0x33ccb0(0x3bb)]('sf-input-train-'+_0x20ded7['id']),_0x140ea8=_0x22cf91&&_0x99030f[_0x33ccb0(0x2a3)](parseFloat,_0x22cf91[_0x33ccb0(0x37f)])||_0x2562a3[_0x33ccb0(0x18b)],_0x38ec15=_0x99030f[_0x33ccb0(0x29f)](_0x99030f[_0x33ccb0(0x2d8)](0.0005*_0x1eb902,_0x4ef556),_0x140ea8),_0x374f14=_0x99030f[_0x33ccb0(0x2d8)](_0x38ec15,_0x20ded7['minBsMddRatio']),_0x416bc3=_0x99030f[_0x33ccb0(0x159)](getLargestEssaForLineAndDosageForm,_0x20ded7,_0xf015dc),_0x1c786e=_0x416bc3>0x0?_0x99030f[_0x33ccb0(0x29f)](_0x374f14,_0x416bc3):0x0,_0x5e50ab=_0x99030f['EkyAn'](_0x1c786e,_0x20ded7['assumedSsa']),_0x46843a=_0x20ded7[_0x33ccb0(0x241)][_0x33ccb0(0x18c)](_0x55a4e4=>{const _0x10ce56=_0x33ccb0,_0x268a76=a13_0x26f094[_0x10ce56(0x1b2)][_0x10ce56(0x282)](_0x9d3e6b=>_0x9d3e6b['id']===_0x55a4e4);return _0x359d9d[_0x10ce56(0x215)](_0x268a76,{'name':_0x10ce56(0x352)+_0x55a4e4+')','machineNumber':'N/A'});}),_0x13817c=_0x20ded7[_0x33ccb0(0x241)][_0x33ccb0(0x18c)](_0x3e00af=>{const _0x55bbe1=_0x33ccb0,_0x2b6a8b=a13_0x26f094[_0x55bbe1(0x1b2)]['find'](_0x143bd8=>_0x143bd8['id']===_0x3e00af);return _0x2b6a8b?_0x2b6a8b[_0x55bbe1(0x203)]:_0x55bbe1(0x352)+_0x3e00af+')';})[_0x33ccb0(0x39a)](',\x20'),_0x9d6b3=_0x20ded7[_0x33ccb0(0x21b)]['map'](_0xa7a52d=>_0xa7a52d[_0x33ccb0(0x301)]+'\x20-\x20'+_0xa7a52d[_0x33ccb0(0x203)])[_0x33ccb0(0x39a)](';\x20'),_0x54e0b0=_0x20ded7[_0x33ccb0(0x1fc)]?_0x20ded7[_0x33ccb0(0x1fc)][_0x33ccb0(0x2ad)]+'\x20('+_0x20ded7['worstProductRpn'][_0x33ccb0(0x2b6)]+_0x33ccb0(0x29e)+_0x20ded7[_0x33ccb0(0x1fc)][_0x33ccb0(0x361)]:_0x33ccb0(0x2c4);_0x51eb48[_0x33ccb0(0x17f)]({'Train':'T'+_0x20ded7['id'],'Total\x20Products':_0x20ded7[_0x33ccb0(0x21b)][_0x33ccb0(0x22a)],'Total\x20Machines':_0x46843a[_0x33ccb0(0x22a)],'Total\x20Area\x20(ESSA)\x20cm²':_0x20ded7[_0x33ccb0(0x1f0)][_0x33ccb0(0x18a)](),'Products':_0x9d6b3,'Machines':_0x13817c,'Worst-Case\x20Dosage\x20Form':_0x5d5736,'Safety\x20Factor\x20Range':_0x2562a3[_0x33ccb0(0x2b7)]+_0x33ccb0(0x32a)+_0x2562a3[_0x33ccb0(0x18b)],'Applied\x20Safety\x20Factor':_0x140ea8,'Detergent\x20Ingredients':_0x394080,'Body\x20Weight\x20(kg)':_0x4ef556,'Minimum\x20LD50\x20(mg/kg)':_0x1eb902,'Min\x20Batch\x20Size\x20(kg)':_0x20ded7[_0x33ccb0(0x302)],'Min\x20BS/MDD\x20Ratio':_0x20ded7[_0x33ccb0(0x206)][_0x33ccb0(0x289)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x54e0b0,'ADI\x20(mg)':_0x38ec15[_0x33ccb0(0x289)](0x4),'MACO\x20(mg)':_0x374f14[_0x33ccb0(0x289)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x1c786e[_0x33ccb0(0x2de)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x5e50ab[_0x33ccb0(0x289)](0x4)});});const _0x4e1dec=XLSX['utils'][_0x56fdf3(0x319)](_0x51eb48);XLSX[_0x56fdf3(0x3b5)]['book_append_sheet'](_0x36390b,_0x4e1dec,_0x99030f[_0x56fdf3(0x3b4)]);}}catch(_0x49174c){console[_0x56fdf3(0x345)](_0x99030f[_0x56fdf3(0x28c)],_0x49174c);}try{const _0x2eb49c=[];_0xf015dc['forEach'](_0x6fbca4=>{const _0x4b38fc=_0x56fdf3,_0x5f4707=_0x6fbca4['machineIds']['map'](_0x459640=>{const _0x58dd25=a13_0xd75d,_0x36dae7=a13_0x26f094['machines'][_0x58dd25(0x282)](_0x5ba986=>_0x5ba986['id']===_0x459640);return _0x36dae7||{'id':_0x459640,'name':'Unknown\x20(ID:\x20'+_0x459640+')','machineNumber':_0x58dd25(0x2c4)};}),_0x53e28d=_0x6fbca4[_0x4b38fc(0x241)]['map'](_0x4c7fb8=>{const _0x48008c=_0x4b38fc,_0x23e19e=a13_0x26f094['machines'][_0x48008c(0x282)](_0x35a418=>_0x35a418['id']===_0x4c7fb8);return _0x23e19e?_0x23e19e['name']:_0x48008c(0x352)+_0x4c7fb8+')';})[_0x4b38fc(0x39a)](',\x20'),_0x393d85=_0x6fbca4[_0x4b38fc(0x21b)]['map'](_0xc2abed=>_0xc2abed[_0x4b38fc(0x301)]+_0x4b38fc(0x32a)+_0xc2abed[_0x4b38fc(0x203)])[_0x4b38fc(0x39a)](';\x20'),_0x28d80c=_0x6fbca4[_0x4b38fc(0x21b)][_0x4b38fc(0x18c)](_0x5c1374=>_0x5c1374[_0x4b38fc(0x301)]+':\x20'+_0x5c1374[_0x4b38fc(0x203)])[_0x4b38fc(0x39a)]('\x0a'),_0x44d446=_0x5f4707['map'](_0x39f8aa=>_0x39f8aa[_0x4b38fc(0x380)]+':\x20'+_0x39f8aa[_0x4b38fc(0x203)])[_0x4b38fc(0x39a)]('\x0a');_0x2eb49c['push']({'Train\x20ID':'T'+_0x6fbca4['id'],'Products\x20Count':_0x6fbca4[_0x4b38fc(0x21b)][_0x4b38fc(0x22a)],'Machines\x20Count':_0x5f4707[_0x4b38fc(0x22a)],'Total\x20Area\x20(ESSA)\x20cm²':_0x6fbca4[_0x4b38fc(0x1f0)][_0x4b38fc(0x18a)](),'Products\x20(Code\x20-\x20Name)':_0x393d85,'Machines\x20(Number\x20-\x20Name)':_0x53e28d,'Products\x20Detailed':_0x28d80c,'Machines\x20Detailed':_0x44d446,'Min\x20Batch\x20Size\x20(kg)':_0x6fbca4[_0x4b38fc(0x302)],'Min\x20BS/MDD\x20Ratio':_0x6fbca4[_0x4b38fc(0x206)][_0x4b38fc(0x289)](0x2),'Assumed\x20SSA\x20(cm²)':_0x6fbca4[_0x4b38fc(0x160)],'Lowest\x20LTD\x20(mg)':_0x6fbca4[_0x4b38fc(0x1a2)],'Lowest\x20PDE\x20(mg)':null!==_0x6fbca4[_0x4b38fc(0x39f)]?_0x6fbca4['lowestPde']:_0x37dc78[_0x4b38fc(0x2a8)],'Worst\x20RPN\x20Product':_0x6fbca4['worstProductRpn']?_0x6fbca4['worstProductRpn'][_0x4b38fc(0x2ad)]+'\x20('+_0x6fbca4[_0x4b38fc(0x1fc)][_0x4b38fc(0x2b6)]+_0x4b38fc(0x29e)+_0x6fbca4['worstProductRpn'][_0x4b38fc(0x361)]:_0x37dc78[_0x4b38fc(0x2a8)]});});const _0x147fd4=XLSX[_0x56fdf3(0x3b5)][_0x56fdf3(0x319)](_0x2eb49c);XLSX[_0x56fdf3(0x3b5)][_0x56fdf3(0x195)](_0x36390b,_0x147fd4,_0x99030f[_0x56fdf3(0x2a6)]);}catch(_0x2b0708){console[_0x56fdf3(0x345)](_0x99030f[_0x56fdf3(0x31f)],_0x2b0708);}try{const _0x3184d0=a13_0x26f094[_0x56fdf3(0x21b)][_0x56fdf3(0x29b)](_0x3809b9=>{const _0x2e408b=_0x56fdf3,_0x315d1c=_0x5923d0(_0x3809b9);return _0x3809b9[_0x2e408b(0x36b)]['map'](_0x5f2ff7=>({'productName':_0x3809b9[_0x2e408b(0x203)],'productCode':_0x3809b9[_0x2e408b(0x301)],'ingredientName':_0x5f2ff7['name'],'rpn':_0x106a67(_0x5f2ff7)[_0x2e408b(0x361)],'trainId':_0x2e408b(0x2c4)!==_0x315d1c?'T'+_0x315d1c:'N/A'}));})['sort']((_0xc5c01d,_0x5dcb87)=>_0x5dcb87[_0x56fdf3(0x361)]-_0xc5c01d[_0x56fdf3(0x361)])[_0x56fdf3(0x1fb)](0x0,0xa);if(_0x99030f[_0x56fdf3(0x15a)](_0x3184d0[_0x56fdf3(0x22a)],0x0)){const _0x109c54=_0x3184d0[_0x56fdf3(0x18c)]((_0x17d298,_0x55c006)=>({'Rank':_0x55c006+0x1,'Product\x20Code':_0x17d298[_0x56fdf3(0x301)],'Product\x20Name':_0x17d298['productName'],'Train':_0x17d298[_0x56fdf3(0x38f)],'Ingredient':_0x17d298[_0x56fdf3(0x2b6)],'RPN':_0x17d298[_0x56fdf3(0x361)]})),_0x4dd79f=XLSX[_0x56fdf3(0x3b5)][_0x56fdf3(0x319)](_0x109c54);XLSX[_0x56fdf3(0x3b5)][_0x56fdf3(0x195)](_0x36390b,_0x4dd79f,_0x99030f['ceoak']);}}catch(_0x204f35){console['error'](_0x99030f[_0x56fdf3(0x1ca)],_0x204f35);}try{const _0x40b7f8=a13_0x26f094[_0x56fdf3(0x21b)][_0x56fdf3(0x170)](_0x131db7=>_0x131db7[_0x56fdf3(0x1b9)]);if(_0x40b7f8[_0x56fdf3(0x22a)]>0x0){const _0x3b9850=_0x40b7f8[_0x56fdf3(0x18c)](_0x1c0eca=>({'Product\x20Code':_0x1c0eca[_0x56fdf3(0x301)],'Product\x20Name':_0x1c0eca[_0x56fdf3(0x203)],'Product\x20Type':_0x1c0eca['productType'],'Batch\x20Size\x20(kg)':_0x1c0eca[_0x56fdf3(0x1a4)],'MDD\x20(mg)':_0x1c0eca['mddMg'],'Critical\x20Reason':_0x1c0eca[_0x56fdf3(0x37a)]||'No\x20reason\x20provided','Train':_0x56fdf3(0x2c4)!==_0x5923d0(_0x1c0eca)?'T'+_0x5923d0(_0x1c0eca):_0x56fdf3(0x2c4)})),_0x2344d3=XLSX[_0x56fdf3(0x3b5)][_0x56fdf3(0x319)](_0x3b9850);XLSX[_0x56fdf3(0x3b5)]['book_append_sheet'](_0x36390b,_0x2344d3,_0x56fdf3(0x27d));}}catch(_0x3f753f){console[_0x56fdf3(0x345)]('Error\x20creating\x20Critical\x20Products\x20sheet:',_0x3f753f);}try{const _0x1eaf63=a13_0x26f094[_0x56fdf3(0x21b)][_0x56fdf3(0x18c)](_0xc7727d=>{const _0x361717=_0x56fdf3,_0x352999=_0x99030f[_0x361717(0x27e)](_0x5923d0,_0xc7727d),_0x1f2b98=_0xc7727d['activeIngredients'][_0x361717(0x1c8)]((_0x51cdc5,_0x4d46b0)=>{const _0x4fcfea=_0x361717,_0x36006e=_0x37dc78[_0x4fcfea(0x2e4)](_0x106a67,_0x4d46b0)[_0x4fcfea(0x361)];return _0x37dc78[_0x4fcfea(0x1d5)](_0x36006e,_0x51cdc5[_0x4fcfea(0x361)])?{..._0x4d46b0,'rpn':_0x36006e}:_0x51cdc5;},{'rpn':0x0,'name':_0x99030f[_0x361717(0x19b)]});return{'Product\x20Code':_0xc7727d[_0x361717(0x301)],'Product\x20Name':_0xc7727d['name'],'Product\x20Type':_0xc7727d['productType'],'Batch\x20Size\x20(kg)':_0xc7727d[_0x361717(0x1a4)],'MDD\x20(mg)':_0xc7727d[_0x361717(0x26c)],'Train':_0x99030f['UUEuC'](_0x99030f[_0x361717(0x19b)],_0x352999)?'T'+_0x352999:_0x361717(0x2c4),'Is\x20Critical':_0xc7727d[_0x361717(0x1b9)]?_0x361717(0x2d9):'No','Critical\x20Reason':_0xc7727d['criticalReason']||_0x99030f[_0x361717(0x19b)],'Ingredients\x20Count':_0xc7727d['activeIngredients'][_0x361717(0x22a)],'Highest\x20RPN\x20Ingredient':_0x1f2b98[_0x361717(0x203)],'Highest\x20RPN\x20Value':_0x1f2b98[_0x361717(0x361)]||0x0};}),_0x940591=XLSX['utils'][_0x56fdf3(0x319)](_0x1eaf63);XLSX[_0x56fdf3(0x3b5)][_0x56fdf3(0x195)](_0x36390b,_0x940591,_0x99030f[_0x56fdf3(0x249)]);}catch(_0x370997){console['error'](_0x99030f[_0x56fdf3(0x3a6)],_0x370997);}try{const _0x3cba22=[];a13_0x26f094[_0x56fdf3(0x21b)][_0x56fdf3(0x1fd)](_0x12e69f=>{const _0x2010c8=_0x56fdf3,_0x54fcba={'osvsR':function(_0x2df405,_0x2d5027){return _0x2df405(_0x2d5027);},'bRIzR':_0x37dc78[_0x2010c8(0x266)],'UOTvM':_0x37dc78[_0x2010c8(0x2a8)]},_0x256e84=_0x5923d0(_0x12e69f),_0x39d61e={'Product\x20Code':_0x12e69f[_0x2010c8(0x301)],'Product\x20Name':_0x12e69f[_0x2010c8(0x203)],'Product\x20Type':_0x12e69f[_0x2010c8(0x375)],'Batch\x20Size\x20(kg)':_0x12e69f[_0x2010c8(0x1a4)],'MDD\x20(mg)':_0x12e69f[_0x2010c8(0x26c)],'Train':_0x37dc78[_0x2010c8(0x1eb)]('N/A',_0x256e84)?'T'+_0x256e84:_0x37dc78['QbiqX'],'Is\x20Critical':_0x12e69f[_0x2010c8(0x1b9)]?'Yes':'No','Critical\x20Reason':_0x12e69f[_0x2010c8(0x37a)]||_0x37dc78['QbiqX'],'Ingredient\x20Type':_0x37dc78[_0x2010c8(0x1e1)],'Ingredient\x20Name':'','LTD\x20(mg)':'','PDE\x20(mg)':'','LD50\x20(mg/kg)':'','Severity':'','Occurrence':'','Detection':'','RPN':''};_0x3cba22[_0x2010c8(0x17f)](_0x39d61e),_0x12e69f[_0x2010c8(0x36b)][_0x2010c8(0x1fd)](_0x4fd333=>{const _0x330995=_0x2010c8,_0x567edd=_0x54fcba[_0x330995(0x1bf)](_0x106a67,_0x4fd333);_0x3cba22[_0x330995(0x17f)]({'Product\x20Code':'','Product\x20Name':'','Product\x20Type':'','Batch\x20Size\x20(kg)':'','MDD\x20(mg)':'','Train':'','Is\x20Critical':'','Critical\x20Reason':'','Ingredient\x20Type':_0x54fcba['bRIzR'],'Ingredient\x20Name':_0x4fd333[_0x330995(0x203)],'LTD\x20(mg)':_0x4fd333[_0x330995(0x35e)]||_0x54fcba[_0x330995(0x15b)],'PDE\x20(mg)':_0x4fd333[_0x330995(0x181)]||_0x54fcba['UOTvM'],'LD50\x20(mg/kg)':_0x4fd333[_0x330995(0x262)]||_0x54fcba[_0x330995(0x15b)],'Severity':_0x567edd[_0x330995(0x285)],'Occurrence':_0x567edd[_0x330995(0x33b)],'Detection':_0x567edd['detection'],'RPN':_0x567edd[_0x330995(0x361)]});});});const _0x468e42=XLSX[_0x56fdf3(0x3b5)][_0x56fdf3(0x319)](_0x3cba22);XLSX[_0x56fdf3(0x3b5)][_0x56fdf3(0x195)](_0x36390b,_0x468e42,_0x99030f[_0x56fdf3(0x1d9)]);}catch(_0x132793){console['error'](_0x99030f['xsNsY'],_0x132793);}const _0x338536=new Date()[_0x56fdf3(0x1af)]()[_0x56fdf3(0x18f)]('T')[0x0];XLSX[_0x56fdf3(0x2ec)](_0x36390b,_0x56fdf3(0x14d)+_0x338536+_0x56fdf3(0x357)),_0x99030f[_0x56fdf3(0x209)](hideLoader),_0x99030f[_0x56fdf3(0x278)](showCustomAlert,_0x99030f[_0x56fdf3(0x2c7)],_0x99030f[_0x56fdf3(0x365)]);})[_0x105c0d(0x2d3)](_0x4fa792=>{const _0x57bf50=_0x105c0d;console[_0x57bf50(0x345)](_0x99030f[_0x57bf50(0x20b)],_0x4fa792),_0x99030f[_0x57bf50(0x209)](hideLoader),_0x99030f[_0x57bf50(0x159)](showCustomAlert,_0x57bf50(0x3a2),_0x57bf50(0x390));});}export function toggleStageSection(_0x53d4b0){const _0x364e97=a13_0x17be56,_0x1f9165={'Mjjpx':function(_0x5c5019,_0x4a1c4b){return _0x5c5019===_0x4a1c4b;},'wKbUL':_0x364e97(0x22d),'oyYUH':_0x364e97(0x38e),'toNeZ':'Hide','EpNxW':_0x364e97(0x24c)},_0x17245b=document[_0x364e97(0x3bb)]('stage-'+_0x53d4b0),_0x2af300=_0x1f9165[_0x364e97(0x202)](_0x1f9165[_0x364e97(0x250)],_0x17245b[_0x364e97(0x2b4)][_0x364e97(0x36a)]);_0x17245b[_0x364e97(0x2b4)][_0x364e97(0x36a)]=_0x2af300?'':_0x1f9165['wKbUL'],localStorage[_0x364e97(0x35b)](_0x364e97(0x310)+_0x53d4b0+'-hidden',!_0x2af300);const _0xb27f99=_0x17245b[_0x364e97(0x2e3)]['querySelector'](_0x1f9165[_0x364e97(0x275)]);_0xb27f99&&(_0xb27f99['textContent']=_0x2af300?_0x1f9165[_0x364e97(0x233)]:_0x1f9165['EpNxW']);}