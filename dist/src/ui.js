const a13_0x5d3211=a13_0x144a;(function(_0x23b7c5,_0x2dcad7){const _0x34c4aa=a13_0x144a,_0x3e0d34=_0x23b7c5();while(!![]){try{const _0x1af954=parseInt(_0x34c4aa(0xea))/0x1*(parseInt(_0x34c4aa(0x199))/0x2)+-parseInt(_0x34c4aa(0xad))/0x3+-parseInt(_0x34c4aa(0x96))/0x4+parseInt(_0x34c4aa(0x10b))/0x5+-parseInt(_0x34c4aa(0x24f))/0x6*(parseInt(_0x34c4aa(0x10f))/0x7)+-parseInt(_0x34c4aa(0x21e))/0x8+parseInt(_0x34c4aa(0x2b6))/0x9;if(_0x1af954===_0x2dcad7)break;else _0x3e0d34['push'](_0x3e0d34['shift']());}catch(_0x361835){_0x3e0d34['push'](_0x3e0d34['shift']());}}}(a13_0x149b,0xab7bf));import*as a13_0x529504 from'./state.js';import{fullAppRender as a13_0x50a144}from'./app.js';function a13_0x149b(){const _0x46f9b7=['forEach','nIqHB','hxstw','toggle-pm-','_Train_','SnYKT','push','Error\x20loading\x20products','product-sf-input','xuXBY','Product\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','cwEow','zVaqi','includes','Hide\x20PDE','UKRZa','./macoProductView.js','kKMIQ','theme-toggle-light-icon','VBFXB','Error\x20creating\x20All\x20Products\x20sheet:','disabled','Yajwv','AcWGK','GjCaJ','reduce','ld50','rpnRatingText','macoMachines','maco_data_export.json','href','Machines\x20data\x20exported\x20to\x20Excel\x20successfully!','RMtrs','jGIIW','NlETq','dEAZC','cqjnN','siBtY','tutSE','gBOhZ','criticalReason','Other','XhTzV','CnusE','Train\x20','setProducts','lowestPde','PUfqW','solubility','Ueope','hpIFr','detection','Trains\x20','Product_MACO_Report','Train\x20Summary\x20data\x20exported\x20to\x20Excel\x20successfully!','FzBnv','severity','pdeScore','rntRY','zpwct','Failed\x20to\x20export\x20machines\x20data\x20to\x20Excel.','none','yjbtK','productRegister-ld50Hidden','XHdNK','EZixk','Error\x20creating\x20Detergent\x20MACO\x20sheet:','wHSCu','etbcz','dark','Yes','#productRegister\x20.mainTable.hide-','productType','macoChartInstance','ePLIK','LWbMX','No\x20trains\x20message\x20display:','dOesA','pkvhU','Data\x20imported\x20successfully.','ZJtxK','QrTkd','udiTC','No\x20reason\x20provided','CaIcC','sortValue','poxot','kpPlo','pYzAG','llfLz','target','mPJEm','There\x20are\x20no\x20detergent\x20ingredients\x20configured.\x20Add\x20detergent\x20ingredients\x20first.','5258016tTtaXJ','QgoTE','ttAbQ','renderMacoForTrains','exJLX','WkrQv','productRegister','Health-Based\x20Limit\x20(PDE)','innerHTML','OLFgS','Train\x20summary\x20container\x20is\x20hidden\x20or\x20missing','detergentMaco',')\x20-\x20RPN:\x20','UByNa','Error\x20exporting\x20all\x20tabs\x20to\x20Excel:','TIdOC','PRODUCT','Error\x20exporting\x20machines\x20to\x20Excel:','ibbzo','oFcCs','vVVmH','zgtTZ','QlzHN','Train\x20Summary\x20Report','machineNumber','split','worstProductRpn','solubilityScore','zSZcw','Error\x20exporting\x20Summary\x20to\x20Excel:','setScoringWasInEditModeForPrint','assumedSsa','lowestLd50','LEhYR','yxcBT','10\x20ppm\x20Criterion','INGREDIENT','VQGDw','HyXXw','stringify','fQAsI','trainSummaryContainer','Error\x20loading\x20scoring\x20criteria','style','./macoDetergentView.js','add','ltdMg','FhkYo','HyEVt','36bbnpey','\x20.ingredients-sub-table','Critical\x20Products','macoProducts','sBTIL','sort','ejlFr','CTSJm','There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','toggle-dm-','zioxW','\x20-\x20','BhZqK','log','ZfnGn','pde','jwiKR','dRSxr','beYAB','noTrainSummaryMessage','name','IGLRg','oSOWK','.toggle-ld50','.xlsx','pIBZG','macoForTrains','therapeuticDoseScore','Health-Based\x20Limit\x20(NOEL)','XaCZw','AooWt','lMfoo','join','detergentIngredients','flatMap','Container\x20display:','EVsfY','true','EkBWF','Dlpmr','YJBnH','ceiQz','Error\x20creating\x20Top\x2010\x20RPN\x20sheet:','hjlga','JFRKl','UYKOS','getLargestEssaForLineAndDosageForm','IhSlk','PFiUq','LOdln','sTMLM','ERuMc','ldYLY','cwqYH','keys','CFqNg','Detergent\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','length','scoring-system','isArray','dzkUS','occurrence','LvQPQ','dFIBj','VjRiY','vQiYF','toggle','trainId','KwiAk','number','MACO_Machines_','EPHBD','DpxFC','PJlKw','value','Failed\x20to\x20export\x20data\x20to\x20Excel.','GRjel','Unknown\x20(ID:\x20','IKIjF','querySelectorAll','MNWAO','Ioxvk','ABxNi','TbtTM','therapeuticDose','fRtTu','FTYzB','Success','tEDcm','Ljnfw','area','EeofH','parse','printSelectedTrain','productCode','renderWorstCaseByTrain','BvExs','rNRTy','No\x20Data','KlIsc','\x20-\x20Worst\x20Case\x20Analysis','sPKrE','sDgMc','16386696XBdHGN','hide-ld50','Ieljc','fcmVM','toISOString','azpkc','bofXo','finally','mdd','flex','undo-btn','Setting\x20printSelectedTrain\x20to:','wocUl','printing-','Complete_MACO_Report_','StfPB','minMbsKg','XOBWD','vghtU','NcBmb','slice','CiyXT','VHPKC','_Trains_','ld50Score','USUza','SznGo','trim','Error','lowestLtd','aUGdU','documentElement','FkeWk','minBsMddRatio','qoZwp','cKuRH','lZrAX','querySelector','fKvni','setItem','mhxZs','stage-','toExponential','POEzp','VTNKY','plUDj','vKKaV','seCcz','fgdED','#detergentMaco\x20.train-content.collapsed','Product\x20MACO','revokeObjectURL','remove','oIySn','elkVZ','MACO_All_Products_Report.xlsx','VxPqm','max','isCritical','KScTQ','rpn','pTGBT','maco-breakdown-details-','rpnChartInstance',',\x20#','book_new','UnQEF','BHTSU','iopys','iHhTo','Container\x20has\x20content:','trainSummary','onload','N/A','3500676mQRozJ','stage','classList','setMachines','OJggX','znHHL','arQHR','\x20.mainTable,\x20#','uyXXu','theme-toggle-dark-icon','Worst\x20Case\x20Products','gnTgO','iWTUB','display','Dufru','IvnMd','Show\x20PDE','all','jFMzL','jKmQW','cFQei','gHUbT','setMachineStageDisplayOrder','3134061LdBbJM','XoYxs','clDtU','rGXsz','Error\x20creating\x20Product\x20MACO\x20sheet:','Error\x20loading\x20train\x20summary:\x20','customAlertModal','startsWith','worstCaseProducts','content-pm-','hLbOw','UWlRh','lOYVv','bgtdz','SIOeS','YjaOB','cleanability','dAuad','pdeMg','sebbc','AvpjZ','machineStageDisplayOrder','./utils.js','setScoringCriteria','jOGDj','-pdeHidden','ovPDl','Show\x20LD50','dLhIy','message','iPATT','VqsDD','tlNFV','./worstCaseView.js','renderRpnChart','XDCAK','All\x20Products','There\x20is\x20no\x20data\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','map','igqAm','toggle-','cleanabilityScore','oBqIU','siTru','XxCLf','oaWoP','DBpvP','dsGNw','columnVisibilityDropdown','MsLeM','mSNNv','click','Visual\x20Clean\x20Limit','vlMCc','Train_Summary_Report','#macoForTrains\x20.train-content.collapsed','min','FFMOW','OQoJU','MACO\x20Report','Train\x20Summary','3Qvxdcw','batchSizeKg','ygYXM','ojaao','NEkty','Error\x20loading\x20machines','breakdown-toggle-btn-','LKHos','.toggle-pde','xltcv','productName','tNtWY','Detergent\x20MACO\x20Report','oaNmj','./trainSummaryView.js','safetyFactorConfig','find','collapsed','mddMg','EjHnN','SKNhh','input','BPYzV','contains','toFixed','YMnQM','WZiAu','0.1%\x20Therapeutic\x20Dose','Complete\x20report\x20with\x20all\x20tabs\x20exported\x20to\x20Excel\x20successfully!','LDMcV','vzGGA','toLocaleString','date','4905350CIvRAV','hide-pde','Error\x20creating\x20Product\x20Register\x20sheet:','YQDev','647150xCxyjY','Error\x20loading\x20machine\x20stage\x20order','required','HDRSv','JnrZP','ArthB','IFvXn','RasxL','Hide','setHistory','getElementById','iCCff','customAlertTitle','Failed\x20to\x20export\x20data\x20to\x20JSON.','#macoForTrains\x20[id^=\x22maco-breakdown-details-\x22].hidden','nrphZ','YIYWz','QJGZV','eXXIA','download','bodyWeight','json_to_sheet','XMroM','utils','not\x20found','upDpL','genXJ','AJcXZ','Failed\x20to\x20export\x20Product\x20MACO\x20data\x20to\x20Excel.','Invalid\x20JSON\x20file\x20structure.','PAtZP','IKwVz','scoringInEditMode','getItem','QTzmR','Detergent\x20MACO','PoZOS','pWRPu','YNVHi','match','IUoev','ibIAs','OSJDn','thPAm','rHjtC','noDbR','SlMOh','Summary\x20report\x20data\x20exported\x20to\x20Excel\x20successfully!','renderTrainSummary','yESHW','UcyLt','Failed\x20to\x20parse\x20JSON\x20file.','xEDYu','JytsI','XyZGY','qnIhO','writeFile','textContent','Error\x20exporting\x20Product\x20MACO\x20to\x20Excel:','DDKzQ','ingredientName','wEnpN','toLocaleDateString','Product\x20Register','removeChild','OeWzr','NbMmu','MAoMA','ESTVR','button','lrdTk','BCnHJ','SEXDL','hide-','block','machineIds','\x20not\x20found\x20or\x20has\x20no\x20products.','HvMIi','\x20.mainTable.hide-','VNzuL','Machines','VaaiX','Show\x20MACO\x20Calculation\x20Breakdown','print','sf-input-train','macoDetergentIngredients','wjiEv','tUFTd','uALfx','RtxwV','book_append_sheet','apyVC','machines','Show','history','ErTkS','XnLFi','Failed\x20to\x20export\x20Train\x20Summary\x20data\x20to\x20Excel.','dNdDs','error','then','AqRRS','scoringCriteria','UvcJf','MACO_Summary_Report_','filter','Hidden','AHkTL','ECaIz','DwaGq','products','Save\x20Error','wpZEI','Hide\x20MACO\x20Calculation\x20Breakdown','parentElement','ZpJrb','mErrY','viewProducts','productRegister-','FAoCn','Error\x20creating\x20Critical\x20Products\x20sheet:','trKPp','body','Error\x20loading\x20detergent\x20ingredients','pVOKD','productRegister-pdeHidden','pspYL','pPaxY','nJYOe','dXDET','There\x20are\x20no\x20summary\x20data\x20to\x20export.\x20Add\x20products\x20and\x20ingredients\x20first.','anhnu','hYfey','Failed\x20to\x20export\x20Detergent\x20MACO\x20data\x20to\x20Excel.','createElement','macoScoringCriteria','activeIngredients','Error\x20exporting\x20Train\x20Summary\x20to\x20Excel:','688262EJylgS','IqGeX','closest','zDlCr','rBlog','YLxGg','setDetergentIngredients','RUHjE','!cols','hidden','AFCSl','AiAGL','uoQjx','yHZwb','machineStage-','IthDU','Top\x2010\x20RPN','content-','None','uelgY','essa','createObjectURL','gQITF','There\x20is\x20no\x20data\x20in\x20the\x20current\x20view\x20to\x20export.','NhqUJ','CdFXl','IwXBQ','EjgHm','xwSDJ','\x20.train-content-inner','catch','SgymR','LwbZS','dJZRC','There\x20are\x20no\x20products\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','EwTGZ','LTOin','AmFqQ','historyIndex','UKchw'];a13_0x149b=function(){return _0x46f9b7;};return a13_0x149b();}import{generateTrainMap as a13_0x34877a}from'./utils.js';import{toggleScoringEditMode as a13_0x37caa4}from'./scoringView.js';import{renderRpnChart as a13_0x310f79}from'./worstCaseView.js';import{renderMacoChart as a13_0x1b0845}from'./dashboardView.js';const s=document['getElementById']('loader');export const showLoader=()=>s[a13_0x5d3211(0x249)]['display']='flex';export const hideLoader=()=>s[a13_0x5d3211(0x249)][a13_0x5d3211(0xa3)]='none';export function showCustomAlert(_0x591533,_0x1cd438){const _0x49b289=a13_0x5d3211,_0x2f9033={'yjbtK':_0x49b289(0x11b),'erjKb':'customAlertMessage'};document[_0x49b289(0x119)](_0x2f9033[_0x49b289(0x1ff)])['textContent']=_0x591533,document[_0x49b289(0x119)](_0x2f9033['erjKb'])[_0x49b289(0x148)]=_0x1cd438,document[_0x49b289(0x119)](_0x49b289(0xb3))['style']['display']=_0x49b289(0x2bf);}export const hideModal=_0x38ba22=>document[a13_0x5d3211(0x119)](_0x38ba22)['style'][a13_0x5d3211(0xa3)]='none';export const showModal=_0x25c7eb=>document[a13_0x5d3211(0x119)](_0x25c7eb)['style'][a13_0x5d3211(0xa3)]=a13_0x5d3211(0x2bf);export function saveAllDataToLocalStorage(){const _0x4c47a7=a13_0x5d3211,_0x2fbb66={'upDpL':_0x4c47a7(0x252),'dJZRC':_0x4c47a7(0x1dd),'dtNLl':_0x4c47a7(0x196),'RDfTv':_0x4c47a7(0x164),'SgymR':_0x4c47a7(0xc2),'PCGsR':'Failed\x20to\x20save\x20data\x20to\x20localStorage','ibIAs':function(_0x3dbb4f,_0x10a62b,_0x44fa3b){return _0x3dbb4f(_0x10a62b,_0x44fa3b);},'bonas':_0x4c47a7(0x17e),'EPHBD':'Could\x20not\x20save\x20data.\x20Storage\x20might\x20be\x20full.'};try{localStorage[_0x4c47a7(0x73)](_0x2fbb66[_0x4c47a7(0x128)],JSON[_0x4c47a7(0x245)](a13_0x529504['products'])),localStorage[_0x4c47a7(0x73)](_0x2fbb66[_0x4c47a7(0x1ba)],JSON['stringify'](a13_0x529504[_0x4c47a7(0x16b)])),localStorage[_0x4c47a7(0x73)](_0x2fbb66['dtNLl'],JSON[_0x4c47a7(0x245)](a13_0x529504[_0x4c47a7(0x175)])),localStorage[_0x4c47a7(0x73)](_0x2fbb66['RDfTv'],JSON[_0x4c47a7(0x245)](a13_0x529504[_0x4c47a7(0x270)])),localStorage['setItem'](_0x2fbb66[_0x4c47a7(0x1b8)],JSON[_0x4c47a7(0x245)](a13_0x529504[_0x4c47a7(0xc2)]));}catch(_0x236c4f){console['error'](_0x2fbb66['PCGsR'],_0x236c4f),_0x2fbb66[_0x4c47a7(0x138)](showCustomAlert,_0x2fbb66['bonas'],_0x2fbb66[_0x4c47a7(0x296)]);}}function a13_0x144a(_0x361ac7,_0x8d1fa3){const _0x149b2f=a13_0x149b();return a13_0x144a=function(_0x144adf,_0x5c1730){_0x144adf=_0x144adf-0x67;let _0x2d6ac7=_0x149b2f[_0x144adf];return _0x2d6ac7;},a13_0x144a(_0x361ac7,_0x8d1fa3);}export function loadAllDataFromLocalStorage(){const _0x40dae9=a13_0x5d3211,_0x2aa8d8={'LVltY':_0x40dae9(0x252),'mErrY':_0x40dae9(0x1dd),'HyEVt':_0x40dae9(0x196),'KrHbf':_0x40dae9(0x164),'AHLzr':_0x40dae9(0x1c8),'dFIBj':_0x40dae9(0xef),'zgtTZ':_0x40dae9(0x18a),'iCCff':_0x40dae9(0x110)},_0x54f15c=localStorage[_0x40dae9(0x130)](_0x2aa8d8['LVltY']),_0x1295cb=localStorage['getItem'](_0x2aa8d8[_0x40dae9(0x183)]),_0x464a5a=localStorage['getItem'](_0x2aa8d8[_0x40dae9(0x24e)]),_0xb6fa74=localStorage[_0x40dae9(0x130)](_0x2aa8d8['KrHbf']),_0xbac019=localStorage['getItem'](_0x40dae9(0xc2));if(_0x54f15c)try{a13_0x529504[_0x40dae9(0x1ee)](JSON[_0x40dae9(0x2ab)](_0x54f15c));}catch(_0x459c47){console['error'](_0x2aa8d8['AHLzr'],_0x459c47);}if(_0x1295cb)try{a13_0x529504[_0x40dae9(0x99)](JSON['parse'](_0x1295cb));}catch(_0xac389c){console[_0x40dae9(0x172)](_0x2aa8d8[_0x40dae9(0x28e)],_0xac389c);}if(_0x464a5a)try{a13_0x529504[_0x40dae9(0xc4)](JSON[_0x40dae9(0x2ab)](_0x464a5a));}catch(_0x361e44){console[_0x40dae9(0x172)](_0x40dae9(0x248),_0x361e44);}if(_0xb6fa74)try{a13_0x529504['setDetergentIngredients'](JSON[_0x40dae9(0x2ab)](_0xb6fa74));}catch(_0x5d8f3a){console[_0x40dae9(0x172)](_0x2aa8d8[_0x40dae9(0x233)],_0x5d8f3a);}if(_0xbac019)try{a13_0x529504[_0x40dae9(0xac)](JSON[_0x40dae9(0x2ab)](_0xbac019));}catch(_0x276d59){console[_0x40dae9(0x172)](_0x2aa8d8[_0x40dae9(0x11a)],_0x276d59);}}export function saveStateForUndo(){const _0x5d5dfc=a13_0x5d3211,_0x3f7244={'ttAbQ':function(_0x2d1f83){return _0x2d1f83();},'FTYzB':function(_0x4ccdd0,_0x20af75){return _0x4ccdd0+_0x20af75;},'etbcz':function(_0x19e234,_0x162cf0){return _0x19e234-_0x162cf0;}};_0x3f7244[_0x5d5dfc(0x220)](a13_0x34877a);const _0xf62b41=a13_0x529504[_0x5d5dfc(0x16d)][_0x5d5dfc(0x2ca)](0x0,_0x3f7244[_0x5d5dfc(0x2a5)](a13_0x529504[_0x5d5dfc(0x1bf)],0x1)),_0x4147af={'products':JSON['parse'](JSON[_0x5d5dfc(0x245)](a13_0x529504[_0x5d5dfc(0x17d)])),'machines':JSON[_0x5d5dfc(0x2ab)](JSON[_0x5d5dfc(0x245)](a13_0x529504[_0x5d5dfc(0x16b)])),'scoringCriteria':JSON[_0x5d5dfc(0x2ab)](JSON[_0x5d5dfc(0x245)](a13_0x529504[_0x5d5dfc(0x175)])),'detergentIngredients':JSON[_0x5d5dfc(0x2ab)](JSON['stringify'](a13_0x529504[_0x5d5dfc(0x270)]))};_0xf62b41[_0x5d5dfc(0x1c7)](_0x4147af),a13_0x529504[_0x5d5dfc(0x118)](_0xf62b41,_0x3f7244[_0x5d5dfc(0x205)](_0xf62b41[_0x5d5dfc(0x288)],0x1)),_0x3f7244[_0x5d5dfc(0x220)](updateUndoRedoButtons),saveAllDataToLocalStorage();}export function updateUndoRedoButtons(){const _0x439748=a13_0x5d3211,_0x37c61a={'ABxNi':_0x439748(0x2c0),'vQiYF':'redo-btn','Ueope':function(_0x369997,_0x2cef9d){return _0x369997<=_0x2cef9d;},'qoZwp':function(_0x5bde77,_0x2146b9){return _0x5bde77>=_0x2146b9;}},_0x391226=document[_0x439748(0x119)](_0x37c61a[_0x439748(0x2a1)]),_0x5da476=document[_0x439748(0x119)](_0x37c61a[_0x439748(0x290)]);_0x391226&&(_0x391226[_0x439748(0x1d6)]=_0x37c61a[_0x439748(0x1f2)](a13_0x529504[_0x439748(0x1bf)],0x0)),_0x5da476&&(_0x5da476[_0x439748(0x1d6)]=_0x37c61a[_0x439748(0x6e)](a13_0x529504[_0x439748(0x1bf)],a13_0x529504[_0x439748(0x16d)][_0x439748(0x288)]-0x1));}export function undoChange(){const _0x4ceec8=a13_0x5d3211,_0x39ec31={'RfyOO':function(_0x4e00c9,_0x27306c){return _0x4e00c9(_0x27306c);},'JQwYL':function(_0x1bedc7){return _0x1bedc7();}};if(a13_0x529504['historyIndex']>0x0){const _0x584e4c=a13_0x529504[_0x4ceec8(0x1bf)]-0x1,_0x517c79=a13_0x529504['history'][_0x584e4c];a13_0x529504[_0x4ceec8(0x1ee)](JSON['parse'](JSON['stringify'](_0x517c79['products']))),a13_0x529504['setMachines'](JSON[_0x4ceec8(0x2ab)](JSON[_0x4ceec8(0x245)](_0x517c79[_0x4ceec8(0x16b)]))),a13_0x529504[_0x4ceec8(0xc4)](JSON[_0x4ceec8(0x2ab)](JSON['stringify'](_0x517c79[_0x4ceec8(0x175)]))),a13_0x529504[_0x4ceec8(0x19f)](JSON[_0x4ceec8(0x2ab)](JSON['stringify'](_0x517c79['detergentIngredients']))),a13_0x529504[_0x4ceec8(0x118)](a13_0x529504['history'],_0x584e4c),a13_0x529504[_0x4ceec8(0x12f)]&&_0x39ec31['RfyOO'](a13_0x37caa4,!0x1),a13_0x50a144(),updateUndoRedoButtons(),_0x39ec31['JQwYL'](saveAllDataToLocalStorage);}}export function redoChange(){const _0x4a8e8c=a13_0x5d3211,_0x58ba95={'XoYxs':function(_0x5e0d91,_0xd2ca91){return _0x5e0d91<_0xd2ca91;},'AvpjZ':function(_0x423c2f,_0x1ddb5){return _0x423c2f-_0x1ddb5;},'RtxwV':function(_0x48f5db){return _0x48f5db();}};if(_0x58ba95[_0x4a8e8c(0xae)](a13_0x529504[_0x4a8e8c(0x1bf)],_0x58ba95[_0x4a8e8c(0xc1)](a13_0x529504[_0x4a8e8c(0x16d)][_0x4a8e8c(0x288)],0x1))){const _0x49c7d6=a13_0x529504[_0x4a8e8c(0x1bf)]+0x1,_0x4c2a96=a13_0x529504['history'][_0x49c7d6];a13_0x529504[_0x4a8e8c(0x1ee)](JSON['parse'](JSON[_0x4a8e8c(0x245)](_0x4c2a96['products']))),a13_0x529504['setMachines'](JSON[_0x4a8e8c(0x2ab)](JSON['stringify'](_0x4c2a96[_0x4a8e8c(0x16b)]))),a13_0x529504['setScoringCriteria'](JSON['parse'](JSON[_0x4a8e8c(0x245)](_0x4c2a96[_0x4a8e8c(0x175)]))),a13_0x529504['setDetergentIngredients'](JSON[_0x4a8e8c(0x2ab)](JSON[_0x4a8e8c(0x245)](_0x4c2a96[_0x4a8e8c(0x270)]))),a13_0x529504[_0x4a8e8c(0x118)](a13_0x529504[_0x4a8e8c(0x16d)],_0x49c7d6),a13_0x529504[_0x4a8e8c(0x12f)]&&a13_0x37caa4(!0x1),_0x58ba95[_0x4a8e8c(0x168)](a13_0x50a144),_0x58ba95['RtxwV'](updateUndoRedoButtons),saveAllDataToLocalStorage();}}export function toggleDarkMode(_0x7a1269){const _0x489357=a13_0x5d3211,_0x3f197d={'xeeoG':_0x489357(0x1d3),'CTOwo':_0x489357(0x9f),'XnLFi':_0x489357(0x206),'IFvXn':_0x489357(0x1a2),'rrGRZ':function(_0x4aed8e){return _0x4aed8e();}},_0x517167=document[_0x489357(0x119)](_0x3f197d['xeeoG']),_0x4cc4a9=document[_0x489357(0x119)](_0x3f197d['CTOwo']);_0x7a1269?(document[_0x489357(0x6b)][_0x489357(0x98)][_0x489357(0x24b)](_0x3f197d[_0x489357(0x16f)]),_0x517167&&_0x517167[_0x489357(0x98)][_0x489357(0x24b)]('hidden'),_0x4cc4a9&&_0x4cc4a9['classList'][_0x489357(0x80)](_0x489357(0x1a2))):(document['documentElement']['classList'][_0x489357(0x80)](_0x3f197d[_0x489357(0x16f)]),_0x517167&&_0x517167[_0x489357(0x98)]['remove'](_0x3f197d[_0x489357(0x115)]),_0x4cc4a9&&_0x4cc4a9['classList'][_0x489357(0x24b)](_0x3f197d[_0x489357(0x115)])),a13_0x529504[_0x489357(0x8b)]&&_0x3f197d['rrGRZ'](a13_0x310f79),a13_0x529504[_0x489357(0x20a)]&&a13_0x1b0845();}export function printCurrentView(_0x5660d6,_0x87157='all'){const _0x14276a=a13_0x5d3211,_0x1abd02={'SEXDL':function(_0x287ba6,_0x226ed7,_0x4ef856){return _0x287ba6(_0x226ed7,_0x4ef856);},'UvcJf':_0x14276a(0xfb),'BHTSU':'hidden','RYxjI':_0x14276a(0x161),'ZpJrb':_0x14276a(0xe4),'sBTIL':_0x14276a(0x11d),'OinTg':function(_0x25b5a8,_0x1b2cca,_0x42a88c){return _0x25b5a8(_0x1b2cca,_0x42a88c);},'exJLX':_0x14276a(0x7d),'elkVZ':'Error\x20loading\x20detergent\x20view\x20for\x20print:','sTMLM':_0x14276a(0x24a),'VjRiY':_0x14276a(0x262),'EKviq':_0x14276a(0x92),'dsGNw':function(_0x2696a0,_0x4a916f){return _0x2696a0===_0x4a916f;},'UWlRh':_0x14276a(0x228),'StfPB':function(_0x188539,_0x136359,_0x5789d3){return _0x188539(_0x136359,_0x5789d3);},'lAMFU':function(_0x2753d5,_0x5d8fec){return _0x2753d5(_0x5d8fec);},'VTNKY':function(_0x15dbec,_0x4bbff1){return _0x15dbec+_0x4bbff1;},'YLxGg':_0x14276a(0xb2),'ArthB':_0x14276a(0x289),'wpZEI':function(_0x112530,_0x194eff){return _0x112530(_0x194eff);},'CqSSS':'Printing\x20view:','MNWAO':function(_0xa33038,_0x4f3624){return _0xa33038===_0x4f3624;},'nHuTd':_0x14276a(0x269),'ECaIz':_0x14276a(0x1d1),'VaaiX':_0x14276a(0x229),'HDRSv':function(_0x430340,_0x124ba6){return _0x430340===_0x124ba6;},'TIdOC':_0x14276a(0x93),'VqsDD':_0x14276a(0x2c1),'WqFQQ':_0x14276a(0xf8)};_0x1abd02[_0x14276a(0xdc)](_0x1abd02[_0x14276a(0x114)],_0x5660d6)&&a13_0x529504[_0x14276a(0x12f)]&&(a13_0x529504[_0x14276a(0x23c)](!0x0),_0x1abd02[_0x14276a(0x17f)](a13_0x37caa4,!0x1)),console['log'](_0x1abd02['CqSSS'],_0x5660d6,'Train:',_0x87157),document['body'][_0x14276a(0x98)][_0x14276a(0x24b)](_0x14276a(0x2c3)+_0x5660d6),_0x1abd02['MNWAO'](_0x14276a(0xb5),_0x5660d6)?import(_0x14276a(0xce))[_0x14276a(0x173)](_0x3b5246=>{const _0x5e1839=_0x14276a;window['printSelectedTrain']=_0x87157,_0x3b5246[_0x5e1839(0x2ae)](),_0x1abd02[_0x5e1839(0x157)](setTimeout,()=>{window['print']();},0xc8);}):_0x1abd02[_0x14276a(0xdc)](_0x1abd02['nHuTd'],_0x5660d6)?(window[_0x14276a(0x2ac)]=_0x87157,import(_0x1abd02[_0x14276a(0x17b)])['then'](_0x59a9a6=>{const _0x5b0a48=_0x14276a,_0x32aab6={'igqAm':_0x1abd02[_0x5b0a48(0x176)],'dLhIy':_0x1abd02[_0x5b0a48(0x8f)],'TbtTM':_0x1abd02['RYxjI'],'DBpvP':function(_0x403822,_0x5d4838,_0x1b923a){return _0x403822(_0x5d4838,_0x1b923a);}};_0x59a9a6[_0x5b0a48(0x221)]();const _0x25f197=document['querySelectorAll'](_0x1abd02[_0x5b0a48(0x182)]),_0x54efaa=[];_0x25f197[_0x5b0a48(0x1c1)](_0x56b5fe=>{const _0x49a114=_0x5b0a48,_0x264262=_0x56b5fe['id'][_0x49a114(0x136)](/content-pm-(\d+)/);if(_0x264262){_0x54efaa[_0x49a114(0x1c7)](_0x264262[0x1]),_0x56b5fe[_0x49a114(0x98)][_0x49a114(0x80)](_0x32aab6[_0x49a114(0xd4)]);const _0x4baa3f=document['getElementById'](_0x49a114(0x1c4)+_0x264262[0x1]);_0x4baa3f&&(_0x4baa3f[_0x49a114(0x148)]='▼');}});const _0x41b3e0=document[_0x5b0a48(0x29e)](_0x1abd02[_0x5b0a48(0x253)]),_0x4be10a=[];_0x41b3e0['forEach'](_0x45877e=>{const _0x50f8a3=_0x5b0a48,_0x10ba72=_0x45877e['id'][_0x50f8a3(0x136)](/maco-breakdown-details-(\d+)/);if(_0x10ba72){_0x4be10a[_0x50f8a3(0x1c7)](_0x10ba72[0x1]),_0x45877e[_0x50f8a3(0x98)][_0x50f8a3(0x80)](_0x32aab6[_0x50f8a3(0xc9)]);const _0x3fe434=document['getElementById'](_0x50f8a3(0xf0)+_0x10ba72[0x1]);_0x3fe434&&(_0x3fe434['textContent']=_0x50f8a3(0x180));}}),_0x1abd02['OinTg'](setTimeout,()=>{const _0x341a68=_0x5b0a48;window['print'](),_0x32aab6[_0x341a68(0xdb)](setTimeout,()=>{const _0x4afd47=_0x341a68,_0x1b2b61={'wjiEv':_0x32aab6[_0x4afd47(0xc9)],'AooWt':_0x32aab6[_0x4afd47(0x2a2)]};_0x54efaa['forEach'](_0x107b42=>{const _0x2295c2=_0x4afd47,_0x5c820a=document[_0x2295c2(0x119)](_0x2295c2(0xb6)+_0x107b42),_0x50cee4=document['getElementById']('toggle-pm-'+_0x107b42);_0x5c820a&&_0x5c820a['classList']['add'](_0x2295c2(0xfb)),_0x50cee4&&(_0x50cee4[_0x2295c2(0x148)]='▶');}),_0x4be10a[_0x4afd47(0x1c1)](_0xf5f472=>{const _0x46e74f=_0x4afd47,_0x5bf2da=document[_0x46e74f(0x119)](_0x46e74f(0x8a)+_0xf5f472),_0x140857=document[_0x46e74f(0x119)](_0x46e74f(0xf0)+_0xf5f472);_0x5bf2da&&_0x5bf2da[_0x46e74f(0x98)][_0x46e74f(0x24b)](_0x1b2b61[_0x46e74f(0x165)]),_0x140857&&(_0x140857[_0x46e74f(0x148)]=_0x1b2b61[_0x46e74f(0x26d)]);});},0x3e8);},0xc8);})):_0x1abd02[_0x14276a(0x29f)](_0x1abd02[_0x14276a(0x160)],_0x5660d6)?(window[_0x14276a(0x2ac)]=_0x87157,import(_0x14276a(0x24a))[_0x14276a(0x173)](_0x31face=>{const _0x18af16=_0x14276a,_0x4abb7f={'HyXXw':function(_0x5d3d18,_0xd19b18,_0x380040){return _0x1abd02['OinTg'](_0x5d3d18,_0xd19b18,_0x380040);}};_0x31face['renderDetergentMaco']();const _0x50f2e5=document['querySelectorAll'](_0x1abd02[_0x18af16(0x222)]),_0x4f9070=[];_0x50f2e5['forEach'](_0xe0b7ec=>{const _0x2a98df=_0x18af16,_0x4d262f=_0xe0b7ec['id'][_0x2a98df(0x136)](/content-dm-(\d+)/);if(_0x4d262f){_0x4f9070[_0x2a98df(0x1c7)](_0x4d262f[0x1]),_0xe0b7ec[_0x2a98df(0x98)][_0x2a98df(0x80)](_0x1abd02[_0x2a98df(0x176)]);const _0x46ab56=document['getElementById'](_0x2a98df(0x258)+_0x4d262f[0x1]);_0x46ab56&&(_0x46ab56[_0x2a98df(0x148)]='▼');}}),_0x1abd02[_0x18af16(0x157)](setTimeout,()=>{const _0x4bfe9b=_0x18af16;window['print'](),_0x4abb7f[_0x4bfe9b(0x244)](setTimeout,()=>{const _0x189ba2=_0x4bfe9b;_0x4f9070[_0x189ba2(0x1c1)](_0x1dc2f3=>{const _0x4da1f6=_0x189ba2,_0x29b06e=document['getElementById']('content-dm-'+_0x1dc2f3),_0x3ead69=document[_0x4da1f6(0x119)](_0x4da1f6(0x258)+_0x1dc2f3);_0x29b06e&&_0x29b06e[_0x4da1f6(0x98)]['add'](_0x4da1f6(0xfb)),_0x3ead69&&(_0x3ead69['textContent']='▶');});},0x3e8);},0xc8);})[_0x14276a(0x1b7)](_0x157159=>{const _0x36704b=_0x14276a;console[_0x36704b(0x172)](_0x1abd02[_0x36704b(0x82)],_0x157159),window[_0x36704b(0x162)]();})[_0x14276a(0x2bd)](()=>{const _0x2d4737=_0x14276a,_0x24e107={'LREQt':_0x1abd02[_0x2d4737(0x281)]};_0x1abd02[_0x2d4737(0x157)](setTimeout,()=>{const _0x1a8590=_0x2d4737;window[_0x1a8590(0x2ac)]=null,import(_0x24e107['LREQt'])['then'](_0x21723a=>_0x21723a['renderDetergentMaco']())['catch'](()=>{});},0x4b0);})):_0x1abd02[_0x14276a(0x112)](_0x1abd02[_0x14276a(0x22d)],_0x5660d6)?(window[_0x14276a(0x2ac)]=_0x87157,console['log'](_0x1abd02[_0x14276a(0xcc)],_0x87157),import(_0x1abd02['WqFQQ'])[_0x14276a(0x173)](_0x236f27=>{const _0x246d3a=_0x14276a,_0x1ebcb2={'gQITF':_0x1abd02[_0x246d3a(0x28f)],'uelgY':_0x246d3a(0x127),'LvQPQ':_0x246d3a(0x20d),'CnusE':_0x1abd02['EKviq'],'RNeCz':function(_0x57ac51,_0x8743c7){const _0x30df9e=_0x246d3a;return _0x1abd02[_0x30df9e(0xdc)](_0x57ac51,_0x8743c7);},'dNdDs':_0x246d3a(0x1fe),'EZixk':_0x1abd02[_0x246d3a(0xb8)],'ZxYhD':function(_0x455a39,_0x271327){return _0x455a39(_0x271327);},'ygYXM':'No\x20train\x20data\x20to\x20print.\x20Please\x20ensure\x20you\x20have\x20created\x20trains\x20first.','WZiAu':function(_0x14a49a,_0x5e0474,_0xece5ce){return _0x1abd02['StfPB'](_0x14a49a,_0x5e0474,_0xece5ce);}};_0x236f27[_0x246d3a(0x13f)](),_0x1abd02[_0x246d3a(0x157)](setTimeout,()=>{const _0x10cb6c=_0x246d3a,_0x4538a4=document['getElementById'](_0x10cb6c(0x247)),_0x369e9f=document['getElementById'](_0x1ebcb2[_0x10cb6c(0x1af)]);if(console[_0x10cb6c(0x25c)](_0x10cb6c(0x272),_0x4538a4?_0x4538a4['style'][_0x10cb6c(0xa3)]:_0x1ebcb2[_0x10cb6c(0x1ac)]),console['log'](_0x1ebcb2[_0x10cb6c(0x28d)],_0x369e9f?_0x369e9f[_0x10cb6c(0x249)][_0x10cb6c(0xa3)]:_0x1ebcb2[_0x10cb6c(0x1ac)]),console[_0x10cb6c(0x25c)](_0x1ebcb2[_0x10cb6c(0x1ec)],!!_0x4538a4&&_0x4538a4[_0x10cb6c(0x226)][_0x10cb6c(0x288)]>0x0),!_0x4538a4||_0x1ebcb2['RNeCz'](_0x1ebcb2[_0x10cb6c(0x171)],_0x4538a4[_0x10cb6c(0x249)][_0x10cb6c(0xa3)]))return console['warn'](_0x1ebcb2[_0x10cb6c(0x202)]),void _0x1ebcb2['ZxYhD'](alert,_0x1ebcb2[_0x10cb6c(0xec)]);window[_0x10cb6c(0x162)](),_0x1ebcb2[_0x10cb6c(0x104)](setTimeout,()=>{const _0x4e040f=_0x10cb6c;window[_0x4e040f(0x2ac)]=null,_0x236f27['renderTrainSummary']();},0x3e8);},0x1f4);})['catch'](_0x504d34=>{const _0x49fdcb=_0x14276a;console[_0x49fdcb(0x172)]('Error\x20loading\x20train\x20summary\x20view:',_0x504d34),_0x1abd02['lAMFU'](alert,_0x1abd02[_0x49fdcb(0x78)](_0x1abd02[_0x49fdcb(0x19e)],_0x504d34['message']));})):_0x1abd02[_0x14276a(0x2c5)](setTimeout,()=>{window['print']();},0x64);}export function toggleColumn(_0x41b0e6,_0x291eaf){const _0x12df4c=a13_0x5d3211,_0x5d8c04={'QrTkd':function(_0x4e78c5,_0x37bbcb){return _0x4e78c5===_0x37bbcb;},'GjCaJ':_0x12df4c(0x25e),'AiOPZ':_0x12df4c(0x224),'EhYJK':function(_0x9776a8,_0x3b1b14){return _0x9776a8(_0x3b1b14);},'cHfSu':_0x12df4c(0xb5),'llfLz':_0x12df4c(0xce),'AcWGK':function(_0x492935,_0x111812){return _0x492935!==_0x111812;}};if(_0x5d8c04[_0x12df4c(0x212)](_0x5d8c04[_0x12df4c(0x1d9)],_0x41b0e6)||_0x5d8c04[_0x12df4c(0x212)](_0x12df4c(0x1db),_0x41b0e6)){[_0x5d8c04['AiOPZ'],'worstCaseProducts']['forEach'](_0x306479=>{const _0x16ee3c=_0x12df4c;document[_0x16ee3c(0x29e)]('#'+_0x306479+'\x20.mainTable,\x20#'+_0x306479+_0x16ee3c(0x250))[_0x16ee3c(0x1c1)](_0x4ebbc9=>{const _0x128efd=_0x16ee3c;_0x4ebbc9[_0x128efd(0x98)]['toggle'](_0x128efd(0x158)+_0x41b0e6);}),document[_0x16ee3c(0x29e)]('#'+_0x306479+',\x20#'+_0x306479+_0x16ee3c(0x1b6))[_0x16ee3c(0x1c1)](_0x3be80a=>{const _0x57b27c=_0x16ee3c;_0x3be80a&&_0x3be80a[_0x57b27c(0x98)][_0x57b27c(0x291)](_0x57b27c(0x158)+_0x41b0e6);});});const _0x17a238=null!==document['querySelector'](_0x12df4c(0x208)+_0x41b0e6);localStorage['setItem'](_0x12df4c(0x185)+_0x41b0e6+_0x12df4c(0x179),_0x17a238),_0x5d8c04['EhYJK'](updateToggleIcons,_0x5d8c04['AiOPZ']),updateToggleIcons(_0x5d8c04['cHfSu']),import(_0x5d8c04[_0x12df4c(0x21a)])[_0x12df4c(0x173)](_0x1adc1a=>{const _0xfde014=_0x12df4c;_0x1adc1a[_0xfde014(0x2ae)]();}),import(_0x5d8c04[_0x12df4c(0x21a)])['then'](_0x132675=>{const _0x5043fd=_0x12df4c;_0x132675[_0x5043fd(0xcf)]&&_0x132675[_0x5043fd(0xcf)]();});}else{document['querySelectorAll']('#'+_0x291eaf+_0x12df4c(0x9d)+_0x291eaf+_0x12df4c(0x250))[_0x12df4c(0x1c1)](_0x5639d1=>{const _0x402377=_0x12df4c;_0x5639d1[_0x402377(0x98)]['toggle'](_0x402377(0x158)+_0x41b0e6);});const _0x46f130=_0x5d8c04[_0x12df4c(0x1d8)](null,document[_0x12df4c(0x71)]('#'+_0x291eaf+_0x12df4c(0x15d)+_0x41b0e6));localStorage[_0x12df4c(0x73)](_0x291eaf+'-'+_0x41b0e6+_0x12df4c(0x179),_0x46f130),updateToggleIcons(_0x291eaf);}}export function toggleColumnVisibilityDropdown(){const _0x55210d=a13_0x5d3211,_0x4b1128={'zSZcw':'#columnVisibilityDropdown','bFTpS':'button[onclick=\x22toggleColumnVisibilityDropdown()\x22]','arQHR':_0x55210d(0x1a2),'pIBZG':_0x55210d(0xe0),'PAtZP':_0x55210d(0xdd)},_0x1a8206=document[_0x55210d(0x119)](_0x4b1128[_0x55210d(0x12d)]);_0x1a8206[_0x55210d(0x98)][_0x55210d(0x291)](_0x55210d(0x1a2)),_0x1a8206[_0x55210d(0x98)][_0x55210d(0x101)](_0x55210d(0x1a2))||document['addEventListener'](_0x4b1128['pIBZG'],function _0x2b0a4c(_0x45dda4){const _0x456b62=_0x55210d;_0x45dda4['target']['closest'](_0x4b1128[_0x456b62(0x23a)])||_0x45dda4[_0x456b62(0x21b)][_0x456b62(0x19b)](_0x4b1128['bFTpS'])||(_0x1a8206[_0x456b62(0x98)][_0x456b62(0x24b)](_0x4b1128[_0x456b62(0x9c)]),document['removeEventListener'](_0x4b1128[_0x456b62(0x268)],_0x2b0a4c));});}export function updateToggleIcons(_0x1358ca){const _0x4550dd=a13_0x5d3211,_0x305c47={'CiyXT':_0x4550dd(0x10c),'hpIFr':_0x4550dd(0x2b7),'gHUbT':function(_0x1d0163,_0x103e15){return _0x1d0163===_0x103e15;},'OeWzr':_0x4550dd(0x18c),'QJGZV':_0x4550dd(0x200),'oIySn':function(_0x5a3377,_0x5b515e){return _0x5a3377===_0x5b515e;},'YNVHi':_0x4550dd(0x274),'ERuMc':function(_0x1f5072,_0x5c50e7){return _0x1f5072&&_0x5c50e7;},'ojaao':function(_0x1d84db,_0x25c5c5){return _0x1d84db===_0x25c5c5;},'sPKrE':function(_0x5ac768,_0x167206){return _0x5ac768===_0x167206;},'UnQEF':_0x4550dd(0x266),'siTru':_0x4550dd(0xa6),'UcyLt':_0x4550dd(0x1cf),'zZUyM':_0x4550dd(0xc8),'GBoeu':'Hide\x20LD50'},_0x19e2ab=document['getElementById'](_0x1358ca);if(!_0x19e2ab)return;let _0x2012dc,_0xef764b;if(_0x305c47['gHUbT'](_0x4550dd(0xb5),_0x1358ca)){const _0x34de52=localStorage['getItem'](_0x305c47[_0x4550dd(0x150)]),_0x2e4860=localStorage[_0x4550dd(0x130)](_0x305c47[_0x4550dd(0x120)]);if(_0x305c47[_0x4550dd(0xab)](null,_0x34de52)&&_0x305c47[_0x4550dd(0xab)](null,_0x2e4860))_0x2012dc=!0x1,_0xef764b=!0x1;else{const _0x2860da=_0x305c47[_0x4550dd(0x81)](_0x305c47[_0x4550dd(0x135)],_0x34de52),_0x270e02=_0x305c47['YNVHi']===_0x2e4860;_0x305c47[_0x4550dd(0x282)](_0x2860da,_0x270e02)?(_0x2012dc=!0x1,_0xef764b=!0x0):(_0x2012dc=_0x2860da,_0xef764b=_0x270e02);}}else{const _0x4f73f6=localStorage[_0x4550dd(0x130)](_0x1358ca+_0x4550dd(0xc6)),_0x529699=localStorage['getItem'](_0x1358ca+'-ld50Hidden');_0x2012dc=_0x305c47[_0x4550dd(0xed)](_0x305c47['YNVHi'],_0x4f73f6),_0xef764b=_0x305c47[_0x4550dd(0x2b4)](_0x305c47[_0x4550dd(0x135)],_0x529699);}const _0x1b0ab2=_0x19e2ab[_0x4550dd(0x71)](_0x4550dd(0xf2)),_0xf18ce=_0x19e2ab[_0x4550dd(0x71)](_0x305c47[_0x4550dd(0x8e)]);_0x1b0ab2&&(_0x1b0ab2['innerHTML']=_0x2012dc?_0x305c47[_0x4550dd(0xd8)]:_0x305c47[_0x4550dd(0x141)]),_0xf18ce&&(_0xf18ce[_0x4550dd(0x226)]=_0xef764b?_0x305c47['zZUyM']:_0x305c47['GBoeu']),document[_0x4550dd(0x29e)]('#'+_0x1358ca+_0x4550dd(0x9d)+_0x1358ca+_0x4550dd(0x250))[_0x4550dd(0x1c1)](_0xe42a17=>{const _0x2eaa0d=_0x4550dd;_0xe42a17&&(_0xe42a17[_0x2eaa0d(0x98)]['toggle'](_0x305c47[_0x2eaa0d(0x2cb)],_0x2012dc),_0xe42a17[_0x2eaa0d(0x98)][_0x2eaa0d(0x291)](_0x305c47[_0x2eaa0d(0x1f3)],_0xef764b));}),document[_0x4550dd(0x29e)]('#'+_0x1358ca+_0x4550dd(0x8c)+_0x1358ca+'\x20.train-content-inner')[_0x4550dd(0x1c1)](_0x27f31b=>{const _0x58026e=_0x4550dd;_0x27f31b&&(_0x27f31b[_0x58026e(0x98)]['toggle'](_0x305c47['CiyXT'],_0x2012dc),_0x27f31b['classList'][_0x58026e(0x291)](_0x58026e(0x2b7),_0xef764b));});}export function exportToExcel(){const _0x36c21d=a13_0x5d3211,_0x4eb6d1={'LKHos':function(_0x33ee70,_0x2e070e){return _0x33ee70+_0x2e070e;},'yxcBT':function(_0xcb8390,_0x5c7fda){return _0xcb8390(_0x5c7fda);},'iPATT':function(_0x2f4e8d){return _0x2f4e8d();},'NbMmu':function(_0x51f908,_0x7de299,_0x39cbbc){return _0x51f908(_0x7de299,_0x39cbbc);},'XaCZw':_0x36c21d(0x2b1),'LTOin':_0x36c21d(0x1b0),'pspYL':_0x36c21d(0xe8),'fRtTu':'!cols','gBOhZ':'Error\x20exporting\x20to\x20Excel:','dEAZC':function(_0x3dec6d){return _0x3dec6d();},'xEDYu':_0x36c21d(0x68),'UYKOS':_0x36c21d(0x29a),'gtDrg':function(_0x196971){return _0x196971();},'PUfqW':'./utils.js'};_0x4eb6d1['gtDrg'](showLoader),import(_0x4eb6d1[_0x36c21d(0x1f0)])['then'](_0x29e9fb=>{const _0x45e811=_0x36c21d,_0x1df60b={'cFQei':function(_0x311b36,_0x2e3c9d){const _0x1e1953=a13_0x144a;return _0x4eb6d1[_0x1e1953(0xf1)](_0x311b36,_0x2e3c9d);},'WqQOl':_0x45e811(0x207),'iloPK':function(_0x17df33,_0x22652e){const _0x1f5be4=_0x45e811;return _0x4eb6d1[_0x1f5be4(0x240)](_0x17df33,_0x22652e);}},{getProductTrainId:_0x3c7fd0,calculateScores:_0x1370b9}=_0x29e9fb,_0x137526=[];if(a13_0x529504[_0x45e811(0x17d)][_0x45e811(0x1c1)](_0x27aa8d=>{const _0x2b07d9=_0x45e811;let _0x3658cf='No';_0x27aa8d[_0x2b07d9(0x86)]&&(_0x3658cf=_0x1df60b[_0x2b07d9(0xaa)](_0x1df60b['WqQOl'],_0x27aa8d[_0x2b07d9(0x1e9)]?':\x20'+_0x27aa8d[_0x2b07d9(0x1e9)]:''));const _0x1f1653=_0x1df60b['iloPK'](_0x3c7fd0,_0x27aa8d),_0x5eab6c=_0x27aa8d[_0x2b07d9(0x10a)]?new Date(_0x27aa8d[_0x2b07d9(0x10a)])[_0x2b07d9(0x14d)]():'';_0x137526['push']({'Date':_0x5eab6c,'Product\x20Code':_0x27aa8d[_0x2b07d9(0x2ad)],'Product\x20Name':_0x27aa8d[_0x2b07d9(0x263)],'Train\x20No.':_0x1f1653,'Dosage\x20Form':_0x27aa8d[_0x2b07d9(0x209)]||'','Batch\x20Size\x20(Kg)':_0x27aa8d[_0x2b07d9(0xeb)],'Special\x20Case\x20Product':_0x3658cf,'Active\x20Ingredient':'','Solubility':'','Therapeutic\x20Dose\x20(mg/day)':'','Cleanability':'','PDE\x20(µg/day)':'','LD50\x20(mg/kg)':'','Solubility\x20Score':'','Therapeutic\x20Dose\x20Score':'','Cleanability\x20Score':'','Toxicity\x20Score':'','RPN':'','RPN\x20Rating':''}),_0x27aa8d['activeIngredients'][_0x2b07d9(0x1c1)](_0x4df9ad=>{const _0x27ef6a=_0x2b07d9,_0x496ced=_0x1370b9(_0x4df9ad);_0x137526[_0x27ef6a(0x1c7)]({'Date':'','Product\x20Code':'','Product\x20Name':'\x20\x20└─\x20'+_0x4df9ad[_0x27ef6a(0x263)],'Train\x20No.':'','Dosage\x20Form':'','Batch\x20Size\x20(Kg)':'','Special\x20Case\x20Product':'','Active\x20Ingredient':_0x4df9ad[_0x27ef6a(0x263)],'Solubility':_0x4df9ad[_0x27ef6a(0x1f1)]||'','Therapeutic\x20Dose\x20(mg/day)':_0x4df9ad[_0x27ef6a(0x2a3)]||'','Cleanability':_0x4df9ad[_0x27ef6a(0xbd)]||'','PDE\x20(µg/day)':_0x4df9ad[_0x27ef6a(0x25e)]||'','LD50\x20(mg/kg)':_0x4df9ad['ld50']||'','Solubility\x20Score':_0x496ced['solubilityScore']||'','Therapeutic\x20Dose\x20Score':_0x496ced[_0x27ef6a(0x26a)]||'','Cleanability\x20Score':_0x496ced[_0x27ef6a(0xd6)]||'','Toxicity\x20Score':_0x496ced[_0x27ef6a(0x1fa)]||_0x496ced[_0x27ef6a(0x2ce)]||'','RPN':_0x496ced[_0x27ef6a(0x88)],'RPN\x20Rating':_0x496ced[_0x27ef6a(0x1dc)]});});}),0x0===_0x137526[_0x45e811(0x288)])return _0x4eb6d1[_0x45e811(0xcb)](hideLoader),void _0x4eb6d1[_0x45e811(0x151)](showCustomAlert,_0x4eb6d1[_0x45e811(0x26c)],_0x4eb6d1[_0x45e811(0x1bd)]);const _0x5eddf7=XLSX[_0x45e811(0x126)][_0x45e811(0x124)](_0x137526),_0x5a05db=XLSX[_0x45e811(0x126)][_0x45e811(0x8d)]();XLSX[_0x45e811(0x126)][_0x45e811(0x169)](_0x5a05db,_0x5eddf7,_0x4eb6d1[_0x45e811(0x18d)]);const _0x3956dd=Object[_0x45e811(0x285)](_0x137526[0x0])[_0x45e811(0xd3)](_0x5573f1=>({'wch':Math[_0x45e811(0x85)](_0x5573f1[_0x45e811(0x288)],..._0x137526[_0x45e811(0xd3)](_0x2153e1=>String(_0x2153e1[_0x5573f1]||'')[_0x45e811(0x288)]))+0x2}));_0x5eddf7[_0x4eb6d1[_0x45e811(0x2a4)]]=_0x3956dd,XLSX['writeFile'](_0x5a05db,_0x45e811(0x83)),hideLoader();})[_0x36c21d(0x1b7)](_0x1335d6=>{const _0x137bc1=_0x36c21d;console[_0x137bc1(0x172)](_0x4eb6d1[_0x137bc1(0x1e8)],_0x1335d6),_0x4eb6d1[_0x137bc1(0x1e4)](hideLoader),showCustomAlert(_0x4eb6d1[_0x137bc1(0x143)],_0x4eb6d1[_0x137bc1(0x27c)]);});}export function exportAllToJson(){const _0x1a9469=a13_0x5d3211,_0x592c95={'EkBWF':function(_0x2f2bd1){return _0x2f2bd1();},'fopFb':'application/json','YQDev':_0x1a9469(0x1de),'QgoTE':'Error','siBtY':function(_0x1c5c43,_0x1e25d7){return _0x1c5c43+_0x1e25d7;},'pVOKD':function(_0x3ec35d){return _0x3ec35d();}};_0x592c95[_0x1a9469(0x275)](showLoader);try{const _0x2e5a38={'exportDate':new Date()['toISOString'](),'scoringCriteria':a13_0x529504[_0x1a9469(0x175)],'products':a13_0x529504['products'],'machines':a13_0x529504[_0x1a9469(0x16b)],'detergentIngredients':a13_0x529504[_0x1a9469(0x270)]},_0x3333da=JSON[_0x1a9469(0x245)](_0x2e5a38,null,0x2),_0x229825=new Blob([_0x3333da],{'type':_0x592c95['fopFb']}),_0x3c5ebc=URL[_0x1a9469(0x1ae)](_0x229825),_0x52ea89=document[_0x1a9469(0x195)]('a');_0x52ea89[_0x1a9469(0x1df)]=_0x3c5ebc,_0x52ea89[_0x1a9469(0x122)]=_0x592c95[_0x1a9469(0x10e)],document[_0x1a9469(0x189)]['appendChild'](_0x52ea89),_0x52ea89[_0x1a9469(0xe0)](),document[_0x1a9469(0x189)][_0x1a9469(0x14f)](_0x52ea89),URL[_0x1a9469(0x7f)](_0x3c5ebc);}catch(_0x292a9b){showCustomAlert(_0x592c95[_0x1a9469(0x21f)],_0x592c95[_0x1a9469(0x1e6)](_0x1a9469(0x11c),_0x292a9b[_0x1a9469(0xca)]));}finally{_0x592c95[_0x1a9469(0x18b)](hideLoader);}}export function importFromJson(_0x59e5e8){const _0x3ed663=a13_0x5d3211,_0x4347bf={'SIOeS':function(_0x3b72ea){return _0x3b72ea();},'beYAB':function(_0x368fd0){return _0x368fd0();},'SnYKT':function(_0x1f0308,_0x143f6f,_0x44ff1c){return _0x1f0308(_0x143f6f,_0x44ff1c);},'gnTgO':_0x3ed663(0x2a6),'rVHqN':_0x3ed663(0x210),'EjHnN':_0x3ed663(0x68),'LwbZS':_0x3ed663(0x142)},_0x4cfd4b=_0x59e5e8[_0x3ed663(0x21b)]['files'][0x0];if(!_0x4cfd4b)return;const _0x5ca938=new FileReader();_0x5ca938[_0x3ed663(0x94)]=function(_0x499e21){const _0x4a64cc=_0x3ed663;try{const _0x49afaa=JSON['parse'](_0x499e21[_0x4a64cc(0x21b)]['result']);_0x49afaa&&_0x49afaa[_0x4a64cc(0x17d)]&&_0x49afaa[_0x4a64cc(0x175)]&&_0x49afaa[_0x4a64cc(0x16b)]?(a13_0x529504[_0x4a64cc(0x1ee)](_0x49afaa[_0x4a64cc(0x17d)]),a13_0x529504['setMachines'](_0x49afaa[_0x4a64cc(0x16b)]),a13_0x529504[_0x4a64cc(0xc4)](_0x49afaa[_0x4a64cc(0x175)]),_0x49afaa[_0x4a64cc(0x270)]&&a13_0x529504[_0x4a64cc(0x19f)](_0x49afaa['detergentIngredients']),_0x4347bf[_0x4a64cc(0xbb)](saveStateForUndo),_0x4347bf[_0x4a64cc(0x261)](a13_0x50a144),_0x4347bf['SnYKT'](showCustomAlert,_0x4347bf[_0x4a64cc(0xa1)],_0x4347bf['rVHqN'])):showCustomAlert(_0x4a64cc(0x68),_0x4a64cc(0x12c));}catch(_0x194dc2){_0x4347bf[_0x4a64cc(0x1c6)](showCustomAlert,_0x4347bf[_0x4a64cc(0xfd)],_0x4347bf[_0x4a64cc(0x1b9)]);}finally{_0x59e5e8[_0x4a64cc(0x21b)]['value']='';}},_0x5ca938['readAsText'](_0x4cfd4b);}export function toggleOtherProductType(_0x2ae4d5,_0x5ef1aa){const _0x2c41bf=a13_0x5d3211,_0x5ba8e8={'xltcv':'none'},_0x6568=document[_0x2c41bf(0x119)](_0x5ef1aa),_0x116bd0=_0x6568[_0x2c41bf(0x71)]('input');_0x2c41bf(0x1ea)===_0x2ae4d5['value']?(_0x6568['style']['display']=_0x2c41bf(0x159),_0x116bd0[_0x2c41bf(0x111)]=!0x0):(_0x6568[_0x2c41bf(0x249)][_0x2c41bf(0xa3)]=_0x5ba8e8[_0x2c41bf(0xf3)],_0x116bd0[_0x2c41bf(0x111)]=!0x1,_0x116bd0[_0x2c41bf(0x299)]='');}export function toggleOtherMachineStage(_0x18f4b6,_0x2f6eac){const _0x27bc2b=a13_0x5d3211,_0x220bf5={'BvExs':'input','ldYLY':function(_0x28af7a,_0x41708e){return _0x28af7a===_0x41708e;},'oFcCs':_0x27bc2b(0x1ea),'uyXXu':'block'},_0x4caeed=document['getElementById'](_0x2f6eac),_0x53e73c=_0x4caeed[_0x27bc2b(0x71)](_0x220bf5[_0x27bc2b(0x2af)]);_0x220bf5[_0x27bc2b(0x283)](_0x220bf5[_0x27bc2b(0x231)],_0x18f4b6[_0x27bc2b(0x299)])?(_0x4caeed[_0x27bc2b(0x249)][_0x27bc2b(0xa3)]=_0x220bf5[_0x27bc2b(0x9e)],_0x53e73c[_0x27bc2b(0x111)]=!0x0):(_0x4caeed[_0x27bc2b(0x249)][_0x27bc2b(0xa3)]=_0x27bc2b(0x1fe),_0x53e73c[_0x27bc2b(0x111)]=!0x1,_0x53e73c[_0x27bc2b(0x299)]='');}export function toggleOtherMachineGroup(_0x1f591e,_0x3e3cf0){const _0x20afa1=a13_0x5d3211,_0x4746d8={'XMroM':function(_0x28914c,_0x544d2a){return _0x28914c===_0x544d2a;},'MsLeM':_0x20afa1(0x1ea),'AmFqQ':'block','bMaOx':'none'},_0x5b31e0=document[_0x20afa1(0x119)](_0x3e3cf0),_0x1b6b67=_0x5b31e0['querySelector'](_0x20afa1(0xff));_0x4746d8[_0x20afa1(0x125)](_0x4746d8[_0x20afa1(0xde)],_0x1f591e[_0x20afa1(0x299)])?(_0x5b31e0[_0x20afa1(0x249)][_0x20afa1(0xa3)]=_0x4746d8[_0x20afa1(0x1be)],_0x1b6b67['required']=!0x0):(_0x5b31e0[_0x20afa1(0x249)][_0x20afa1(0xa3)]=_0x4746d8['bMaOx'],_0x1b6b67[_0x20afa1(0x111)]=!0x1,_0x1b6b67[_0x20afa1(0x299)]='');}export function clampSafetyFactor(_0x8b1f89,_0x3c4e3a){const _0x31c046=a13_0x5d3211,_0x2d3aa5={'cqjnN':function(_0x17c0e5,_0x3d08ce){return _0x17c0e5(_0x3d08ce);},'KScTQ':function(_0x399227,_0x1761a5){return _0x399227(_0x1761a5);},'nJYOe':function(_0x236a88,_0x3e0d8c){return _0x236a88(_0x3e0d8c);},'jFMzL':function(_0x66902a,_0x33a227){return _0x66902a<_0x33a227;},'XhTzV':function(_0x42e5d9,_0x7ecd9c){return _0x42e5d9>_0x7ecd9c;},'bgtdz':function(_0x3eb443,_0x24deb5){return _0x3eb443(_0x24deb5);},'Hqcrd':_0x31c046(0x1c9),'iMvNY':function(_0x564130,_0x37fd64){return _0x564130(_0x37fd64);},'LZybh':_0x31c046(0x163)},_0x451ab0=_0x2d3aa5[_0x31c046(0x1e5)](parseFloat,_0x8b1f89[_0x31c046(0xe5)]),_0x55f503=_0x2d3aa5[_0x31c046(0x1e5)](parseFloat,_0x8b1f89[_0x31c046(0x85)]);let _0xc26f6e=_0x2d3aa5[_0x31c046(0x87)](parseFloat,_0x8b1f89[_0x31c046(0x299)]);_0x2d3aa5[_0x31c046(0x18f)](isNaN,_0xc26f6e)&&(_0xc26f6e=_0x451ab0),_0x2d3aa5[_0x31c046(0xa8)](_0xc26f6e,_0x451ab0)?_0xc26f6e=_0x451ab0:_0x2d3aa5[_0x31c046(0x1eb)](_0xc26f6e,_0x55f503)&&(_0xc26f6e=_0x55f503),_0x2d3aa5[_0x31c046(0xba)](parseFloat,_0x8b1f89['value'])!==_0xc26f6e&&(_0x8b1f89[_0x31c046(0x299)]=_0xc26f6e),_0x8b1f89['id'][_0x31c046(0xb4)](_0x2d3aa5['Hqcrd'])?_0x2d3aa5['iMvNY'](recalculateProductMacoForTrain,_0x3c4e3a):_0x8b1f89['id'][_0x31c046(0xb4)](_0x2d3aa5['LZybh'])&&recalculateDetergentMacoForTrain(_0x3c4e3a);}export function toggleTrain(_0x1c8712){const _0x5d94db=a13_0x5d3211,_0x29f499={'JeUIy':function(_0x4f937e,_0x3f71f5){return _0x4f937e&&_0x3f71f5;},'pYzAG':_0x5d94db(0xfb)},_0x2d9750=document[_0x5d94db(0x119)](_0x5d94db(0x1aa)+_0x1c8712),_0xeb5fbd=document['getElementById'](_0x5d94db(0xd5)+_0x1c8712);_0x29f499['JeUIy'](_0x2d9750,_0xeb5fbd)&&(_0x2d9750['classList']['contains'](_0x5d94db(0xfb))?(_0x2d9750[_0x5d94db(0x98)][_0x5d94db(0x80)](_0x5d94db(0xfb)),_0xeb5fbd[_0x5d94db(0x148)]='▼'):(_0x2d9750[_0x5d94db(0x98)][_0x5d94db(0x24b)](_0x29f499[_0x5d94db(0x219)]),_0xeb5fbd[_0x5d94db(0x148)]='▶'));}export function toggleMacoBreakdown(_0x5e6171){const _0x27ddc5=a13_0x5d3211,_0x4a9d63={'Dlpmr':_0x27ddc5(0x1a2),'DknMW':_0x27ddc5(0x180),'lOYVv':_0x27ddc5(0x161)},_0x19cc8a=document[_0x27ddc5(0x119)](_0x27ddc5(0x8a)+_0x5e6171),_0x397505=document[_0x27ddc5(0x119)](_0x27ddc5(0xf0)+_0x5e6171);_0x19cc8a[_0x27ddc5(0x98)][_0x27ddc5(0x101)](_0x27ddc5(0x1a2))?(_0x19cc8a[_0x27ddc5(0x98)][_0x27ddc5(0x80)](_0x4a9d63[_0x27ddc5(0x276)]),_0x397505[_0x27ddc5(0x148)]=_0x4a9d63['DknMW']):(_0x19cc8a[_0x27ddc5(0x98)][_0x27ddc5(0x24b)](_0x4a9d63[_0x27ddc5(0x276)]),_0x397505['textContent']=_0x4a9d63[_0x27ddc5(0xb9)]);}export function exportWorstCaseToExcel(_0x2e6023=a13_0x5d3211(0xa7)){const _0x2b2c53=a13_0x5d3211,_0xd93ae7={'IUoev':_0x2b2c53(0x95),'RasxL':function(_0x46ec01,_0x12684c){return _0x46ec01===_0x12684c;},'CTSJm':function(_0xe1ea6){return _0xe1ea6();},'oaNmj':_0x2b2c53(0x2b1),'FzBnv':_0x2b2c53(0x1bb),'SVkSE':function(_0x2b0c4d,_0x333293){return _0x2b0c4d!==_0x333293;},'PoZOS':'all','ibbzo':function(_0x2de494,_0x434bd6){return _0x2de494===_0x434bd6;},'dzkUS':function(_0x2eeb57,_0x58f77d,_0x32f048){return _0x2eeb57(_0x58f77d,_0x32f048);},'sWibM':_0x2b2c53(0xd2),'IGLRg':_0x2b2c53(0xa0),'zDlCr':_0x2b2c53(0x1a1),'DaZtm':function(_0x3c2830,_0x10ef98){return _0x3c2830!==_0x10ef98;},'SKNhh':function(_0x473d79){return _0x473d79();},'SYDuP':'Error\x20exporting\x20worst\x20case\x20to\x20Excel:','gnqOa':function(_0x39bc24){return _0x39bc24();},'UKRZa':'Error','hLbOw':'Failed\x20to\x20export\x20worst\x20case\x20data\x20to\x20Excel.','qnIhO':function(_0x6008de){return _0x6008de();}};_0xd93ae7[_0x2b2c53(0x146)](showLoader),import(_0x2b2c53(0xc3))[_0x2b2c53(0x173)](_0x2d7f1c=>{const _0x366dac=_0x2b2c53,_0x3ac1c4={'EwTGZ':function(_0x21cda6,_0x1f75e9){return _0x21cda6(_0x1f75e9);},'nIqHB':_0xd93ae7[_0x366dac(0x137)]},{getProductTrainId:_0x5203d1,calculateScores:_0x1c186d,getToxicityPreference:_0x12d87e}=_0x2d7f1c,_0x962c2e=[];let _0x28be61=a13_0x529504[_0x366dac(0x184)][_0x366dac(0xb5)]||a13_0x529504[_0x366dac(0x17d)];if(_0xd93ae7[_0x366dac(0x116)](0x0,_0x28be61[_0x366dac(0x288)]))return _0xd93ae7[_0x366dac(0x256)](hideLoader),void showCustomAlert(_0xd93ae7[_0x366dac(0xf7)],_0xd93ae7[_0x366dac(0x1f8)]);const _0x27d9fc={};_0x28be61[_0x366dac(0x1c1)](_0x9b56b1=>{const _0x1eaecd=_0x366dac,_0x6775cc=_0x3ac1c4[_0x1eaecd(0x1bc)](_0x5203d1,_0x9b56b1);_0x1eaecd(0x95)!==_0x6775cc&&(_0x27d9fc[_0x6775cc]||(_0x27d9fc[_0x6775cc]=[]),_0x27d9fc[_0x6775cc]['push'](_0x9b56b1));});let _0x2c62f4=_0x27d9fc;if(_0xd93ae7['SVkSE'](_0xd93ae7[_0x366dac(0x133)],_0x2e6023)&&(_0x2c62f4={},Array[_0x366dac(0x28a)](_0x2e6023)?_0x2e6023[_0x366dac(0x1c1)](_0x253dbe=>{_0x27d9fc[_0x253dbe]&&(_0x2c62f4[_0x253dbe]=_0x27d9fc[_0x253dbe]);}):_0x27d9fc[_0x2e6023]&&(_0x2c62f4={[_0x2e6023]:_0x27d9fc[_0x2e6023]}),_0xd93ae7[_0x366dac(0x230)](0x0,Object['keys'](_0x2c62f4)[_0x366dac(0x288)])))return hideLoader(),void _0xd93ae7[_0x366dac(0x28b)](showCustomAlert,_0x366dac(0x2b1),(Array[_0x366dac(0x28a)](_0x2e6023)?_0x366dac(0x1f5)+_0x2e6023[_0x366dac(0x26f)](',\x20'):'Train\x20'+_0x2e6023)+_0x366dac(0x15b));const _0x1a558d=_0xd93ae7[_0x366dac(0x256)](_0x12d87e);if(Object[_0x366dac(0x285)](_0x2c62f4)[_0x366dac(0x254)]((_0x40f75a,_0x3308a7)=>_0x40f75a-_0x3308a7)['forEach'](_0x42733b=>{const _0x4c46eb=_0x366dac,_0x4ca5a2={'seCcz':_0x3ac1c4[_0x4c46eb(0x1c2)]},_0x2e9125=_0x2c62f4[_0x42733b];_0x962c2e[_0x4c46eb(0x1c7)]({'Train':_0x4c46eb(0x1ed)+_0x42733b+_0x4c46eb(0x2b3),'Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),_0x2e9125[_0x4c46eb(0x1c1)](_0x391f05=>{const _0x2ee1ed=_0x4c46eb,_0x2375ef=_0x391f05[_0x2ee1ed(0x197)][_0x2ee1ed(0xd3)](_0x5a9532=>_0x1c186d(_0x5a9532,_0x1a558d)[_0x2ee1ed(0x88)]);_0x391f05[_0x2ee1ed(0x216)]=_0x2375ef[_0x2ee1ed(0x288)]>0x0?Math[_0x2ee1ed(0x85)](..._0x2375ef):0x0;}),_0x2e9125[_0x4c46eb(0x254)]((_0xf4d126,_0x5186e5)=>_0x5186e5[_0x4c46eb(0x216)]-_0xf4d126['sortValue']),_0x2e9125[_0x4c46eb(0x1c1)](_0x123bfb=>{const _0x5a3133=_0x4c46eb,_0x5933ba={'OJggX':_0x4ca5a2[_0x5a3133(0x7b)]},_0x58d7c6=_0x123bfb[_0x5a3133(0x86)]?_0x5a3133(0x207):'No';_0x962c2e['push']({'Train':'','Product\x20Code':_0x123bfb[_0x5a3133(0x2ad)],'Product\x20Name':_0x123bfb['name'],'Highest\x20RPN':_0x123bfb[_0x5a3133(0x216)],'Special\x20Case\x20Product':_0x58d7c6,'Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),(_0x123bfb[_0x5a3133(0x197)]['sort']((_0x1b5913,_0xac4a44)=>_0x1c186d(_0xac4a44,_0x1a558d)['rpn']-_0x1c186d(_0x1b5913,_0x1a558d)[_0x5a3133(0x88)])[_0x5a3133(0x1c1)](_0x4efaa7=>{const _0x3c8ca5=_0x5a3133,_0x8fd75b=_0x1c186d(_0x4efaa7,_0x1a558d);_0x962c2e[_0x3c8ca5(0x1c7)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':_0x4efaa7[_0x3c8ca5(0x263)],'TD\x20Score':_0x8fd75b['therapeuticDoseScore'],'Solubility\x20Score':_0x8fd75b[_0x3c8ca5(0x239)],'Cleanability\x20Score':_0x8fd75b[_0x3c8ca5(0xd6)],'PDE\x20Score':_0x8fd75b[_0x3c8ca5(0x1fa)]??_0x5933ba[_0x3c8ca5(0x9a)],'LD50\x20Score':_0x8fd75b[_0x3c8ca5(0x2ce)]??_0x5933ba[_0x3c8ca5(0x9a)],'RPN':_0x8fd75b[_0x3c8ca5(0x88)],'Rating':_0x8fd75b[_0x3c8ca5(0x1dc)]});}),_0x962c2e[_0x5a3133(0x1c7)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}));});}),0x0===_0x962c2e['length'])return _0xd93ae7[_0x366dac(0x256)](hideLoader),void showCustomAlert(_0xd93ae7[_0x366dac(0xf7)],_0xd93ae7['sWibM']);const _0x5ab429=XLSX[_0x366dac(0x126)][_0x366dac(0x124)](_0x962c2e),_0x320400=XLSX[_0x366dac(0x126)]['book_new']();XLSX[_0x366dac(0x126)][_0x366dac(0x169)](_0x320400,_0x5ab429,_0xd93ae7[_0x366dac(0x264)]);const _0x55d751=Object[_0x366dac(0x285)](_0x962c2e[0x0])['map'](_0x84c775=>({'wch':Math[_0x366dac(0x85)](_0x84c775[_0x366dac(0x288)],..._0x962c2e[_0x366dac(0xd3)](_0x48fff1=>String(_0x48fff1[_0x84c775]||'')[_0x366dac(0x288)]))+0x2}));_0x5ab429[_0xd93ae7[_0x366dac(0x19c)]]=_0x55d751;const _0xe2640b=new Date()[_0x366dac(0x2ba)]()[_0x366dac(0x237)]('T')[0x0];let _0xe8ffe7='';_0xd93ae7['DaZtm'](_0x366dac(0xa7),_0x2e6023)&&(_0xe8ffe7=Array[_0x366dac(0x28a)](_0x2e6023)?'_Trains_'+_0x2e6023[_0x366dac(0x26f)]('_'):_0x366dac(0x1c5)+_0x2e6023),XLSX['writeFile'](_0x320400,'MACO_Worst_Case_Products'+_0xe8ffe7+'_'+_0xe2640b+'.xlsx'),_0xd93ae7[_0x366dac(0xfe)](hideLoader);})[_0x2b2c53(0x1b7)](_0x2ff96e=>{const _0x2c1201=_0x2b2c53;console['error'](_0xd93ae7['SYDuP'],_0x2ff96e),_0xd93ae7['gnqOa'](hideLoader),showCustomAlert(_0xd93ae7[_0x2c1201(0x1d0)],_0xd93ae7[_0x2c1201(0xb7)]);});}export function exportMachinesToExcel(){const _0x408088=a13_0x5d3211,_0x468637={'kKMIQ':_0x408088(0x1ab),'RvLLb':function(_0x475ea6){return _0x475ea6();},'bxfaV':function(_0x33da87,_0xe5c8f3){return _0x33da87===_0xe5c8f3;},'ErTkS':function(_0x1d3ca4){return _0x1d3ca4();},'wocUl':function(_0x108347,_0x1468d9,_0xaa5736){return _0x108347(_0x1468d9,_0xaa5736);},'uALfx':'There\x20are\x20no\x20machines\x20to\x20export.','SznGo':_0x408088(0x15f),'maLBB':'!cols','pPaxY':_0x408088(0x1e0),'jwiKR':_0x408088(0x22f),'Reuaz':function(_0x3460ba,_0x2e13e1,_0x4e428e){return _0x3460ba(_0x2e13e1,_0x4e428e);},'KwiAk':'Error'};_0x468637['RvLLb'](showLoader);try{if(_0x468637['bxfaV'](0x0,a13_0x529504[_0x408088(0x16b)]['length']))return _0x468637['ErTkS'](hideLoader),void _0x468637[_0x408088(0x2c2)](showCustomAlert,_0x408088(0x2b1),_0x468637[_0x408088(0x167)]);const _0xb41831=[],_0x33e5bb={};a13_0x529504[_0x408088(0x16b)][_0x408088(0x1c1)](_0x375850=>{const _0x38335a=_0x408088;_0x33e5bb[_0x375850[_0x38335a(0x97)]]||(_0x33e5bb[_0x375850[_0x38335a(0x97)]]=[]),_0x33e5bb[_0x375850[_0x38335a(0x97)]][_0x38335a(0x1c7)](_0x375850);}),a13_0x529504[_0x408088(0xc2)]['forEach'](_0x162713=>{const _0x2785e6=_0x408088;_0x33e5bb[_0x162713]&&_0x33e5bb[_0x162713][_0x2785e6(0x1c1)](_0x5da077=>{const _0x4bb7f2=_0x2785e6,_0x288511=a13_0x529504['products'][_0x4bb7f2(0x178)](_0x482887=>_0x482887[_0x4bb7f2(0x15a)]&&_0x482887[_0x4bb7f2(0x15a)]['includes'](_0x5da077['id'])),_0x185c82=_0x288511[_0x4bb7f2(0xd3)](_0x239fe2=>_0x239fe2[_0x4bb7f2(0x263)])[_0x4bb7f2(0x26f)](',\x20')||_0x468637[_0x4bb7f2(0x1d2)],_0x3df981=_0x288511[_0x4bb7f2(0x288)];_0xb41831[_0x4bb7f2(0x1c7)]({'Machine\x20Number':_0x5da077[_0x4bb7f2(0x236)],'Machine\x20Name':_0x5da077[_0x4bb7f2(0x263)],'Stage':_0x5da077[_0x4bb7f2(0x97)],'Area\x20(sq\x20cm)':_0x5da077[_0x4bb7f2(0x2a9)],'Assigned\x20Products\x20Count':_0x3df981,'Assigned\x20Products':_0x185c82});});});const _0x193ccb=XLSX[_0x408088(0x126)][_0x408088(0x124)](_0xb41831),_0x1e3f56=XLSX[_0x408088(0x126)]['book_new']();XLSX[_0x408088(0x126)][_0x408088(0x169)](_0x1e3f56,_0x193ccb,_0x468637[_0x408088(0x2d0)]);const _0x5b19dd=[{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0xf},{'wch':0x14},{'wch':0x32}];_0x193ccb[_0x468637['maLBB']]=_0x5b19dd;const _0xf4c7e1=new Date()['toISOString']()['split']('T')[0x0];XLSX['writeFile'](_0x1e3f56,_0x408088(0x295)+_0xf4c7e1+'.xlsx'),hideLoader(),_0x468637['wocUl'](showCustomAlert,'Success',_0x468637[_0x408088(0x18e)]);}catch(_0x273a61){console[_0x408088(0x172)](_0x468637[_0x408088(0x25f)],_0x273a61),_0x468637[_0x408088(0x16e)](hideLoader),_0x468637['Reuaz'](showCustomAlert,_0x468637[_0x408088(0x293)],_0x408088(0x1fd));}}export function exportProductMacoToExcel(_0x4b4beb=a13_0x5d3211(0xa7)){const _0x977007=a13_0x5d3211,_0x38e8b3={'iopys':function(_0x3986e7,_0x2f9cea){return _0x3986e7||_0x2f9cea;},'DDKzQ':function(_0x3dcd45,_0x564e6e){return _0x3dcd45(_0x564e6e);},'NcBmb':function(_0x39cf7d,_0x45ab5a){return _0x39cf7d*_0x45ab5a;},'pWRPu':function(_0x4c5d7b,_0x2086f7){return _0x4c5d7b===_0x2086f7;},'PXDoy':_0x977007(0x274),'YjaOB':'productRegister-ld50Hidden','bofXo':function(_0x2fd86a,_0x4331ca,_0x1e27cb){return _0x2fd86a(_0x4331ca,_0x1e27cb);},'WUiSU':_0x977007(0x241),'nrphZ':_0x977007(0x225),'EwVNO':_0x977007(0x26b),'mYMTG':function(_0x1bd214,_0x41e69d){return _0x1bd214>_0x41e69d;},'nZpBu':_0x977007(0x95),'CdFXl':function(_0x4a3acf,_0x14d0a0){return _0x4a3acf!==_0x14d0a0;},'hjlga':function(_0x3a43ae){return _0x3a43ae();},'LWbMX':_0x977007(0x2b1),'iHhTo':_0x977007(0x257),'SlMOh':function(_0x4456f,_0x49c1c4){return _0x4456f!==_0x49c1c4;},'hxstw':_0x977007(0xa7),'JFRKl':function(_0x368337){return _0x368337();},'yESHW':'No\x20trains\x20match\x20the\x20selected\x20criteria.','poxot':'Product\x20MACO\x20Report','fKvni':_0x977007(0x1a1),'vRgIA':function(_0x387c3e,_0x38dd14,_0x19a5f8){return _0x387c3e(_0x38dd14,_0x19a5f8);},'YbOlQ':_0x977007(0x1cb),'zioxW':_0x977007(0x149),'Yajwv':function(_0x3ac349){return _0x3ac349();},'iypcE':_0x977007(0x12b)};showLoader(),import(_0x977007(0xc3))[_0x977007(0x173)](_0x2947d3=>{const _0x2588c3=_0x977007,_0x4ec356={'rBlog':function(_0x1c4e7b,_0x3ae833){const _0x88922=a13_0x144a;return _0x38e8b3[_0x88922(0x90)](_0x1c4e7b,_0x3ae833);},'kpPlo':function(_0x2ebdef,_0xf5e2b7){const _0x39a4b5=a13_0x144a;return _0x38e8b3[_0x39a4b5(0x14a)](_0x2ebdef,_0xf5e2b7);},'tEDcm':function(_0x1e7d05,_0x2673d6){return _0x1e7d05*_0x2673d6;},'UKchw':function(_0x5b5857,_0x44bd0c){const _0x3ac362=a13_0x144a;return _0x38e8b3[_0x3ac362(0x2c9)](_0x5b5857,_0x44bd0c);},'genXJ':function(_0x3d3424,_0x48a43f){return _0x3d3424/_0x48a43f;},'aUGdU':function(_0x57d250,_0x2e42c7){const _0x543a51=a13_0x144a;return _0x38e8b3[_0x543a51(0x134)](_0x57d250,_0x2e42c7);},'lMfoo':_0x38e8b3['PXDoy'],'ZJtxK':function(_0x3d498c,_0x48407d){const _0x26dd5d=a13_0x144a;return _0x38e8b3[_0x26dd5d(0x134)](_0x3d498c,_0x48407d);},'zpwct':_0x38e8b3[_0x2588c3(0xbc)],'WzlaZ':function(_0x1830fd,_0x18b3df){return _0x1830fd!==_0x18b3df;},'dRSxr':function(_0x1cde72,_0x3ed435){const _0x5131f3=_0x2588c3;return _0x38e8b3[_0x5131f3(0x2c9)](_0x1cde72,_0x3ed435);},'rNRTy':function(_0x4f149a,_0x2298d8,_0x2bce32){const _0x3a9738=_0x2588c3;return _0x38e8b3[_0x3a9738(0x2bc)](_0x4f149a,_0x2298d8,_0x2bce32);},'RReqF':_0x38e8b3['WUiSU'],'noDbR':function(_0x24b81d,_0x2658db){const _0x49ce7d=_0x2588c3;return _0x38e8b3[_0x49ce7d(0x134)](_0x24b81d,_0x2658db);},'CaIcC':_0x38e8b3[_0x2588c3(0x11e)],'vlMCc':_0x38e8b3['EwVNO'],'udiTC':function(_0x177df0,_0x12f805){return _0x38e8b3['mYMTG'](_0x177df0,_0x12f805);},'oSOWK':_0x38e8b3['nZpBu'],'FAoCn':function(_0x25935a,_0x4cff30){const _0x53fada=_0x2588c3;return _0x38e8b3[_0x53fada(0x1b2)](_0x25935a,_0x4cff30);}},{getTrainData:_0x5b4913,getWorstCaseProductType:_0x216423,getMacoPerSwabForTrain:_0x5298b8,getLargestEssaForLineAndDosageForm:_0xfbc75}=_0x2947d3,_0x1e0e85=_0x38e8b3[_0x2588c3(0x27a)](_0x5b4913);if(0x0===_0x1e0e85[_0x2588c3(0x288)])return _0x38e8b3[_0x2588c3(0x27a)](hideLoader),void _0x38e8b3[_0x2588c3(0x2bc)](showCustomAlert,_0x38e8b3[_0x2588c3(0x20c)],_0x38e8b3[_0x2588c3(0x91)]);let _0xdbeab1=_0x1e0e85;if(_0x38e8b3[_0x2588c3(0x13d)](_0x38e8b3[_0x2588c3(0x1c3)],_0x4b4beb)&&(_0xdbeab1=Array[_0x2588c3(0x28a)](_0x4b4beb)?_0x1e0e85[_0x2588c3(0x178)](_0x3938ec=>_0x4b4beb[_0x2588c3(0x1ce)](String(_0x3938ec['id']))):_0x1e0e85[_0x2588c3(0x178)](_0x3d4fab=>String(_0x3d4fab['id'])===String(_0x4b4beb))),_0x38e8b3[_0x2588c3(0x134)](0x0,_0xdbeab1[_0x2588c3(0x288)]))return _0x38e8b3[_0x2588c3(0x27b)](hideLoader),void _0x38e8b3[_0x2588c3(0x2bc)](showCustomAlert,_0x2588c3(0x2b1),_0x38e8b3[_0x2588c3(0x140)]);const _0xcdb7db=[];_0xdbeab1[_0x2588c3(0x1c1)](_0x3f573f=>{const _0x267569=_0x2588c3,_0x94729b={'wEnpN':function(_0x5c114e,_0x5a85cc){const _0x15bb0b=a13_0x144a;return _0x4ec356[_0x15bb0b(0x19d)](_0x5c114e,_0x5a85cc);}},_0x46020e=_0x4ec356[_0x267569(0x218)](_0x216423,_0x3f573f[_0x267569(0x17d)][_0x267569(0xd3)](_0x1d7dda=>_0x1d7dda[_0x267569(0x209)])),_0x5f65b9=(a13_0x529504[_0x267569(0xf9)][_0x46020e]||a13_0x529504[_0x267569(0xf9)][_0x267569(0x1ea)])[_0x267569(0x85)],_0x3c8b9d=_0x4ec356[_0x267569(0x2a7)](_0x3f573f[_0x267569(0x69)],_0x3f573f[_0x267569(0x6d)])/_0x5f65b9,_0x418c6e=_0x4ec356['UKchw'](0xa,_0x3f573f[_0x267569(0x2c6)]);let _0x51c3b1=0x1/0x0,_0x39169f=_0x4ec356[_0x267569(0x129)](0x1,0x0);const _0x59e3bd=_0x4ec356[_0x267569(0x6a)](_0x4ec356[_0x267569(0x26e)],localStorage[_0x267569(0x130)]('productRegister-pdeHidden')),_0x3dc5ec=_0x4ec356[_0x267569(0x211)](_0x4ec356[_0x267569(0x26e)],localStorage[_0x267569(0x130)](_0x4ec356[_0x267569(0x1fc)]));if(null===_0x3f573f['lowestPde']||_0x59e3bd||(_0x51c3b1=_0x3f573f[_0x267569(0x1ef)]*_0x3f573f['minBsMddRatio']),_0x4ec356['WzlaZ'](null,_0x3f573f['lowestLd50'])&&!_0x3dc5ec){const _0x2a9a39=_0x4ec356[_0x267569(0x260)](0x46,_0x3f573f[_0x267569(0x23e)])/0x7d0,_0x377361=_0x3f573f[_0x267569(0x17d)]['flatMap'](_0x4345f9=>_0x4345f9['activeIngredients'][_0x267569(0xd3)](_0x2c5a71=>_0x2c5a71[_0x267569(0x2be)]/0x3e8)),_0x4a776f=Math[_0x267569(0xe5)](..._0x377361);_0x39169f=_0x4ec356[_0x267569(0x129)](_0x4ec356[_0x267569(0x260)](_0x4ec356['dRSxr'](_0x2a9a39,_0x3f573f[_0x267569(0x2c6)]),0x3e8),_0x4ec356[_0x267569(0x1c0)](_0x5f65b9,_0x4a776f));}const _0x3ea8b4=_0x4ec356[_0x267569(0x2b0)](_0xfbc75,_0x3f573f,_0x1e0e85),_0x16372d=_0x4ec356[_0x267569(0x2a7)](0.004,_0x3ea8b4),_0x171b82=[{'name':'0.1%\x20Therapeutic\x20Dose','value':_0x3c8b9d},{'name':_0x4ec356['RReqF'],'value':_0x418c6e}];_0x4ec356[_0x267569(0x13c)](null,_0x3f573f[_0x267569(0x1ef)])||_0x59e3bd||_0x171b82[_0x267569(0x1c7)]({'name':_0x4ec356[_0x267569(0x215)],'value':_0x51c3b1}),null===_0x3f573f[_0x267569(0x23e)]||_0x3dc5ec||_0x171b82[_0x267569(0x1c7)]({'name':_0x4ec356[_0x267569(0xe2)],'value':_0x39169f}),_0x171b82[_0x267569(0x1c7)]({'name':_0x267569(0xe1),'value':_0x16372d});const _0x524f9a=_0x171b82['reduce']((_0x2afc9d,_0x2f71b3)=>_0x2f71b3[_0x267569(0x299)]<_0x2afc9d['value']?_0x2f71b3:_0x2afc9d),_0x4b4e1e=_0x524f9a[_0x267569(0x299)],_0x5d2b34=_0x4ec356[_0x267569(0x213)](_0x3ea8b4,0x0)?_0x4ec356[_0x267569(0x129)](_0x4b4e1e,_0x3ea8b4):0x0,_0x4cb736=_0x5d2b34*_0x3f573f[_0x267569(0x23d)],_0x1a8dc7=_0x3f573f['machineIds'][_0x267569(0xd3)](_0x42a3ba=>{const _0x2842e1=_0x267569,_0x479899=a13_0x529504['machines'][_0x2842e1(0xfa)](_0x3341ae=>_0x3341ae['id']===_0x42a3ba);return _0x94729b[_0x2842e1(0x14c)](_0x479899,{'name':'Unknown\x20(ID:\x20'+_0x42a3ba+')','machineNumber':_0x2842e1(0x95)});}),_0x2331b4=_0x3f573f[_0x267569(0x15a)][_0x267569(0xd3)](_0x2b31ed=>{const _0x571228=_0x267569,_0x3d64e2=a13_0x529504[_0x571228(0x16b)][_0x571228(0xfa)](_0x418999=>_0x418999['id']===_0x2b31ed);return _0x3d64e2?_0x3d64e2[_0x571228(0x263)]:_0x571228(0x29c)+_0x2b31ed+')';})[_0x267569(0x26f)](',\x20'),_0x29aa48=_0x3f573f[_0x267569(0x17d)]['map'](_0x5ad1db=>_0x5ad1db[_0x267569(0x2ad)]+_0x267569(0x25a)+_0x5ad1db[_0x267569(0x263)])[_0x267569(0x26f)](';\x20'),_0x541baa=_0x3f573f[_0x267569(0x238)]?_0x3f573f[_0x267569(0x238)][_0x267569(0xf4)]+'\x20('+_0x3f573f[_0x267569(0x238)][_0x267569(0x14b)]+_0x267569(0x22a)+_0x3f573f[_0x267569(0x238)]['rpn']:_0x4ec356['oSOWK'];_0xcdb7db[_0x267569(0x1c7)]({'Train':'T'+_0x3f573f['id'],'Total\x20Products':_0x3f573f[_0x267569(0x17d)][_0x267569(0x288)],'Total\x20Machines':_0x1a8dc7['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x3f573f['essa'][_0x267569(0x109)](),'Products':_0x29aa48,'Machines':_0x2331b4,'Worst-Case\x20Dosage\x20Form':_0x46020e,'Safety\x20Factor':_0x5f65b9,'Lowest\x20LTD\x20(mg)':_0x3f573f['lowestLtd'],'Min\x20Batch\x20Size\x20(kg)':_0x3f573f[_0x267569(0x2c6)],'Min\x20BS/MDD\x20Ratio':_0x3f573f[_0x267569(0x6d)][_0x267569(0x102)](0x2),'Lowest\x20PDE\x20(mg)':_0x4ec356[_0x267569(0x186)](null,_0x3f573f[_0x267569(0x1ef)])?_0x3f573f[_0x267569(0x1ef)]:_0x4ec356['oSOWK'],'Worst-Case\x20Product\x20(by\x20RPN)':_0x541baa,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x3c8b9d[_0x267569(0x102)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x418c6e[_0x267569(0x102)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x267569(0x294)==typeof _0x51c3b1?_0x51c3b1[_0x267569(0x102)](0x2):_0x4ec356[_0x267569(0x265)],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x16372d[_0x267569(0x102)](0x2),'Selected\x20MACO\x20Method':_0x524f9a[_0x267569(0x263)],'Final\x20MACO\x20(mg)':_0x4b4e1e[_0x267569(0x102)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x5d2b34[_0x267569(0x76)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x4cb736[_0x267569(0x102)](0x4)});});const _0x58fa80=XLSX[_0x2588c3(0x126)][_0x2588c3(0x124)](_0xcdb7db),_0x2081e4=XLSX['utils']['book_new']();XLSX[_0x2588c3(0x126)]['book_append_sheet'](_0x2081e4,_0x58fa80,_0x38e8b3[_0x2588c3(0x217)]),_0x58fa80[_0x38e8b3[_0x2588c3(0x72)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0x12},{'wch':0xf},{'wch':0x12},{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0x12},{'wch':0x12}];const _0x4cc890=new Date()['toISOString']()[_0x2588c3(0x237)]('T')[0x0];let _0x140b2f=_0x2588c3(0x1f6);if(_0x38e8b3[_0x2588c3(0x1c3)]!==_0x4b4beb){if(Array[_0x2588c3(0x28a)](_0x4b4beb))_0x140b2f+=_0x2588c3(0x2cd)+_0x4b4beb[_0x2588c3(0x254)]((_0x3695e5,_0x105c03)=>_0x3695e5-_0x105c03)['join']('_');else _0x140b2f+='_Train_'+_0x4b4beb;}_0x140b2f+='_'+_0x4cc890+_0x2588c3(0x267),XLSX[_0x2588c3(0x147)](_0x2081e4,_0x140b2f),hideLoader(),_0x38e8b3['vRgIA'](showCustomAlert,'Success',_0x38e8b3['YbOlQ']);})[_0x977007(0x1b7)](_0x3db356=>{const _0x575b37=_0x977007;console[_0x575b37(0x172)](_0x38e8b3[_0x575b37(0x259)],_0x3db356),_0x38e8b3[_0x575b37(0x1d7)](hideLoader),_0x38e8b3[_0x575b37(0x2bc)](showCustomAlert,_0x575b37(0x68),_0x38e8b3['iypcE']);});}export function exportDetergentMacoToExcel(_0x5aafe0=a13_0x5d3211(0xa7)){const _0x45ab9d=a13_0x5d3211,_0x248260={'eVbzp':function(_0x379bbd,_0x550e6c){return _0x379bbd||_0x550e6c;},'NhqUJ':function(_0x44637f,_0x550651){return _0x44637f(_0x550651);},'vghtU':function(_0x323dfb,_0x5863ee){return _0x323dfb/_0x5863ee;},'EeofH':function(_0x2bdbd0,_0x3f0903){return _0x2bdbd0*_0x3f0903;},'hYfey':function(_0x5c993a,_0x43ce15){return _0x5c993a*_0x43ce15;},'FcLml':_0x45ab9d(0x95),'azpkc':function(_0x2fb003){return _0x2fb003();},'jOGDj':_0x45ab9d(0xa7),'oaWoP':function(_0x2be22a,_0x5d688d){return _0x2be22a===_0x5d688d;},'dOesA':function(_0x2f82db,_0x178bb0,_0x181113){return _0x2f82db(_0x178bb0,_0x181113);},'pTGBT':_0x45ab9d(0x257),'fQAsI':function(_0xb58100,_0x1a9082){return _0xb58100===_0x1a9082;},'MeuGC':_0x45ab9d(0x2b1),'mmphL':_0x45ab9d(0x21d),'xuXBY':_0x45ab9d(0xf6),'dNKDN':function(_0x46e613,_0x11b0dc,_0x264143){return _0x46e613(_0x11b0dc,_0x264143);},'ZJOpH':'Success','FkeWk':_0x45ab9d(0x287),'QTzmR':function(_0xfd9ac8){return _0xfd9ac8();},'PRvEz':function(_0x15e398,_0x59f13f,_0x49fe55){return _0x15e398(_0x59f13f,_0x49fe55);},'VHPKC':_0x45ab9d(0x194),'lNUus':_0x45ab9d(0xc3)};showLoader(),import(_0x248260['lNUus'])['then'](_0x36773c=>{const _0x45e1ed=_0x45ab9d,{getTrainData:_0x51fc6a,getWorstCaseProductType:_0x9ae5e6}=_0x36773c;let _0x17efb3=_0x248260[_0x45e1ed(0x2bb)](_0x51fc6a);if(_0x248260[_0x45e1ed(0xc5)]!==_0x5aafe0&&(_0x17efb3=Array[_0x45e1ed(0x28a)](_0x5aafe0)?_0x17efb3[_0x45e1ed(0x178)](_0x243726=>_0x5aafe0[_0x45e1ed(0x1ce)](String(_0x243726['id']))):_0x17efb3['filter'](_0x4faf59=>String(_0x4faf59['id'])===String(_0x5aafe0))),_0x248260[_0x45e1ed(0xda)](0x0,_0x17efb3[_0x45e1ed(0x288)]))return _0x248260[_0x45e1ed(0x2bb)](hideLoader),void _0x248260[_0x45e1ed(0x20e)](showCustomAlert,'No\x20Data',_0x248260[_0x45e1ed(0x89)]);if(_0x248260[_0x45e1ed(0x246)](0x0,a13_0x529504['detergentIngredients'][_0x45e1ed(0x288)]))return _0x248260['azpkc'](hideLoader),void showCustomAlert(_0x248260['MeuGC'],_0x248260['mmphL']);const _0x3254b7=[],_0x55c635=_0x248260[_0x45e1ed(0x1b1)](parseFloat,document[_0x45e1ed(0x119)](_0x45e1ed(0x123))?.['value'])||0x46,_0x361dd2=a13_0x529504['detergentIngredients'][_0x45e1ed(0xd3)](_0x1084fe=>parseFloat(_0x1084fe[_0x45e1ed(0x1db)]))[_0x45e1ed(0x178)](_0x15ad4c=>!isNaN(_0x15ad4c)),_0x7f94cd=_0x361dd2[_0x45e1ed(0x288)]>0x0?Math['min'](..._0x361dd2):0x0,_0x3c8bd2=a13_0x529504['detergentIngredients']['map'](_0x43f3b5=>_0x43f3b5[_0x45e1ed(0x263)])[_0x45e1ed(0x178)](_0x38ed46=>''!==_0x38ed46[_0x45e1ed(0x67)]())['join'](',\x20');_0x17efb3[_0x45e1ed(0x1c1)](_0x274aee=>{const _0x7504b7=_0x45e1ed,_0x133504={'BCnHJ':function(_0x57cf85,_0x44f118){return _0x248260['eVbzp'](_0x57cf85,_0x44f118);},'anhnu':_0x7504b7(0x95)},_0x23837a=_0x248260[_0x7504b7(0x1b1)](_0x9ae5e6,_0x274aee[_0x7504b7(0x17d)][_0x7504b7(0xd3)](_0x52236e=>_0x52236e['productType'])),_0x27d581=a13_0x529504[_0x7504b7(0xf9)][_0x23837a]||a13_0x529504[_0x7504b7(0xf9)][_0x7504b7(0x1ea)],_0x220ca7=document[_0x7504b7(0x119)]('sf-input-train-'+_0x274aee['id']),_0x2125eb=_0x220ca7&&parseFloat(_0x220ca7['value'])||_0x27d581[_0x7504b7(0x85)],_0x357bd5=_0x248260[_0x7504b7(0x2c8)](_0x248260[_0x7504b7(0x2aa)](_0x248260[_0x7504b7(0x2aa)](0.0005,_0x7f94cd),_0x55c635),_0x2125eb),_0x24e2f5=_0x357bd5*_0x274aee[_0x7504b7(0x6d)],_0x481b66=_0x36773c[_0x7504b7(0x27d)](_0x274aee,_0x17efb3),_0x235b30=_0x481b66>0x0?_0x24e2f5/_0x481b66:0x0,_0x592eca=_0x248260[_0x7504b7(0x193)](_0x235b30,_0x274aee[_0x7504b7(0x23d)]),_0x2a7f0e=_0x274aee[_0x7504b7(0x15a)][_0x7504b7(0xd3)](_0x5d32a1=>{const _0x48c0f6=_0x7504b7,_0x145523=a13_0x529504[_0x48c0f6(0x16b)][_0x48c0f6(0xfa)](_0x253356=>_0x253356['id']===_0x5d32a1);return _0x133504[_0x48c0f6(0x156)](_0x145523,{'name':_0x48c0f6(0x29c)+_0x5d32a1+')','machineNumber':_0x133504[_0x48c0f6(0x192)]});}),_0x298135=_0x274aee['machineIds'][_0x7504b7(0xd3)](_0x1be5b5=>{const _0x1a320a=_0x7504b7,_0x5596a6=a13_0x529504['machines'][_0x1a320a(0xfa)](_0xaa4ebb=>_0xaa4ebb['id']===_0x1be5b5);return _0x5596a6?_0x5596a6[_0x1a320a(0x263)]:_0x1a320a(0x29c)+_0x1be5b5+')';})[_0x7504b7(0x26f)](',\x20'),_0x26e476=_0x274aee[_0x7504b7(0x17d)][_0x7504b7(0xd3)](_0x3cb4ae=>_0x3cb4ae[_0x7504b7(0x2ad)]+_0x7504b7(0x25a)+_0x3cb4ae[_0x7504b7(0x263)])['join'](';\x20'),_0x3fb48a=_0x274aee['worstProductRpn']?_0x274aee['worstProductRpn'][_0x7504b7(0xf4)]+'\x20('+_0x274aee['worstProductRpn']['ingredientName']+')\x20-\x20RPN:\x20'+_0x274aee[_0x7504b7(0x238)][_0x7504b7(0x88)]:_0x248260['FcLml'];_0x3254b7[_0x7504b7(0x1c7)]({'Train':'T'+_0x274aee['id'],'Total\x20Products':_0x274aee[_0x7504b7(0x17d)]['length'],'Total\x20Machines':_0x2a7f0e[_0x7504b7(0x288)],'Total\x20Area\x20(ESSA)\x20cm²':_0x274aee['essa'][_0x7504b7(0x109)](),'Products':_0x26e476,'Machines':_0x298135,'Worst-Case\x20Dosage\x20Form':_0x23837a,'Safety\x20Factor\x20Range':_0x27d581[_0x7504b7(0xe5)]+_0x7504b7(0x25a)+_0x27d581[_0x7504b7(0x85)],'Applied\x20Safety\x20Factor':_0x2125eb,'Detergent\x20Ingredients':_0x3c8bd2,'Body\x20Weight\x20(kg)':_0x55c635,'Minimum\x20LD50\x20(mg/kg)':_0x7f94cd,'Min\x20Batch\x20Size\x20(kg)':_0x274aee[_0x7504b7(0x2c6)],'Min\x20BS/MDD\x20Ratio':_0x274aee['minBsMddRatio']['toFixed'](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x3fb48a,'ADI\x20(mg)':_0x357bd5['toFixed'](0x4),'MACO\x20(mg)':_0x24e2f5[_0x7504b7(0x102)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x235b30[_0x7504b7(0x76)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x592eca[_0x7504b7(0x102)](0x4)});});const _0x4c291c=XLSX[_0x45e1ed(0x126)][_0x45e1ed(0x124)](_0x3254b7),_0x1868ba=XLSX[_0x45e1ed(0x126)][_0x45e1ed(0x8d)]();XLSX['utils'][_0x45e1ed(0x169)](_0x1868ba,_0x4c291c,_0x248260[_0x45e1ed(0x1ca)]),_0x4c291c['!cols']=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0x1e},{'wch':0xc},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0xc},{'wch':0xc},{'wch':0x12},{'wch':0x12}];const _0x14a344=new Date()[_0x45e1ed(0x2ba)]()[_0x45e1ed(0x237)]('T')[0x0];XLSX[_0x45e1ed(0x147)](_0x1868ba,'Detergent_MACO_Report_'+_0x14a344+_0x45e1ed(0x267)),_0x248260['azpkc'](hideLoader),_0x248260['dNKDN'](showCustomAlert,_0x248260['ZJOpH'],_0x248260[_0x45e1ed(0x6c)]);})['catch'](_0x3364c8=>{const _0x30afd8=_0x45ab9d;console['error']('Error\x20exporting\x20Detergent\x20MACO\x20to\x20Excel:',_0x3364c8),_0x248260[_0x30afd8(0x131)](hideLoader),_0x248260['PRvEz'](showCustomAlert,'Error',_0x248260[_0x30afd8(0x2cc)]);});}export function exportTrainSummaryToExcel(_0x6bfa3a='all'){const _0x1ce477=a13_0x5d3211,_0x5ec74c={'tutSE':function(_0x12f7e9,_0x6b7257){return _0x12f7e9!==_0x6b7257;},'OSJDn':_0x1ce477(0x95),'DvjFu':function(_0x45946b){return _0x45946b();},'LDMcV':function(_0xd6b022,_0x2fad7c){return _0xd6b022===_0x2fad7c;},'jKmQW':function(_0x469545,_0x3bc4b8,_0xd44444){return _0x469545(_0x3bc4b8,_0xd44444);},'jGIIW':function(_0x31a4b9,_0x595bac){return _0x31a4b9===_0x595bac;},'cwqYH':'No\x20Data','Lbgze':'No\x20trains\x20match\x20the\x20selected\x20criteria.','uoQjx':_0x1ce477(0x235),'AHkTL':_0x1ce477(0x1a1),'AFCSl':_0x1ce477(0xe3),'IqGeX':_0x1ce477(0xa7),'trKPp':_0x1ce477(0x2a6),'BhZqK':_0x1ce477(0x1f7),'xyixq':_0x1ce477(0x198),'YMnQM':function(_0x1d5ba6){return _0x1d5ba6();},'IwXBQ':_0x1ce477(0x68),'xwSDJ':_0x1ce477(0x170),'mhxZs':_0x1ce477(0xc3)};showLoader(),import(_0x5ec74c[_0x1ce477(0x74)])[_0x1ce477(0x173)](_0x53c97d=>{const _0x5975f0=_0x1ce477,_0x3c9689={'sebbc':_0x5ec74c['OSJDn']},{getTrainData:_0x596d5b}=_0x53c97d,_0x151d45=_0x5ec74c['DvjFu'](_0x596d5b);if(_0x5ec74c[_0x5975f0(0x107)](0x0,_0x151d45[_0x5975f0(0x288)]))return hideLoader(),void _0x5ec74c[_0x5975f0(0xa9)](showCustomAlert,_0x5975f0(0x2b1),'There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.');let _0x429e7c=_0x151d45;if(_0x5ec74c[_0x5975f0(0x1e7)](_0x5975f0(0xa7),_0x6bfa3a)&&(_0x429e7c=Array[_0x5975f0(0x28a)](_0x6bfa3a)?_0x151d45['filter'](_0xbf42c7=>_0x6bfa3a[_0x5975f0(0x1ce)](String(_0xbf42c7['id']))):_0x151d45['filter'](_0x4e20a4=>String(_0x4e20a4['id'])===String(_0x6bfa3a))),_0x5ec74c[_0x5975f0(0x1e2)](0x0,_0x429e7c[_0x5975f0(0x288)]))return hideLoader(),void _0x5ec74c[_0x5975f0(0xa9)](showCustomAlert,_0x5ec74c[_0x5975f0(0x284)],_0x5ec74c['Lbgze']);const _0x9021c8=[];_0x429e7c[_0x5975f0(0x1c1)](_0x4753b9=>{const _0x52c52b=_0x5975f0,_0x35609c=_0x4753b9[_0x52c52b(0x15a)]['map'](_0x1fa3a5=>{const _0x29e1dd=_0x52c52b,_0x39bcef=a13_0x529504['machines'][_0x29e1dd(0xfa)](_0x4c3598=>_0x4c3598['id']===_0x1fa3a5);return _0x39bcef||{'id':_0x1fa3a5,'name':_0x29e1dd(0x29c)+_0x1fa3a5+')','machineNumber':_0x3c9689[_0x29e1dd(0xc0)]};}),_0x9ab696=_0x4753b9[_0x52c52b(0x15a)][_0x52c52b(0xd3)](_0x1c35cb=>{const _0x237819=_0x52c52b,_0x44330e=a13_0x529504[_0x237819(0x16b)][_0x237819(0xfa)](_0x9b03d1=>_0x9b03d1['id']===_0x1c35cb);return _0x44330e?_0x44330e[_0x237819(0x263)]:'Unknown\x20(ID:\x20'+_0x1c35cb+')';})['join'](',\x20'),_0xbdf4ab=_0x4753b9['products'][_0x52c52b(0xd3)](_0x130818=>_0x130818[_0x52c52b(0x2ad)]+_0x52c52b(0x25a)+_0x130818[_0x52c52b(0x263)])[_0x52c52b(0x26f)](';\x20'),_0x1f3da6=_0x4753b9[_0x52c52b(0x17d)]['map'](_0x265192=>_0x265192[_0x52c52b(0x2ad)]+':\x20'+_0x265192[_0x52c52b(0x263)])[_0x52c52b(0x26f)]('\x0a'),_0x5f1a23=_0x35609c[_0x52c52b(0xd3)](_0x526a2f=>_0x526a2f[_0x52c52b(0x236)]+':\x20'+_0x526a2f[_0x52c52b(0x263)])[_0x52c52b(0x26f)]('\x0a');_0x9021c8[_0x52c52b(0x1c7)]({'Train\x20ID':'T'+_0x4753b9['id'],'Products\x20Count':_0x4753b9[_0x52c52b(0x17d)][_0x52c52b(0x288)],'Machines\x20Count':_0x35609c[_0x52c52b(0x288)],'Total\x20Area\x20(ESSA)\x20cm²':_0x4753b9['essa']['toLocaleString'](),'Products\x20(Code\x20-\x20Name)':_0xbdf4ab,'Machines\x20(Number\x20-\x20Name)':_0x9ab696,'Products\x20Detailed':_0x1f3da6,'Machines\x20Detailed':_0x5f1a23,'Min\x20Batch\x20Size\x20(kg)':_0x4753b9['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x4753b9[_0x52c52b(0x6d)][_0x52c52b(0x102)](0x2),'Assumed\x20SSA\x20(cm²)':_0x4753b9['assumedSsa'],'Lowest\x20LTD\x20(mg)':_0x4753b9[_0x52c52b(0x69)],'Lowest\x20PDE\x20(mg)':_0x5ec74c['tutSE'](null,_0x4753b9[_0x52c52b(0x1ef)])?_0x4753b9[_0x52c52b(0x1ef)]:_0x52c52b(0x95),'Worst\x20RPN\x20Product':_0x4753b9[_0x52c52b(0x238)]?_0x4753b9['worstProductRpn'][_0x52c52b(0xf4)]+'\x20('+_0x4753b9[_0x52c52b(0x238)][_0x52c52b(0x14b)]+')\x20-\x20RPN:\x20'+_0x4753b9[_0x52c52b(0x238)]['rpn']:_0x5ec74c[_0x52c52b(0x139)]});});const _0x2c8928=XLSX[_0x5975f0(0x126)]['json_to_sheet'](_0x9021c8),_0x3b6011=XLSX[_0x5975f0(0x126)][_0x5975f0(0x8d)]();XLSX[_0x5975f0(0x126)][_0x5975f0(0x169)](_0x3b6011,_0x2c8928,_0x5ec74c[_0x5975f0(0x1a5)]),_0x2c8928[_0x5ec74c[_0x5975f0(0x17a)]]=[{'wch':0xa},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x3c},{'wch':0x3c},{'wch':0x28},{'wch':0x28},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32}];const _0x1ead07=new Date()['toISOString']()[_0x5975f0(0x237)]('T')[0x0];let _0xb0dfc8=_0x5ec74c[_0x5975f0(0x1a3)];if(_0x5ec74c[_0x5975f0(0x19a)]!==_0x6bfa3a){if(Array[_0x5975f0(0x28a)](_0x6bfa3a))_0xb0dfc8+=_0x5975f0(0x2cd)+_0x6bfa3a['sort']((_0x4fbd4c,_0x4e156c)=>_0x4fbd4c-_0x4e156c)['join']('_');else _0xb0dfc8+=_0x5975f0(0x1c5)+_0x6bfa3a;}_0xb0dfc8+='_'+_0x1ead07+_0x5975f0(0x267),XLSX[_0x5975f0(0x147)](_0x3b6011,_0xb0dfc8),_0x5ec74c['DvjFu'](hideLoader),_0x5ec74c['jKmQW'](showCustomAlert,_0x5ec74c[_0x5975f0(0x188)],_0x5ec74c[_0x5975f0(0x25b)]);})[_0x1ce477(0x1b7)](_0x1fd0bf=>{const _0x3c40d1=_0x1ce477;console[_0x3c40d1(0x172)](_0x5ec74c['xyixq'],_0x1fd0bf),_0x5ec74c[_0x3c40d1(0x103)](hideLoader),_0x5ec74c['jKmQW'](showCustomAlert,_0x5ec74c[_0x3c40d1(0x1b3)],_0x5ec74c[_0x3c40d1(0x1b5)]);});}export function exportSummaryToExcel(){const _0x422d6d=a13_0x5d3211,_0x5699c3={'aMHIY':function(_0x3d25bd,_0x2b8f37){return _0x3d25bd(_0x2b8f37);},'WvfUl':function(_0xd44b65,_0x540970){return _0xd44b65>_0x540970;},'ovPDl':_0x422d6d(0x95),'XHdNK':function(_0xdb9395,_0x4061f2){return _0xdb9395!==_0x4061f2;},'EVsfY':_0x422d6d(0x207),'sDgMc':function(_0xa140e6,_0x59f32c){return _0xa140e6===_0x59f32c;},'XkxhS':function(_0xc6f2e6,_0x49e33d,_0x599b83){return _0xc6f2e6(_0x49e33d,_0x599b83);},'oBqIU':_0x422d6d(0x2b1),'xGvFx':_0x422d6d(0x191),'LRMzO':function(_0x510076,_0x3beeec){return _0x510076>_0x3beeec;},'ZfnGn':'!cols','FFMOW':'Top\x2010\x20RPN','UQxnW':function(_0x3c06dc,_0x53ea4d){return _0x3c06dc>_0x53ea4d;},'fcmVM':_0x422d6d(0x251),'IvnMd':_0x422d6d(0xd1),'lguga':function(_0x478cc0,_0x55be88,_0x16bdbe){return _0x478cc0(_0x55be88,_0x16bdbe);},'tWvnV':_0x422d6d(0x2a6),'JytsI':_0x422d6d(0x13e),'MMOdf':_0x422d6d(0x23b),'yHZwb':function(_0x383dee){return _0x383dee();},'USUza':_0x422d6d(0x68),'IKwVz':'Failed\x20to\x20export\x20Summary\x20report\x20data\x20to\x20Excel.','ejlFr':_0x422d6d(0xc3)};showLoader(),import(_0x5699c3[_0x422d6d(0x255)])[_0x422d6d(0x173)](_0x378a6f=>{const _0x524c14=_0x422d6d,{getProductTrainId:_0x3c5d9f,calculateScores:_0x217b88}=_0x378a6f,_0x3fcb86=a13_0x529504[_0x524c14(0x17d)][_0x524c14(0x271)](_0x3be7f2=>{const _0x4db797=_0x524c14,_0xe4625=_0x3c5d9f(_0x3be7f2);return _0x3be7f2['activeIngredients'][_0x4db797(0xd3)](_0xfc548a=>({'productName':_0x3be7f2[_0x4db797(0x263)],'productCode':_0x3be7f2[_0x4db797(0x2ad)],'ingredientName':_0xfc548a['name'],'rpn':_0x217b88(_0xfc548a)[_0x4db797(0x88)],'trainId':_0x4db797(0x95)!==_0xe4625?'T'+_0xe4625:_0x4db797(0x95),'scores':_0x217b88(_0xfc548a)}));})[_0x524c14(0x254)]((_0x56c4ce,_0x23b3eb)=>_0x23b3eb['rpn']-_0x56c4ce[_0x524c14(0x88)])['slice'](0x0,0xa),_0x4a2174=a13_0x529504['products']['filter'](_0x4370d4=>_0x4370d4[_0x524c14(0x86)]);if(_0x5699c3[_0x524c14(0x2b5)](0x0,_0x3fcb86[_0x524c14(0x288)])&&_0x5699c3[_0x524c14(0x2b5)](0x0,_0x4a2174[_0x524c14(0x288)]))return hideLoader(),void _0x5699c3['XkxhS'](showCustomAlert,_0x5699c3[_0x524c14(0xd7)],_0x5699c3['xGvFx']);const _0x8b88b6=XLSX[_0x524c14(0x126)][_0x524c14(0x8d)]();if(_0x5699c3['LRMzO'](_0x3fcb86[_0x524c14(0x288)],0x0)){const _0x2b6230=_0x3fcb86[_0x524c14(0xd3)]((_0xacfe27,_0x47ed8a)=>({'Rank':_0x47ed8a+0x1,'Product\x20Code':_0xacfe27[_0x524c14(0x2ad)],'Product\x20Name':_0xacfe27['productName'],'Train':_0xacfe27[_0x524c14(0x292)],'Ingredient':_0xacfe27[_0x524c14(0x14b)],'RPN':_0xacfe27[_0x524c14(0x88)]})),_0x38a6b4=XLSX[_0x524c14(0x126)][_0x524c14(0x124)](_0x2b6230),_0x347e21=[{'wch':0x8},{'wch':0xf},{'wch':0x1e},{'wch':0xa},{'wch':0x19},{'wch':0x8}];_0x38a6b4[_0x5699c3['ZfnGn']]=_0x347e21,XLSX[_0x524c14(0x126)][_0x524c14(0x169)](_0x8b88b6,_0x38a6b4,_0x5699c3[_0x524c14(0xe6)]);}if(_0x5699c3['UQxnW'](_0x4a2174[_0x524c14(0x288)],0x0)){const _0x3c9e80=_0x4a2174[_0x524c14(0xd3)](_0x1449b9=>({'Product\x20Code':_0x1449b9[_0x524c14(0x2ad)],'Product\x20Name':_0x1449b9['name'],'Product\x20Type':_0x1449b9[_0x524c14(0x209)],'Batch\x20Size\x20(kg)':_0x1449b9[_0x524c14(0xeb)],'MDD\x20(mg)':_0x1449b9[_0x524c14(0xfc)],'Critical\x20Reason':_0x1449b9['criticalReason']||_0x524c14(0x214),'Train':'N/A'!==_0x3c5d9f(_0x1449b9)?'T'+_0x3c5d9f(_0x1449b9):_0x524c14(0x95)})),_0x3c3676=XLSX[_0x524c14(0x126)][_0x524c14(0x124)](_0x3c9e80),_0x1594d2=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32},{'wch':0xa}];_0x3c3676[_0x5699c3[_0x524c14(0x25d)]]=_0x1594d2,XLSX['utils'][_0x524c14(0x169)](_0x8b88b6,_0x3c3676,_0x5699c3[_0x524c14(0x2b9)]);}const _0x5ba788=a13_0x529504[_0x524c14(0x17d)][_0x524c14(0xd3)](_0x37bf28=>{const _0x4a81d4=_0x524c14,_0x3d0fae={'dAuad':function(_0x3e696e,_0x5cc22f){return _0x5699c3['aMHIY'](_0x3e696e,_0x5cc22f);},'LOdln':function(_0x32b2a3,_0x249cd6){return _0x5699c3['WvfUl'](_0x32b2a3,_0x249cd6);}},_0x40b967=_0x3c5d9f(_0x37bf28),_0x3d9cc2=_0x37bf28[_0x4a81d4(0x197)][_0x4a81d4(0x1da)]((_0x1250ca,_0x44de6b)=>{const _0xd82010=_0x4a81d4,_0xae6945=_0x3d0fae[_0xd82010(0xbe)](_0x217b88,_0x44de6b)[_0xd82010(0x88)];return _0x3d0fae[_0xd82010(0x280)](_0xae6945,_0x1250ca['rpn'])?{..._0x44de6b,'rpn':_0xae6945}:_0x1250ca;},{'rpn':0x0,'name':_0x5699c3['ovPDl']});return{'Product\x20Code':_0x37bf28[_0x4a81d4(0x2ad)],'Product\x20Name':_0x37bf28[_0x4a81d4(0x263)],'Product\x20Type':_0x37bf28[_0x4a81d4(0x209)],'Batch\x20Size\x20(kg)':_0x37bf28[_0x4a81d4(0xeb)],'MDD\x20(mg)':_0x37bf28[_0x4a81d4(0xfc)],'Train':_0x5699c3[_0x4a81d4(0x201)](_0x5699c3[_0x4a81d4(0xc7)],_0x40b967)?'T'+_0x40b967:_0x5699c3[_0x4a81d4(0xc7)],'Is\x20Critical':_0x37bf28[_0x4a81d4(0x86)]?_0x5699c3[_0x4a81d4(0x273)]:'No','Critical\x20Reason':_0x37bf28[_0x4a81d4(0x1e9)]||_0x5699c3[_0x4a81d4(0xc7)],'Ingredients\x20Count':_0x37bf28[_0x4a81d4(0x197)]['length'],'Highest\x20RPN\x20Ingredient':_0x3d9cc2['name'],'Highest\x20RPN\x20Value':_0x3d9cc2[_0x4a81d4(0x88)]||0x0};}),_0x4aa586=XLSX[_0x524c14(0x126)][_0x524c14(0x124)](_0x5ba788);_0x4aa586[_0x5699c3['ZfnGn']]=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xa},{'wch':0xa},{'wch':0x28},{'wch':0xc},{'wch':0x19},{'wch':0xc}],XLSX[_0x524c14(0x126)][_0x524c14(0x169)](_0x8b88b6,_0x4aa586,_0x5699c3[_0x524c14(0xa5)]);const _0x57d9ab=new Date()[_0x524c14(0x2ba)]()['split']('T')[0x0];XLSX[_0x524c14(0x147)](_0x8b88b6,_0x524c14(0x177)+_0x57d9ab+_0x524c14(0x267)),hideLoader(),_0x5699c3['lguga'](showCustomAlert,_0x5699c3['tWvnV'],_0x5699c3[_0x524c14(0x144)]);})['catch'](_0x2fa1a3=>{const _0xbf4d5f=_0x422d6d;console['error'](_0x5699c3['MMOdf'],_0x2fa1a3),_0x5699c3[_0xbf4d5f(0x1a6)](hideLoader),showCustomAlert(_0x5699c3[_0xbf4d5f(0x2cf)],_0x5699c3[_0xbf4d5f(0x12e)]);});}export function exportAllTabsToExcel(){const _0x3e8cab=a13_0x5d3211,_0x4e4804={'vzGGA':function(_0x2324d0,_0x47d48c){return _0x2324d0!==_0x47d48c;},'vVVmH':function(_0x5ee6ec,_0x534af5){return _0x5ee6ec(_0x534af5);},'RUHjE':function(_0x1a0f3f,_0x27985d){return _0x1a0f3f(_0x27985d);},'VxPqm':_0x3e8cab(0x95),'lrdTk':function(_0x2ecf81,_0x59f3a6){return _0x2ecf81!==_0x59f3a6;},'RITtX':_0x3e8cab(0x207),'GRjel':_0x3e8cab(0x22e),'Ljnfw':function(_0x59eba4,_0x58726c){return _0x59eba4/_0x58726c;},'mPJEm':function(_0x2e650b,_0x55549a){return _0x2e650b===_0x55549a;},'MAoMA':_0x3e8cab(0x274),'NUjjC':_0x3e8cab(0x200),'HvMIi':function(_0x5c138c,_0x19a968){return _0x5c138c===_0x19a968;},'znHHL':function(_0x2c4f00,_0x4d7e13){return _0x2c4f00*_0x4d7e13;},'eXXIA':function(_0x3aa083,_0x95a867){return _0x3aa083*_0x95a867;},'wcQWD':_0x3e8cab(0x241),'ESTVR':function(_0x434187,_0xb4f21f){return _0x434187===_0xb4f21f;},'clDtU':_0x3e8cab(0x225),'rHjtC':_0x3e8cab(0xe1),'IKIjF':function(_0x2555a1,_0x42943c){return _0x2555a1>_0x42943c;},'XOBWD':function(_0x52982d,_0x491b31){return _0x52982d!==_0x491b31;},'AqRRS':function(_0x59423f,_0x2b4469){return _0x59423f*_0x2b4469;},'ONXyK':function(_0x5965d7,_0x3b4bf9){return _0x5965d7*_0x3b4bf9;},'thPAm':function(_0x15aa15,_0x14056a){return _0x15aa15>_0x14056a;},'WkrQv':function(_0x9c5516,_0x188c8b){return _0x9c5516/_0x188c8b;},'cKuRH':function(_0x1f74e5,_0x4eb73f){return _0x1f74e5*_0x4eb73f;},'IthDU':function(_0x319504,_0x328410){return _0x319504===_0x328410;},'NEkty':function(_0x202789){return _0x202789();},'plUDj':function(_0x3c5e3f,_0x1369e5,_0x2b3bed){return _0x3c5e3f(_0x1369e5,_0x2b3bed);},'PJlKw':_0x3e8cab(0x2b1),'DwaGq':_0x3e8cab(0x257),'YgNQR':_0x3e8cab(0x7e),'tUFTd':_0x3e8cab(0xb1),'ceiQz':function(_0x27a02f,_0x3a1a02){return _0x27a02f>_0x3a1a02;},'lZrAX':_0x3e8cab(0x123),'IrxRZ':_0x3e8cab(0x132),'YJBnH':_0x3e8cab(0x203),'AJcXZ':_0x3e8cab(0xe9),'VQGDw':'Error\x20creating\x20Train\x20Summary\x20sheet:','apyVC':_0x3e8cab(0x1a9),'QlzHN':'Critical\x20Products','XxCLf':_0x3e8cab(0xd1),'rntRY':_0x3e8cab(0x1d5),'VBFXB':_0x3e8cab(0x14e),'Ieljc':_0x3e8cab(0x10d),'ucdrO':function(_0x41e003){return _0x41e003();},'cwEow':_0x3e8cab(0x2a6),'EYgVD':_0x3e8cab(0x106),'hhPQb':function(_0x352f6a){return _0x352f6a();},'zVaqi':function(_0x4f8c43,_0x552b85,_0xa7f1f5){return _0x4f8c43(_0x552b85,_0xa7f1f5);},'KnbiL':_0x3e8cab(0x68),'PFiUq':'Failed\x20to\x20export\x20complete\x20report\x20to\x20Excel.','BPYzV':function(_0x4c11e6){return _0x4c11e6();},'AiAGL':_0x3e8cab(0xc3)};_0x4e4804[_0x3e8cab(0x100)](showLoader),import(_0x4e4804[_0x3e8cab(0x1a4)])[_0x3e8cab(0x173)](_0xf0202=>{const _0x126ac7=_0x3e8cab,_0x5345e4={'POEzp':_0x4e4804[_0x126ac7(0x84)],'tNtWY':function(_0x124a9a,_0x164781){return _0x124a9a(_0x164781);},'Ioxvk':function(_0x1df8f1,_0x475ae7){return _0x1df8f1/_0x475ae7;},'XDCAK':function(_0x3c066e,_0x3b20f4){return _0x3c066e*_0x3b20f4;},'FKUzP':function(_0x55c2d3,_0x295c69){return _0x4e4804['Ljnfw'](_0x55c2d3,_0x295c69);},'YIYWz':function(_0x3627c9,_0xa71cb5){const _0x797e03=_0x126ac7;return _0x4e4804[_0x797e03(0x21c)](_0x3627c9,_0xa71cb5);},'MmOoX':_0x4e4804[_0x126ac7(0x152)],'JnrZP':_0x4e4804['NUjjC'],'XyZGY':function(_0x512508,_0x3781e6){const _0x4a59ab=_0x126ac7;return _0x4e4804[_0x4a59ab(0x15c)](_0x512508,_0x3781e6);},'EjgHm':function(_0x4a9bd3,_0x54fa5d){const _0x1a0724=_0x126ac7;return _0x4e4804[_0x1a0724(0x9b)](_0x4a9bd3,_0x54fa5d);},'wHSCu':function(_0xc0006a,_0x1032ee){return _0xc0006a!==_0x1032ee;},'Zzncb':function(_0x48c10c,_0x3d239a){return _0x48c10c*_0x3d239a;},'rGXsz':function(_0x4b3dcb,_0xf041a2){const _0x27e9ff=_0x126ac7;return _0x4e4804[_0x27e9ff(0x2a8)](_0x4b3dcb,_0xf041a2);},'mSNNv':function(_0x1ef82d,_0xf48c3a){const _0x439134=_0x126ac7;return _0x4e4804[_0x439134(0x121)](_0x1ef82d,_0xf48c3a);},'fgdED':function(_0x193d9c,_0x434110){return _0x193d9c*_0x434110;},'iWTUB':function(_0x1808bd,_0x569f1b,_0x585d16){return _0x1808bd(_0x569f1b,_0x585d16);},'tlNFV':_0x126ac7(0x105),'OQoJU':_0x4e4804['wcQWD'],'KlIsc':function(_0x182a37,_0x1955a3){const _0xfbbfbd=_0x126ac7;return _0x4e4804[_0xfbbfbd(0x153)](_0x182a37,_0x1955a3);},'LEhYR':_0x4e4804[_0x126ac7(0xaf)],'kseQE':_0x126ac7(0x26b),'UByNa':_0x4e4804[_0x126ac7(0x13b)],'vKKaV':function(_0x410b01,_0x58331e){const _0x23502a=_0x126ac7;return _0x4e4804[_0x23502a(0x29d)](_0x410b01,_0x58331e);},'CFqNg':function(_0x3a6087,_0x448cf0){const _0x454975=_0x126ac7;return _0x4e4804[_0x454975(0x2c7)](_0x3a6087,_0x448cf0);},'ePLIK':function(_0x5219ad,_0x4318da){return _0x5219ad==_0x4318da;},'FhkYo':function(_0x22becd,_0xaf83f8){const _0x58ab51=_0x126ac7;return _0x4e4804[_0x58ab51(0x232)](_0x22becd,_0xaf83f8);},'nxXhk':function(_0x27ab5f,_0x20cf37){const _0x3567d8=_0x126ac7;return _0x4e4804[_0x3567d8(0x2a8)](_0x27ab5f,_0x20cf37);},'wOdHH':function(_0x4252b6,_0x362fa0){const _0x401c6c=_0x126ac7;return _0x4e4804[_0x401c6c(0x174)](_0x4252b6,_0x362fa0);},'Dufru':function(_0x28b45b,_0x249e0a){return _0x4e4804['ONXyK'](_0x28b45b,_0x249e0a);},'dXDET':function(_0x2172ef,_0x8cdf9f){const _0x4037b5=_0x126ac7;return _0x4e4804[_0x4037b5(0x13a)](_0x2172ef,_0x8cdf9f);},'pkvhU':function(_0x53aff2,_0x100328){const _0x1a936a=_0x126ac7;return _0x4e4804[_0x1a936a(0x223)](_0x53aff2,_0x100328);},'XRtNU':function(_0x43c88d,_0x1ef176){const _0x110cfb=_0x126ac7;return _0x4e4804[_0x110cfb(0x6f)](_0x43c88d,_0x1ef176);},'RMtrs':function(_0x337033,_0x592fc5){const _0x44a690=_0x126ac7;return _0x4e4804[_0x44a690(0x1a0)](_0x337033,_0x592fc5);}},{getTrainData:_0x2676f3,getWorstCaseProductType:_0x4f950c,getProductTrainId:_0x244615,calculateScores:_0x29e549}=_0xf0202,_0x70e4e9=_0x2676f3();if(_0x4e4804[_0x126ac7(0x1a8)](0x0,_0x70e4e9[_0x126ac7(0x288)]))return _0x4e4804[_0x126ac7(0xee)](hideLoader),void _0x4e4804[_0x126ac7(0x79)](showCustomAlert,_0x4e4804[_0x126ac7(0x298)],_0x4e4804[_0x126ac7(0x17c)]);const _0x991d19=XLSX[_0x126ac7(0x126)][_0x126ac7(0x8d)]();try{const _0x51a63f=[];_0x70e4e9[_0x126ac7(0x1c1)](_0x3c092a=>{const _0x2d9427=_0x126ac7,_0x178da4={'VNzuL':function(_0x1aaeec,_0x445706){return _0x1aaeec||_0x445706;},'IhSlk':_0x5345e4[_0x2d9427(0x77)]},_0x5ca0de=_0x5345e4[_0x2d9427(0xf5)](_0x4f950c,_0x3c092a['products'][_0x2d9427(0xd3)](_0x966e57=>_0x966e57['productType'])),_0x5e6782=(a13_0x529504[_0x2d9427(0xf9)][_0x5ca0de]||a13_0x529504[_0x2d9427(0xf9)][_0x2d9427(0x1ea)])[_0x2d9427(0x85)],_0x2ed247=_0x5345e4[_0x2d9427(0x2a0)](_0x5345e4[_0x2d9427(0xd0)](_0x3c092a['lowestLtd'],_0x3c092a[_0x2d9427(0x6d)]),_0x5e6782),_0x58d066=_0x5345e4[_0x2d9427(0xd0)](0xa,_0x3c092a[_0x2d9427(0x2c6)]);let _0x70d1ea=_0x5345e4['FKUzP'](0x1,0x0),_0x34568b=_0x5345e4['FKUzP'](0x1,0x0);const _0x538fe4=_0x5345e4[_0x2d9427(0x11f)](_0x5345e4['MmOoX'],localStorage[_0x2d9427(0x130)](_0x2d9427(0x18c))),_0x41d41e=_0x5345e4[_0x2d9427(0x11f)](_0x5345e4['MmOoX'],localStorage['getItem'](_0x5345e4[_0x2d9427(0x113)]));if(_0x5345e4[_0x2d9427(0x145)](null,_0x3c092a['lowestPde'])||_0x538fe4||(_0x70d1ea=_0x5345e4[_0x2d9427(0x1b4)](_0x3c092a['lowestPde'],_0x3c092a[_0x2d9427(0x6d)])),_0x5345e4[_0x2d9427(0x204)](null,_0x3c092a[_0x2d9427(0x23e)])&&!_0x41d41e){const _0x3fa069=_0x5345e4['Ioxvk'](_0x5345e4['Zzncb'](0x46,_0x3c092a[_0x2d9427(0x23e)]),0x7d0),_0xbefcff=_0x3c092a[_0x2d9427(0x17d)][_0x2d9427(0x271)](_0x2ed217=>_0x2ed217[_0x2d9427(0x197)][_0x2d9427(0xd3)](_0x49905a=>_0x49905a['mdd']/0x3e8)),_0x2e6195=Math[_0x2d9427(0xe5)](..._0xbefcff);_0x34568b=_0x5345e4[_0x2d9427(0xb0)](_0x5345e4[_0x2d9427(0xdf)](_0x5345e4[_0x2d9427(0x7c)](_0x3fa069,_0x3c092a['minMbsKg']),0x3e8),_0x5e6782*_0x2e6195);}const _0x969e0b=_0x5345e4[_0x2d9427(0xa2)](getLargestEssaForLineAndDosageForm,_0x3c092a,_0x70e4e9),_0x28adc0=0.004*_0x969e0b,_0x3b038a=[{'name':_0x5345e4[_0x2d9427(0xcd)],'value':_0x2ed247},{'name':_0x5345e4[_0x2d9427(0xe7)],'value':_0x58d066}];_0x5345e4[_0x2d9427(0x2b2)](null,_0x3c092a[_0x2d9427(0x1ef)])||_0x538fe4||_0x3b038a[_0x2d9427(0x1c7)]({'name':_0x5345e4[_0x2d9427(0x23f)],'value':_0x70d1ea}),_0x5345e4[_0x2d9427(0x2b2)](null,_0x3c092a['lowestLd50'])||_0x41d41e||_0x3b038a['push']({'name':_0x5345e4['kseQE'],'value':_0x34568b}),_0x3b038a[_0x2d9427(0x1c7)]({'name':_0x5345e4[_0x2d9427(0x22b)],'value':_0x28adc0});const _0x3a1ce2=_0x3b038a['reduce']((_0x1d95b7,_0x507844)=>_0x507844['value']<_0x1d95b7[_0x2d9427(0x299)]?_0x507844:_0x1d95b7),_0x35f324=_0x3a1ce2[_0x2d9427(0x299)],_0x166aa8=_0x5345e4[_0x2d9427(0x7a)](_0x969e0b,0x0)?_0x35f324/_0x969e0b:0x0,_0x26bf28=_0x5345e4[_0x2d9427(0x1b4)](_0x166aa8,_0x3c092a[_0x2d9427(0x23d)]),_0x2ccbf2=_0x3c092a[_0x2d9427(0x15a)]['map'](_0x2ab32c=>{const _0x2fe8ed=_0x2d9427,_0x34ad03=a13_0x529504[_0x2fe8ed(0x16b)][_0x2fe8ed(0xfa)](_0x1d5bc7=>_0x1d5bc7['id']===_0x2ab32c);return _0x178da4[_0x2fe8ed(0x15e)](_0x34ad03,{'name':'Unknown\x20(ID:\x20'+_0x2ab32c+')','machineNumber':_0x178da4[_0x2fe8ed(0x27e)]});}),_0x3c650c=_0x3c092a[_0x2d9427(0x15a)][_0x2d9427(0xd3)](_0x230b2f=>{const _0x1200b2=_0x2d9427,_0x5fe1a1=a13_0x529504[_0x1200b2(0x16b)][_0x1200b2(0xfa)](_0x127223=>_0x127223['id']===_0x230b2f);return _0x5fe1a1?_0x5fe1a1['name']:_0x1200b2(0x29c)+_0x230b2f+')';})[_0x2d9427(0x26f)](',\x20'),_0x3e7b21=_0x3c092a[_0x2d9427(0x17d)][_0x2d9427(0xd3)](_0xf3a76a=>_0xf3a76a[_0x2d9427(0x2ad)]+_0x2d9427(0x25a)+_0xf3a76a[_0x2d9427(0x263)])[_0x2d9427(0x26f)](';\x20'),_0x5bd2e2=_0x3c092a['worstProductRpn']?_0x3c092a[_0x2d9427(0x238)][_0x2d9427(0xf4)]+'\x20('+_0x3c092a[_0x2d9427(0x238)][_0x2d9427(0x14b)]+_0x2d9427(0x22a)+_0x3c092a[_0x2d9427(0x238)][_0x2d9427(0x88)]:_0x5345e4[_0x2d9427(0x77)];_0x51a63f[_0x2d9427(0x1c7)]({'Train':'T'+_0x3c092a['id'],'Total\x20Products':_0x3c092a[_0x2d9427(0x17d)][_0x2d9427(0x288)],'Total\x20Machines':_0x2ccbf2['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x3c092a[_0x2d9427(0x1ad)][_0x2d9427(0x109)](),'Products':_0x3e7b21,'Machines':_0x3c650c,'Worst-Case\x20Dosage\x20Form':_0x5ca0de,'Safety\x20Factor':_0x5e6782,'Lowest\x20LTD\x20(mg)':_0x3c092a[_0x2d9427(0x69)],'Min\x20Batch\x20Size\x20(kg)':_0x3c092a[_0x2d9427(0x2c6)],'Min\x20BS/MDD\x20Ratio':_0x3c092a[_0x2d9427(0x6d)]['toFixed'](0x2),'Lowest\x20PDE\x20(mg)':_0x5345e4[_0x2d9427(0x286)](null,_0x3c092a[_0x2d9427(0x1ef)])?_0x3c092a[_0x2d9427(0x1ef)]:_0x5345e4[_0x2d9427(0x77)],'Worst-Case\x20Product\x20(by\x20RPN)':_0x5bd2e2,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x2ed247[_0x2d9427(0x102)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x58d066[_0x2d9427(0x102)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x5345e4[_0x2d9427(0x20b)](_0x2d9427(0x294),typeof _0x70d1ea)?_0x70d1ea[_0x2d9427(0x102)](0x2):_0x5345e4[_0x2d9427(0x77)],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x28adc0[_0x2d9427(0x102)](0x2),'Selected\x20MACO\x20Method':_0x3a1ce2[_0x2d9427(0x263)],'Final\x20MACO\x20(mg)':_0x35f324[_0x2d9427(0x102)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x166aa8[_0x2d9427(0x76)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x26bf28['toFixed'](0x4)});});const _0x4bc6eb=XLSX[_0x126ac7(0x126)][_0x126ac7(0x124)](_0x51a63f);XLSX[_0x126ac7(0x126)][_0x126ac7(0x169)](_0x991d19,_0x4bc6eb,_0x4e4804['YgNQR']);}catch(_0x277abc){console[_0x126ac7(0x172)](_0x4e4804[_0x126ac7(0x166)],_0x277abc);}try{if(_0x4e4804[_0x126ac7(0x278)](a13_0x529504[_0x126ac7(0x270)]['length'],0x0)){const _0xe88a1=parseFloat(document[_0x126ac7(0x119)](_0x4e4804[_0x126ac7(0x70)])?.['value'])||0x46,_0xc145f9=a13_0x529504[_0x126ac7(0x270)][_0x126ac7(0xd3)](_0x164eee=>parseFloat(_0x164eee[_0x126ac7(0x1db)]))[_0x126ac7(0x178)](_0x5aedd6=>!isNaN(_0x5aedd6)),_0x5c8427=_0x4e4804[_0x126ac7(0x29d)](_0xc145f9[_0x126ac7(0x288)],0x0)?Math[_0x126ac7(0xe5)](..._0xc145f9):0x0,_0xbe66b9=a13_0x529504[_0x126ac7(0x270)][_0x126ac7(0xd3)](_0x3683ef=>_0x3683ef[_0x126ac7(0x263)])[_0x126ac7(0x178)](_0x1c180d=>''!==_0x1c180d[_0x126ac7(0x67)]())['join'](',\x20'),_0x2e776a=[];_0x70e4e9[_0x126ac7(0x1c1)](_0x24e44a=>{const _0x131917=_0x126ac7,_0xb2acf1={'WkzWo':function(_0x127ede,_0x236abd){return _0x127ede||_0x236abd;}},_0x4237ad=_0x5345e4[_0x131917(0x24d)](_0x4f950c,_0x24e44a['products'][_0x131917(0xd3)](_0x2d3e74=>_0x2d3e74[_0x131917(0x209)])),_0x4df9ea=a13_0x529504['safetyFactorConfig'][_0x4237ad]||a13_0x529504[_0x131917(0xf9)]['Other'],_0x557cc2=document['getElementById']('sf-input-train-'+_0x24e44a['id']),_0x36c293=_0x557cc2&&parseFloat(_0x557cc2[_0x131917(0x299)])||_0x4df9ea[_0x131917(0x85)],_0x11793c=_0x5345e4['nxXhk'](_0x5345e4['wOdHH'](_0x5345e4['Zzncb'](0.0005,_0x5c8427),_0xe88a1),_0x36c293),_0x1a1b17=_0x5345e4[_0x131917(0xa4)](_0x11793c,_0x24e44a[_0x131917(0x6d)]),_0x35aeb1=getLargestEssaForLineAndDosageForm(_0x24e44a,_0x70e4e9),_0x2a9a0d=_0x5345e4[_0x131917(0x190)](_0x35aeb1,0x0)?_0x5345e4[_0x131917(0x20f)](_0x1a1b17,_0x35aeb1):0x0,_0x282fa4=_0x5345e4['XRtNU'](_0x2a9a0d,_0x24e44a[_0x131917(0x23d)]),_0x59e989=_0x24e44a['machineIds']['map'](_0x4579b4=>{const _0x43bb85=_0x131917,_0x14b279=a13_0x529504[_0x43bb85(0x16b)][_0x43bb85(0xfa)](_0x256028=>_0x256028['id']===_0x4579b4);return _0xb2acf1['WkzWo'](_0x14b279,{'name':_0x43bb85(0x29c)+_0x4579b4+')','machineNumber':'N/A'});}),_0x3c8026=_0x24e44a[_0x131917(0x15a)][_0x131917(0xd3)](_0x175986=>{const _0x3e8530=_0x131917,_0x36256d=a13_0x529504['machines']['find'](_0x264f18=>_0x264f18['id']===_0x175986);return _0x36256d?_0x36256d[_0x3e8530(0x263)]:_0x3e8530(0x29c)+_0x175986+')';})[_0x131917(0x26f)](',\x20'),_0x2706a1=_0x24e44a[_0x131917(0x17d)]['map'](_0x262adc=>_0x262adc['productCode']+'\x20-\x20'+_0x262adc['name'])[_0x131917(0x26f)](';\x20'),_0x3d9325=_0x24e44a[_0x131917(0x238)]?_0x24e44a[_0x131917(0x238)][_0x131917(0xf4)]+'\x20('+_0x24e44a[_0x131917(0x238)][_0x131917(0x14b)]+_0x131917(0x22a)+_0x24e44a[_0x131917(0x238)][_0x131917(0x88)]:_0x5345e4[_0x131917(0x77)];_0x2e776a[_0x131917(0x1c7)]({'Train':'T'+_0x24e44a['id'],'Total\x20Products':_0x24e44a[_0x131917(0x17d)]['length'],'Total\x20Machines':_0x59e989['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x24e44a[_0x131917(0x1ad)][_0x131917(0x109)](),'Products':_0x2706a1,'Machines':_0x3c8026,'Worst-Case\x20Dosage\x20Form':_0x4237ad,'Safety\x20Factor\x20Range':_0x4df9ea[_0x131917(0xe5)]+'\x20-\x20'+_0x4df9ea[_0x131917(0x85)],'Applied\x20Safety\x20Factor':_0x36c293,'Detergent\x20Ingredients':_0xbe66b9,'Body\x20Weight\x20(kg)':_0xe88a1,'Minimum\x20LD50\x20(mg/kg)':_0x5c8427,'Min\x20Batch\x20Size\x20(kg)':_0x24e44a[_0x131917(0x2c6)],'Min\x20BS/MDD\x20Ratio':_0x24e44a[_0x131917(0x6d)][_0x131917(0x102)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x3d9325,'ADI\x20(mg)':_0x11793c[_0x131917(0x102)](0x4),'MACO\x20(mg)':_0x1a1b17[_0x131917(0x102)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x2a9a0d[_0x131917(0x76)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x282fa4[_0x131917(0x102)](0x4)});});const _0x4c12da=XLSX['utils'][_0x126ac7(0x124)](_0x2e776a);XLSX[_0x126ac7(0x126)][_0x126ac7(0x169)](_0x991d19,_0x4c12da,_0x4e4804['IrxRZ']);}}catch(_0x52ffc5){console[_0x126ac7(0x172)](_0x4e4804[_0x126ac7(0x277)],_0x52ffc5);}try{const _0x245c6f=[];_0x70e4e9[_0x126ac7(0x1c1)](_0x289a0e=>{const _0x706b2=_0x126ac7,_0x4958c8=_0x289a0e[_0x706b2(0x15a)][_0x706b2(0xd3)](_0x3cce66=>{const _0x58a7d1=_0x706b2,_0x5afe56=a13_0x529504['machines'][_0x58a7d1(0xfa)](_0x5eed76=>_0x5eed76['id']===_0x3cce66);return _0x5afe56||{'id':_0x3cce66,'name':_0x58a7d1(0x29c)+_0x3cce66+')','machineNumber':_0x5345e4[_0x58a7d1(0x77)]};}),_0x278a2e=_0x289a0e[_0x706b2(0x15a)][_0x706b2(0xd3)](_0x32b2e0=>{const _0x544f85=_0x706b2,_0xf52d86=a13_0x529504['machines'][_0x544f85(0xfa)](_0x2c5264=>_0x2c5264['id']===_0x32b2e0);return _0xf52d86?_0xf52d86[_0x544f85(0x263)]:_0x544f85(0x29c)+_0x32b2e0+')';})['join'](',\x20'),_0x5cb821=_0x289a0e[_0x706b2(0x17d)][_0x706b2(0xd3)](_0x46ec0c=>_0x46ec0c[_0x706b2(0x2ad)]+_0x706b2(0x25a)+_0x46ec0c[_0x706b2(0x263)])[_0x706b2(0x26f)](';\x20'),_0x344f35=_0x289a0e['products'][_0x706b2(0xd3)](_0x241a8b=>_0x241a8b[_0x706b2(0x2ad)]+':\x20'+_0x241a8b[_0x706b2(0x263)])[_0x706b2(0x26f)]('\x0a'),_0x4e0dc1=_0x4958c8['map'](_0x4f8190=>_0x4f8190[_0x706b2(0x236)]+':\x20'+_0x4f8190[_0x706b2(0x263)])[_0x706b2(0x26f)]('\x0a');_0x245c6f[_0x706b2(0x1c7)]({'Train\x20ID':'T'+_0x289a0e['id'],'Products\x20Count':_0x289a0e[_0x706b2(0x17d)][_0x706b2(0x288)],'Machines\x20Count':_0x4958c8[_0x706b2(0x288)],'Total\x20Area\x20(ESSA)\x20cm²':_0x289a0e[_0x706b2(0x1ad)][_0x706b2(0x109)](),'Products\x20(Code\x20-\x20Name)':_0x5cb821,'Machines\x20(Number\x20-\x20Name)':_0x278a2e,'Products\x20Detailed':_0x344f35,'Machines\x20Detailed':_0x4e0dc1,'Min\x20Batch\x20Size\x20(kg)':_0x289a0e[_0x706b2(0x2c6)],'Min\x20BS/MDD\x20Ratio':_0x289a0e['minBsMddRatio'][_0x706b2(0x102)](0x2),'Assumed\x20SSA\x20(cm²)':_0x289a0e['assumedSsa'],'Lowest\x20LTD\x20(mg)':_0x289a0e[_0x706b2(0x69)],'Lowest\x20PDE\x20(mg)':_0x4e4804[_0x706b2(0x108)](null,_0x289a0e[_0x706b2(0x1ef)])?_0x289a0e['lowestPde']:_0x706b2(0x95),'Worst\x20RPN\x20Product':_0x289a0e[_0x706b2(0x238)]?_0x289a0e[_0x706b2(0x238)][_0x706b2(0xf4)]+'\x20('+_0x289a0e[_0x706b2(0x238)][_0x706b2(0x14b)]+')\x20-\x20RPN:\x20'+_0x289a0e[_0x706b2(0x238)][_0x706b2(0x88)]:_0x706b2(0x95)});});const _0x22b961=XLSX['utils'][_0x126ac7(0x124)](_0x245c6f);XLSX[_0x126ac7(0x126)][_0x126ac7(0x169)](_0x991d19,_0x22b961,_0x4e4804[_0x126ac7(0x12a)]);}catch(_0xef510b){console[_0x126ac7(0x172)](_0x4e4804[_0x126ac7(0x243)],_0xef510b);}try{const _0x500831=a13_0x529504[_0x126ac7(0x17d)][_0x126ac7(0x271)](_0x24e4c8=>{const _0x5dd53b=_0x126ac7,_0x3b1aa7=_0x244615(_0x24e4c8);return _0x24e4c8['activeIngredients'][_0x5dd53b(0xd3)](_0xcf93a=>({'productName':_0x24e4c8[_0x5dd53b(0x263)],'productCode':_0x24e4c8[_0x5dd53b(0x2ad)],'ingredientName':_0xcf93a[_0x5dd53b(0x263)],'rpn':_0x29e549(_0xcf93a)['rpn'],'trainId':_0x5dd53b(0x95)!==_0x3b1aa7?'T'+_0x3b1aa7:_0x5dd53b(0x95)}));})[_0x126ac7(0x254)]((_0x3baa19,_0x3ce8ad)=>_0x3ce8ad[_0x126ac7(0x88)]-_0x3baa19['rpn'])[_0x126ac7(0x2ca)](0x0,0xa);if(_0x4e4804['ceiQz'](_0x500831[_0x126ac7(0x288)],0x0)){const _0x830188=_0x500831[_0x126ac7(0xd3)]((_0x280972,_0x462643)=>({'Rank':_0x462643+0x1,'Product\x20Code':_0x280972[_0x126ac7(0x2ad)],'Product\x20Name':_0x280972[_0x126ac7(0xf4)],'Train':_0x280972[_0x126ac7(0x292)],'Ingredient':_0x280972[_0x126ac7(0x14b)],'RPN':_0x280972[_0x126ac7(0x88)]})),_0x5762f4=XLSX[_0x126ac7(0x126)][_0x126ac7(0x124)](_0x830188);XLSX[_0x126ac7(0x126)][_0x126ac7(0x169)](_0x991d19,_0x5762f4,_0x4e4804[_0x126ac7(0x16a)]);}}catch(_0x54fc17){console[_0x126ac7(0x172)](_0x126ac7(0x279),_0x54fc17);}try{const _0x20269a=a13_0x529504[_0x126ac7(0x17d)][_0x126ac7(0x178)](_0x31d392=>_0x31d392[_0x126ac7(0x86)]);if(_0x20269a[_0x126ac7(0x288)]>0x0){const _0x3a6318=_0x20269a['map'](_0x5eb47e=>({'Product\x20Code':_0x5eb47e['productCode'],'Product\x20Name':_0x5eb47e['name'],'Product\x20Type':_0x5eb47e['productType'],'Batch\x20Size\x20(kg)':_0x5eb47e['batchSizeKg'],'MDD\x20(mg)':_0x5eb47e['mddMg'],'Critical\x20Reason':_0x5eb47e[_0x126ac7(0x1e9)]||_0x126ac7(0x214),'Train':_0x126ac7(0x95)!==_0x244615(_0x5eb47e)?'T'+_0x244615(_0x5eb47e):_0x126ac7(0x95)})),_0x5bf727=XLSX[_0x126ac7(0x126)][_0x126ac7(0x124)](_0x3a6318);XLSX[_0x126ac7(0x126)]['book_append_sheet'](_0x991d19,_0x5bf727,_0x4e4804[_0x126ac7(0x234)]);}}catch(_0x1f2f0c){console[_0x126ac7(0x172)](_0x126ac7(0x187),_0x1f2f0c);}try{const _0x41c602=a13_0x529504[_0x126ac7(0x17d)][_0x126ac7(0xd3)](_0x3f1f92=>{const _0x3c4c7a=_0x126ac7,_0x549237={'OLFgS':function(_0x3637cd,_0x5e20c7){const _0x71edb9=a13_0x144a;return _0x4e4804[_0x71edb9(0x232)](_0x3637cd,_0x5e20c7);}},_0x23de0b=_0x4e4804['RUHjE'](_0x244615,_0x3f1f92),_0x451967=_0x3f1f92[_0x3c4c7a(0x197)][_0x3c4c7a(0x1da)]((_0x17df67,_0x107cdf)=>{const _0x343a48=_0x3c4c7a,_0x1b805b=_0x549237[_0x343a48(0x227)](_0x29e549,_0x107cdf)['rpn'];return _0x1b805b>_0x17df67[_0x343a48(0x88)]?{..._0x107cdf,'rpn':_0x1b805b}:_0x17df67;},{'rpn':0x0,'name':_0x4e4804[_0x3c4c7a(0x84)]});return{'Product\x20Code':_0x3f1f92[_0x3c4c7a(0x2ad)],'Product\x20Name':_0x3f1f92[_0x3c4c7a(0x263)],'Product\x20Type':_0x3f1f92[_0x3c4c7a(0x209)],'Batch\x20Size\x20(kg)':_0x3f1f92[_0x3c4c7a(0xeb)],'MDD\x20(mg)':_0x3f1f92[_0x3c4c7a(0xfc)],'Train':_0x4e4804[_0x3c4c7a(0x155)](_0x4e4804['VxPqm'],_0x23de0b)?'T'+_0x23de0b:_0x4e4804['VxPqm'],'Is\x20Critical':_0x3f1f92[_0x3c4c7a(0x86)]?_0x4e4804['RITtX']:'No','Critical\x20Reason':_0x3f1f92['criticalReason']||_0x3c4c7a(0x95),'Ingredients\x20Count':_0x3f1f92['activeIngredients'][_0x3c4c7a(0x288)],'Highest\x20RPN\x20Ingredient':_0x451967[_0x3c4c7a(0x263)],'Highest\x20RPN\x20Value':_0x451967[_0x3c4c7a(0x88)]||0x0};}),_0x4fa807=XLSX['utils'][_0x126ac7(0x124)](_0x41c602);XLSX['utils'][_0x126ac7(0x169)](_0x991d19,_0x4fa807,_0x4e4804[_0x126ac7(0xd9)]);}catch(_0x3d7ce5){console['error'](_0x4e4804[_0x126ac7(0x1fb)],_0x3d7ce5);}try{const _0x4cedfd=[];a13_0x529504[_0x126ac7(0x17d)][_0x126ac7(0x1c1)](_0x4b9a6d=>{const _0x4c22cc=_0x126ac7,_0x440df8=_0x4e4804['RUHjE'](_0x244615,_0x4b9a6d),_0x2d289e={'Product\x20Code':_0x4b9a6d[_0x4c22cc(0x2ad)],'Product\x20Name':_0x4b9a6d['name'],'Product\x20Type':_0x4b9a6d[_0x4c22cc(0x209)],'Batch\x20Size\x20(kg)':_0x4b9a6d[_0x4c22cc(0xeb)],'MDD\x20(mg)':_0x4b9a6d[_0x4c22cc(0xfc)],'Train':_0x4e4804[_0x4c22cc(0x108)](_0x4e4804[_0x4c22cc(0x84)],_0x440df8)?'T'+_0x440df8:_0x4c22cc(0x95),'Is\x20Critical':_0x4b9a6d[_0x4c22cc(0x86)]?'Yes':'No','Critical\x20Reason':_0x4b9a6d[_0x4c22cc(0x1e9)]||_0x4e4804[_0x4c22cc(0x84)],'Ingredient\x20Type':_0x4e4804[_0x4c22cc(0x29b)],'Ingredient\x20Name':'','LTD\x20(mg)':'','PDE\x20(mg)':'','LD50\x20(mg/kg)':'','Severity':'','Occurrence':'','Detection':'','RPN':''};_0x4cedfd['push'](_0x2d289e),_0x4b9a6d[_0x4c22cc(0x197)]['forEach'](_0x4a039a=>{const _0x252e2b=_0x4c22cc,_0x6849c4=_0x5345e4[_0x252e2b(0x1e1)](_0x29e549,_0x4a039a);_0x4cedfd['push']({'Product\x20Code':'','Product\x20Name':'','Product\x20Type':'','Batch\x20Size\x20(kg)':'','MDD\x20(mg)':'','Train':'','Is\x20Critical':'','Critical\x20Reason':'','Ingredient\x20Type':_0x252e2b(0x242),'Ingredient\x20Name':_0x4a039a[_0x252e2b(0x263)],'LTD\x20(mg)':_0x4a039a[_0x252e2b(0x24c)]||_0x5345e4[_0x252e2b(0x77)],'PDE\x20(mg)':_0x4a039a[_0x252e2b(0xbf)]||_0x252e2b(0x95),'LD50\x20(mg/kg)':_0x4a039a['ld50']||_0x5345e4[_0x252e2b(0x77)],'Severity':_0x6849c4[_0x252e2b(0x1f9)],'Occurrence':_0x6849c4[_0x252e2b(0x28c)],'Detection':_0x6849c4[_0x252e2b(0x1f4)],'RPN':_0x6849c4[_0x252e2b(0x88)]});});});const _0x4e6304=XLSX[_0x126ac7(0x126)][_0x126ac7(0x124)](_0x4cedfd);XLSX[_0x126ac7(0x126)]['book_append_sheet'](_0x991d19,_0x4e6304,_0x4e4804[_0x126ac7(0x1d4)]);}catch(_0x222b4f){console[_0x126ac7(0x172)](_0x4e4804[_0x126ac7(0x2b8)],_0x222b4f);}const _0x3b1250=new Date()['toISOString']()[_0x126ac7(0x237)]('T')[0x0];XLSX['writeFile'](_0x991d19,_0x126ac7(0x2c4)+_0x3b1250+_0x126ac7(0x267)),_0x4e4804['ucdrO'](hideLoader),_0x4e4804[_0x126ac7(0x79)](showCustomAlert,_0x4e4804[_0x126ac7(0x1cc)],_0x4e4804['EYgVD']);})[_0x3e8cab(0x1b7)](_0x14ac2e=>{const _0x35ddae=_0x3e8cab;console[_0x35ddae(0x172)](_0x35ddae(0x22c),_0x14ac2e),_0x4e4804['hhPQb'](hideLoader),_0x4e4804[_0x35ddae(0x1cd)](showCustomAlert,_0x4e4804['KnbiL'],_0x4e4804[_0x35ddae(0x27f)]);});}export function toggleStageSection(_0x654537){const _0x9fe2ea=a13_0x5d3211,_0x413889={'DpxFC':function(_0x173f89,_0x3bf503){return _0x173f89===_0x3bf503;},'ZnBzk':_0x9fe2ea(0x1fe),'DcKDD':_0x9fe2ea(0x154),'NlETq':_0x9fe2ea(0x117)},_0x6c2c5a=document['getElementById'](_0x9fe2ea(0x75)+_0x654537),_0x5c176e=_0x413889[_0x9fe2ea(0x297)](_0x413889['ZnBzk'],_0x6c2c5a[_0x9fe2ea(0x249)][_0x9fe2ea(0xa3)]);_0x6c2c5a[_0x9fe2ea(0x249)][_0x9fe2ea(0xa3)]=_0x5c176e?'':'none',localStorage[_0x9fe2ea(0x73)](_0x9fe2ea(0x1a7)+_0x654537+'-hidden',!_0x5c176e);const _0x3639ef=_0x6c2c5a[_0x9fe2ea(0x181)][_0x9fe2ea(0x71)](_0x413889['DcKDD']);_0x3639ef&&(_0x3639ef['textContent']=_0x5c176e?_0x413889[_0x9fe2ea(0x1e3)]:_0x9fe2ea(0x16c));}