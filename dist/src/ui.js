const a16_0x74705c=a16_0x37a5;(function(_0x28da84,_0xbbe20f){const _0x1d0068=a16_0x37a5,_0x57895f=_0x28da84();while(!![]){try{const _0x2fe18f=parseInt(_0x1d0068(0x1aa))/0x1*(parseInt(_0x1d0068(0x1c2))/0x2)+-parseInt(_0x1d0068(0x1dd))/0x3+-parseInt(_0x1d0068(0x275))/0x4+parseInt(_0x1d0068(0x2c3))/0x5*(-parseInt(_0x1d0068(0x36c))/0x6)+parseInt(_0x1d0068(0x28d))/0x7+parseInt(_0x1d0068(0x1d4))/0x8+-parseInt(_0x1d0068(0x185))/0x9*(-parseInt(_0x1d0068(0x388))/0xa);if(_0x2fe18f===_0xbbe20f)break;else _0x57895f['push'](_0x57895f['shift']());}catch(_0x5d3204){_0x57895f['push'](_0x57895f['shift']());}}}(a16_0x5263,0xb3c8b));import*as a16_0x1d463c from'./state.js';import{fullAppRender as a16_0x165ed8}from'./app.js';import{generateTrainMap as a16_0x4c8b40,getTrainIdToLineNumberMap as a16_0x56e423,getProductTrainNumber as a16_0x22d264}from'./utils.js';import{toggleScoringEditMode as a16_0x33e4df}from'./scoringView.js';import{renderRpnChart as a16_0x48c9ee}from'./worstCaseView.js';import{renderMacoChart as a16_0x4b6615}from'./dashboardView.js';const c=document[a16_0x74705c(0x23c)](a16_0x74705c(0x2a4));export const showLoader=()=>c['style']['display']=a16_0x74705c(0x37e);export const hideLoader=()=>c[a16_0x74705c(0x227)][a16_0x74705c(0x1c9)]=a16_0x74705c(0x295);export function showCustomAlert(_0x37eae6,_0x5dfbe5){const _0x526fc3=a16_0x74705c,_0x369359={'SZfxF':_0x526fc3(0x1e9),'SvDVA':_0x526fc3(0x19d),'tcWdl':_0x526fc3(0x1ae),'eQsCZ':_0x526fc3(0x37e)};document[_0x526fc3(0x23c)](_0x369359[_0x526fc3(0x207)])[_0x526fc3(0x30f)]=_0x37eae6,document[_0x526fc3(0x23c)](_0x369359[_0x526fc3(0x204)])[_0x526fc3(0x30f)]=_0x5dfbe5,document['getElementById'](_0x369359[_0x526fc3(0x261)])[_0x526fc3(0x227)][_0x526fc3(0x1c9)]=_0x369359['eQsCZ'];}export const hideModal=_0x2c8d0b=>document[a16_0x74705c(0x23c)](_0x2c8d0b)[a16_0x74705c(0x227)][a16_0x74705c(0x1c9)]=a16_0x74705c(0x295);export const showModal=_0x6c3952=>document[a16_0x74705c(0x23c)](_0x6c3952)[a16_0x74705c(0x227)]['display']=a16_0x74705c(0x37e);export function saveAllDataToLocalStorage(){const _0x1ba191=a16_0x74705c,_0x2c2347={'MuUOv':_0x1ba191(0x148),'lRGHW':'macoMachines','BPFrz':_0x1ba191(0x29e),'tAqwE':'macoDetergentIngredients','qnVkt':_0x1ba191(0x218),'pdSGE':_0x1ba191(0x322),'ornpq':function(_0x1519e6,_0x5875f8,_0x342c90){return _0x1519e6(_0x5875f8,_0x342c90);},'XeKTo':_0x1ba191(0x277)};try{localStorage[_0x1ba191(0x32b)](_0x2c2347[_0x1ba191(0x264)],JSON[_0x1ba191(0x30d)](a16_0x1d463c['products'])),localStorage[_0x1ba191(0x32b)](_0x2c2347['lRGHW'],JSON[_0x1ba191(0x30d)](a16_0x1d463c[_0x1ba191(0x292)])),localStorage[_0x1ba191(0x32b)](_0x2c2347[_0x1ba191(0x377)],JSON['stringify'](a16_0x1d463c[_0x1ba191(0x2de)])),localStorage['setItem'](_0x2c2347['tAqwE'],JSON[_0x1ba191(0x30d)](a16_0x1d463c[_0x1ba191(0x2f8)])),localStorage['setItem'](_0x2c2347[_0x1ba191(0x16d)],JSON[_0x1ba191(0x30d)](a16_0x1d463c[_0x1ba191(0x218)]));}catch(_0x5da92f){console[_0x1ba191(0x191)](_0x2c2347[_0x1ba191(0x129)],_0x5da92f),_0x2c2347[_0x1ba191(0x21e)](showCustomAlert,_0x1ba191(0x248),_0x2c2347[_0x1ba191(0x149)]);}}export function loadAllDataFromLocalStorage(){const _0x560a78=a16_0x74705c,_0x594661={'xSzPg':'macoProducts','RgjCX':_0x560a78(0x218),'zQYLk':_0x560a78(0x1e0),'CyQYI':_0x560a78(0x139),'HegDP':_0x560a78(0x165),'xpqpf':'Error\x20loading\x20machine\x20stage\x20order'},_0x52fa42=localStorage[_0x560a78(0x31f)](_0x594661['xSzPg']),_0x5a17ae=localStorage[_0x560a78(0x31f)](_0x560a78(0x24d)),_0x1e61e3=localStorage[_0x560a78(0x31f)]('macoScoringCriteria'),_0x38104c=localStorage[_0x560a78(0x31f)](_0x560a78(0x297)),_0x2a295d=localStorage[_0x560a78(0x31f)](_0x594661['RgjCX']);if(_0x52fa42)try{a16_0x1d463c[_0x560a78(0x29a)](JSON[_0x560a78(0x15a)](_0x52fa42));}catch(_0x5a6a39){console[_0x560a78(0x191)](_0x594661['zQYLk'],_0x5a6a39);}if(_0x5a17ae)try{a16_0x1d463c['setMachines'](JSON[_0x560a78(0x15a)](_0x5a17ae));}catch(_0xd3fbbf){console[_0x560a78(0x191)](_0x560a78(0x316),_0xd3fbbf);}if(_0x1e61e3)try{a16_0x1d463c[_0x560a78(0x2b6)](JSON['parse'](_0x1e61e3));}catch(_0x173ff0){console[_0x560a78(0x191)](_0x594661[_0x560a78(0x317)],_0x173ff0);}if(_0x38104c)try{a16_0x1d463c['setDetergentIngredients'](JSON[_0x560a78(0x15a)](_0x38104c));}catch(_0x359347){console[_0x560a78(0x191)](_0x594661['HegDP'],_0x359347);}if(_0x2a295d)try{a16_0x1d463c[_0x560a78(0x2ac)](JSON['parse'](_0x2a295d));}catch(_0x3c1e17){console[_0x560a78(0x191)](_0x594661[_0x560a78(0x2bb)],_0x3c1e17);}}export function saveStateForUndo(){const _0x23b022=a16_0x74705c,_0x476a0a={'LCQvP':function(_0x521efa){return _0x521efa();}};_0x476a0a['LCQvP'](a16_0x4c8b40);const _0x40f392=a16_0x1d463c[_0x23b022(0x347)][_0x23b022(0x350)](0x0,a16_0x1d463c[_0x23b022(0x1ed)]+0x1),_0x9fe499={'products':JSON[_0x23b022(0x15a)](JSON['stringify'](a16_0x1d463c['products'])),'machines':JSON[_0x23b022(0x15a)](JSON[_0x23b022(0x30d)](a16_0x1d463c[_0x23b022(0x292)])),'scoringCriteria':JSON[_0x23b022(0x15a)](JSON[_0x23b022(0x30d)](a16_0x1d463c[_0x23b022(0x2de)])),'detergentIngredients':JSON[_0x23b022(0x15a)](JSON['stringify'](a16_0x1d463c[_0x23b022(0x2f8)]))};_0x40f392['push'](_0x9fe499),a16_0x1d463c['setHistory'](_0x40f392,_0x40f392[_0x23b022(0x182)]-0x1),_0x476a0a[_0x23b022(0x26d)](updateUndoRedoButtons),saveAllDataToLocalStorage();}export function updateUndoRedoButtons(){const _0x1bc05e=a16_0x74705c,_0x145acf={'PHkne':_0x1bc05e(0x2ae),'GxavP':_0x1bc05e(0x171),'FFRNy':function(_0x3a9a2f,_0x247d56){return _0x3a9a2f<=_0x247d56;},'ULnWT':function(_0x28694c,_0x23409e){return _0x28694c>=_0x23409e;}},_0x40321e=document[_0x1bc05e(0x23c)](_0x145acf['PHkne']),_0x3079f8=document[_0x1bc05e(0x23c)](_0x145acf['GxavP']);_0x40321e&&(_0x40321e[_0x1bc05e(0x186)]=_0x145acf[_0x1bc05e(0x253)](a16_0x1d463c['historyIndex'],0x0)),_0x3079f8&&(_0x3079f8[_0x1bc05e(0x186)]=_0x145acf['ULnWT'](a16_0x1d463c[_0x1bc05e(0x1ed)],a16_0x1d463c[_0x1bc05e(0x347)][_0x1bc05e(0x182)]-0x1));}export function undoChange(){const _0x6a7756=a16_0x74705c,_0x4718a9={'ZuKOs':function(_0x5670b8,_0x224d71){return _0x5670b8>_0x224d71;},'IcCmw':function(_0x76eb11,_0x5b989d){return _0x76eb11-_0x5b989d;}};if(_0x4718a9[_0x6a7756(0x1d0)](a16_0x1d463c[_0x6a7756(0x1ed)],0x0)){const _0x235c15=_0x4718a9[_0x6a7756(0x17a)](a16_0x1d463c[_0x6a7756(0x1ed)],0x1),_0x321100=a16_0x1d463c[_0x6a7756(0x347)][_0x235c15];a16_0x1d463c[_0x6a7756(0x29a)](JSON[_0x6a7756(0x15a)](JSON[_0x6a7756(0x30d)](_0x321100[_0x6a7756(0x175)]))),a16_0x1d463c[_0x6a7756(0x19e)](JSON[_0x6a7756(0x15a)](JSON[_0x6a7756(0x30d)](_0x321100['machines']))),a16_0x1d463c[_0x6a7756(0x2b6)](JSON['parse'](JSON[_0x6a7756(0x30d)](_0x321100[_0x6a7756(0x2de)]))),a16_0x1d463c[_0x6a7756(0x2ea)](JSON[_0x6a7756(0x15a)](JSON[_0x6a7756(0x30d)](_0x321100['detergentIngredients']))),a16_0x1d463c[_0x6a7756(0x1e2)](a16_0x1d463c[_0x6a7756(0x347)],_0x235c15),a16_0x1d463c[_0x6a7756(0x1bb)]&&a16_0x33e4df(!0x1),a16_0x165ed8(),updateUndoRedoButtons(),saveAllDataToLocalStorage();}}function a16_0x5263(){const _0x2e1045=['split','customAlertTitle','TnvKN','collapsed','dbMLI','historyIndex','readAsText','MNlNq','SzQvA','UAjyr','JXGKy','.xlsx','vbwlh','fXfJm','.toggle-pde','vcdPL','kgRbN','stage','print','Product\x20Register','flatMap','Failed\x20to\x20export\x20Detergent\x20MACO\x20data\x20to\x20Excel.','gsJeH','There\x20are\x20no\x20products\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','NQzFU','bQuWq','removeChild','gFGpt','SvDVA','startsWith','HbJeG','SZfxF','activeIngredients','PLGpN','Other','xYTDE','MACO_Worst_Case_Products','sf-input-train-','Hide\x20MACO\x20Calculation\x20Breakdown','Udtgi','_Train_','criticalReason','macoChartInstance','rmrHV','EXwDL','hide-ld50','QJYnN','Detergent\x20MACO\x20Report','machineStageDisplayOrder','snjJq','WbSwO','filter','ovckB','ZHyeq','ornpq','Visual\x20Clean\x20Limit','JsmsP','uyesk','KBOPX','FttQJ','Show','-pdeHidden','qOzIM','style','Error\x20loading\x20train\x20summary:\x20','MCrGB','zjnQp','yauNN','DIIag','Product_MACO_Report','hOYao','hide-','IOWMp','WrjZG','No\x20reason\x20provided','toLocaleDateString','Show\x20MACO\x20Calculation\x20Breakdown','hEntN','uJGuc','tyzdK','There\x20are\x20no\x20machines\x20to\x20export.','XjLQO','JxDSd','PRODUCT','getElementById','vQvuU','classList','EbobM','\x20.mainTable,\x20#','jIcTQ','toISOString','Complete_MACO_Report_','awxPz','Error\x20creating\x20Train\x20Summary\x20sheet:','worstProductRpn','book_append_sheet','Save\x20Error','JsqGA','Failed\x20to\x20export\x20complete\x20report\x20to\x20Excel.','WuVac','dizYS','macoMachines','LYhGL','productName','OmCtd','productRegister-pdeHidden','target','FFRNy','all','Hide','FLZLq','JGLIH','find','QSZKi','UHFId','UDTEp','lowestLd50','rhVYi','IQTtY','UlbgJ','kQfuB','tcWdl','bMmtY','productType','MuUOv','pwddp','Summary\x20report\x20data\x20exported\x20to\x20Excel\x20successfully!','eNuDE','jwgXr','\x20-\x20Worst\x20Case\x20Analysis','#productRegister\x20.mainTable.hide-','cLWCn','Train_Summary_Report','LCQvP','JEugG','trainSummary','xIyiV','pde','lSKIm','ld50','PyxBd','2002652jiNBRg','JVMzy','Could\x20not\x20save\x20data.\x20Storage\x20might\x20be\x20full.','ZMrPT','#columnVisibilityDropdown','AvLIq','INGREDIENT','\x20not\x20found\x20or\x20has\x20no\x20products.','LmEvC','LaMht','appendChild','sortValue','content-pm-','\x20.ingredients-sub-table','LwYZb','Dmefo','ptRir','OxqmW','There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','RkqGb','ld50Score','vizNL','Error','pPhLP','7370909sUJRtg','./worstCaseView.js','\x20.train-content-inner','None','vckrz','machines','Container\x20display:','Error\x20exporting\x20Product\x20MACO\x20to\x20Excel:','none','Unknown\x20(ID:\x20','macoDetergentIngredients','QcEss','Error\x20creating\x20Detergent\x20MACO\x20sheet:','setProducts','fylMl','XKTlS','MbyEm','macoScoringCriteria','productRegister-','download','eWtjA','Health-Based\x20Limit\x20(PDE)','XUcDM','loader','osMJg','worstCaseProducts','Machines','renderRpnChart','add','mGjcf','kJKAC','setMachineStageDisplayOrder','vIeIw','undo-btn','pIkBt','YbZpW','ltiRA','LHnox','skkrw','GuTel','FGHUi','setScoringCriteria','QwCcY','trainSummaryContainer','SDToC','Muaae','xpqpf','MMtLX','puxDB','Machines\x20data\x20exported\x20to\x20Excel\x20successfully!','JXBdz','productRegister-ld50Hidden','osHCY','yDuKO','145170SadbMK','cnfVc','printSelectedTrain','LmuWl','Hide\x20LD50','lBDJr','toggle-pm-','eSple','./trainSummaryView.js','bvxVp','McwMZ','result','iDXlv','EQeyu','FZWeu','setScoringWasInEditModeForPrint','XQDfw','SURfo','eaHFD','Error\x20exporting\x20all\x20tabs\x20to\x20Excel:','qszoe','documentElement','UnUdz','DSUpZ','hnWyM','nlwrP','button','scoringCriteria','addEventListener','Error\x20loading\x20train\x20summary\x20view:','qydxL','Show\x20PDE','yZDye','jnrOy','slkdO','qybBw','NCEnI','hNrJc','lowestLtd','setDetergentIngredients','trainId','RRqcn','match','jUNUD','auoTX',')\x20-\x20RPN:\x20','rdyKf','Critical\x20Products','RRgwc','batchSizeKg','application/json','NsljK','renderMacoForTrains','detergentIngredients','utils','sf-input-train','Wruih','mddMg','XAFqV','Error\x20exporting\x20worst\x20case\x20to\x20Excel:','message','dyQKu','There\x20is\x20no\x20data\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','bExSc','cZtWh','reduce','click','Fbirt','FAJNB','TKkJQ','-hidden','sRDCk','\x20-\x20','required','stringify','N/A','textContent','fwmqq','oZWEy','wHMCu','Detergent\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','lnKSS','Klxmd','Error\x20loading\x20machines','CyQYI','TzYbM','Hidden','Train:','RpGFA',',\x20#','KAYZo','isArray','getItem','remove','SqEcu','Failed\x20to\x20save\x20data\x20to\x20localStorage','ZFICZ','Product\x20MACO\x20Report','Error\x20exporting\x20to\x20Excel:','content-dm-','closest','tEFXA','then','finally','setItem','Failed\x20to\x20export\x20machines\x20data\x20to\x20Excel.','xhuCe','QBThb','UpsOE','zGvIk','join','Error\x20creating\x20All\x20Products\x20sheet:','columnVisibilityDropdown','XcShi','MACO\x20Report','Printing\x20view:','GWhki','tmfsN','Train\x20summary\x20container\x20is\x20hidden\x20or\x20missing','ysPOq','renderDetergentMaco','NONqn','contains','alTWo','essa','warn','value','hidden','vFnaz','machineNumber','TMzOV','CGBXZ','history','lowestPde','!cols','TXWvp','book_new','keys','input','max','hZZMp','slice','qYxjL','includes','\x20.mainTable.hide-','hdybm','xErHB','rpnChartInstance','mxiNB','Error\x20creating\x20Product\x20MACO\x20sheet:','vKxvG','true','gYKao','bodyWeight','MXyeA','number','_Trains_','IsgfZ','ITYOT','solubilityScore','innerHTML','wMeAZ','EeFvU','MeKtd','KNgmQ','Worst\x20Case\x20Products','ltdMg','TuPtd','name','252CObzAc','Train\x20','toggle-','Failed\x20to\x20export\x20data\x20to\x20Excel.','HTJAu','PYUhT','get','osoqd','Yes','getLargestEssaForLineAndDosageForm','querySelector','BPFrz','forEach','wKymq','xKMaY','mdd','Hide\x20PDE','kgBNq','flex','productCode','ahZhi','eppdd','ryerv','removeEventListener','KyNEs','rFruY','pdeScore','RzHSE','10gtkJlx','zIxTG','GdJtL','pdSGE','TFRbq','therapeuticDoseScore','0.1%\x20Therapeutic\x20Dose','toLocaleString','WLMLb','QKbeb','sxYTN','dAGpR','NwkmP','haAmV','Container\x20has\x20content:','viewProducts','minBsMddRatio','HMini','dark','Error\x20loading\x20scoring\x20criteria','push','Error\x20creating\x20Product\x20Register\x20sheet:','button[onclick=\x22toggleColumnVisibilityDropdown()\x22]','writeFile','wnFqh','Trains\x20','hide-pde','toggle-dm-','WJZjF','MYfQA','YMlia','Failed\x20to\x20export\x20worst\x20case\x20data\x20to\x20Excel.','Failed\x20to\x20export\x20Product\x20MACO\x20data\x20to\x20Excel.','Sdtqn','macoProducts','XeKTo','querySelectorAll','LBfCz','dDzFf','uURJb','There\x20is\x20no\x20data\x20in\x20the\x20current\x20view\x20to\x20export.','TtnMK','CQuhn','HsFRb','Failed\x20to\x20parse\x20JSON\x20file.','sort','toFixed','Setting\x20printSelectedTrain\x20to:','printing-','Complete\x20report\x20with\x20all\x20tabs\x20exported\x20to\x20Excel\x20successfully!','vHsLw','TmTbs','parse','json_to_sheet','safetyFactorConfig','No\x20trains\x20match\x20the\x20selected\x20criteria.','WyzCy','wdcoK','bZyck','vbWlD','tiYwi','onload','MACO_Machines_','Error\x20loading\x20detergent\x20ingredients','dLGCC','Error\x20creating\x20Top\x2010\x20RPN\x20sheet:','dNHZO','No\x20trains\x20message\x20display:','TrDcm','jtYPV','CYySD','qnVkt','NemAZ','rZAeT','MACO_All_Products_Report.xlsx','redo-btn','qiVYW','assumedSsa','CTSsQ','products','breakdown-toggle-btn-','min','uUdTr','log','IcCmw','ZJNrk','toggle','IJJgv','occurrence','There\x20are\x20no\x20summary\x20data\x20to\x20export.\x20Add\x20products\x20and\x20ingredients\x20first.','Invalid\x20JSON\x20file\x20structure.','xOExS','length','Failed\x20to\x20export\x20Summary\x20report\x20data\x20to\x20Excel.','uNfvi','513261oNqHVW','disabled','map','jZIeJ','gchAY','catch','Error\x20exporting\x20Summary\x20to\x20Excel:','SeOEV','MACO_Summary_Report_','Cuknt','AqidS','./macoDetergentView.js','error','trim','LVpjP','renderWorstCaseByTrain','enMkG','dOieJ','VkHvE','SYiqg','Success','vGHAn','xuUsD','detergentMaco','customAlertMessage','setMachines','minMbsKg','toExponential','./utils.js','YkbOS','gTbgr','Top\x2010\x20RPN','whceT','fMHQJ','OXKTd','createObjectURL','HdjPu','384728NhasXS','ztlwt','riVuh','maco-breakdown-details-','customAlertModal','block','ingredientName','cleanabilityScore','isCritical','olgVI','Train\x20Summary\x20Report','ShBfh','HYgyq','kTXEG','Failed\x20to\x20export\x20data\x20to\x20JSON.','revokeObjectURL','Health-Based\x20Limit\x20(NOEL)','scoringInEditMode','files','ZpVEn','hvrTa','HODwa','kOIQf','VTjVD','4Ufaysj','xMGwj','rpnRatingText','productRegister','kOIKC','yprNk','date','display','LzzcM','machineIds','hMyZR','rpn','YGlLN','ltvVV','ZuKOs','Nipjb','No\x20Data','HnEey','9967760hrlXjU','All\x20Products','ppXku','LHzFx','PiEdF','DUHMp','OpbvP','aXmhK','10\x20ppm\x20Criterion','2006868zxedzy','bPIdR','therapeuticDose','Error\x20loading\x20products','rPTjN','setHistory','maco_data_export.json','PkNEV','body','vewjf','OLahC'];a16_0x5263=function(){return _0x2e1045;};return a16_0x5263();}export function redoChange(){const _0x220224=a16_0x74705c,_0x2c219d={'vfxee':function(_0x58e0b8,_0x3b0456){return _0x58e0b8<_0x3b0456;},'zoKmY':function(_0x5eba5f,_0x48bde6){return _0x5eba5f-_0x48bde6;},'sxYTN':function(_0x1ce56,_0x4ef683){return _0x1ce56+_0x4ef683;},'xYTDE':function(_0x4ad61c){return _0x4ad61c();}};if(_0x2c219d['vfxee'](a16_0x1d463c[_0x220224(0x1ed)],_0x2c219d['zoKmY'](a16_0x1d463c[_0x220224(0x347)][_0x220224(0x182)],0x1))){const _0x3307b7=_0x2c219d[_0x220224(0x130)](a16_0x1d463c[_0x220224(0x1ed)],0x1),_0x3ed970=a16_0x1d463c[_0x220224(0x347)][_0x3307b7];a16_0x1d463c[_0x220224(0x29a)](JSON[_0x220224(0x15a)](JSON['stringify'](_0x3ed970[_0x220224(0x175)]))),a16_0x1d463c[_0x220224(0x19e)](JSON[_0x220224(0x15a)](JSON[_0x220224(0x30d)](_0x3ed970[_0x220224(0x292)]))),a16_0x1d463c[_0x220224(0x2b6)](JSON['parse'](JSON[_0x220224(0x30d)](_0x3ed970['scoringCriteria']))),a16_0x1d463c[_0x220224(0x2ea)](JSON[_0x220224(0x15a)](JSON[_0x220224(0x30d)](_0x3ed970['detergentIngredients']))),a16_0x1d463c['setHistory'](a16_0x1d463c[_0x220224(0x347)],_0x3307b7),a16_0x1d463c[_0x220224(0x1bb)]&&a16_0x33e4df(!0x1),_0x2c219d['xYTDE'](a16_0x165ed8),_0x2c219d[_0x220224(0x20b)](updateUndoRedoButtons),_0x2c219d[_0x220224(0x20b)](saveAllDataToLocalStorage);}}export function toggleDarkMode(_0x1b5b2b){const _0x36267b=a16_0x74705c,_0x20521c={'wdcoK':'theme-toggle-dark-icon','GuTel':_0x36267b(0x138),'ptRir':_0x36267b(0x342)},_0x455420=document[_0x36267b(0x23c)]('theme-toggle-light-icon'),_0x56e2e2=document[_0x36267b(0x23c)](_0x20521c[_0x36267b(0x15f)]);_0x1b5b2b?(document['documentElement']['classList']['add'](_0x20521c[_0x36267b(0x2b4)]),_0x455420&&_0x455420[_0x36267b(0x23e)][_0x36267b(0x2a9)](_0x20521c[_0x36267b(0x285)]),_0x56e2e2&&_0x56e2e2[_0x36267b(0x23e)][_0x36267b(0x320)](_0x20521c[_0x36267b(0x285)])):(document[_0x36267b(0x2d8)]['classList'][_0x36267b(0x320)](_0x36267b(0x138)),_0x455420&&_0x455420['classList'][_0x36267b(0x320)]('hidden'),_0x56e2e2&&_0x56e2e2[_0x36267b(0x23e)][_0x36267b(0x2a9)](_0x20521c[_0x36267b(0x285)])),a16_0x1d463c[_0x36267b(0x356)]&&a16_0x48c9ee(),a16_0x1d463c[_0x36267b(0x212)]&&a16_0x4b6615();}export function printCurrentView(_0x182802,_0x2ad764='all'){const _0x30717a=a16_0x74705c,_0x1fb096={'NONqn':function(_0x3dfa4e,_0x46d729,_0x193af8){return _0x3dfa4e(_0x46d729,_0x193af8);},'zjnQp':_0x30717a(0x342),'WoidC':_0x30717a(0x20e),'ryerv':_0x30717a(0x234),'uJGuc':'#macoForTrains\x20.train-content.collapsed','McwMZ':'#macoForTrains\x20[id^=\x22maco-breakdown-details-\x22].hidden','PLGpN':_0x30717a(0x1eb),'OVriL':function(_0x1dc842,_0x2bdc9b,_0x26968f){return _0x1dc842(_0x2bdc9b,_0x26968f);},'ekYak':'Error\x20loading\x20detergent\x20view\x20for\x20print:','JsqGA':_0x30717a(0x190),'Muaae':_0x30717a(0x2b8),'MNlNq':'noTrainSummaryMessage','JVMzy':_0x30717a(0x293),'SeOEV':'not\x20found','osoqd':_0x30717a(0x169),'fuKJy':function(_0x5e4e08,_0xddc385){return _0x5e4e08>_0xddc385;},'bZyck':function(_0x2ff434,_0x21ca67){return _0x2ff434===_0x21ca67;},'QSZKi':'none','WyzCy':_0x30717a(0x339),'MQcTZ':function(_0x40c5c6,_0x1d9c1f,_0x274f79){return _0x40c5c6(_0x1d9c1f,_0x274f79);},'LmuWl':_0x30717a(0x2e0),'vckrz':function(_0x116ed7,_0x10ca8a){return _0x116ed7(_0x10ca8a);},'FttQJ':_0x30717a(0x228),'eNuDE':function(_0x2d957c,_0x332ad3){return _0x2d957c===_0x332ad3;},'rWRGE':'scoring-system','hdybm':_0x30717a(0x2a6),'uyesk':'macoForTrains','uUdTr':'./macoProductView.js','RkqGb':function(_0x441827,_0x145a67){return _0x441827===_0x145a67;},'rfuLb':_0x30717a(0x19c),'XKTlS':_0x30717a(0x26f),'dAGpR':_0x30717a(0x2cb)};_0x1fb096[_0x30717a(0x267)](_0x1fb096['rWRGE'],_0x182802)&&a16_0x1d463c[_0x30717a(0x1bb)]&&(a16_0x1d463c[_0x30717a(0x2d2)](!0x0),a16_0x33e4df(!0x1)),console['log'](_0x30717a(0x336),_0x182802,_0x30717a(0x31a),_0x2ad764),document[_0x30717a(0x1e5)][_0x30717a(0x23e)][_0x30717a(0x2a9)](_0x30717a(0x156)+_0x182802),_0x1fb096[_0x30717a(0x160)](_0x1fb096[_0x30717a(0x354)],_0x182802)?import(_0x30717a(0x28e))[_0x30717a(0x329)](_0x27c66e=>{const _0x31d073=_0x30717a;window[_0x31d073(0x2c5)]=_0x2ad764,_0x27c66e[_0x31d073(0x194)](),_0x1fb096[_0x31d073(0x33c)](setTimeout,()=>{window['print']();},0xc8);}):_0x1fb096[_0x30717a(0x221)]===_0x182802?(window[_0x30717a(0x2c5)]=_0x2ad764,import(_0x1fb096[_0x30717a(0x178)])[_0x30717a(0x329)](_0x90e166=>{const _0x3d6e4f=_0x30717a,_0xf4c1e4={'JsmsP':_0x1fb096[_0x3d6e4f(0x22a)],'dbMLI':_0x1fb096['WoidC'],'NCEnI':_0x1fb096[_0x3d6e4f(0x382)]};_0x90e166[_0x3d6e4f(0x2f7)]();const _0x1c69ce=document[_0x3d6e4f(0x14a)](_0x1fb096[_0x3d6e4f(0x236)]),_0x171169=[];_0x1c69ce[_0x3d6e4f(0x378)](_0x1011fc=>{const _0x2fe3f3=_0x3d6e4f,_0x406f74=_0x1011fc['id'][_0x2fe3f3(0x2ed)](/content-pm-(\d+)/);if(_0x406f74){_0x171169[_0x2fe3f3(0x13a)](_0x406f74[0x1]),_0x1011fc[_0x2fe3f3(0x23e)][_0x2fe3f3(0x320)](_0x2fe3f3(0x1eb));const _0xc0356f=document[_0x2fe3f3(0x23c)](_0x2fe3f3(0x2c9)+_0x406f74[0x1]);_0xc0356f&&(_0xc0356f[_0x2fe3f3(0x30f)]='▼');}});const _0x299c97=document[_0x3d6e4f(0x14a)](_0x1fb096[_0x3d6e4f(0x2cd)]),_0x52630a=[];_0x299c97[_0x3d6e4f(0x378)](_0x48af3c=>{const _0xe4e098=_0x3d6e4f,_0x292bee=_0x48af3c['id'][_0xe4e098(0x2ed)](/maco-breakdown-details-(\d+)/);if(_0x292bee){_0x52630a['push'](_0x292bee[0x1]),_0x48af3c[_0xe4e098(0x23e)][_0xe4e098(0x320)](_0xf4c1e4['JsmsP']);const _0x136501=document['getElementById'](_0xe4e098(0x176)+_0x292bee[0x1]);_0x136501&&(_0x136501[_0xe4e098(0x30f)]=_0xf4c1e4[_0xe4e098(0x1ec)]);}}),_0x1fb096[_0x3d6e4f(0x33c)](setTimeout,()=>{const _0x376daa=_0x3d6e4f,_0x1e987f={'EXwDL':_0xf4c1e4[_0x376daa(0x220)],'LHnox':_0xf4c1e4[_0x376daa(0x2e7)]};window[_0x376daa(0x1fa)](),setTimeout(()=>{const _0x21ba5c=_0x376daa;_0x171169['forEach'](_0x3fc012=>{const _0x5bb3ab=a16_0x37a5,_0x193cc3=document[_0x5bb3ab(0x23c)](_0x5bb3ab(0x281)+_0x3fc012),_0x4918bf=document[_0x5bb3ab(0x23c)](_0x5bb3ab(0x2c9)+_0x3fc012);_0x193cc3&&_0x193cc3[_0x5bb3ab(0x23e)]['add']('collapsed'),_0x4918bf&&(_0x4918bf[_0x5bb3ab(0x30f)]='▶');}),_0x52630a[_0x21ba5c(0x378)](_0x1f03da=>{const _0x2927da=_0x21ba5c,_0x10b65=document[_0x2927da(0x23c)](_0x2927da(0x1ad)+_0x1f03da),_0x2d7ea7=document[_0x2927da(0x23c)](_0x2927da(0x176)+_0x1f03da);_0x10b65&&_0x10b65[_0x2927da(0x23e)][_0x2927da(0x2a9)](_0x1e987f[_0x2927da(0x214)]),_0x2d7ea7&&(_0x2d7ea7[_0x2927da(0x30f)]=_0x1e987f[_0x2927da(0x2b2)]);});},0x3e8);},0xc8);})):_0x1fb096[_0x30717a(0x288)](_0x1fb096['rfuLb'],_0x182802)?(window[_0x30717a(0x2c5)]=_0x2ad764,import(_0x1fb096[_0x30717a(0x249)])[_0x30717a(0x329)](_0x5b2513=>{const _0x376989=_0x30717a;_0x5b2513[_0x376989(0x33b)]();const _0x26034e=document[_0x376989(0x14a)]('#detergentMaco\x20.train-content.collapsed'),_0x4e01fa=[];_0x26034e[_0x376989(0x378)](_0x18b320=>{const _0x3f7836=_0x376989,_0x4c2e56=_0x18b320['id'][_0x3f7836(0x2ed)](/content-dm-(\d+)/);if(_0x4c2e56){_0x4e01fa[_0x3f7836(0x13a)](_0x4c2e56[0x1]),_0x18b320['classList'][_0x3f7836(0x320)](_0x1fb096[_0x3f7836(0x209)]);const _0x53fb57=document[_0x3f7836(0x23c)](_0x3f7836(0x141)+_0x4c2e56[0x1]);_0x53fb57&&(_0x53fb57[_0x3f7836(0x30f)]='▼');}}),_0x1fb096[_0x376989(0x33c)](setTimeout,()=>{const _0x52e24a=_0x376989;window[_0x52e24a(0x1fa)](),_0x1fb096['OVriL'](setTimeout,()=>{const _0x207d14=_0x52e24a,_0x380f83={'KBOPX':_0x207d14(0x1eb)};_0x4e01fa[_0x207d14(0x378)](_0x431ce0=>{const _0x5880f8=_0x207d14,_0xa5bb5b=document[_0x5880f8(0x23c)](_0x5880f8(0x326)+_0x431ce0),_0x376817=document[_0x5880f8(0x23c)](_0x5880f8(0x141)+_0x431ce0);_0xa5bb5b&&_0xa5bb5b[_0x5880f8(0x23e)][_0x5880f8(0x2a9)](_0x380f83[_0x5880f8(0x222)]),_0x376817&&(_0x376817['textContent']='▶');});},0x3e8);},0xc8);})[_0x30717a(0x18a)](_0x2e1377=>{const _0x304c50=_0x30717a;console[_0x304c50(0x191)](_0x1fb096['ekYak'],_0x2e1377),window[_0x304c50(0x1fa)]();})[_0x30717a(0x32a)](()=>{const _0x2e52fb=_0x30717a,_0x1095c8={'kgBNq':_0x1fb096[_0x2e52fb(0x249)]};_0x1fb096['NONqn'](setTimeout,()=>{const _0x374a42=_0x2e52fb;window['printSelectedTrain']=null,import(_0x1095c8[_0x374a42(0x37d)])['then'](_0x3f8d8e=>_0x3f8d8e['renderDetergentMaco']())[_0x374a42(0x18a)](()=>{});},0x4b0);})):_0x1fb096['bZyck'](_0x1fb096[_0x30717a(0x29c)],_0x182802)?(window['printSelectedTrain']=_0x2ad764,console['log'](_0x30717a(0x155),_0x2ad764),import(_0x1fb096[_0x30717a(0x131)])[_0x30717a(0x329)](_0x16f7b8=>{const _0x3bc25a=_0x30717a;_0x16f7b8['renderTrainSummary'](),_0x1fb096[_0x3bc25a(0x33c)](setTimeout,()=>{const _0x1d77a7=_0x3bc25a,_0x1a4775=document[_0x1d77a7(0x23c)](_0x1fb096[_0x1d77a7(0x2ba)]),_0x5a90b2=document['getElementById'](_0x1fb096[_0x1d77a7(0x1ef)]);if(console['log'](_0x1fb096[_0x1d77a7(0x276)],_0x1a4775?_0x1a4775[_0x1d77a7(0x227)]['display']:_0x1fb096['SeOEV']),console[_0x1d77a7(0x179)](_0x1fb096[_0x1d77a7(0x373)],_0x5a90b2?_0x5a90b2['style']['display']:_0x1fb096[_0x1d77a7(0x18c)]),console[_0x1d77a7(0x179)](_0x1d77a7(0x134),!!_0x1a4775&&_0x1fb096['fuKJy'](_0x1a4775[_0x1d77a7(0x363)]['length'],0x0)),!_0x1a4775||_0x1fb096[_0x1d77a7(0x160)](_0x1fb096[_0x1d77a7(0x259)],_0x1a4775[_0x1d77a7(0x227)][_0x1d77a7(0x1c9)]))return console[_0x1d77a7(0x340)](_0x1fb096[_0x1d77a7(0x15e)]),void alert('No\x20train\x20data\x20to\x20print.\x20Please\x20ensure\x20you\x20have\x20created\x20trains\x20first.');window[_0x1d77a7(0x1fa)](),_0x1fb096['MQcTZ'](setTimeout,()=>{const _0x4e2b4b=_0x1d77a7;window[_0x4e2b4b(0x2c5)]=null,_0x16f7b8['renderTrainSummary']();},0x3e8);},0x1f4);})[_0x30717a(0x18a)](_0x5150c0=>{const _0x54f47a=_0x30717a;console[_0x54f47a(0x191)](_0x1fb096[_0x54f47a(0x2c6)],_0x5150c0),_0x1fb096[_0x54f47a(0x291)](alert,_0x1fb096[_0x54f47a(0x223)]+_0x5150c0['message']);})):setTimeout(()=>{const _0x1ee5db=_0x30717a;window[_0x1ee5db(0x1fa)]();},0x64);}export function toggleColumn(_0x39e421,_0x28793d){const _0x4a0bd4=a16_0x74705c,_0x2fbb86={'wHMCu':function(_0x1dc230,_0x5e6bea){return _0x1dc230===_0x5e6bea;},'wLZbF':_0x4a0bd4(0x273),'DSUpZ':'productRegister','rhVYi':_0x4a0bd4(0x2a6),'EQeyu':function(_0x3c74cf,_0x3d1691){return _0x3c74cf(_0x3d1691);},'YbZpW':_0x4a0bd4(0x28e)};if(_0x2fbb86[_0x4a0bd4(0x312)](_0x4a0bd4(0x271),_0x39e421)||_0x2fbb86[_0x4a0bd4(0x312)](_0x2fbb86['wLZbF'],_0x39e421)){[_0x2fbb86[_0x4a0bd4(0x2da)],_0x2fbb86['rhVYi']][_0x4a0bd4(0x378)](_0x2e8118=>{const _0x1799e7=_0x4a0bd4;document[_0x1799e7(0x14a)]('#'+_0x2e8118+_0x1799e7(0x240)+_0x2e8118+_0x1799e7(0x282))[_0x1799e7(0x378)](_0x4712be=>{const _0x57af2f=_0x1799e7;_0x4712be[_0x57af2f(0x23e)][_0x57af2f(0x17c)](_0x57af2f(0x22f)+_0x39e421);}),document[_0x1799e7(0x14a)]('#'+_0x2e8118+_0x1799e7(0x31c)+_0x2e8118+'\x20.train-content-inner')[_0x1799e7(0x378)](_0x409e39=>{const _0xfe76c8=_0x1799e7;_0x409e39&&_0x409e39[_0xfe76c8(0x23e)][_0xfe76c8(0x17c)](_0xfe76c8(0x22f)+_0x39e421);});});const _0x3e6375=null!==document[_0x4a0bd4(0x376)](_0x4a0bd4(0x26a)+_0x39e421);localStorage[_0x4a0bd4(0x32b)](_0x4a0bd4(0x29f)+_0x39e421+_0x4a0bd4(0x319),_0x3e6375),_0x2fbb86[_0x4a0bd4(0x2d0)](updateToggleIcons,_0x4a0bd4(0x1c5)),_0x2fbb86[_0x4a0bd4(0x2d0)](updateToggleIcons,_0x2fbb86[_0x4a0bd4(0x25d)]),import(_0x2fbb86[_0x4a0bd4(0x2b0)])[_0x4a0bd4(0x329)](_0x56491c=>{const _0x562b20=_0x4a0bd4;_0x56491c[_0x562b20(0x194)]();}),import(_0x2fbb86[_0x4a0bd4(0x2b0)])[_0x4a0bd4(0x329)](_0x1f58cf=>{const _0x4a5099=_0x4a0bd4;_0x1f58cf[_0x4a5099(0x2a8)]&&_0x1f58cf[_0x4a5099(0x2a8)]();});}else{document[_0x4a0bd4(0x14a)]('#'+_0x28793d+'\x20.mainTable,\x20#'+_0x28793d+_0x4a0bd4(0x282))[_0x4a0bd4(0x378)](_0x46caed=>{const _0x3f3daf=_0x4a0bd4;_0x46caed[_0x3f3daf(0x23e)][_0x3f3daf(0x17c)](_0x3f3daf(0x22f)+_0x39e421);});const _0x54e2ed=null!==document[_0x4a0bd4(0x376)]('#'+_0x28793d+_0x4a0bd4(0x353)+_0x39e421);localStorage['setItem'](_0x28793d+'-'+_0x39e421+_0x4a0bd4(0x319),_0x54e2ed),updateToggleIcons(_0x28793d);}}export function toggleColumnVisibilityDropdown(){const _0x377295=a16_0x74705c,_0x5b000b={'JhHHF':_0x377295(0x279),'dOVKO':_0x377295(0x13c),'cnfVc':_0x377295(0x342),'dNHZO':'click'},_0x2dfdaa=document[_0x377295(0x23c)](_0x377295(0x333));_0x2dfdaa[_0x377295(0x23e)][_0x377295(0x17c)](_0x5b000b[_0x377295(0x2c4)]),_0x2dfdaa['classList']['contains'](_0x377295(0x342))||document[_0x377295(0x2df)](_0x5b000b[_0x377295(0x168)],function _0x518923(_0x23277c){const _0x4fff24=_0x377295;_0x23277c[_0x4fff24(0x252)][_0x4fff24(0x327)](_0x5b000b['JhHHF'])||_0x23277c[_0x4fff24(0x252)][_0x4fff24(0x327)](_0x5b000b['dOVKO'])||(_0x2dfdaa[_0x4fff24(0x23e)]['add'](_0x5b000b['cnfVc']),document[_0x4fff24(0x383)](_0x5b000b[_0x4fff24(0x168)],_0x518923));});}export function updateToggleIcons(_0x2bd43a){const _0x5bdf29=a16_0x74705c,_0xd3d2d0={'HODwa':_0x5bdf29(0x140),'duROk':_0x5bdf29(0x215),'XUcDM':function(_0x302fee,_0x56101f){return _0x302fee===_0x56101f;},'GdJtL':_0x5bdf29(0x2a6),'NwkmP':'productRegister-pdeHidden','ovckB':function(_0xd827,_0x939335){return _0xd827===_0x939335;},'FLZLq':function(_0x133160,_0x24abd4){return _0x133160===_0x24abd4;},'Dmefo':_0x5bdf29(0x35a),'rmrHV':function(_0x36e921,_0x13886e){return _0x36e921&&_0x13886e;},'CYySD':function(_0x58badf,_0x1358ae){return _0x58badf===_0x1358ae;},'vbwlh':_0x5bdf29(0x1f6),'RRgwc':'.toggle-ld50','uURJb':_0x5bdf29(0x2e2),'LwYZb':_0x5bdf29(0x37c),'tiYwi':'Show\x20LD50','awxPz':_0x5bdf29(0x2c7)},_0x46ec6d=document['getElementById'](_0x2bd43a);if(!_0x46ec6d)return;let _0x13c93e,_0x432c05;if(_0xd3d2d0[_0x5bdf29(0x2a3)](_0xd3d2d0[_0x5bdf29(0x128)],_0x2bd43a)){const _0x69dba9=localStorage['getItem'](_0xd3d2d0[_0x5bdf29(0x132)]),_0x139502=localStorage[_0x5bdf29(0x31f)]('productRegister-ld50Hidden');if(_0xd3d2d0[_0x5bdf29(0x21c)](null,_0x69dba9)&&_0xd3d2d0[_0x5bdf29(0x21c)](null,_0x139502))_0x13c93e=!0x1,_0x432c05=!0x1;else{const _0x564b31=_0xd3d2d0[_0x5bdf29(0x256)](_0xd3d2d0['Dmefo'],_0x69dba9),_0x5a8142=_0xd3d2d0[_0x5bdf29(0x284)]===_0x139502;_0xd3d2d0[_0x5bdf29(0x213)](_0x564b31,_0x5a8142)?(_0x13c93e=!0x1,_0x432c05=!0x0):(_0x13c93e=_0x564b31,_0x432c05=_0x5a8142);}}else{const _0x15c486=localStorage[_0x5bdf29(0x31f)](_0x2bd43a+_0x5bdf29(0x225)),_0x24a775=localStorage[_0x5bdf29(0x31f)](_0x2bd43a+'-ld50Hidden');_0x13c93e=_0xd3d2d0[_0x5bdf29(0x16c)](_0xd3d2d0[_0x5bdf29(0x284)],_0x15c486),_0x432c05=_0xd3d2d0[_0x5bdf29(0x284)]===_0x24a775;}const _0x4a0833=_0x46ec6d[_0x5bdf29(0x376)](_0xd3d2d0[_0x5bdf29(0x1f4)]),_0x20fd07=_0x46ec6d[_0x5bdf29(0x376)](_0xd3d2d0[_0x5bdf29(0x2f3)]);_0x4a0833&&(_0x4a0833['innerHTML']=_0x13c93e?_0xd3d2d0[_0x5bdf29(0x14d)]:_0xd3d2d0[_0x5bdf29(0x283)]),_0x20fd07&&(_0x20fd07[_0x5bdf29(0x363)]=_0x432c05?_0xd3d2d0[_0x5bdf29(0x162)]:_0xd3d2d0[_0x5bdf29(0x244)]),document[_0x5bdf29(0x14a)]('#'+_0x2bd43a+_0x5bdf29(0x240)+_0x2bd43a+_0x5bdf29(0x282))[_0x5bdf29(0x378)](_0x110783=>{const _0x59e589=_0x5bdf29;_0x110783&&(_0x110783['classList'][_0x59e589(0x17c)](_0xd3d2d0[_0x59e589(0x1bf)],_0x13c93e),_0x110783[_0x59e589(0x23e)]['toggle'](_0x59e589(0x215),_0x432c05));}),document[_0x5bdf29(0x14a)]('#'+_0x2bd43a+_0x5bdf29(0x31c)+_0x2bd43a+_0x5bdf29(0x28f))[_0x5bdf29(0x378)](_0x2535bb=>{const _0x460ac7=_0x5bdf29;_0x2535bb&&(_0x2535bb[_0x460ac7(0x23e)]['toggle'](_0xd3d2d0[_0x460ac7(0x1bf)],_0x13c93e),_0x2535bb[_0x460ac7(0x23e)][_0x460ac7(0x17c)](_0xd3d2d0['duROk'],_0x432c05));});}export function exportToExcel(){const _0x10b27d=a16_0x74705c,_0x340b40={'sRDCk':function(_0x1947ea,_0xea0ecc){return _0x1947ea(_0xea0ecc);},'qmAxl':function(_0x1adcfd,_0x241f51){return _0x1adcfd===_0x241f51;},'eppdd':function(_0x43dee8){return _0x43dee8();},'AqidS':'No\x20Data','HTJAu':_0x10b27d(0x14e),'HMini':_0x10b27d(0x335),'Wruih':_0x10b27d(0x170),'MMtLX':_0x10b27d(0x325),'bUysM':function(_0x3f0444){return _0x3f0444();},'nECKU':_0x10b27d(0x36f),'gYKao':function(_0x408f7c){return _0x408f7c();},'vQvuU':_0x10b27d(0x1a1)};_0x340b40[_0x10b27d(0x35b)](showLoader),import(_0x340b40[_0x10b27d(0x23d)])[_0x10b27d(0x329)](_0x2cb3be=>{const _0x522338=_0x10b27d,_0x3114d6={'vbWlD':function(_0x2fb82b,_0x420b60){return _0x2fb82b(_0x420b60);},'bPIdR':'Yes','RpGFA':function(_0x5967d4,_0x4e84c6){const _0x5eb0b3=a16_0x37a5;return _0x340b40[_0x5eb0b3(0x30a)](_0x5967d4,_0x4e84c6);}},{getProductTrainId:_0x40d65a,calculateScores:_0x132170}=_0x2cb3be,_0x165089=[];if(a16_0x1d463c['products'][_0x522338(0x378)](_0x4f5041=>{const _0x5d55a5=_0x522338;let _0x247382='No';_0x4f5041[_0x5d55a5(0x1b2)]&&(_0x247382=_0x3114d6[_0x5d55a5(0x1de)]+(_0x4f5041[_0x5d55a5(0x211)]?':\x20'+_0x4f5041[_0x5d55a5(0x211)]:''));const _0x44a62c=_0x3114d6[_0x5d55a5(0x31b)](a16_0x22d264,_0x4f5041),_0x52d45f=_0x4f5041[_0x5d55a5(0x1c8)]?new Date(_0x4f5041[_0x5d55a5(0x1c8)])[_0x5d55a5(0x233)]():'';_0x165089[_0x5d55a5(0x13a)]({'Date':_0x52d45f,'Product\x20Code':_0x4f5041['productCode'],'Product\x20Name':_0x4f5041['name'],'Train\x20No.':_0x44a62c,'Dosage\x20Form':_0x4f5041['productType']||'','Batch\x20Size\x20(Kg)':_0x4f5041[_0x5d55a5(0x2f4)],'Special\x20Case\x20Product':_0x247382,'Active\x20Ingredient':'','Solubility':'','Therapeutic\x20Dose\x20(mg/day)':'','Cleanability':'','PDE\x20(µg/day)':'','LD50\x20(mg/kg)':'','Solubility\x20Score':'','Therapeutic\x20Dose\x20Score':'','Cleanability\x20Score':'','Toxicity\x20Score':'','RPN':'','RPN\x20Rating':''}),_0x4f5041[_0x5d55a5(0x208)][_0x5d55a5(0x378)](_0x3958c4=>{const _0xbf21a0=_0x5d55a5,_0x34ad38=_0x3114d6[_0xbf21a0(0x161)](_0x132170,_0x3958c4);_0x165089[_0xbf21a0(0x13a)]({'Date':'','Product\x20Code':'','Product\x20Name':'\x20\x20└─\x20'+_0x3958c4[_0xbf21a0(0x36b)],'Train\x20No.':'','Dosage\x20Form':'','Batch\x20Size\x20(Kg)':'','Special\x20Case\x20Product':'','Active\x20Ingredient':_0x3958c4[_0xbf21a0(0x36b)],'Solubility':_0x3958c4['solubility']||'','Therapeutic\x20Dose\x20(mg/day)':_0x3958c4[_0xbf21a0(0x1df)]||'','Cleanability':_0x3958c4['cleanability']||'','PDE\x20(µg/day)':_0x3958c4['pde']||'','LD50\x20(mg/kg)':_0x3958c4[_0xbf21a0(0x273)]||'','Solubility\x20Score':_0x34ad38['solubilityScore']||'','Therapeutic\x20Dose\x20Score':_0x34ad38[_0xbf21a0(0x12b)]||'','Cleanability\x20Score':_0x34ad38[_0xbf21a0(0x1b1)]||'','Toxicity\x20Score':_0x34ad38[_0xbf21a0(0x386)]||_0x34ad38[_0xbf21a0(0x289)]||'','RPN':_0x34ad38[_0xbf21a0(0x1cd)],'RPN\x20Rating':_0x34ad38[_0xbf21a0(0x1c4)]});});}),_0x340b40['qmAxl'](0x0,_0x165089[_0x522338(0x182)]))return _0x340b40[_0x522338(0x381)](hideLoader),void showCustomAlert(_0x340b40[_0x522338(0x18f)],_0x340b40[_0x522338(0x370)]);const _0x11e661=XLSX[_0x522338(0x2f9)]['json_to_sheet'](_0x165089),_0x4adec7=XLSX[_0x522338(0x2f9)][_0x522338(0x34b)]();XLSX[_0x522338(0x2f9)][_0x522338(0x247)](_0x4adec7,_0x11e661,_0x340b40[_0x522338(0x137)]);const _0x1551f2=Object['keys'](_0x165089[0x0])[_0x522338(0x187)](_0x3a501a=>({'wch':Math[_0x522338(0x34e)](_0x3a501a[_0x522338(0x182)],..._0x165089[_0x522338(0x187)](_0x2df4d8=>String(_0x2df4d8[_0x3a501a]||'')[_0x522338(0x182)]))+0x2}));_0x11e661[_0x522338(0x349)]=_0x1551f2,XLSX['writeFile'](_0x4adec7,_0x340b40[_0x522338(0x2fb)]),_0x340b40[_0x522338(0x381)](hideLoader);})[_0x10b27d(0x18a)](_0x3f9479=>{const _0x2c2527=_0x10b27d;console[_0x2c2527(0x191)](_0x340b40[_0x2c2527(0x2bc)],_0x3f9479),_0x340b40['bUysM'](hideLoader),showCustomAlert(_0x2c2527(0x28b),_0x340b40['nECKU']);});}export function exportAllToJson(){const _0x4c1921=a16_0x74705c,_0x2f54ce={'hMyZR':function(_0xb290be){return _0xb290be();},'bQuWq':_0x4c1921(0x2f5),'WuVac':_0x4c1921(0x1e3),'snjJq':function(_0x8b8767,_0x183765,_0x3266e9){return _0x8b8767(_0x183765,_0x3266e9);},'ZpVEn':_0x4c1921(0x28b),'Cuknt':_0x4c1921(0x1b8),'vFnaz':function(_0x4e1c5f){return _0x4e1c5f();}};_0x2f54ce[_0x4c1921(0x1cc)](showLoader);try{const _0x37cdc3={'exportDate':new Date()[_0x4c1921(0x242)](),'scoringCriteria':a16_0x1d463c[_0x4c1921(0x2de)],'products':a16_0x1d463c[_0x4c1921(0x175)],'machines':a16_0x1d463c[_0x4c1921(0x292)],'detergentIngredients':a16_0x1d463c['detergentIngredients']},_0x4d83e5=JSON[_0x4c1921(0x30d)](_0x37cdc3,null,0x2),_0x3db077=new Blob([_0x4d83e5],{'type':_0x2f54ce[_0x4c1921(0x201)]}),_0x3a5235=URL[_0x4c1921(0x1a8)](_0x3db077),_0x2f5814=document['createElement']('a');_0x2f5814['href']=_0x3a5235,_0x2f5814[_0x4c1921(0x2a0)]=_0x2f54ce[_0x4c1921(0x24b)],document['body'][_0x4c1921(0x27f)](_0x2f5814),_0x2f5814[_0x4c1921(0x305)](),document[_0x4c1921(0x1e5)][_0x4c1921(0x202)](_0x2f5814),URL[_0x4c1921(0x1b9)](_0x3a5235);}catch(_0x4cb913){_0x2f54ce[_0x4c1921(0x219)](showCustomAlert,_0x2f54ce[_0x4c1921(0x1bd)],_0x2f54ce[_0x4c1921(0x18e)]+_0x4cb913[_0x4c1921(0x2ff)]);}finally{_0x2f54ce[_0x4c1921(0x343)](hideLoader);}}export function importFromJson(_0x3e5b14){const _0x13aaa7=a16_0x74705c,_0x503b3e={'CGBXZ':function(_0x404379,_0x3c39c4,_0x3dbf23){return _0x404379(_0x3c39c4,_0x3dbf23);},'jwgXr':'Data\x20imported\x20successfully.','oAtBS':_0x13aaa7(0x180),'fylMl':function(_0xaaa7b9,_0x7deb07,_0x470d67){return _0xaaa7b9(_0x7deb07,_0x470d67);},'NemAZ':_0x13aaa7(0x28b)},_0xb91025=_0x3e5b14[_0x13aaa7(0x252)][_0x13aaa7(0x1bc)][0x0];if(!_0xb91025)return;const _0xd1cbee=new FileReader();_0xd1cbee[_0x13aaa7(0x163)]=function(_0x1840c7){const _0x466434=_0x13aaa7;try{const _0x5ca348=JSON[_0x466434(0x15a)](_0x1840c7['target'][_0x466434(0x2ce)]);_0x5ca348&&_0x5ca348['products']&&_0x5ca348[_0x466434(0x2de)]&&_0x5ca348[_0x466434(0x292)]?(a16_0x1d463c[_0x466434(0x29a)](_0x5ca348[_0x466434(0x175)]),a16_0x1d463c[_0x466434(0x19e)](_0x5ca348['machines']),a16_0x1d463c['setScoringCriteria'](_0x5ca348[_0x466434(0x2de)]),_0x5ca348[_0x466434(0x2f8)]&&a16_0x1d463c['setDetergentIngredients'](_0x5ca348[_0x466434(0x2f8)]),saveStateForUndo(),a16_0x165ed8(),_0x503b3e[_0x466434(0x346)](showCustomAlert,_0x466434(0x199),_0x503b3e[_0x466434(0x268)])):showCustomAlert(_0x466434(0x28b),_0x503b3e['oAtBS']);}catch(_0x94d1e2){_0x503b3e[_0x466434(0x29b)](showCustomAlert,_0x503b3e[_0x466434(0x16e)],_0x466434(0x152));}finally{_0x3e5b14['target']['value']='';}},_0xd1cbee[_0x13aaa7(0x1ee)](_0xb91025);}export function toggleOtherProductType(_0xba36e8,_0xd8ae6){const _0x119627=a16_0x74705c,_0x4566fb={'Jgtau':_0x119627(0x34d),'vHnqB':function(_0x9adcd,_0x3d237f){return _0x9adcd===_0x3d237f;},'maTkN':_0x119627(0x20a)},_0x411a3a=document[_0x119627(0x23c)](_0xd8ae6),_0x36dcf4=_0x411a3a[_0x119627(0x376)](_0x4566fb['Jgtau']);_0x4566fb['vHnqB'](_0x4566fb['maTkN'],_0xba36e8[_0x119627(0x341)])?(_0x411a3a[_0x119627(0x227)][_0x119627(0x1c9)]=_0x119627(0x1af),_0x36dcf4['required']=!0x0):(_0x411a3a['style'][_0x119627(0x1c9)]=_0x119627(0x295),_0x36dcf4[_0x119627(0x30c)]=!0x1,_0x36dcf4[_0x119627(0x341)]='');}export function toggleOtherMachineStage(_0x1ab714,_0xc97914){const _0x1362ab=a16_0x74705c,_0x5cc0fe={'fXfJm':'input','QwCcY':function(_0x728e8f,_0x23fa27){return _0x728e8f===_0x23fa27;},'AhmHt':_0x1362ab(0x20a),'WLMLb':_0x1362ab(0x1af),'ZMrPT':_0x1362ab(0x295)},_0x3ea5ef=document['getElementById'](_0xc97914),_0x1812f8=_0x3ea5ef[_0x1362ab(0x376)](_0x5cc0fe[_0x1362ab(0x1f5)]);_0x5cc0fe[_0x1362ab(0x2b7)](_0x5cc0fe['AhmHt'],_0x1ab714[_0x1362ab(0x341)])?(_0x3ea5ef[_0x1362ab(0x227)][_0x1362ab(0x1c9)]=_0x5cc0fe[_0x1362ab(0x12e)],_0x1812f8[_0x1362ab(0x30c)]=!0x0):(_0x3ea5ef[_0x1362ab(0x227)][_0x1362ab(0x1c9)]=_0x5cc0fe[_0x1362ab(0x278)],_0x1812f8['required']=!0x1,_0x1812f8[_0x1362ab(0x341)]='');}export function toggleOtherMachineGroup(_0x2f3e37,_0x2264f7){const _0x5bf3ad=a16_0x74705c,_0x2eb19a={'LYhGL':'input','vIeIw':function(_0x4cb780,_0x2a29a7){return _0x4cb780===_0x2a29a7;},'RRqcn':_0x5bf3ad(0x20a),'IoDRr':_0x5bf3ad(0x1af),'qydxL':_0x5bf3ad(0x295)},_0x56602e=document[_0x5bf3ad(0x23c)](_0x2264f7),_0xd5e727=_0x56602e['querySelector'](_0x2eb19a[_0x5bf3ad(0x24e)]);_0x2eb19a[_0x5bf3ad(0x2ad)](_0x2eb19a[_0x5bf3ad(0x2ec)],_0x2f3e37['value'])?(_0x56602e[_0x5bf3ad(0x227)][_0x5bf3ad(0x1c9)]=_0x2eb19a['IoDRr'],_0xd5e727['required']=!0x0):(_0x56602e[_0x5bf3ad(0x227)][_0x5bf3ad(0x1c9)]=_0x2eb19a[_0x5bf3ad(0x2e1)],_0xd5e727['required']=!0x1,_0xd5e727[_0x5bf3ad(0x341)]='');}export function clampSafetyFactor(_0x1c3b94,_0x1d9870){const _0x5f4119=a16_0x74705c,_0x17258b={'NQzFU':function(_0x1d96b9,_0x5c541a){return _0x1d96b9(_0x5c541a);},'FmoGA':function(_0x37c360,_0x6f02d0){return _0x37c360(_0x6f02d0);},'uIbHd':function(_0xd06723,_0x36160a){return _0xd06723<_0x36160a;},'eSple':function(_0x1cde27,_0x2525c4){return _0x1cde27>_0x2525c4;},'vYlxx':function(_0x3de92e,_0x1a92a1){return _0x3de92e!==_0x1a92a1;},'UnUdz':'product-sf-input','ydulJ':function(_0x1ea946,_0x27f431){return _0x1ea946(_0x27f431);},'vewjf':_0x5f4119(0x2fa),'Nipjb':function(_0x12cb71,_0x30ef41){return _0x12cb71(_0x30ef41);}},_0xe97da8=_0x17258b[_0x5f4119(0x200)](parseFloat,_0x1c3b94[_0x5f4119(0x177)]),_0x274d4f=parseFloat(_0x1c3b94['max']);let _0x1148e5=parseFloat(_0x1c3b94[_0x5f4119(0x341)]);_0x17258b['FmoGA'](isNaN,_0x1148e5)&&(_0x1148e5=_0xe97da8),_0x17258b['uIbHd'](_0x1148e5,_0xe97da8)?_0x1148e5=_0xe97da8:_0x17258b[_0x5f4119(0x2ca)](_0x1148e5,_0x274d4f)&&(_0x1148e5=_0x274d4f),_0x17258b['vYlxx'](parseFloat(_0x1c3b94[_0x5f4119(0x341)]),_0x1148e5)&&(_0x1c3b94[_0x5f4119(0x341)]=_0x1148e5),_0x1c3b94['id'][_0x5f4119(0x205)](_0x17258b[_0x5f4119(0x2d9)])?_0x17258b['ydulJ'](recalculateProductMacoForTrain,_0x1d9870):_0x1c3b94['id'][_0x5f4119(0x205)](_0x17258b[_0x5f4119(0x1e6)])&&_0x17258b[_0x5f4119(0x1d1)](recalculateDetergentMacoForTrain,_0x1d9870);}export function toggleTrain(_0x52720f){const _0x58e0df=a16_0x74705c,_0x5bd2ac={'ZHyeq':function(_0x4b4f04,_0x232356){return _0x4b4f04&&_0x232356;},'OXKTd':_0x58e0df(0x1eb)},_0xdf1e3b=document[_0x58e0df(0x23c)]('content-'+_0x52720f),_0x2d4d9b=document[_0x58e0df(0x23c)](_0x58e0df(0x36e)+_0x52720f);_0x5bd2ac[_0x58e0df(0x21d)](_0xdf1e3b,_0x2d4d9b)&&(_0xdf1e3b[_0x58e0df(0x23e)]['contains'](_0x5bd2ac['OXKTd'])?(_0xdf1e3b[_0x58e0df(0x23e)]['remove'](_0x5bd2ac[_0x58e0df(0x1a7)]),_0x2d4d9b[_0x58e0df(0x30f)]='▼'):(_0xdf1e3b['classList'][_0x58e0df(0x2a9)](_0x58e0df(0x1eb)),_0x2d4d9b[_0x58e0df(0x30f)]='▶'));}export function toggleMacoBreakdown(_0x18e984){const _0x21b813=a16_0x74705c,_0x2212c1={'fMHQJ':_0x21b813(0x20e),'ahZhi':_0x21b813(0x234)},_0x5dc19f=document[_0x21b813(0x23c)](_0x21b813(0x1ad)+_0x18e984),_0x3fc26e=document['getElementById'](_0x21b813(0x176)+_0x18e984);_0x5dc19f[_0x21b813(0x23e)][_0x21b813(0x33d)](_0x21b813(0x342))?(_0x5dc19f[_0x21b813(0x23e)][_0x21b813(0x320)]('hidden'),_0x3fc26e[_0x21b813(0x30f)]=_0x2212c1[_0x21b813(0x1a6)]):(_0x5dc19f[_0x21b813(0x23e)][_0x21b813(0x2a9)](_0x21b813(0x342)),_0x3fc26e['textContent']=_0x2212c1[_0x21b813(0x380)]);}export function exportWorstCaseToExcel(_0x4d210c=a16_0x74705c(0x254)){const _0x13b496=a16_0x74705c,_0x32e629={'EMqLB':function(_0x3d6fc0,_0x14459c){return _0x3d6fc0(_0x14459c);},'yZDye':function(_0x3fea56,_0x3cf7af){return _0x3fea56!==_0x3cf7af;},'dizYS':function(_0x169298,_0x139a9e,_0x3ccb45){return _0x169298(_0x139a9e,_0x3ccb45);},'WrjZG':_0x13b496(0x30e),'yauNN':_0x13b496(0x374),'CQuhn':function(_0x20f67c,_0x4d1c58){return _0x20f67c===_0x4d1c58;},'FZWeu':_0x13b496(0x1ff),'kOIKC':_0x13b496(0x254),'NcOaP':function(_0x4035de){return _0x4035de();},'TtnMK':function(_0x3e4ea1,_0x166297,_0x4bb558){return _0x3e4ea1(_0x166297,_0x4bb558);},'pwddp':_0x13b496(0x1d2),'mGjcf':function(_0x28384c){return _0x28384c();},'nlwrP':function(_0x2b3831){return _0x2b3831();},'xuUsD':function(_0xdcfc53,_0x71e1e5,_0x3be3ff){return _0xdcfc53(_0x71e1e5,_0x3be3ff);},'UpsOE':_0x13b496(0x301),'hNrJc':_0x13b496(0x368),'XjLQO':_0x13b496(0x349),'PRoIg':function(_0x49a22d,_0x44f696){return _0x49a22d!==_0x44f696;},'jnrOy':function(_0x435191){return _0x435191();},'pIkBt':_0x13b496(0x2fe),'enMkG':function(_0x1f82a1,_0x39867b,_0x507c89){return _0x1f82a1(_0x39867b,_0x507c89);},'Klxmd':_0x13b496(0x145),'osHCY':function(_0x46186e){return _0x46186e();},'vGHAn':_0x13b496(0x1a1)};_0x32e629[_0x13b496(0x2c1)](showLoader),import(_0x32e629[_0x13b496(0x19a)])[_0x13b496(0x329)](_0x2a834e=>{const _0x5873a9=_0x13b496,_0x5e5f31={'qSddr':function(_0x388f47,_0x3f631e,_0x356fe1){const _0x1afb78=a16_0x37a5;return _0x32e629[_0x1afb78(0x24c)](_0x388f47,_0x3f631e,_0x356fe1);},'iRqDR':_0x32e629[_0x5873a9(0x231)],'ZaNIS':_0x32e629[_0x5873a9(0x22b)]},{getProductTrainId:_0x44fce1,calculateScores:_0x8badc,getToxicityPreference:_0x1b1f23}=_0x2a834e,_0x5d5aec=[];let _0x4fd323=a16_0x1d463c[_0x5873a9(0x135)][_0x5873a9(0x2a6)]||a16_0x1d463c[_0x5873a9(0x175)];if(_0x32e629[_0x5873a9(0x150)](0x0,_0x4fd323[_0x5873a9(0x182)]))return hideLoader(),void _0x32e629['dizYS'](showCustomAlert,_0x5873a9(0x1d2),_0x32e629[_0x5873a9(0x2d1)]);const _0x4c5be8={};_0x4fd323[_0x5873a9(0x378)](_0x1593ea=>{const _0x51426a=_0x5873a9,_0x5da3db=_0x32e629['EMqLB'](a16_0x22d264,_0x1593ea);_0x32e629[_0x51426a(0x2e3)](_0x51426a(0x30e),_0x5da3db)&&(_0x4c5be8[_0x5da3db]||(_0x4c5be8[_0x5da3db]=[]),_0x4c5be8[_0x5da3db][_0x51426a(0x13a)](_0x1593ea));});let _0x5c5060=_0x4c5be8;if(_0x32e629[_0x5873a9(0x2e3)](_0x32e629[_0x5873a9(0x1c6)],_0x4d210c)&&(_0x5c5060={},Array[_0x5873a9(0x31e)](_0x4d210c)?_0x4d210c[_0x5873a9(0x378)](_0x7c94=>{_0x4c5be8[_0x7c94]&&(_0x5c5060[_0x7c94]=_0x4c5be8[_0x7c94]);}):_0x4c5be8[_0x4d210c]&&(_0x5c5060={[_0x4d210c]:_0x4c5be8[_0x4d210c]}),_0x32e629['CQuhn'](0x0,Object[_0x5873a9(0x34c)](_0x5c5060)['length'])))return _0x32e629['NcOaP'](hideLoader),void _0x32e629[_0x5873a9(0x14f)](showCustomAlert,_0x32e629[_0x5873a9(0x265)],(Array['isArray'](_0x4d210c)?_0x5873a9(0x13f)+_0x4d210c['join'](',\x20'):'Train\x20'+_0x4d210c)+_0x5873a9(0x27c));const _0x584252=_0x32e629[_0x5873a9(0x2aa)](_0x1b1f23);if(Object[_0x5873a9(0x34c)](_0x5c5060)[_0x5873a9(0x153)]((_0x19132f,_0x3dccbf)=>_0x19132f-_0x3dccbf)['forEach'](_0x16cad5=>{const _0x115f32=_0x5873a9,_0x4f3dd0={'rFruY':function(_0xbfb761,_0x1a14bd,_0x2df727){return _0x5e5f31['qSddr'](_0xbfb761,_0x1a14bd,_0x2df727);},'MXyeA':_0x5e5f31['iRqDR'],'HYgyq':_0x5e5f31['ZaNIS']},_0xb28add=_0x5c5060[_0x16cad5];_0x5d5aec[_0x115f32(0x13a)]({'Train':_0x115f32(0x36d)+_0x16cad5+_0x115f32(0x269),'Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),_0xb28add[_0x115f32(0x378)](_0x7772ca=>{const _0x5d65c8=_0x115f32,_0x52c7c8=_0x7772ca[_0x5d65c8(0x208)][_0x5d65c8(0x187)](_0x318e6b=>_0x8badc(_0x318e6b,_0x584252)['rpn']);_0x7772ca[_0x5d65c8(0x280)]=_0x52c7c8[_0x5d65c8(0x182)]>0x0?Math['max'](..._0x52c7c8):0x0;}),_0xb28add[_0x115f32(0x153)]((_0x38d6f2,_0xa40a88)=>_0xa40a88['sortValue']-_0x38d6f2[_0x115f32(0x280)]),_0xb28add['forEach'](_0x19cf86=>{const _0x4168c4=_0x115f32,_0x5c49fa=_0x19cf86[_0x4168c4(0x1b2)]?_0x4f3dd0[_0x4168c4(0x1b6)]:'No';_0x5d5aec['push']({'Train':'','Product\x20Code':_0x19cf86[_0x4168c4(0x37f)],'Product\x20Name':_0x19cf86['name'],'Highest\x20RPN':_0x19cf86[_0x4168c4(0x280)],'Special\x20Case\x20Product':_0x5c49fa,'Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),(_0x19cf86[_0x4168c4(0x208)][_0x4168c4(0x153)]((_0x40c6a0,_0x36b74d)=>_0x8badc(_0x36b74d,_0x584252)[_0x4168c4(0x1cd)]-_0x8badc(_0x40c6a0,_0x584252)['rpn'])[_0x4168c4(0x378)](_0x2fac02=>{const _0x2e7bb8=_0x4168c4,_0x912332=_0x4f3dd0[_0x2e7bb8(0x385)](_0x8badc,_0x2fac02,_0x584252);_0x5d5aec[_0x2e7bb8(0x13a)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':_0x2fac02[_0x2e7bb8(0x36b)],'TD\x20Score':_0x912332[_0x2e7bb8(0x12b)],'Solubility\x20Score':_0x912332[_0x2e7bb8(0x362)],'Cleanability\x20Score':_0x912332[_0x2e7bb8(0x1b1)],'PDE\x20Score':_0x912332[_0x2e7bb8(0x386)]??_0x4f3dd0['MXyeA'],'LD50\x20Score':_0x912332['ld50Score']??_0x4f3dd0[_0x2e7bb8(0x35d)],'RPN':_0x912332['rpn'],'Rating':_0x912332[_0x2e7bb8(0x1c4)]});}),_0x5d5aec[_0x4168c4(0x13a)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}));});}),_0x32e629[_0x5873a9(0x150)](0x0,_0x5d5aec['length']))return _0x32e629[_0x5873a9(0x2dc)](hideLoader),void _0x32e629[_0x5873a9(0x19b)](showCustomAlert,_0x32e629[_0x5873a9(0x265)],_0x32e629[_0x5873a9(0x32f)]);const _0x220f62=XLSX[_0x5873a9(0x2f9)][_0x5873a9(0x15b)](_0x5d5aec),_0x8c9179=XLSX[_0x5873a9(0x2f9)]['book_new']();XLSX[_0x5873a9(0x2f9)][_0x5873a9(0x247)](_0x8c9179,_0x220f62,_0x32e629[_0x5873a9(0x2e8)]);const _0x433a36=Object[_0x5873a9(0x34c)](_0x5d5aec[0x0])[_0x5873a9(0x187)](_0x18f873=>({'wch':Math['max'](_0x18f873[_0x5873a9(0x182)],..._0x5d5aec[_0x5873a9(0x187)](_0x362da5=>String(_0x362da5[_0x18f873]||'')[_0x5873a9(0x182)]))+0x2}));_0x220f62[_0x32e629[_0x5873a9(0x239)]]=_0x433a36;const _0x27ddda=new Date()['toISOString']()[_0x5873a9(0x1e8)]('T')[0x0];let _0x2171c8='';_0x32e629['PRoIg'](_0x5873a9(0x254),_0x4d210c)&&(_0x2171c8=Array[_0x5873a9(0x31e)](_0x4d210c)?_0x5873a9(0x35f)+_0x4d210c['join']('_'):_0x5873a9(0x210)+_0x4d210c),XLSX[_0x5873a9(0x13d)](_0x8c9179,_0x5873a9(0x20c)+_0x2171c8+'_'+_0x27ddda+_0x5873a9(0x1f3)),_0x32e629[_0x5873a9(0x2e4)](hideLoader);})[_0x13b496(0x18a)](_0x12b170=>{const _0xa0da97=_0x13b496;console[_0xa0da97(0x191)](_0x32e629[_0xa0da97(0x2af)],_0x12b170),_0x32e629[_0xa0da97(0x2dc)](hideLoader),_0x32e629[_0xa0da97(0x195)](showCustomAlert,'Error',_0x32e629[_0xa0da97(0x315)]);});}export function exportMachinesToExcel(){const _0x433f5a=a16_0x74705c,_0x5d5431={'rZAeT':function(_0xcf8fa6,_0x3fab42,_0x82fc8f){return _0xcf8fa6(_0x3fab42,_0x82fc8f);},'zRRDl':_0x433f5a(0x1d2),'uNfvi':_0x433f5a(0x238),'JeqGo':_0x433f5a(0x2a7),'xErHB':_0x433f5a(0x349),'DUHMp':_0x433f5a(0x199),'FMwxx':'Error\x20exporting\x20machines\x20to\x20Excel:','QKbeb':function(_0x434ea8){return _0x434ea8();},'rXDTA':_0x433f5a(0x32c)};showLoader();try{if(0x0===a16_0x1d463c[_0x433f5a(0x292)][_0x433f5a(0x182)])return hideLoader(),void _0x5d5431[_0x433f5a(0x16f)](showCustomAlert,_0x5d5431['zRRDl'],_0x5d5431[_0x433f5a(0x184)]);const _0x2e4ee6=[],_0x1bf98a={};a16_0x1d463c['machines'][_0x433f5a(0x378)](_0x2f429f=>{const _0x1fd05a=_0x433f5a;_0x1bf98a[_0x2f429f['stage']]||(_0x1bf98a[_0x2f429f['stage']]=[]),_0x1bf98a[_0x2f429f[_0x1fd05a(0x1f9)]][_0x1fd05a(0x13a)](_0x2f429f);}),a16_0x1d463c[_0x433f5a(0x218)][_0x433f5a(0x378)](_0x2e4ccd=>{const _0x38fa2a=_0x433f5a;_0x1bf98a[_0x2e4ccd]&&_0x1bf98a[_0x2e4ccd][_0x38fa2a(0x378)](_0x531b29=>{const _0x123d7f=_0x38fa2a,_0x252bf9=a16_0x1d463c[_0x123d7f(0x175)][_0x123d7f(0x21b)](_0x22f077=>_0x22f077[_0x123d7f(0x1cb)]&&_0x22f077[_0x123d7f(0x1cb)]['includes'](_0x531b29['id'])),_0x4e3227=_0x252bf9[_0x123d7f(0x187)](_0x17f814=>_0x17f814['name'])[_0x123d7f(0x331)](',\x20')||_0x123d7f(0x290),_0x193f5d=_0x252bf9[_0x123d7f(0x182)];_0x2e4ee6['push']({'Machine\x20Number':_0x531b29['machineNumber'],'Machine\x20Name':_0x531b29['name'],'Stage':_0x531b29[_0x123d7f(0x1f9)],'Area\x20(sq\x20cm)':_0x531b29['area'],'Assigned\x20Products\x20Count':_0x193f5d,'Assigned\x20Products':_0x4e3227});});});const _0x325e6c=XLSX['utils']['json_to_sheet'](_0x2e4ee6),_0x1609f9=XLSX[_0x433f5a(0x2f9)][_0x433f5a(0x34b)]();XLSX[_0x433f5a(0x2f9)][_0x433f5a(0x247)](_0x1609f9,_0x325e6c,_0x5d5431['JeqGo']);const _0x15d61e=[{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0xf},{'wch':0x14},{'wch':0x32}];_0x325e6c[_0x5d5431[_0x433f5a(0x355)]]=_0x15d61e;const _0x1ac5b6=new Date()[_0x433f5a(0x242)]()[_0x433f5a(0x1e8)]('T')[0x0];XLSX['writeFile'](_0x1609f9,_0x433f5a(0x164)+_0x1ac5b6+_0x433f5a(0x1f3)),hideLoader(),_0x5d5431[_0x433f5a(0x16f)](showCustomAlert,_0x5d5431[_0x433f5a(0x1d9)],_0x433f5a(0x2be));}catch(_0x574e19){console[_0x433f5a(0x191)](_0x5d5431['FMwxx'],_0x574e19),_0x5d5431[_0x433f5a(0x12f)](hideLoader),_0x5d5431[_0x433f5a(0x16f)](showCustomAlert,'Error',_0x5d5431['rXDTA']);}}export function exportProductMacoToExcel(_0x5ea970='all'){const _0x3a1898=a16_0x74705c,_0x19947c={'TmTbs':function(_0xe09ee5,_0x453a03){return _0xe09ee5(_0x453a03);},'jcLvv':function(_0x4a85ec,_0xa06a8e){return _0x4a85ec/_0xa06a8e;},'SDToC':function(_0x30ad96,_0x434128){return _0x30ad96===_0x434128;},'qOzIM':'true','IsgfZ':_0x3a1898(0x251),'GWhki':_0x3a1898(0x2c0),'YkbOS':function(_0x230d60,_0x46acab){return _0x230d60===_0x46acab;},'IQTtY':function(_0x135e14,_0x48740f){return _0x135e14/_0x48740f;},'Ktzoe':function(_0x5b8bcf,_0x5e069c){return _0x5b8bcf*_0x5e069c;},'zIxTG':function(_0xf126d4,_0x27c4e4){return _0xf126d4*_0x27c4e4;},'VTjVD':_0x3a1898(0x1dc),'JnUhe':function(_0x13af6f,_0x228212){return _0x13af6f>_0x228212;},'EbobM':_0x3a1898(0x30e),'YMlia':function(_0x403ed4,_0x5cf877){return _0x403ed4(_0x5cf877);},'EeFvU':function(_0xa49a45,_0x47cdf8){return _0xa49a45==_0x47cdf8;},'TrDcm':'number','bMmtY':function(_0x762d1a){return _0x762d1a();},'vHsLw':_0x3a1898(0x1d2),'DFfqu':_0x3a1898(0x287),'hEntN':function(_0x166f3d,_0x168544){return _0x166f3d!==_0x168544;},'SYiqg':'all','OpbvP':_0x3a1898(0x324),'CTSsQ':_0x3a1898(0x22d),'ppXku':function(_0x38e994,_0x4ed516){return _0x38e994!==_0x4ed516;},'kQfuB':function(_0x2ac428,_0x53fbbd,_0x5b4eda){return _0x2ac428(_0x53fbbd,_0x5b4eda);},'DkFZS':'Product\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','lSKIm':_0x3a1898(0x294),'AvLIq':_0x3a1898(0x146),'bExSc':_0x3a1898(0x1a1)};_0x19947c['bMmtY'](showLoader),import(_0x19947c[_0x3a1898(0x302)])['then'](_0x31f2ee=>{const _0xcee7d2=_0x3a1898,_0x29bce7={'gFGpt':function(_0x1a6727,_0x366743){const _0x4d83f4=a16_0x37a5;return _0x19947c[_0x4d83f4(0x159)](_0x1a6727,_0x366743);},'ShBfh':function(_0x91d81d,_0x4a7943){return _0x19947c['jcLvv'](_0x91d81d,_0x4a7943);},'RJqYL':function(_0x40b473,_0x125b08){return _0x40b473/_0x125b08;},'JEugG':function(_0x610a9c,_0xda0137){return _0x610a9c/_0xda0137;},'QUejU':function(_0x2f1a78,_0x421d7b){const _0x2ce90b=a16_0x37a5;return _0x19947c[_0x2ce90b(0x2b9)](_0x2f1a78,_0x421d7b);},'zGvIk':_0x19947c[_0xcee7d2(0x226)],'LaMht':_0x19947c[_0xcee7d2(0x360)],'rzpKE':_0x19947c[_0xcee7d2(0x337)],'JXGKy':function(_0x9b95b4,_0x361d69){const _0x117b75=_0xcee7d2;return _0x19947c[_0x117b75(0x1a2)](_0x9b95b4,_0x361d69);},'slkdO':function(_0x5dce5e,_0x14b8ad){return _0x5dce5e*_0x14b8ad;},'fwmqq':function(_0x3f6e87,_0x59484c){const _0x4b8ddc=_0xcee7d2;return _0x19947c[_0x4b8ddc(0x25e)](_0x3f6e87,_0x59484c);},'xVMCC':function(_0x30c3bf,_0x38ddf3){return _0x19947c['Ktzoe'](_0x30c3bf,_0x38ddf3);},'rPTjN':function(_0x6c27a8,_0x2935ae,_0x560bb9){return _0x6c27a8(_0x2935ae,_0x560bb9);},'ltvVV':function(_0x263486,_0x16609a){const _0xb59bcf=_0xcee7d2;return _0x19947c[_0xb59bcf(0x127)](_0x263486,_0x16609a);},'whceT':_0x19947c[_0xcee7d2(0x1c1)],'wnFqh':function(_0x515153,_0x135fe3){return _0x19947c['YkbOS'](_0x515153,_0x135fe3);},'kJKAC':_0xcee7d2(0x2a2),'TKkJQ':_0xcee7d2(0x1ba),'HnEey':_0xcee7d2(0x21f),'fOwMH':function(_0x2d493f,_0x23f963){return _0x19947c['JnUhe'](_0x2d493f,_0x23f963);},'MCrGB':function(_0x2dd9d0,_0x57bc8c){const _0x34deeb=_0xcee7d2;return _0x19947c[_0x34deeb(0x127)](_0x2dd9d0,_0x57bc8c);},'wKymq':_0x19947c[_0xcee7d2(0x23f)],'PkNEV':function(_0x377f21){return _0x377f21();},'qYxjL':function(_0x11a6a8,_0x293a77){const _0x548ae6=_0xcee7d2;return _0x19947c[_0x548ae6(0x144)](_0x11a6a8,_0x293a77);},'ysPOq':function(_0x1b74c3,_0x12bf5e){return _0x1b74c3!==_0x12bf5e;},'NDbqz':function(_0x4924b3,_0x5d5021){const _0x2499b8=_0xcee7d2;return _0x19947c[_0x2499b8(0x365)](_0x4924b3,_0x5d5021);},'puxDB':_0x19947c[_0xcee7d2(0x16a)]},{getTrainData:_0x5adb80,getWorstCaseProductType:_0x1d348c,getMacoPerSwabForTrain:_0x55bbd8,getLargestEssaForLineAndDosageForm:_0xc45ad3}=_0x31f2ee,_0xf6de62=_0x5adb80();if(0x0===_0xf6de62[_0xcee7d2(0x182)])return _0x19947c['bMmtY'](hideLoader),void showCustomAlert(_0x19947c[_0xcee7d2(0x158)],_0x19947c['DFfqu']);let _0x28bda0=_0xf6de62;if(_0x19947c[_0xcee7d2(0x235)](_0x19947c[_0xcee7d2(0x198)],_0x5ea970)&&(_0x28bda0=Array[_0xcee7d2(0x31e)](_0x5ea970)?_0xf6de62[_0xcee7d2(0x21b)](_0x4383ac=>_0x5ea970[_0xcee7d2(0x352)](String(_0x4383ac['id']))):_0xf6de62[_0xcee7d2(0x21b)](_0x277999=>String(_0x277999['id'])===String(_0x5ea970))),0x0===_0x28bda0[_0xcee7d2(0x182)])return _0x19947c[_0xcee7d2(0x262)](hideLoader),void showCustomAlert(_0xcee7d2(0x1d2),'No\x20trains\x20match\x20the\x20selected\x20criteria.');const _0x51bc9e=[];_0x28bda0[_0xcee7d2(0x378)](_0x151d74=>{const _0xa91ca9=_0xcee7d2,_0x2e878a={'ddXDt':function(_0x5d2d4b,_0xf28186){return _0x5d2d4b||_0xf28186;}},_0x277f3f=_0x29bce7[_0xa91ca9(0x203)](_0x1d348c,_0x151d74['products'][_0xa91ca9(0x187)](_0x4c4c02=>_0x4c4c02[_0xa91ca9(0x263)])),_0x294cc9=(a16_0x1d463c[_0xa91ca9(0x15c)][_0x277f3f]||a16_0x1d463c['safetyFactorConfig'][_0xa91ca9(0x20a)])[_0xa91ca9(0x34e)],_0x24f4aa=_0x29bce7[_0xa91ca9(0x1b5)](_0x151d74[_0xa91ca9(0x2e9)]*_0x151d74[_0xa91ca9(0x136)],_0x294cc9),_0x51272b=0xa*_0x151d74[_0xa91ca9(0x19f)];let _0x4442d2=_0x29bce7['RJqYL'](0x1,0x0),_0xdcab48=_0x29bce7[_0xa91ca9(0x26e)](0x1,0x0);const _0x3caefe=_0x29bce7['QUejU'](_0x29bce7[_0xa91ca9(0x330)],localStorage[_0xa91ca9(0x31f)](_0x29bce7[_0xa91ca9(0x27e)])),_0x2e00f4=_0xa91ca9(0x35a)===localStorage[_0xa91ca9(0x31f)](_0x29bce7['rzpKE']);if(_0x29bce7[_0xa91ca9(0x1f2)](null,_0x151d74['lowestPde'])||_0x3caefe||(_0x4442d2=_0x151d74[_0xa91ca9(0x348)]*_0x151d74[_0xa91ca9(0x136)]),null!==_0x151d74[_0xa91ca9(0x25c)]&&!_0x2e00f4){const _0x2c0b48=_0x29bce7[_0xa91ca9(0x1b5)](_0x29bce7[_0xa91ca9(0x2e5)](0x46,_0x151d74[_0xa91ca9(0x25c)]),0x7d0),_0x2fa6c8=_0x151d74['products'][_0xa91ca9(0x1fc)](_0xeac4e7=>_0xeac4e7[_0xa91ca9(0x208)][_0xa91ca9(0x187)](_0x2a09d4=>_0x2a09d4[_0xa91ca9(0x37b)]/0x3e8)),_0x512cee=Math[_0xa91ca9(0x177)](..._0x2fa6c8);_0xdcab48=_0x29bce7[_0xa91ca9(0x310)](_0x29bce7[_0xa91ca9(0x2e5)](_0x29bce7['xVMCC'](_0x2c0b48,_0x151d74[_0xa91ca9(0x19f)]),0x3e8),_0x29bce7['xVMCC'](_0x294cc9,_0x512cee));}const _0x52c1c4=_0x29bce7[_0xa91ca9(0x1e1)](_0xc45ad3,_0x151d74,_0xf6de62),_0x14bd80=_0x29bce7[_0xa91ca9(0x1cf)](0.004,_0x52c1c4),_0x67c6ab=[{'name':_0xa91ca9(0x12c),'value':_0x24f4aa},{'name':_0x29bce7[_0xa91ca9(0x1a5)],'value':_0x51272b}];_0x29bce7['wnFqh'](null,_0x151d74[_0xa91ca9(0x348)])||_0x3caefe||_0x67c6ab[_0xa91ca9(0x13a)]({'name':_0x29bce7[_0xa91ca9(0x2ab)],'value':_0x4442d2}),_0x29bce7[_0xa91ca9(0x13e)](null,_0x151d74[_0xa91ca9(0x25c)])||_0x2e00f4||_0x67c6ab['push']({'name':_0x29bce7[_0xa91ca9(0x308)],'value':_0xdcab48}),_0x67c6ab[_0xa91ca9(0x13a)]({'name':_0x29bce7[_0xa91ca9(0x1d3)],'value':_0x14bd80});const _0x5d2063=_0x67c6ab[_0xa91ca9(0x304)]((_0x272023,_0x44796c)=>_0x44796c[_0xa91ca9(0x341)]<_0x272023['value']?_0x44796c:_0x272023),_0x151628=_0x5d2063['value'],_0x5ae077=_0x29bce7['fOwMH'](_0x52c1c4,0x0)?_0x151628/_0x52c1c4:0x0,_0x234687=_0x29bce7[_0xa91ca9(0x229)](_0x5ae077,_0x151d74[_0xa91ca9(0x173)]),_0x13be03=_0x151d74[_0xa91ca9(0x1cb)][_0xa91ca9(0x187)](_0x454772=>{const _0xd982bc=_0xa91ca9,_0xfccaaa=a16_0x1d463c[_0xd982bc(0x292)][_0xd982bc(0x258)](_0x532823=>_0x532823['id']===_0x454772);return _0x2e878a['ddXDt'](_0xfccaaa,{'name':_0xd982bc(0x296)+_0x454772+')','machineNumber':'N/A'});}),_0x51c13d=_0x151d74[_0xa91ca9(0x1cb)][_0xa91ca9(0x187)](_0x325690=>{const _0x138ae2=_0xa91ca9,_0x30be44=a16_0x1d463c[_0x138ae2(0x292)]['find'](_0x14d32a=>_0x14d32a['id']===_0x325690);return _0x30be44?_0x30be44['name']:_0x138ae2(0x296)+_0x325690+')';})[_0xa91ca9(0x331)](',\x20'),_0x3742e6=_0x151d74['products'][_0xa91ca9(0x187)](_0x29129e=>_0x29129e['productCode']+'\x20-\x20'+_0x29129e['name'])[_0xa91ca9(0x331)](';\x20'),_0x11702b=_0x151d74[_0xa91ca9(0x246)]?_0x151d74[_0xa91ca9(0x246)][_0xa91ca9(0x24f)]+'\x20('+_0x151d74['worstProductRpn'][_0xa91ca9(0x1b0)]+_0xa91ca9(0x2f0)+_0x151d74['worstProductRpn'][_0xa91ca9(0x1cd)]:_0x29bce7['wKymq'];_0x51bc9e[_0xa91ca9(0x13a)]({'Train':'T'+(_0x29bce7[_0xa91ca9(0x1e4)](a16_0x56e423)['get'](_0x29bce7[_0xa91ca9(0x351)](String,_0x151d74['id']))?.[_0xa91ca9(0x35e)]||_0x151d74['id']),'Total\x20Products':_0x151d74['products']['length'],'Total\x20Machines':_0x13be03[_0xa91ca9(0x182)],'Total\x20Area\x20(ESSA)\x20cm²':_0x151d74[_0xa91ca9(0x33f)][_0xa91ca9(0x12d)](),'Products':_0x3742e6,'Machines':_0x51c13d,'Worst-Case\x20Dosage\x20Form':_0x277f3f,'Safety\x20Factor':_0x294cc9,'Lowest\x20LTD\x20(mg)':_0x151d74[_0xa91ca9(0x2e9)],'Min\x20Batch\x20Size\x20(kg)':_0x151d74[_0xa91ca9(0x19f)],'Min\x20BS/MDD\x20Ratio':_0x151d74[_0xa91ca9(0x136)]['toFixed'](0x2),'Lowest\x20PDE\x20(mg)':_0x29bce7[_0xa91ca9(0x33a)](null,_0x151d74['lowestPde'])?_0x151d74[_0xa91ca9(0x348)]:_0x29bce7[_0xa91ca9(0x379)],'Worst-Case\x20Product\x20(by\x20RPN)':_0x11702b,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x24f4aa[_0xa91ca9(0x154)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x51272b[_0xa91ca9(0x154)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x29bce7['NDbqz'](_0x29bce7[_0xa91ca9(0x2bd)],typeof _0x4442d2)?_0x4442d2[_0xa91ca9(0x154)](0x2):_0x29bce7['wKymq'],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x14bd80[_0xa91ca9(0x154)](0x2),'Selected\x20MACO\x20Method':_0x5d2063[_0xa91ca9(0x36b)],'Final\x20MACO\x20(mg)':_0x151628[_0xa91ca9(0x154)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x5ae077[_0xa91ca9(0x1a0)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x234687[_0xa91ca9(0x154)](0x4)});});const _0xc2ff74=XLSX[_0xcee7d2(0x2f9)]['json_to_sheet'](_0x51bc9e),_0x146889=XLSX[_0xcee7d2(0x2f9)][_0xcee7d2(0x34b)]();XLSX[_0xcee7d2(0x2f9)][_0xcee7d2(0x247)](_0x146889,_0xc2ff74,_0x19947c[_0xcee7d2(0x1da)]),_0xc2ff74[_0xcee7d2(0x349)]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0x12},{'wch':0xf},{'wch':0x12},{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0x12},{'wch':0x12}];const _0x17ebb8=new Date()[_0xcee7d2(0x242)]()[_0xcee7d2(0x1e8)]('T')[0x0];let _0x1af058=_0x19947c[_0xcee7d2(0x174)];if(_0x19947c[_0xcee7d2(0x1d6)](_0x19947c[_0xcee7d2(0x198)],_0x5ea970)){if(Array[_0xcee7d2(0x31e)](_0x5ea970))_0x1af058+=_0xcee7d2(0x35f)+_0x5ea970['sort']((_0x36f765,_0x327b75)=>_0x36f765-_0x327b75)[_0xcee7d2(0x331)]('_');else _0x1af058+=_0xcee7d2(0x210)+_0x5ea970;}_0x1af058+='_'+_0x17ebb8+_0xcee7d2(0x1f3),XLSX[_0xcee7d2(0x13d)](_0x146889,_0x1af058),hideLoader(),_0x19947c[_0xcee7d2(0x260)](showCustomAlert,_0xcee7d2(0x199),_0x19947c['DkFZS']);})[_0x3a1898(0x18a)](_0x376822=>{const _0x53d7aa=_0x3a1898;console[_0x53d7aa(0x191)](_0x19947c[_0x53d7aa(0x272)],_0x376822),hideLoader(),showCustomAlert(_0x53d7aa(0x28b),_0x19947c[_0x53d7aa(0x27a)]);});}function a16_0x37a5(_0x459c03,_0x2df16d){const _0x5263d7=a16_0x5263();return a16_0x37a5=function(_0x37a5e0,_0x5ad104){_0x37a5e0=_0x37a5e0-0x127;let _0x3fc3e0=_0x5263d7[_0x37a5e0];return _0x3fc3e0;},a16_0x37a5(_0x459c03,_0x2df16d);}export function exportDetergentMacoToExcel(_0x5b1bf3=a16_0x74705c(0x254)){const _0x59424f=a16_0x74705c,_0x4692d6={'XQDfw':function(_0x43eb33,_0x5c5f72){return _0x43eb33||_0x5c5f72;},'IOWMp':function(_0x12e073,_0x3ea4c1){return _0x12e073(_0x3ea4c1);},'SURfo':function(_0x24eea8,_0x5126df){return _0x24eea8/_0x5126df;},'skkrw':function(_0x4b45fc,_0x493f4e){return _0x4b45fc*_0x493f4e;},'vizNL':function(_0x40f78f,_0xdde7d5){return _0x40f78f>_0xdde7d5;},'RzHSE':function(_0x54e89d,_0x22bab0){return _0x54e89d*_0x22bab0;},'IJJgv':function(_0x3610d4){return _0x3610d4();},'gsJeH':function(_0x3aefb2,_0xb910b8){return _0x3aefb2===_0xb910b8;},'auoTX':function(_0x4a2ace){return _0x4a2ace();},'olgVI':function(_0xf9b4ec,_0x56655c,_0x18f934){return _0xf9b4ec(_0x56655c,_0x18f934);},'HbJeG':_0x59424f(0x1d2),'PyxBd':'There\x20are\x20no\x20detergent\x20ingredients\x20configured.\x20Add\x20detergent\x20ingredients\x20first.','alTWo':function(_0x1c73f5,_0x3fcdbe){return _0x1c73f5(_0x3fcdbe);},'ztlwt':'bodyWeight','TXWvp':function(_0x50f148,_0x4ec2d5){return _0x50f148>_0x4ec2d5;},'UlbgJ':_0x59424f(0x217),'gAtjl':'!cols','QBThb':function(_0x5e0a4b){return _0x5e0a4b();},'dLGCC':_0x59424f(0x313),'xMGwj':function(_0x9c0196){return _0x9c0196();},'KyNEs':function(_0x5f448a,_0x4de2e6,_0x5c87e0){return _0x5f448a(_0x4de2e6,_0x5c87e0);},'Udtgi':_0x59424f(0x1fd),'GwyYk':_0x59424f(0x1a1)};_0x4692d6[_0x59424f(0x2ef)](showLoader),import(_0x4692d6['GwyYk'])[_0x59424f(0x329)](_0x468dc7=>{const _0x3362f3=_0x59424f,{getTrainData:_0x53baef,getWorstCaseProductType:_0x2bf36e}=_0x468dc7;let _0x16c988=_0x4692d6['IJJgv'](_0x53baef);if(_0x3362f3(0x254)!==_0x5b1bf3&&(_0x16c988=Array[_0x3362f3(0x31e)](_0x5b1bf3)?_0x16c988['filter'](_0xd3a95a=>_0x5b1bf3[_0x3362f3(0x352)](String(_0xd3a95a['id']))):_0x16c988[_0x3362f3(0x21b)](_0x2d1ea5=>String(_0x2d1ea5['id'])===String(_0x5b1bf3))),_0x4692d6[_0x3362f3(0x1fe)](0x0,_0x16c988[_0x3362f3(0x182)]))return _0x4692d6['auoTX'](hideLoader),void _0x4692d6[_0x3362f3(0x1b3)](showCustomAlert,_0x4692d6[_0x3362f3(0x206)],_0x3362f3(0x287));if(_0x4692d6[_0x3362f3(0x1fe)](0x0,a16_0x1d463c[_0x3362f3(0x2f8)][_0x3362f3(0x182)]))return _0x4692d6[_0x3362f3(0x17d)](hideLoader),void _0x4692d6[_0x3362f3(0x1b3)](showCustomAlert,_0x4692d6[_0x3362f3(0x206)],_0x4692d6[_0x3362f3(0x274)]);const _0x19ab45=[],_0x15a089=_0x4692d6[_0x3362f3(0x33e)](parseFloat,document[_0x3362f3(0x23c)](_0x4692d6[_0x3362f3(0x1ab)])?.[_0x3362f3(0x341)])||0x46,_0x2052a3=a16_0x1d463c[_0x3362f3(0x2f8)]['map'](_0x5e0286=>parseFloat(_0x5e0286['ld50']))[_0x3362f3(0x21b)](_0x4c9d74=>!isNaN(_0x4c9d74)),_0xe77af1=_0x4692d6[_0x3362f3(0x34a)](_0x2052a3[_0x3362f3(0x182)],0x0)?Math['min'](..._0x2052a3):0x0,_0x106081=a16_0x1d463c[_0x3362f3(0x2f8)]['map'](_0x45bd93=>_0x45bd93['name'])[_0x3362f3(0x21b)](_0x3477f2=>''!==_0x3477f2['trim']())[_0x3362f3(0x331)](',\x20');_0x16c988[_0x3362f3(0x378)](_0x1df3f7=>{const _0x239caf=_0x3362f3,_0x17bbbc={'OLahC':function(_0x38ce44,_0xd7f86a){const _0x4ea662=a16_0x37a5;return _0x4692d6[_0x4ea662(0x2d3)](_0x38ce44,_0xd7f86a);},'uAfJJ':_0x239caf(0x30e)},_0x367714=_0x4692d6[_0x239caf(0x230)](_0x2bf36e,_0x1df3f7[_0x239caf(0x175)][_0x239caf(0x187)](_0x539887=>_0x539887[_0x239caf(0x263)])),_0x205c40=a16_0x1d463c[_0x239caf(0x15c)][_0x367714]||a16_0x1d463c[_0x239caf(0x15c)][_0x239caf(0x20a)],_0x2e99fb=document[_0x239caf(0x23c)](_0x239caf(0x20d)+_0x1df3f7['id']),_0x567da2=_0x2e99fb&&_0x4692d6[_0x239caf(0x230)](parseFloat,_0x2e99fb['value'])||_0x205c40[_0x239caf(0x34e)],_0x3caf69=_0x4692d6[_0x239caf(0x2d4)](_0x4692d6[_0x239caf(0x2b3)](_0x4692d6[_0x239caf(0x2b3)](0.0005,_0xe77af1),_0x15a089),_0x567da2),_0x3d8ac1=_0x4692d6['skkrw'](_0x3caf69,_0x1df3f7['minBsMddRatio']),_0x2dbe22=_0x468dc7[_0x239caf(0x375)](_0x1df3f7,_0x16c988),_0x220213=_0x4692d6[_0x239caf(0x28a)](_0x2dbe22,0x0)?_0x3d8ac1/_0x2dbe22:0x0,_0x4a4608=_0x4692d6[_0x239caf(0x387)](_0x220213,_0x1df3f7[_0x239caf(0x173)]),_0x472233=_0x1df3f7[_0x239caf(0x1cb)][_0x239caf(0x187)](_0x427f4d=>{const _0x2c8c6a=_0x239caf,_0xd9e019=a16_0x1d463c[_0x2c8c6a(0x292)]['find'](_0xbf4e0b=>_0xbf4e0b['id']===_0x427f4d);return _0x17bbbc[_0x2c8c6a(0x1e7)](_0xd9e019,{'name':_0x2c8c6a(0x296)+_0x427f4d+')','machineNumber':_0x17bbbc['uAfJJ']});}),_0x2eded5=_0x1df3f7[_0x239caf(0x1cb)][_0x239caf(0x187)](_0x3d5e10=>{const _0x571d73=_0x239caf,_0x3771c5=a16_0x1d463c[_0x571d73(0x292)][_0x571d73(0x258)](_0xc1aa2b=>_0xc1aa2b['id']===_0x3d5e10);return _0x3771c5?_0x3771c5[_0x571d73(0x36b)]:_0x571d73(0x296)+_0x3d5e10+')';})['join'](',\x20'),_0x3fd314=_0x1df3f7[_0x239caf(0x175)][_0x239caf(0x187)](_0x5664c4=>_0x5664c4[_0x239caf(0x37f)]+_0x239caf(0x30b)+_0x5664c4['name'])[_0x239caf(0x331)](';\x20'),_0xeb660c=_0x1df3f7[_0x239caf(0x246)]?_0x1df3f7[_0x239caf(0x246)]['productName']+'\x20('+_0x1df3f7[_0x239caf(0x246)][_0x239caf(0x1b0)]+')\x20-\x20RPN:\x20'+_0x1df3f7['worstProductRpn']['rpn']:_0x239caf(0x30e);_0x19ab45[_0x239caf(0x13a)]({'Train':'T'+(_0x4692d6[_0x239caf(0x17d)](a16_0x56e423)[_0x239caf(0x372)](String(_0x1df3f7['id']))?.[_0x239caf(0x35e)]||_0x1df3f7['id']),'Total\x20Products':_0x1df3f7[_0x239caf(0x175)][_0x239caf(0x182)],'Total\x20Machines':_0x472233['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x1df3f7[_0x239caf(0x33f)]['toLocaleString'](),'Products':_0x3fd314,'Machines':_0x2eded5,'Worst-Case\x20Dosage\x20Form':_0x367714,'Safety\x20Factor\x20Range':_0x205c40['min']+'\x20-\x20'+_0x205c40[_0x239caf(0x34e)],'Applied\x20Safety\x20Factor':_0x567da2,'Detergent\x20Ingredients':_0x106081,'Body\x20Weight\x20(kg)':_0x15a089,'Minimum\x20LD50\x20(mg/kg)':_0xe77af1,'Min\x20Batch\x20Size\x20(kg)':_0x1df3f7[_0x239caf(0x19f)],'Min\x20BS/MDD\x20Ratio':_0x1df3f7[_0x239caf(0x136)]['toFixed'](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0xeb660c,'ADI\x20(mg)':_0x3caf69[_0x239caf(0x154)](0x4),'MACO\x20(mg)':_0x3d8ac1['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x220213[_0x239caf(0x1a0)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x4a4608[_0x239caf(0x154)](0x4)});});const _0x30a70b=XLSX[_0x3362f3(0x2f9)]['json_to_sheet'](_0x19ab45),_0x7893d7=XLSX[_0x3362f3(0x2f9)][_0x3362f3(0x34b)]();XLSX[_0x3362f3(0x2f9)][_0x3362f3(0x247)](_0x7893d7,_0x30a70b,_0x4692d6[_0x3362f3(0x25f)]),_0x30a70b[_0x4692d6['gAtjl']]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0x1e},{'wch':0xc},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0xc},{'wch':0xc},{'wch':0x12},{'wch':0x12}];const _0x448343=new Date()[_0x3362f3(0x242)]()[_0x3362f3(0x1e8)]('T')[0x0];XLSX[_0x3362f3(0x13d)](_0x7893d7,'Detergent_MACO_Report_'+_0x448343+'.xlsx'),_0x4692d6[_0x3362f3(0x32e)](hideLoader),showCustomAlert(_0x3362f3(0x199),_0x4692d6[_0x3362f3(0x166)]);})[_0x59424f(0x18a)](_0x55b7e7=>{const _0x2f394f=_0x59424f;console[_0x2f394f(0x191)]('Error\x20exporting\x20Detergent\x20MACO\x20to\x20Excel:',_0x55b7e7),_0x4692d6[_0x2f394f(0x1c3)](hideLoader),_0x4692d6[_0x2f394f(0x384)](showCustomAlert,'Error',_0x4692d6[_0x2f394f(0x20f)]);});}export function exportTrainSummaryToExcel(_0x3fa8c7=a16_0x74705c(0x254)){const _0x54ef7e=a16_0x74705c,_0x538be0={'pPhLP':function(_0x16db0b){return _0x16db0b();},'yprNk':function(_0x541b62,_0x65e999){return _0x541b62(_0x65e999);},'SqEcu':_0x54ef7e(0x30e),'JGLIH':function(_0x3e8fb3,_0x23fb18){return _0x3e8fb3||_0x23fb18;},'dbiqA':function(_0x1bd8df){return _0x1bd8df();},'eSfxA':function(_0xb1b621,_0x308d97){return _0xb1b621===_0x308d97;},'iDXlv':function(_0x19ed88){return _0x19ed88();},'ZFICZ':function(_0x2cab54,_0x281d9a,_0xd56028){return _0x2cab54(_0x281d9a,_0xd56028);},'vmvXQ':_0x54ef7e(0x1d2),'QJYnN':_0x54ef7e(0x287),'CDWnV':function(_0x67a4bd,_0x51f47d){return _0x67a4bd!==_0x51f47d;},'XAFqV':_0x54ef7e(0x254),'osMJg':function(_0x22421b,_0x1bde94,_0x46cb45){return _0x22421b(_0x1bde94,_0x46cb45);},'kgRbN':_0x54ef7e(0x1b4),'dexpx':_0x54ef7e(0x349),'aXmhK':function(_0x1cf44e,_0xab616){return _0x1cf44e!==_0xab616;},'riVuh':function(_0x3f41bd){return _0x3f41bd();},'cAEAl':function(_0x55fd9d,_0x43dac9,_0x18d0e9){return _0x55fd9d(_0x43dac9,_0x18d0e9);},'WbSwO':_0x54ef7e(0x199),'UHFId':'Train\x20Summary\x20data\x20exported\x20to\x20Excel\x20successfully!','KAYZo':_0x54ef7e(0x28b),'JxDSd':'Failed\x20to\x20export\x20Train\x20Summary\x20data\x20to\x20Excel.','JXBdz':function(_0x43fa7f){return _0x43fa7f();}};_0x538be0[_0x54ef7e(0x2bf)](showLoader),import(_0x54ef7e(0x1a1))[_0x54ef7e(0x329)](_0x43dc30=>{const _0x47e04a=_0x54ef7e,_0x15cb24={'LzzcM':function(_0x4639c8,_0xf297d8){const _0x23c59a=a16_0x37a5;return _0x538be0[_0x23c59a(0x257)](_0x4639c8,_0xf297d8);}},{getTrainData:_0x392879}=_0x43dc30,_0x30ce7f=_0x538be0['dbiqA'](_0x392879);if(_0x538be0['eSfxA'](0x0,_0x30ce7f[_0x47e04a(0x182)]))return _0x538be0[_0x47e04a(0x2cf)](hideLoader),void _0x538be0[_0x47e04a(0x323)](showCustomAlert,_0x538be0['vmvXQ'],_0x538be0[_0x47e04a(0x216)]);let _0x5d3ea0=_0x30ce7f;if(_0x538be0['CDWnV'](_0x538be0[_0x47e04a(0x2fd)],_0x3fa8c7)&&(_0x5d3ea0=Array[_0x47e04a(0x31e)](_0x3fa8c7)?_0x30ce7f[_0x47e04a(0x21b)](_0x4ad87c=>_0x3fa8c7[_0x47e04a(0x352)](String(_0x4ad87c['id']))):_0x30ce7f[_0x47e04a(0x21b)](_0x5d6d01=>String(_0x5d6d01['id'])===String(_0x3fa8c7))),0x0===_0x5d3ea0[_0x47e04a(0x182)])return hideLoader(),void _0x538be0[_0x47e04a(0x2a5)](showCustomAlert,'No\x20Data',_0x47e04a(0x15d));const _0x5ee2a4=[];_0x5d3ea0[_0x47e04a(0x378)](_0x2d7fea=>{const _0x18cbbc=_0x47e04a,_0x3e89d1=_0x2d7fea[_0x18cbbc(0x1cb)][_0x18cbbc(0x187)](_0x54c93a=>{const _0x35cf42=_0x18cbbc,_0x3b4f79=a16_0x1d463c[_0x35cf42(0x292)][_0x35cf42(0x258)](_0x12edfa=>_0x12edfa['id']===_0x54c93a);return _0x15cb24[_0x35cf42(0x1ca)](_0x3b4f79,{'id':_0x54c93a,'name':'Unknown\x20(ID:\x20'+_0x54c93a+')','machineNumber':_0x35cf42(0x30e)});}),_0x1778ed=_0x2d7fea[_0x18cbbc(0x1cb)][_0x18cbbc(0x187)](_0x2446db=>{const _0x13f985=_0x18cbbc,_0x26199e=a16_0x1d463c[_0x13f985(0x292)][_0x13f985(0x258)](_0x2b4360=>_0x2b4360['id']===_0x2446db);return _0x26199e?_0x26199e[_0x13f985(0x36b)]:_0x13f985(0x296)+_0x2446db+')';})[_0x18cbbc(0x331)](',\x20'),_0x33294c=_0x2d7fea[_0x18cbbc(0x175)][_0x18cbbc(0x187)](_0x37e2c3=>_0x37e2c3[_0x18cbbc(0x37f)]+_0x18cbbc(0x30b)+_0x37e2c3[_0x18cbbc(0x36b)])[_0x18cbbc(0x331)](';\x20'),_0x104ced=_0x2d7fea[_0x18cbbc(0x175)]['map'](_0x1d045f=>_0x1d045f[_0x18cbbc(0x37f)]+':\x20'+_0x1d045f[_0x18cbbc(0x36b)])[_0x18cbbc(0x331)]('\x0a'),_0x4396f7=_0x3e89d1[_0x18cbbc(0x187)](_0x224b9f=>_0x224b9f['machineNumber']+':\x20'+_0x224b9f[_0x18cbbc(0x36b)])[_0x18cbbc(0x331)]('\x0a');_0x5ee2a4['push']({'Train\x20ID':'T'+(_0x538be0[_0x18cbbc(0x28c)](a16_0x56e423)[_0x18cbbc(0x372)](_0x538be0[_0x18cbbc(0x1c7)](String,_0x2d7fea['id']))?.[_0x18cbbc(0x35e)]||_0x2d7fea['id']),'Products\x20Count':_0x2d7fea[_0x18cbbc(0x175)][_0x18cbbc(0x182)],'Machines\x20Count':_0x3e89d1[_0x18cbbc(0x182)],'Total\x20Area\x20(ESSA)\x20cm²':_0x2d7fea[_0x18cbbc(0x33f)][_0x18cbbc(0x12d)](),'Products\x20(Code\x20-\x20Name)':_0x33294c,'Machines\x20(Number\x20-\x20Name)':_0x1778ed,'Products\x20Detailed':_0x104ced,'Machines\x20Detailed':_0x4396f7,'Min\x20Batch\x20Size\x20(kg)':_0x2d7fea[_0x18cbbc(0x19f)],'Min\x20BS/MDD\x20Ratio':_0x2d7fea[_0x18cbbc(0x136)][_0x18cbbc(0x154)](0x2),'Assumed\x20SSA\x20(cm²)':_0x2d7fea['assumedSsa'],'Lowest\x20LTD\x20(mg)':_0x2d7fea[_0x18cbbc(0x2e9)],'Lowest\x20PDE\x20(mg)':null!==_0x2d7fea[_0x18cbbc(0x348)]?_0x2d7fea[_0x18cbbc(0x348)]:_0x538be0[_0x18cbbc(0x321)],'Worst\x20RPN\x20Product':_0x2d7fea[_0x18cbbc(0x246)]?_0x2d7fea[_0x18cbbc(0x246)][_0x18cbbc(0x24f)]+'\x20('+_0x2d7fea['worstProductRpn'][_0x18cbbc(0x1b0)]+_0x18cbbc(0x2f0)+_0x2d7fea[_0x18cbbc(0x246)][_0x18cbbc(0x1cd)]:_0x538be0[_0x18cbbc(0x321)]});});const _0x2608e6=XLSX[_0x47e04a(0x2f9)][_0x47e04a(0x15b)](_0x5ee2a4),_0x1f9e87=XLSX['utils'][_0x47e04a(0x34b)]();XLSX[_0x47e04a(0x2f9)]['book_append_sheet'](_0x1f9e87,_0x2608e6,_0x538be0[_0x47e04a(0x1f8)]),_0x2608e6[_0x538be0['dexpx']]=[{'wch':0xa},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x3c},{'wch':0x3c},{'wch':0x28},{'wch':0x28},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32}];const _0x196157=new Date()[_0x47e04a(0x242)]()['split']('T')[0x0];let _0x44e2ca=_0x47e04a(0x26c);if(_0x538be0[_0x47e04a(0x1db)](_0x538be0[_0x47e04a(0x2fd)],_0x3fa8c7)){if(Array['isArray'](_0x3fa8c7))_0x44e2ca+=_0x47e04a(0x35f)+_0x3fa8c7[_0x47e04a(0x153)]((_0x496f83,_0x4b7478)=>_0x496f83-_0x4b7478)[_0x47e04a(0x331)]('_');else _0x44e2ca+='_Train_'+_0x3fa8c7;}_0x44e2ca+='_'+_0x196157+'.xlsx',XLSX['writeFile'](_0x1f9e87,_0x44e2ca),_0x538be0[_0x47e04a(0x1ac)](hideLoader),_0x538be0['cAEAl'](showCustomAlert,_0x538be0[_0x47e04a(0x21a)],_0x538be0[_0x47e04a(0x25a)]);})[_0x54ef7e(0x18a)](_0x5d0889=>{const _0x2dbe4c=_0x54ef7e;console[_0x2dbe4c(0x191)]('Error\x20exporting\x20Train\x20Summary\x20to\x20Excel:',_0x5d0889),_0x538be0['dbiqA'](hideLoader),showCustomAlert(_0x538be0[_0x2dbe4c(0x31d)],_0x538be0[_0x2dbe4c(0x23a)]);});}export function exportSummaryToExcel(){const _0x51afd4=a16_0x74705c,_0x422d7e={'dDzFf':function(_0x158ee3,_0x23ea5e){return _0x158ee3!==_0x23ea5e;},'LHzFx':_0x51afd4(0x30e),'ALVxy':_0x51afd4(0x374),'bvxVp':function(_0x41ebb8,_0x3599fb){return _0x41ebb8(_0x3599fb);},'HdjPu':function(_0x4963f0,_0x43b11){return _0x4963f0===_0x43b11;},'cZtWh':function(_0x3e3e1a){return _0x3e3e1a();},'TuPtd':function(_0x17e4bf,_0x24f44e,_0x43ee6b){return _0x17e4bf(_0x24f44e,_0x43ee6b);},'WJZjF':_0x51afd4(0x1d2),'yDuKO':function(_0xe34df0,_0x33ff91){return _0xe34df0>_0x33ff91;},'PiEdF':_0x51afd4(0x349),'eaHFD':_0x51afd4(0x1a4),'ITYOT':_0x51afd4(0x1d5),'KNgmQ':function(_0x5b91f8,_0x5749bd,_0x49f4e2){return _0x5b91f8(_0x5749bd,_0x49f4e2);},'VkHvE':_0x51afd4(0x18b),'BNijl':_0x51afd4(0x183),'BzDHA':_0x51afd4(0x1a1)};showLoader(),import(_0x422d7e['BzDHA'])[_0x51afd4(0x329)](_0x2b38a4=>{const _0x42fa4a=_0x51afd4,_0x3ffa6c={'vcdPL':function(_0x5e6d6c,_0x3b7e3c){return _0x5e6d6c(_0x3b7e3c);},'PYUhT':function(_0x11c7d4,_0x4d8faa){const _0x1e580e=a16_0x37a5;return _0x422d7e[_0x1e580e(0x2cc)](_0x11c7d4,_0x4d8faa);},'AqKSM':function(_0x288402,_0x392536){return _0x288402>_0x392536;}},{getProductTrainId:_0x3fa9ad,calculateScores:_0x448cc2}=_0x2b38a4,_0x50158d=a16_0x1d463c['products']['flatMap'](_0xa3c163=>{const _0x31ce97=a16_0x37a5,_0x5d9320=_0x3ffa6c[_0x31ce97(0x1f7)](a16_0x22d264,_0xa3c163);return _0xa3c163[_0x31ce97(0x208)][_0x31ce97(0x187)](_0x598448=>({'productName':_0xa3c163['name'],'productCode':_0xa3c163[_0x31ce97(0x37f)],'ingredientName':_0x598448['name'],'rpn':_0x448cc2(_0x598448)[_0x31ce97(0x1cd)],'trainId':_0x31ce97(0x30e)!==_0x5d9320?'T'+_0x5d9320:_0x31ce97(0x30e),'scores':_0x448cc2(_0x598448)}));})[_0x42fa4a(0x153)]((_0x56e9c9,_0x2065a4)=>_0x2065a4['rpn']-_0x56e9c9['rpn'])[_0x42fa4a(0x350)](0x0,0xa),_0x4e5f1a=a16_0x1d463c[_0x42fa4a(0x175)][_0x42fa4a(0x21b)](_0x1835e8=>_0x1835e8[_0x42fa4a(0x1b2)]);if(_0x422d7e['HdjPu'](0x0,_0x50158d['length'])&&_0x422d7e[_0x42fa4a(0x1a9)](0x0,_0x4e5f1a[_0x42fa4a(0x182)]))return _0x422d7e[_0x42fa4a(0x303)](hideLoader),void _0x422d7e[_0x42fa4a(0x36a)](showCustomAlert,_0x422d7e[_0x42fa4a(0x142)],_0x42fa4a(0x17f));const _0x2d4d96=XLSX[_0x42fa4a(0x2f9)]['book_new']();if(_0x422d7e[_0x42fa4a(0x2c2)](_0x50158d['length'],0x0)){const _0x51660d=_0x50158d[_0x42fa4a(0x187)]((_0x24afd6,_0x4d4ebf)=>({'Rank':_0x4d4ebf+0x1,'Product\x20Code':_0x24afd6['productCode'],'Product\x20Name':_0x24afd6['productName'],'Train':_0x24afd6[_0x42fa4a(0x2eb)],'Ingredient':_0x24afd6[_0x42fa4a(0x1b0)],'RPN':_0x24afd6['rpn']})),_0x19a55f=XLSX[_0x42fa4a(0x2f9)]['json_to_sheet'](_0x51660d),_0x1692aa=[{'wch':0x8},{'wch':0xf},{'wch':0x1e},{'wch':0xa},{'wch':0x19},{'wch':0x8}];_0x19a55f[_0x422d7e[_0x42fa4a(0x1d8)]]=_0x1692aa,XLSX[_0x42fa4a(0x2f9)][_0x42fa4a(0x247)](_0x2d4d96,_0x19a55f,_0x422d7e[_0x42fa4a(0x2d5)]);}if(_0x422d7e['yDuKO'](_0x4e5f1a[_0x42fa4a(0x182)],0x0)){const _0x315686=_0x4e5f1a['map'](_0x156be9=>({'Product\x20Code':_0x156be9[_0x42fa4a(0x37f)],'Product\x20Name':_0x156be9['name'],'Product\x20Type':_0x156be9[_0x42fa4a(0x263)],'Batch\x20Size\x20(kg)':_0x156be9[_0x42fa4a(0x2f4)],'MDD\x20(mg)':_0x156be9[_0x42fa4a(0x2fc)],'Critical\x20Reason':_0x156be9[_0x42fa4a(0x211)]||_0x42fa4a(0x232),'Train':_0x42fa4a(0x30e)!==a16_0x22d264(_0x156be9)?'T'+a16_0x22d264(_0x156be9):'N/A'})),_0x4c1bd2=XLSX[_0x42fa4a(0x2f9)][_0x42fa4a(0x15b)](_0x315686),_0x11d293=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32},{'wch':0xa}];_0x4c1bd2[_0x422d7e[_0x42fa4a(0x1d8)]]=_0x11d293,XLSX[_0x42fa4a(0x2f9)][_0x42fa4a(0x247)](_0x2d4d96,_0x4c1bd2,_0x42fa4a(0x2f2));}const _0x87f1c7=a16_0x1d463c['products']['map'](_0x3cd99e=>{const _0x474a2b=_0x42fa4a,_0x4d06ae=a16_0x22d264(_0x3cd99e),_0x36a101=_0x3cd99e[_0x474a2b(0x208)]['reduce']((_0x537047,_0x36ace5)=>{const _0x4675c8=_0x474a2b,_0x172776=_0x3ffa6c[_0x4675c8(0x371)](_0x448cc2,_0x36ace5)[_0x4675c8(0x1cd)];return _0x3ffa6c['AqKSM'](_0x172776,_0x537047[_0x4675c8(0x1cd)])?{..._0x36ace5,'rpn':_0x172776}:_0x537047;},{'rpn':0x0,'name':'N/A'});return{'Product\x20Code':_0x3cd99e[_0x474a2b(0x37f)],'Product\x20Name':_0x3cd99e[_0x474a2b(0x36b)],'Product\x20Type':_0x3cd99e[_0x474a2b(0x263)],'Batch\x20Size\x20(kg)':_0x3cd99e[_0x474a2b(0x2f4)],'MDD\x20(mg)':_0x3cd99e['mddMg'],'Train':_0x422d7e[_0x474a2b(0x14c)](_0x422d7e[_0x474a2b(0x1d7)],_0x4d06ae)?'T'+_0x4d06ae:_0x422d7e[_0x474a2b(0x1d7)],'Is\x20Critical':_0x3cd99e['isCritical']?_0x422d7e['ALVxy']:'No','Critical\x20Reason':_0x3cd99e[_0x474a2b(0x211)]||_0x422d7e[_0x474a2b(0x1d7)],'Ingredients\x20Count':_0x3cd99e[_0x474a2b(0x208)]['length'],'Highest\x20RPN\x20Ingredient':_0x36a101['name'],'Highest\x20RPN\x20Value':_0x36a101[_0x474a2b(0x1cd)]||0x0};}),_0x557c2f=XLSX[_0x42fa4a(0x2f9)][_0x42fa4a(0x15b)](_0x87f1c7);_0x557c2f[_0x422d7e[_0x42fa4a(0x1d8)]]=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xa},{'wch':0xa},{'wch':0x28},{'wch':0xc},{'wch':0x19},{'wch':0xc}],XLSX['utils'][_0x42fa4a(0x247)](_0x2d4d96,_0x557c2f,_0x422d7e[_0x42fa4a(0x361)]);const _0x120204=new Date()[_0x42fa4a(0x242)]()['split']('T')[0x0];XLSX['writeFile'](_0x2d4d96,_0x42fa4a(0x18d)+_0x120204+_0x42fa4a(0x1f3)),_0x422d7e[_0x42fa4a(0x303)](hideLoader),_0x422d7e[_0x42fa4a(0x367)](showCustomAlert,_0x42fa4a(0x199),_0x42fa4a(0x266));})[_0x51afd4(0x18a)](_0x408ebf=>{const _0x5644a2=_0x51afd4;console[_0x5644a2(0x191)](_0x422d7e[_0x5644a2(0x197)],_0x408ebf),hideLoader(),_0x422d7e[_0x5644a2(0x367)](showCustomAlert,_0x5644a2(0x28b),_0x422d7e['BNijl']);});}export function exportAllTabsToExcel(){const _0x25a8cd=a16_0x74705c,_0x50be57={'rdyKf':'N/A','gchAY':function(_0x5343ec,_0x580c5d){return _0x5343ec(_0x580c5d);},'tEFXA':function(_0xcf2b82,_0xb16a81){return _0xcf2b82/_0xb16a81;},'TMzOV':function(_0x16c4e7,_0x47c274){return _0x16c4e7*_0x47c274;},'hOYao':function(_0x27f45c,_0x519c1b){return _0x27f45c/_0x519c1b;},'LBfCz':function(_0x5e01d3,_0x570418){return _0x5e01d3===_0x570418;},'SzQvA':_0x25a8cd(0x35a),'MYfQA':_0x25a8cd(0x251),'LmEvC':_0x25a8cd(0x2c0),'XcShi':function(_0x54f87b,_0xa8c29f){return _0x54f87b!==_0xa8c29f;},'TFRbq':function(_0x1b4d0a,_0x22de93){return _0x1b4d0a*_0x22de93;},'gTbgr':function(_0x43c3db,_0x249bc2){return _0x43c3db/_0x249bc2;},'tyzdK':function(_0x3de453,_0x548427){return _0x3de453*_0x548427;},'dOieJ':function(_0x3274c6,_0xbfc506){return _0x3274c6*_0xbfc506;},'DIIag':function(_0x1070f6,_0x2bc56d,_0x14bc8f){return _0x1070f6(_0x2bc56d,_0x14bc8f);},'qybBw':_0x25a8cd(0x1dc),'ZJNrk':_0x25a8cd(0x1ba),'fhFAR':_0x25a8cd(0x21f),'EVkIM':function(_0x384792){return _0x384792();},'vKxvG':function(_0x26c82b,_0x541218){return _0x26c82b!==_0x541218;},'lnKSS':function(_0x8fd922,_0x1a53b5){return _0x8fd922==_0x1a53b5;},'HsFRb':_0x25a8cd(0x35e),'eWtjA':function(_0x29121f,_0x4a352b){return _0x29121f(_0x4a352b);},'TnvKN':function(_0x758898,_0x31e7b6){return _0x758898!==_0x31e7b6;},'yrwUh':_0x25a8cd(0x374),'cLWCn':function(_0x4b6c33,_0x5389e1){return _0x4b6c33||_0x5389e1;},'LVpjP':function(_0x222543,_0x5a823b){return _0x222543(_0x5a823b);},'MbyEm':function(_0x43e50c,_0xe11753){return _0x43e50c>_0xe11753;},'ExkGR':function(_0x3d0b97){return _0x3d0b97();},'jIcTQ':_0x25a8cd(0x23b),'Fbirt':function(_0x540e0f){return _0x540e0f();},'oZWEy':function(_0x29e720,_0x19dbe1,_0x1cbfa9){return _0x29e720(_0x19dbe1,_0x1cbfa9);},'lBDJr':_0x25a8cd(0x1d2),'mxiNB':_0x25a8cd(0x287),'hnWyM':_0x25a8cd(0x358),'xIyiV':function(_0x132957,_0x3c29be){return _0x132957>_0x3c29be;},'hvrTa':_0x25a8cd(0x35c),'QcEss':'Detergent\x20MACO','jtYPV':_0x25a8cd(0x245),'kTXEG':_0x25a8cd(0x167),'ltiRA':_0x25a8cd(0x2f2),'wMeAZ':_0x25a8cd(0x1d5),'GbqAK':_0x25a8cd(0x332),'UAjyr':_0x25a8cd(0x1fb),'OxqmW':function(_0x91214f){return _0x91214f();},'oQxKH':function(_0x580874,_0x1f3fd6,_0x1e0011){return _0x580874(_0x1f3fd6,_0x1e0011);},'qiVYW':_0x25a8cd(0x199),'zsJyV':_0x25a8cd(0x2d6),'UDTEp':_0x25a8cd(0x24a),'xOExS':function(_0x316d20){return _0x316d20();}};_0x50be57[_0x25a8cd(0x181)](showLoader),import(_0x25a8cd(0x1a1))['then'](_0x184df3=>{const _0x7d0fb1=_0x25a8cd,_0x25d1e1={'qszoe':function(_0x1f6877,_0xb63694){const _0x1328fa=a16_0x37a5;return _0x50be57[_0x1328fa(0x26b)](_0x1f6877,_0xb63694);},'Sdtqn':_0x50be57[_0x7d0fb1(0x2f1)],'kOIQf':function(_0x3049f4,_0x5a08e5){const _0x2e62b9=_0x7d0fb1;return _0x50be57[_0x2e62b9(0x193)](_0x3049f4,_0x5a08e5);},'haAmV':function(_0x508a90,_0x314936){const _0x263299=_0x7d0fb1;return _0x50be57[_0x263299(0x1a3)](_0x508a90,_0x314936);},'TzYbM':function(_0x582dd4,_0x3c5817){const _0x187b28=_0x7d0fb1;return _0x50be57[_0x187b28(0x12a)](_0x582dd4,_0x3c5817);},'REORo':function(_0x27e5db,_0x43b7cc){return _0x27e5db*_0x43b7cc;},'mJmkK':function(_0x7849fd,_0x39b2c7){const _0x49f5d7=_0x7d0fb1;return _0x50be57[_0x49f5d7(0x29d)](_0x7849fd,_0x39b2c7);},'hZZMp':function(_0x4d0b62){return _0x50be57['ExkGR'](_0x4d0b62);},'YGlLN':_0x7d0fb1(0x27b),'yfdZM':function(_0x3f16c4,_0x4451c8){return _0x3f16c4(_0x4451c8);},'jUNUD':function(_0x4a816a,_0x247061){const _0x150076=_0x7d0fb1;return _0x50be57[_0x150076(0x1ea)](_0x4a816a,_0x247061);},'jZIeJ':_0x7d0fb1(0x374),'tmfsN':_0x50be57[_0x7d0fb1(0x241)]},{getTrainData:_0x18b375,getWorstCaseProductType:_0x106336,getProductTrainId:_0x264e04,calculateScores:_0x2f3344}=_0x184df3,_0x3276f7=_0x50be57[_0x7d0fb1(0x306)](_0x18b375);if(0x0===_0x3276f7[_0x7d0fb1(0x182)])return hideLoader(),void _0x50be57[_0x7d0fb1(0x311)](showCustomAlert,_0x50be57[_0x7d0fb1(0x2c8)],_0x50be57[_0x7d0fb1(0x357)]);const _0x57e938=XLSX['utils'][_0x7d0fb1(0x34b)]();try{const _0x4a5ab5=[];_0x3276f7[_0x7d0fb1(0x378)](_0x5e0606=>{const _0x3949f9=_0x7d0fb1,_0x29d2e4={'wfdtf':_0x50be57[_0x3949f9(0x2f1)]},_0xe33617=_0x50be57[_0x3949f9(0x189)](_0x106336,_0x5e0606[_0x3949f9(0x175)][_0x3949f9(0x187)](_0x563a40=>_0x563a40[_0x3949f9(0x263)])),_0xf123cc=(a16_0x1d463c[_0x3949f9(0x15c)][_0xe33617]||a16_0x1d463c[_0x3949f9(0x15c)]['Other'])['max'],_0x132954=_0x50be57[_0x3949f9(0x328)](_0x50be57[_0x3949f9(0x345)](_0x5e0606[_0x3949f9(0x2e9)],_0x5e0606[_0x3949f9(0x136)]),_0xf123cc),_0x5b8a66=_0x50be57['TMzOV'](0xa,_0x5e0606[_0x3949f9(0x19f)]);let _0x5734ac=_0x50be57[_0x3949f9(0x22e)](0x1,0x0),_0x5a8666=_0x50be57[_0x3949f9(0x328)](0x1,0x0);const _0x49e211=_0x50be57[_0x3949f9(0x14b)](_0x50be57['SzQvA'],localStorage[_0x3949f9(0x31f)](_0x50be57[_0x3949f9(0x143)])),_0x13de99=_0x50be57[_0x3949f9(0x1f0)]===localStorage[_0x3949f9(0x31f)](_0x50be57[_0x3949f9(0x27d)]);if(null===_0x5e0606[_0x3949f9(0x348)]||_0x49e211||(_0x5734ac=_0x50be57[_0x3949f9(0x345)](_0x5e0606[_0x3949f9(0x348)],_0x5e0606[_0x3949f9(0x136)])),_0x50be57[_0x3949f9(0x334)](null,_0x5e0606[_0x3949f9(0x25c)])&&!_0x13de99){const _0x438536=_0x50be57[_0x3949f9(0x328)](_0x50be57[_0x3949f9(0x12a)](0x46,_0x5e0606['lowestLd50']),0x7d0),_0xccbd10=_0x5e0606[_0x3949f9(0x175)][_0x3949f9(0x1fc)](_0x1b62e4=>_0x1b62e4[_0x3949f9(0x208)][_0x3949f9(0x187)](_0x28e258=>_0x28e258[_0x3949f9(0x37b)]/0x3e8)),_0x47e3b7=Math[_0x3949f9(0x177)](..._0xccbd10);_0x5a8666=_0x50be57[_0x3949f9(0x1a3)](_0x50be57[_0x3949f9(0x237)](_0x50be57[_0x3949f9(0x196)](_0x438536,_0x5e0606[_0x3949f9(0x19f)]),0x3e8),_0x50be57[_0x3949f9(0x345)](_0xf123cc,_0x47e3b7));}const _0x13710e=_0x50be57[_0x3949f9(0x22c)](getLargestEssaForLineAndDosageForm,_0x5e0606,_0x3276f7),_0x42e540=_0x50be57['TFRbq'](0.004,_0x13710e),_0x8af33b=[{'name':_0x3949f9(0x12c),'value':_0x132954},{'name':_0x50be57[_0x3949f9(0x2e6)],'value':_0x5b8a66}];null===_0x5e0606[_0x3949f9(0x348)]||_0x49e211||_0x8af33b[_0x3949f9(0x13a)]({'name':_0x3949f9(0x2a2),'value':_0x5734ac}),_0x50be57[_0x3949f9(0x14b)](null,_0x5e0606[_0x3949f9(0x25c)])||_0x13de99||_0x8af33b['push']({'name':_0x50be57[_0x3949f9(0x17b)],'value':_0x5a8666}),_0x8af33b[_0x3949f9(0x13a)]({'name':_0x50be57['fhFAR'],'value':_0x42e540});const _0x15da2c=_0x8af33b[_0x3949f9(0x304)]((_0x42dc78,_0x196a58)=>_0x196a58[_0x3949f9(0x341)]<_0x42dc78['value']?_0x196a58:_0x42dc78),_0x4df9bc=_0x15da2c[_0x3949f9(0x341)],_0x375b20=_0x13710e>0x0?_0x50be57[_0x3949f9(0x1a3)](_0x4df9bc,_0x13710e):0x0,_0x413e1f=_0x375b20*_0x5e0606['assumedSsa'],_0x423795=_0x5e0606['machineIds'][_0x3949f9(0x187)](_0x4fe798=>{const _0x75d4d2=_0x3949f9,_0x39b03c=a16_0x1d463c[_0x75d4d2(0x292)]['find'](_0x27867d=>_0x27867d['id']===_0x4fe798);return _0x39b03c||{'name':_0x75d4d2(0x296)+_0x4fe798+')','machineNumber':_0x29d2e4['wfdtf']};}),_0x51473e=_0x5e0606['machineIds']['map'](_0x2e37a1=>{const _0x335a65=_0x3949f9,_0x2e8821=a16_0x1d463c[_0x335a65(0x292)][_0x335a65(0x258)](_0x4bd6d0=>_0x4bd6d0['id']===_0x2e37a1);return _0x2e8821?_0x2e8821['name']:_0x335a65(0x296)+_0x2e37a1+')';})['join'](',\x20'),_0x35786d=_0x5e0606['products'][_0x3949f9(0x187)](_0x4a5cb2=>_0x4a5cb2[_0x3949f9(0x37f)]+_0x3949f9(0x30b)+_0x4a5cb2[_0x3949f9(0x36b)])[_0x3949f9(0x331)](';\x20'),_0x4a59de=_0x5e0606[_0x3949f9(0x246)]?_0x5e0606[_0x3949f9(0x246)][_0x3949f9(0x24f)]+'\x20('+_0x5e0606['worstProductRpn'][_0x3949f9(0x1b0)]+')\x20-\x20RPN:\x20'+_0x5e0606[_0x3949f9(0x246)][_0x3949f9(0x1cd)]:_0x50be57['rdyKf'];_0x4a5ab5[_0x3949f9(0x13a)]({'Train':'T'+(_0x50be57['EVkIM'](a16_0x56e423)[_0x3949f9(0x372)](_0x50be57[_0x3949f9(0x189)](String,_0x5e0606['id']))?.[_0x3949f9(0x35e)]||_0x5e0606['id']),'Total\x20Products':_0x5e0606[_0x3949f9(0x175)][_0x3949f9(0x182)],'Total\x20Machines':_0x423795['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x5e0606[_0x3949f9(0x33f)]['toLocaleString'](),'Products':_0x35786d,'Machines':_0x51473e,'Worst-Case\x20Dosage\x20Form':_0xe33617,'Safety\x20Factor':_0xf123cc,'Lowest\x20LTD\x20(mg)':_0x5e0606[_0x3949f9(0x2e9)],'Min\x20Batch\x20Size\x20(kg)':_0x5e0606[_0x3949f9(0x19f)],'Min\x20BS/MDD\x20Ratio':_0x5e0606[_0x3949f9(0x136)][_0x3949f9(0x154)](0x2),'Lowest\x20PDE\x20(mg)':_0x50be57[_0x3949f9(0x359)](null,_0x5e0606[_0x3949f9(0x348)])?_0x5e0606[_0x3949f9(0x348)]:_0x3949f9(0x30e),'Worst-Case\x20Product\x20(by\x20RPN)':_0x4a59de,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x132954[_0x3949f9(0x154)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x5b8a66[_0x3949f9(0x154)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x50be57[_0x3949f9(0x314)](_0x50be57[_0x3949f9(0x151)],typeof _0x5734ac)?_0x5734ac[_0x3949f9(0x154)](0x2):_0x50be57['rdyKf'],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x42e540[_0x3949f9(0x154)](0x2),'Selected\x20MACO\x20Method':_0x15da2c[_0x3949f9(0x36b)],'Final\x20MACO\x20(mg)':_0x4df9bc[_0x3949f9(0x154)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x375b20[_0x3949f9(0x1a0)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x413e1f[_0x3949f9(0x154)](0x4)});});const _0x377beb=XLSX['utils'][_0x7d0fb1(0x15b)](_0x4a5ab5);XLSX[_0x7d0fb1(0x2f9)][_0x7d0fb1(0x247)](_0x57e938,_0x377beb,'Product\x20MACO');}catch(_0x6694a9){console[_0x7d0fb1(0x191)](_0x50be57[_0x7d0fb1(0x2db)],_0x6694a9);}try{if(_0x50be57[_0x7d0fb1(0x270)](a16_0x1d463c[_0x7d0fb1(0x2f8)][_0x7d0fb1(0x182)],0x0)){const _0x4db517=parseFloat(document[_0x7d0fb1(0x23c)](_0x50be57[_0x7d0fb1(0x1be)])?.[_0x7d0fb1(0x341)])||0x46,_0x2ee9f9=a16_0x1d463c[_0x7d0fb1(0x2f8)][_0x7d0fb1(0x187)](_0x3ca6d4=>parseFloat(_0x3ca6d4[_0x7d0fb1(0x273)]))[_0x7d0fb1(0x21b)](_0x4712c9=>!isNaN(_0x4712c9)),_0x40e6ad=_0x50be57[_0x7d0fb1(0x29d)](_0x2ee9f9[_0x7d0fb1(0x182)],0x0)?Math[_0x7d0fb1(0x177)](..._0x2ee9f9):0x0,_0x1e2fc0=a16_0x1d463c[_0x7d0fb1(0x2f8)][_0x7d0fb1(0x187)](_0x34a214=>_0x34a214['name'])[_0x7d0fb1(0x21b)](_0x19fd6d=>''!==_0x19fd6d[_0x7d0fb1(0x192)]())[_0x7d0fb1(0x331)](',\x20'),_0xe4d815=[];_0x3276f7['forEach'](_0x34ae68=>{const _0x3b9d80=_0x7d0fb1,_0x12b204=_0x25d1e1[_0x3b9d80(0x1c0)](_0x106336,_0x34ae68[_0x3b9d80(0x175)][_0x3b9d80(0x187)](_0x5bd4c1=>_0x5bd4c1[_0x3b9d80(0x263)])),_0x54e2db=a16_0x1d463c[_0x3b9d80(0x15c)][_0x12b204]||a16_0x1d463c['safetyFactorConfig'][_0x3b9d80(0x20a)],_0x453fb7=document[_0x3b9d80(0x23c)](_0x3b9d80(0x20d)+_0x34ae68['id']),_0x21b81e=_0x453fb7&&parseFloat(_0x453fb7[_0x3b9d80(0x341)])||_0x54e2db[_0x3b9d80(0x34e)],_0x5d8396=_0x25d1e1[_0x3b9d80(0x133)](_0x25d1e1['TzYbM'](0.0005*_0x40e6ad,_0x4db517),_0x21b81e),_0x485e4f=_0x25d1e1['REORo'](_0x5d8396,_0x34ae68[_0x3b9d80(0x136)]),_0x31118b=getLargestEssaForLineAndDosageForm(_0x34ae68,_0x3276f7),_0x3e197e=_0x25d1e1['mJmkK'](_0x31118b,0x0)?_0x485e4f/_0x31118b:0x0,_0x64be98=_0x25d1e1[_0x3b9d80(0x318)](_0x3e197e,_0x34ae68[_0x3b9d80(0x173)]),_0x288326=_0x34ae68[_0x3b9d80(0x1cb)][_0x3b9d80(0x187)](_0x19f30c=>{const _0x41cc02=_0x3b9d80,_0x2541a6=a16_0x1d463c[_0x41cc02(0x292)][_0x41cc02(0x258)](_0x4c510b=>_0x4c510b['id']===_0x19f30c);return _0x25d1e1[_0x41cc02(0x2d7)](_0x2541a6,{'name':_0x41cc02(0x296)+_0x19f30c+')','machineNumber':_0x25d1e1[_0x41cc02(0x147)]});}),_0x2ff8a3=_0x34ae68[_0x3b9d80(0x1cb)][_0x3b9d80(0x187)](_0x29ab8a=>{const _0x52c6ae=_0x3b9d80,_0x2378c3=a16_0x1d463c['machines'][_0x52c6ae(0x258)](_0x333f5f=>_0x333f5f['id']===_0x29ab8a);return _0x2378c3?_0x2378c3[_0x52c6ae(0x36b)]:_0x52c6ae(0x296)+_0x29ab8a+')';})[_0x3b9d80(0x331)](',\x20'),_0x307741=_0x34ae68[_0x3b9d80(0x175)][_0x3b9d80(0x187)](_0x2b3bcc=>_0x2b3bcc['productCode']+_0x3b9d80(0x30b)+_0x2b3bcc[_0x3b9d80(0x36b)])[_0x3b9d80(0x331)](';\x20'),_0x5313a0=_0x34ae68['worstProductRpn']?_0x34ae68['worstProductRpn'][_0x3b9d80(0x24f)]+'\x20('+_0x34ae68[_0x3b9d80(0x246)][_0x3b9d80(0x1b0)]+')\x20-\x20RPN:\x20'+_0x34ae68[_0x3b9d80(0x246)][_0x3b9d80(0x1cd)]:_0x25d1e1['Sdtqn'];_0xe4d815[_0x3b9d80(0x13a)]({'Train':'T'+(_0x25d1e1[_0x3b9d80(0x34f)](a16_0x56e423)[_0x3b9d80(0x372)](String(_0x34ae68['id']))?.['number']||_0x34ae68['id']),'Total\x20Products':_0x34ae68[_0x3b9d80(0x175)][_0x3b9d80(0x182)],'Total\x20Machines':_0x288326[_0x3b9d80(0x182)],'Total\x20Area\x20(ESSA)\x20cm²':_0x34ae68['essa'][_0x3b9d80(0x12d)](),'Products':_0x307741,'Machines':_0x2ff8a3,'Worst-Case\x20Dosage\x20Form':_0x12b204,'Safety\x20Factor\x20Range':_0x54e2db[_0x3b9d80(0x177)]+'\x20-\x20'+_0x54e2db['max'],'Applied\x20Safety\x20Factor':_0x21b81e,'Detergent\x20Ingredients':_0x1e2fc0,'Body\x20Weight\x20(kg)':_0x4db517,'Minimum\x20LD50\x20(mg/kg)':_0x40e6ad,'Min\x20Batch\x20Size\x20(kg)':_0x34ae68['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x34ae68[_0x3b9d80(0x136)][_0x3b9d80(0x154)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x5313a0,'ADI\x20(mg)':_0x5d8396['toFixed'](0x4),'MACO\x20(mg)':_0x485e4f['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x3e197e[_0x3b9d80(0x1a0)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x64be98[_0x3b9d80(0x154)](0x4)});});const _0x547925=XLSX[_0x7d0fb1(0x2f9)][_0x7d0fb1(0x15b)](_0xe4d815);XLSX[_0x7d0fb1(0x2f9)][_0x7d0fb1(0x247)](_0x57e938,_0x547925,_0x50be57[_0x7d0fb1(0x298)]);}}catch(_0xfeb7a1){console[_0x7d0fb1(0x191)](_0x7d0fb1(0x299),_0xfeb7a1);}try{const _0x5946b3=[];_0x3276f7[_0x7d0fb1(0x378)](_0x43e208=>{const _0x44992d=_0x7d0fb1,_0x2ee8db={'NsljK':_0x50be57[_0x44992d(0x2f1)]},_0x422655=_0x43e208['machineIds'][_0x44992d(0x187)](_0x84918b=>{const _0x592b4c=_0x44992d,_0x4336d2=a16_0x1d463c[_0x592b4c(0x292)]['find'](_0x36aa43=>_0x36aa43['id']===_0x84918b);return _0x4336d2||{'id':_0x84918b,'name':_0x592b4c(0x296)+_0x84918b+')','machineNumber':_0x2ee8db[_0x592b4c(0x2f6)]};}),_0x59c11c=_0x43e208['machineIds'][_0x44992d(0x187)](_0x59b35b=>{const _0x45f837=_0x44992d,_0x3cae80=a16_0x1d463c[_0x45f837(0x292)][_0x45f837(0x258)](_0x20756c=>_0x20756c['id']===_0x59b35b);return _0x3cae80?_0x3cae80[_0x45f837(0x36b)]:'Unknown\x20(ID:\x20'+_0x59b35b+')';})[_0x44992d(0x331)](',\x20'),_0x19a885=_0x43e208['products'][_0x44992d(0x187)](_0x4cd98a=>_0x4cd98a[_0x44992d(0x37f)]+_0x44992d(0x30b)+_0x4cd98a[_0x44992d(0x36b)])[_0x44992d(0x331)](';\x20'),_0x5d56ed=_0x43e208[_0x44992d(0x175)][_0x44992d(0x187)](_0x4f767d=>_0x4f767d['productCode']+':\x20'+_0x4f767d['name'])[_0x44992d(0x331)]('\x0a'),_0x3403c5=_0x422655['map'](_0x495cc9=>_0x495cc9[_0x44992d(0x344)]+':\x20'+_0x495cc9['name'])['join']('\x0a');_0x5946b3[_0x44992d(0x13a)]({'Train\x20ID':'T'+(_0x50be57['EVkIM'](a16_0x56e423)['get'](_0x50be57[_0x44992d(0x189)](String,_0x43e208['id']))?.['number']||_0x43e208['id']),'Products\x20Count':_0x43e208[_0x44992d(0x175)][_0x44992d(0x182)],'Machines\x20Count':_0x422655[_0x44992d(0x182)],'Total\x20Area\x20(ESSA)\x20cm²':_0x43e208[_0x44992d(0x33f)]['toLocaleString'](),'Products\x20(Code\x20-\x20Name)':_0x19a885,'Machines\x20(Number\x20-\x20Name)':_0x59c11c,'Products\x20Detailed':_0x5d56ed,'Machines\x20Detailed':_0x3403c5,'Min\x20Batch\x20Size\x20(kg)':_0x43e208[_0x44992d(0x19f)],'Min\x20BS/MDD\x20Ratio':_0x43e208[_0x44992d(0x136)][_0x44992d(0x154)](0x2),'Assumed\x20SSA\x20(cm²)':_0x43e208['assumedSsa'],'Lowest\x20LTD\x20(mg)':_0x43e208[_0x44992d(0x2e9)],'Lowest\x20PDE\x20(mg)':_0x50be57[_0x44992d(0x359)](null,_0x43e208[_0x44992d(0x348)])?_0x43e208['lowestPde']:_0x50be57[_0x44992d(0x2f1)],'Worst\x20RPN\x20Product':_0x43e208[_0x44992d(0x246)]?_0x43e208[_0x44992d(0x246)][_0x44992d(0x24f)]+'\x20('+_0x43e208[_0x44992d(0x246)]['ingredientName']+_0x44992d(0x2f0)+_0x43e208[_0x44992d(0x246)][_0x44992d(0x1cd)]:_0x50be57[_0x44992d(0x2f1)]});});const _0x35658c=XLSX[_0x7d0fb1(0x2f9)][_0x7d0fb1(0x15b)](_0x5946b3);XLSX[_0x7d0fb1(0x2f9)][_0x7d0fb1(0x247)](_0x57e938,_0x35658c,'Train\x20Summary');}catch(_0x15e25b){console['error'](_0x50be57[_0x7d0fb1(0x16b)],_0x15e25b);}try{const _0x6dceea=a16_0x1d463c['products'][_0x7d0fb1(0x1fc)](_0xbe245e=>{const _0x210835=_0x7d0fb1,_0x31c3cf=_0x50be57[_0x210835(0x2a1)](a16_0x22d264,_0xbe245e);return _0xbe245e['activeIngredients'][_0x210835(0x187)](_0x2a97df=>({'productName':_0xbe245e['name'],'productCode':_0xbe245e[_0x210835(0x37f)],'ingredientName':_0x2a97df[_0x210835(0x36b)],'rpn':_0x2f3344(_0x2a97df)[_0x210835(0x1cd)],'trainId':_0x210835(0x30e)!==_0x31c3cf?'T'+_0x31c3cf:_0x210835(0x30e)}));})[_0x7d0fb1(0x153)]((_0x2dbdbc,_0x1fec1a)=>_0x1fec1a['rpn']-_0x2dbdbc[_0x7d0fb1(0x1cd)])['slice'](0x0,0xa);if(_0x50be57[_0x7d0fb1(0x270)](_0x6dceea[_0x7d0fb1(0x182)],0x0)){const _0x576369=_0x6dceea[_0x7d0fb1(0x187)]((_0x4a48db,_0x7de4c6)=>({'Rank':_0x7de4c6+0x1,'Product\x20Code':_0x4a48db[_0x7d0fb1(0x37f)],'Product\x20Name':_0x4a48db[_0x7d0fb1(0x24f)],'Train':_0x4a48db[_0x7d0fb1(0x2eb)],'Ingredient':_0x4a48db[_0x7d0fb1(0x1b0)],'RPN':_0x4a48db[_0x7d0fb1(0x1cd)]})),_0x76477c=XLSX['utils']['json_to_sheet'](_0x576369);XLSX[_0x7d0fb1(0x2f9)][_0x7d0fb1(0x247)](_0x57e938,_0x76477c,_0x7d0fb1(0x1a4));}}catch(_0x3df09a){console[_0x7d0fb1(0x191)](_0x50be57[_0x7d0fb1(0x1b7)],_0x3df09a);}try{const _0x4ac511=a16_0x1d463c[_0x7d0fb1(0x175)][_0x7d0fb1(0x21b)](_0xb8472e=>_0xb8472e[_0x7d0fb1(0x1b2)]);if(_0x50be57[_0x7d0fb1(0x29d)](_0x4ac511[_0x7d0fb1(0x182)],0x0)){const _0x529090=_0x4ac511['map'](_0x2d0c65=>({'Product\x20Code':_0x2d0c65[_0x7d0fb1(0x37f)],'Product\x20Name':_0x2d0c65[_0x7d0fb1(0x36b)],'Product\x20Type':_0x2d0c65[_0x7d0fb1(0x263)],'Batch\x20Size\x20(kg)':_0x2d0c65[_0x7d0fb1(0x2f4)],'MDD\x20(mg)':_0x2d0c65['mddMg'],'Critical\x20Reason':_0x2d0c65[_0x7d0fb1(0x211)]||_0x7d0fb1(0x232),'Train':'N/A'!==a16_0x22d264(_0x2d0c65)?'T'+a16_0x22d264(_0x2d0c65):_0x7d0fb1(0x30e)})),_0x555c80=XLSX['utils']['json_to_sheet'](_0x529090);XLSX[_0x7d0fb1(0x2f9)][_0x7d0fb1(0x247)](_0x57e938,_0x555c80,_0x50be57[_0x7d0fb1(0x2b1)]);}}catch(_0xb047d5){console['error']('Error\x20creating\x20Critical\x20Products\x20sheet:',_0xb047d5);}try{const _0x40aba2=a16_0x1d463c[_0x7d0fb1(0x175)][_0x7d0fb1(0x187)](_0x10bcd8=>{const _0x55f6ea=_0x7d0fb1,_0x41a1fc=_0x50be57['eWtjA'](a16_0x22d264,_0x10bcd8),_0x551402=_0x10bcd8[_0x55f6ea(0x208)][_0x55f6ea(0x304)]((_0x11bf4e,_0x1e718d)=>{const _0x58c68c=_0x55f6ea,_0x523f84=_0x25d1e1[_0x58c68c(0x1c0)](_0x2f3344,_0x1e718d)[_0x58c68c(0x1cd)];return _0x523f84>_0x11bf4e[_0x58c68c(0x1cd)]?{..._0x1e718d,'rpn':_0x523f84}:_0x11bf4e;},{'rpn':0x0,'name':_0x50be57[_0x55f6ea(0x2f1)]});return{'Product\x20Code':_0x10bcd8[_0x55f6ea(0x37f)],'Product\x20Name':_0x10bcd8[_0x55f6ea(0x36b)],'Product\x20Type':_0x10bcd8[_0x55f6ea(0x263)],'Batch\x20Size\x20(kg)':_0x10bcd8['batchSizeKg'],'MDD\x20(mg)':_0x10bcd8[_0x55f6ea(0x2fc)],'Train':_0x50be57[_0x55f6ea(0x1ea)](_0x50be57['rdyKf'],_0x41a1fc)?'T'+_0x41a1fc:_0x50be57['rdyKf'],'Is\x20Critical':_0x10bcd8[_0x55f6ea(0x1b2)]?_0x50be57['yrwUh']:'No','Critical\x20Reason':_0x10bcd8[_0x55f6ea(0x211)]||_0x50be57[_0x55f6ea(0x2f1)],'Ingredients\x20Count':_0x10bcd8[_0x55f6ea(0x208)][_0x55f6ea(0x182)],'Highest\x20RPN\x20Ingredient':_0x551402['name'],'Highest\x20RPN\x20Value':_0x551402[_0x55f6ea(0x1cd)]||0x0};}),_0x508970=XLSX[_0x7d0fb1(0x2f9)]['json_to_sheet'](_0x40aba2);XLSX[_0x7d0fb1(0x2f9)][_0x7d0fb1(0x247)](_0x57e938,_0x508970,_0x50be57[_0x7d0fb1(0x364)]);}catch(_0x14f943){console[_0x7d0fb1(0x191)](_0x50be57['GbqAK'],_0x14f943);}try{const _0x12f9cf=[];a16_0x1d463c[_0x7d0fb1(0x175)]['forEach'](_0x86f0c7=>{const _0x3d2e32=_0x7d0fb1,_0x4ca85b={'xKMaY':function(_0x3ea0ba,_0x44fd43){const _0x4dc019=a16_0x37a5;return _0x25d1e1[_0x4dc019(0x1c0)](_0x3ea0ba,_0x44fd43);},'dyQKu':_0x25d1e1[_0x3d2e32(0x1ce)],'FGHUi':_0x3d2e32(0x30e)},_0x4d1c1e=_0x25d1e1['yfdZM'](a16_0x22d264,_0x86f0c7),_0x198337={'Product\x20Code':_0x86f0c7[_0x3d2e32(0x37f)],'Product\x20Name':_0x86f0c7[_0x3d2e32(0x36b)],'Product\x20Type':_0x86f0c7[_0x3d2e32(0x263)],'Batch\x20Size\x20(kg)':_0x86f0c7[_0x3d2e32(0x2f4)],'MDD\x20(mg)':_0x86f0c7[_0x3d2e32(0x2fc)],'Train':_0x25d1e1[_0x3d2e32(0x2ee)](_0x3d2e32(0x30e),_0x4d1c1e)?'T'+_0x4d1c1e:_0x3d2e32(0x30e),'Is\x20Critical':_0x86f0c7[_0x3d2e32(0x1b2)]?_0x25d1e1[_0x3d2e32(0x188)]:'No','Critical\x20Reason':_0x86f0c7[_0x3d2e32(0x211)]||_0x3d2e32(0x30e),'Ingredient\x20Type':_0x25d1e1[_0x3d2e32(0x338)],'Ingredient\x20Name':'','LTD\x20(mg)':'','PDE\x20(mg)':'','LD50\x20(mg/kg)':'','Severity':'','Occurrence':'','Detection':'','RPN':''};_0x12f9cf[_0x3d2e32(0x13a)](_0x198337),_0x86f0c7['activeIngredients'][_0x3d2e32(0x378)](_0x74203b=>{const _0x4c43b7=_0x3d2e32,_0x586869=_0x4ca85b[_0x4c43b7(0x37a)](_0x2f3344,_0x74203b);_0x12f9cf['push']({'Product\x20Code':'','Product\x20Name':'','Product\x20Type':'','Batch\x20Size\x20(kg)':'','MDD\x20(mg)':'','Train':'','Is\x20Critical':'','Critical\x20Reason':'','Ingredient\x20Type':_0x4ca85b[_0x4c43b7(0x300)],'Ingredient\x20Name':_0x74203b[_0x4c43b7(0x36b)],'LTD\x20(mg)':_0x74203b[_0x4c43b7(0x369)]||'N/A','PDE\x20(mg)':_0x74203b['pdeMg']||_0x4ca85b[_0x4c43b7(0x2b5)],'LD50\x20(mg/kg)':_0x74203b[_0x4c43b7(0x273)]||_0x4ca85b[_0x4c43b7(0x2b5)],'Severity':_0x586869['severity'],'Occurrence':_0x586869[_0x4c43b7(0x17e)],'Detection':_0x586869['detection'],'RPN':_0x586869[_0x4c43b7(0x1cd)]});});});const _0xfe0264=XLSX[_0x7d0fb1(0x2f9)]['json_to_sheet'](_0x12f9cf);XLSX['utils'][_0x7d0fb1(0x247)](_0x57e938,_0xfe0264,_0x50be57[_0x7d0fb1(0x1f1)]);}catch(_0x12ec94){console['error'](_0x7d0fb1(0x13b),_0x12ec94);}const _0x12d2b5=new Date()[_0x7d0fb1(0x242)]()[_0x7d0fb1(0x1e8)]('T')[0x0];XLSX[_0x7d0fb1(0x13d)](_0x57e938,_0x7d0fb1(0x243)+_0x12d2b5+_0x7d0fb1(0x1f3)),_0x50be57[_0x7d0fb1(0x286)](hideLoader),_0x50be57['oQxKH'](showCustomAlert,_0x50be57[_0x7d0fb1(0x172)],_0x7d0fb1(0x157));})[_0x25a8cd(0x18a)](_0xc029ba=>{const _0x336660=_0x25a8cd;console['error'](_0x50be57['zsJyV'],_0xc029ba),hideLoader(),showCustomAlert(_0x336660(0x28b),_0x50be57[_0x336660(0x25b)]);});}export function toggleStageSection(_0xa09fb7){const _0x174246=a16_0x74705c,_0x1adaf5={'xhuCe':function(_0x5509cc,_0x3054e8){return _0x5509cc===_0x3054e8;},'OmCtd':_0x174246(0x295),'MeKtd':_0x174246(0x2dd),'FAJNB':_0x174246(0x224)},_0x57f087=document['getElementById']('stage-'+_0xa09fb7),_0x2d4409=_0x1adaf5[_0x174246(0x32d)]('none',_0x57f087[_0x174246(0x227)][_0x174246(0x1c9)]);_0x57f087[_0x174246(0x227)][_0x174246(0x1c9)]=_0x2d4409?'':_0x1adaf5[_0x174246(0x250)],localStorage[_0x174246(0x32b)]('machineStage-'+_0xa09fb7+_0x174246(0x309),!_0x2d4409);const _0x1bfbb4=_0x57f087['parentElement'][_0x174246(0x376)](_0x1adaf5[_0x174246(0x366)]);_0x1bfbb4&&(_0x1bfbb4['textContent']=_0x2d4409?_0x174246(0x255):_0x1adaf5[_0x174246(0x307)]);}