const a13_0x1da86d=a13_0x3876;(function(_0x5b881f,_0x2b1ac8){const _0x1b7882=a13_0x3876,_0x262047=_0x5b881f();while(!![]){try{const _0x445db3=parseInt(_0x1b7882(0x257))/0x1+parseInt(_0x1b7882(0x11e))/0x2+parseInt(_0x1b7882(0x214))/0x3+-parseInt(_0x1b7882(0x1c8))/0x4+parseInt(_0x1b7882(0x24f))/0x5+parseInt(_0x1b7882(0x1af))/0x6*(parseInt(_0x1b7882(0x225))/0x7)+-parseInt(_0x1b7882(0x138))/0x8;if(_0x445db3===_0x2b1ac8)break;else _0x262047['push'](_0x262047['shift']());}catch(_0x10dc09){_0x262047['push'](_0x262047['shift']());}}}(a13_0x139a,0x739f8));import*as a13_0x199d64 from'./state.js';import{fullAppRender as a13_0x386d6c}from'./app.js';import{generateTrainMap as a13_0x4c1bcb}from'./utils.js';import{toggleScoringEditMode as a13_0x5bb852}from'./scoringView.js';import{renderRpnChart as a13_0x29706a}from'./worstCaseView.js';import{renderMacoChart as a13_0x2dee1c}from'./dashboardView.js';const s=document[a13_0x1da86d(0x1a4)](a13_0x1da86d(0x149));export const showLoader=()=>s[a13_0x1da86d(0x1f0)][a13_0x1da86d(0x1d2)]=a13_0x1da86d(0x1de);export const hideLoader=()=>s[a13_0x1da86d(0x1f0)][a13_0x1da86d(0x1d2)]=a13_0x1da86d(0x1b7);export function showCustomAlert(_0x4fe807,_0x597dbe){const _0x4fea1b=a13_0x1da86d,_0x4f5ed1={'kLrgg':_0x4fea1b(0x1fc),'tfPBb':'customAlertMessage','djbgz':_0x4fea1b(0x1f4),'UlMmM':'flex'};document[_0x4fea1b(0x1a4)](_0x4f5ed1['kLrgg'])[_0x4fea1b(0x2c8)]=_0x4fe807,document[_0x4fea1b(0x1a4)](_0x4f5ed1[_0x4fea1b(0x248)])[_0x4fea1b(0x2c8)]=_0x597dbe,document['getElementById'](_0x4f5ed1[_0x4fea1b(0x2ff)])['style'][_0x4fea1b(0x1d2)]=_0x4f5ed1[_0x4fea1b(0x12e)];}export const hideModal=_0xf670f6=>document[a13_0x1da86d(0x1a4)](_0xf670f6)[a13_0x1da86d(0x1f0)][a13_0x1da86d(0x1d2)]='none';export function saveAllDataToLocalStorage(){const _0x2da326=a13_0x1da86d,_0xdf99c5={'pDiWW':'macoProducts','XjLow':_0x2da326(0xdd),'HkaaT':_0x2da326(0x2f6),'OHAXV':_0x2da326(0x20c),'CdAGQ':_0x2da326(0xfc),'utgbT':function(_0x11ad26,_0x1320ac,_0x242fdd){return _0x11ad26(_0x1320ac,_0x242fdd);},'fxnEt':'Could\x20not\x20save\x20data.\x20Storage\x20might\x20be\x20full.'};try{localStorage[_0x2da326(0x1d4)](_0xdf99c5[_0x2da326(0xe9)],JSON[_0x2da326(0x2ae)](a13_0x199d64[_0x2da326(0x21d)])),localStorage['setItem'](_0x2da326(0x209),JSON[_0x2da326(0x2ae)](a13_0x199d64[_0x2da326(0x206)])),localStorage['setItem'](_0xdf99c5[_0x2da326(0xe8)],JSON[_0x2da326(0x2ae)](a13_0x199d64[_0x2da326(0xe1)])),localStorage[_0x2da326(0x1d4)](_0xdf99c5[_0x2da326(0x16d)],JSON[_0x2da326(0x2ae)](a13_0x199d64['detergentIngredients'])),localStorage[_0x2da326(0x1d4)](_0xdf99c5['OHAXV'],JSON[_0x2da326(0x2ae)](a13_0x199d64[_0x2da326(0x20c)]));}catch(_0x3c3135){console[_0x2da326(0x2d1)](_0xdf99c5[_0x2da326(0x203)],_0x3c3135),_0xdf99c5[_0x2da326(0x10d)](showCustomAlert,_0x2da326(0x13a),_0xdf99c5['fxnEt']);}}export function loadAllDataFromLocalStorage(){const _0x461cfc=a13_0x1da86d,_0x9e5de5={'GzjjP':_0x461cfc(0x270),'wJVHs':_0x461cfc(0x209),'DlFPw':_0x461cfc(0x1c7),'NsfGB':_0x461cfc(0x285),'CLJjw':'Error\x20loading\x20machine\x20stage\x20order'},_0x3dd527=localStorage[_0x461cfc(0x252)](_0x9e5de5[_0x461cfc(0x255)]),_0x5254f6=localStorage[_0x461cfc(0x252)](_0x9e5de5[_0x461cfc(0x10a)]),_0x1b7d35=localStorage[_0x461cfc(0x252)](_0x461cfc(0xdd)),_0xeeab36=localStorage[_0x461cfc(0x252)](_0x461cfc(0x2f6)),_0x2da4f3=localStorage[_0x461cfc(0x252)]('machineStageDisplayOrder');if(_0x3dd527)try{a13_0x199d64[_0x461cfc(0x115)](JSON['parse'](_0x3dd527));}catch(_0x3f275c){console[_0x461cfc(0x2d1)](_0x9e5de5[_0x461cfc(0x17f)],_0x3f275c);}if(_0x5254f6)try{a13_0x199d64['setMachines'](JSON[_0x461cfc(0x197)](_0x5254f6));}catch(_0x28a159){console['error'](_0x461cfc(0x244),_0x28a159);}if(_0x1b7d35)try{a13_0x199d64[_0x461cfc(0x1f9)](JSON[_0x461cfc(0x197)](_0x1b7d35));}catch(_0x385f01){console['error'](_0x9e5de5[_0x461cfc(0x2e4)],_0x385f01);}if(_0xeeab36)try{a13_0x199d64['setDetergentIngredients'](JSON[_0x461cfc(0x197)](_0xeeab36));}catch(_0x10cef8){console[_0x461cfc(0x2d1)]('Error\x20loading\x20detergent\x20ingredients',_0x10cef8);}if(_0x2da4f3)try{a13_0x199d64[_0x461cfc(0x19a)](JSON[_0x461cfc(0x197)](_0x2da4f3));}catch(_0x1a46e6){console[_0x461cfc(0x2d1)](_0x9e5de5[_0x461cfc(0x1be)],_0x1a46e6);}}export function saveStateForUndo(){const _0x4cec05=a13_0x1da86d,_0x358cd6={'gQdpt':function(_0x18f7d5){return _0x18f7d5();}};_0x358cd6['gQdpt'](a13_0x4c1bcb);const _0x332e6e=a13_0x199d64[_0x4cec05(0x113)][_0x4cec05(0x280)](0x0,a13_0x199d64['historyIndex']+0x1),_0x14900c={'products':JSON[_0x4cec05(0x197)](JSON['stringify'](a13_0x199d64[_0x4cec05(0x21d)])),'machines':JSON[_0x4cec05(0x197)](JSON[_0x4cec05(0x2ae)](a13_0x199d64[_0x4cec05(0x206)])),'scoringCriteria':JSON[_0x4cec05(0x197)](JSON[_0x4cec05(0x2ae)](a13_0x199d64[_0x4cec05(0xe1)])),'detergentIngredients':JSON[_0x4cec05(0x197)](JSON[_0x4cec05(0x2ae)](a13_0x199d64[_0x4cec05(0x14f)]))};_0x332e6e[_0x4cec05(0x271)](_0x14900c),a13_0x199d64[_0x4cec05(0x23b)](_0x332e6e,_0x332e6e[_0x4cec05(0x10f)]-0x1),updateUndoRedoButtons(),_0x358cd6['gQdpt'](saveAllDataToLocalStorage);}export function updateUndoRedoButtons(){const _0x5a59dc=a13_0x1da86d,_0x20c8f1={'tjplo':'undo-btn','DYQpn':_0x5a59dc(0x169),'gMAkK':function(_0x31b338,_0x430b5c){return _0x31b338>=_0x430b5c;},'NIBZV':function(_0x18a490,_0x1bcfe3){return _0x18a490-_0x1bcfe3;}},_0x48f555=document[_0x5a59dc(0x1a4)](_0x20c8f1[_0x5a59dc(0x2e9)]),_0x30af2b=document[_0x5a59dc(0x1a4)](_0x20c8f1[_0x5a59dc(0x179)]);_0x48f555&&(_0x48f555[_0x5a59dc(0x207)]=a13_0x199d64[_0x5a59dc(0x1c2)]<=0x0),_0x30af2b&&(_0x30af2b[_0x5a59dc(0x207)]=_0x20c8f1[_0x5a59dc(0x1f5)](a13_0x199d64[_0x5a59dc(0x1c2)],_0x20c8f1[_0x5a59dc(0x21e)](a13_0x199d64['history'][_0x5a59dc(0x10f)],0x1)));}export function undoChange(){const _0x2a6f00=a13_0x1da86d,_0x59f7db={'OPsnC':function(_0x42aec0,_0x2dd9c1){return _0x42aec0-_0x2dd9c1;},'yfcQS':function(_0x459693,_0x481d7c){return _0x459693(_0x481d7c);},'BZJoq':function(_0x4f5540){return _0x4f5540();},'TZzRB':function(_0x51908d){return _0x51908d();}};if(a13_0x199d64[_0x2a6f00(0x1c2)]>0x0){const _0x529dd1=_0x59f7db['OPsnC'](a13_0x199d64['historyIndex'],0x1),_0x5e7ca8=a13_0x199d64[_0x2a6f00(0x113)][_0x529dd1];a13_0x199d64['setProducts'](JSON[_0x2a6f00(0x197)](JSON['stringify'](_0x5e7ca8['products']))),a13_0x199d64[_0x2a6f00(0x219)](JSON[_0x2a6f00(0x197)](JSON[_0x2a6f00(0x2ae)](_0x5e7ca8[_0x2a6f00(0x206)]))),a13_0x199d64[_0x2a6f00(0x1f9)](JSON[_0x2a6f00(0x197)](JSON[_0x2a6f00(0x2ae)](_0x5e7ca8['scoringCriteria']))),a13_0x199d64[_0x2a6f00(0x282)](JSON[_0x2a6f00(0x197)](JSON[_0x2a6f00(0x2ae)](_0x5e7ca8[_0x2a6f00(0x14f)]))),a13_0x199d64[_0x2a6f00(0x23b)](a13_0x199d64[_0x2a6f00(0x113)],_0x529dd1),a13_0x199d64[_0x2a6f00(0x108)]&&_0x59f7db[_0x2a6f00(0x1aa)](a13_0x5bb852,!0x1),a13_0x386d6c(),_0x59f7db[_0x2a6f00(0x27b)](updateUndoRedoButtons),_0x59f7db[_0x2a6f00(0x230)](saveAllDataToLocalStorage);}}export function redoChange(){const _0x56103f=a13_0x1da86d,_0x5eff2f={'qAxqz':function(_0x21c448,_0x3a8e55){return _0x21c448<_0x3a8e55;},'NZEJV':function(_0x596531,_0x59946f){return _0x596531-_0x59946f;},'bUcrM':function(_0x120d61,_0x44a0ff){return _0x120d61+_0x44a0ff;},'ohyYX':function(_0x44ccad){return _0x44ccad();}};if(_0x5eff2f[_0x56103f(0x2a7)](a13_0x199d64[_0x56103f(0x1c2)],_0x5eff2f[_0x56103f(0x29b)](a13_0x199d64[_0x56103f(0x113)]['length'],0x1))){const _0x4f745=_0x5eff2f[_0x56103f(0x18f)](a13_0x199d64[_0x56103f(0x1c2)],0x1),_0x25d037=a13_0x199d64[_0x56103f(0x113)][_0x4f745];a13_0x199d64['setProducts'](JSON[_0x56103f(0x197)](JSON[_0x56103f(0x2ae)](_0x25d037[_0x56103f(0x21d)]))),a13_0x199d64[_0x56103f(0x219)](JSON['parse'](JSON[_0x56103f(0x2ae)](_0x25d037[_0x56103f(0x206)]))),a13_0x199d64[_0x56103f(0x1f9)](JSON['parse'](JSON[_0x56103f(0x2ae)](_0x25d037[_0x56103f(0xe1)]))),a13_0x199d64[_0x56103f(0x282)](JSON['parse'](JSON[_0x56103f(0x2ae)](_0x25d037[_0x56103f(0x14f)]))),a13_0x199d64[_0x56103f(0x23b)](a13_0x199d64[_0x56103f(0x113)],_0x4f745),a13_0x199d64['scoringInEditMode']&&a13_0x5bb852(!0x1),_0x5eff2f[_0x56103f(0x2f1)](a13_0x386d6c),_0x5eff2f['ohyYX'](updateUndoRedoButtons),saveAllDataToLocalStorage();}}export function toggleDarkMode(_0x5d6a6e){const _0x601bab=a13_0x1da86d,_0x46596e={'auCNR':'theme-toggle-light-icon','yWvXm':'theme-toggle-dark-icon','zluNL':_0x601bab(0x212),'ozShC':function(_0x2d4a0b){return _0x2d4a0b();}},_0x388335=document[_0x601bab(0x1a4)](_0x46596e[_0x601bab(0x1ca)]),_0x5f07cb=document['getElementById'](_0x46596e['yWvXm']);_0x5d6a6e?(document[_0x601bab(0x20a)][_0x601bab(0x174)][_0x601bab(0xed)](_0x601bab(0x1a6)),_0x388335&&_0x388335['classList'][_0x601bab(0xed)](_0x46596e[_0x601bab(0x1cc)]),_0x5f07cb&&_0x5f07cb[_0x601bab(0x174)][_0x601bab(0x12d)](_0x46596e[_0x601bab(0x1cc)])):(document[_0x601bab(0x20a)][_0x601bab(0x174)][_0x601bab(0x12d)](_0x601bab(0x1a6)),_0x388335&&_0x388335[_0x601bab(0x174)]['remove']('hidden'),_0x5f07cb&&_0x5f07cb[_0x601bab(0x174)][_0x601bab(0xed)](_0x46596e['zluNL'])),a13_0x199d64['rpnChartInstance']&&_0x46596e[_0x601bab(0x23e)](a13_0x29706a),a13_0x199d64[_0x601bab(0x2f2)]&&_0x46596e['ozShC'](a13_0x2dee1c);}export function printCurrentView(_0x192769,_0x59ab84=a13_0x1da86d(0x1e5)){const _0x5c4905=a13_0x1da86d,_0x51deb3={'LaslP':function(_0x53b22e,_0x10ad58,_0x1e6042){return _0x53b22e(_0x10ad58,_0x1e6042);},'VqOCn':_0x5c4905(0x212),'AVLAa':'Hide\x20MACO\x20Calculation\x20Breakdown','aDsZy':_0x5c4905(0x178),'FIHKt':function(_0x41c0b6,_0x383b04,_0x964753){return _0x41c0b6(_0x383b04,_0x964753);},'bQrKZ':_0x5c4905(0x155),'lRPYm':_0x5c4905(0x22a),'ijosc':_0x5c4905(0x213),'abNVg':function(_0x4a7804,_0x9536ad,_0x2aa28){return _0x4a7804(_0x9536ad,_0x2aa28);},'GBwda':'Error\x20loading\x20detergent\x20view\x20for\x20print:','zLzzN':_0x5c4905(0x187),'QWTeR':function(_0x20b590,_0x54de00,_0x3c1b96){return _0x20b590(_0x54de00,_0x3c1b96);},'HNGSk':_0x5c4905(0x1ef),'chbai':'not\x20found','zxoyl':_0x5c4905(0x23d),'tavwW':function(_0x2e1aca,_0x2dbf85){return _0x2e1aca===_0x2dbf85;},'Zddfn':_0x5c4905(0x15c),'zYADv':function(_0x2cbb7e,_0x146e74){return _0x2cbb7e(_0x146e74);},'bvApN':function(_0x3ecd3a,_0x280959,_0x57e7ef){return _0x3ecd3a(_0x280959,_0x57e7ef);},'xApXU':_0x5c4905(0x263),'ocQzW':function(_0x2d8121,_0x4aae8e){return _0x2d8121+_0x4aae8e;},'kZpeC':_0x5c4905(0xf0),'tatpR':_0x5c4905(0x119),'XdzKx':_0x5c4905(0x2e0),'sJNEI':_0x5c4905(0x16c),'QczIb':_0x5c4905(0x147),'hawbi':_0x5c4905(0x23a),'aZuph':function(_0x4d7aad,_0x2d420c){return _0x4d7aad===_0x2d420c;},'NDoHZ':_0x5c4905(0x28f),'lydmT':_0x5c4905(0x297),'AqSgG':_0x5c4905(0x27d),'wgPlR':_0x5c4905(0x298)};_0x51deb3[_0x5c4905(0x12a)](_0x51deb3['tatpR'],_0x192769)&&a13_0x199d64['scoringInEditMode']&&(a13_0x199d64[_0x5c4905(0x2d8)](!0x0),a13_0x5bb852(!0x1)),console[_0x5c4905(0x205)](_0x51deb3[_0x5c4905(0x221)],_0x192769,_0x51deb3[_0x5c4905(0x13e)],_0x59ab84),document['body'][_0x5c4905(0x174)][_0x5c4905(0xed)]('printing-'+_0x192769),_0x51deb3[_0x5c4905(0x268)]===_0x192769?import(_0x51deb3['hawbi'])[_0x5c4905(0x12f)](_0x18a01f=>{const _0xfbe3f2=_0x5c4905;window['printSelectedTrain']=_0x59ab84,_0x18a01f[_0xfbe3f2(0x2bf)](),_0x51deb3[_0xfbe3f2(0x2c1)](setTimeout,()=>{window['print']();},0xc8);}):_0x51deb3[_0x5c4905(0x300)](_0x51deb3['NDoHZ'],_0x192769)?(window[_0x5c4905(0x145)]=_0x59ab84,import(_0x51deb3['lydmT'])[_0x5c4905(0x12f)](_0x426c4d=>{const _0x20d414=_0x5c4905,_0x41b958={'lyvJd':_0x51deb3[_0x20d414(0x135)],'YwYjb':_0x51deb3[_0x20d414(0x134)],'twrhp':function(_0x128bd4,_0x2608a5,_0x392c73){return _0x51deb3['FIHKt'](_0x128bd4,_0x2608a5,_0x392c73);}};_0x426c4d[_0x20d414(0x299)]();const _0x39bbf1=document[_0x20d414(0x272)](_0x51deb3[_0x20d414(0x163)]),_0x538c52=[];_0x39bbf1[_0x20d414(0x114)](_0x517c1b=>{const _0x170eb0=_0x20d414,_0x16d900=_0x517c1b['id']['match'](/content-pm-(\d+)/);if(_0x16d900){_0x538c52['push'](_0x16d900[0x1]),_0x517c1b[_0x170eb0(0x174)][_0x170eb0(0x12d)]('collapsed');const _0x4b1388=document[_0x170eb0(0x1a4)]('toggle-pm-'+_0x16d900[0x1]);_0x4b1388&&(_0x4b1388[_0x170eb0(0x2c8)]='▼');}});const _0x1ece74=document[_0x20d414(0x272)](_0x51deb3['lRPYm']),_0x20505b=[];_0x1ece74['forEach'](_0x4629f7=>{const _0x47a010=_0x20d414,_0x9ff23d=_0x4629f7['id']['match'](/maco-breakdown-details-(\d+)/);if(_0x9ff23d){_0x20505b[_0x47a010(0x271)](_0x9ff23d[0x1]),_0x4629f7[_0x47a010(0x174)][_0x47a010(0x12d)](_0x51deb3[_0x47a010(0x135)]);const _0x102f0b=document[_0x47a010(0x1a4)](_0x47a010(0x240)+_0x9ff23d[0x1]);_0x102f0b&&(_0x102f0b[_0x47a010(0x2c8)]=_0x51deb3['AVLAa']);}}),setTimeout(()=>{const _0x1cc2de=_0x20d414;window[_0x1cc2de(0x1c0)](),_0x41b958[_0x1cc2de(0x20f)](setTimeout,()=>{const _0x49c8a7=_0x1cc2de,_0x412578={'msjVy':_0x41b958['lyvJd'],'XcAbX':_0x41b958[_0x49c8a7(0x27e)]};_0x538c52[_0x49c8a7(0x114)](_0x5d27c5=>{const _0xeacdd7=_0x49c8a7,_0x404535=document[_0xeacdd7(0x1a4)]('content-pm-'+_0x5d27c5),_0x78b3a5=document[_0xeacdd7(0x1a4)]('toggle-pm-'+_0x5d27c5);_0x404535&&_0x404535['classList']['add'](_0xeacdd7(0x1c5)),_0x78b3a5&&(_0x78b3a5[_0xeacdd7(0x2c8)]='▶');}),_0x20505b['forEach'](_0x13cc5c=>{const _0x5c8a6c=_0x49c8a7,_0x53633e=document['getElementById'](_0x5c8a6c(0x186)+_0x13cc5c),_0x5229fd=document['getElementById']('breakdown-toggle-btn-'+_0x13cc5c);_0x53633e&&_0x53633e[_0x5c8a6c(0x174)][_0x5c8a6c(0xed)](_0x412578[_0x5c8a6c(0x2bd)]),_0x5229fd&&(_0x5229fd['textContent']=_0x412578[_0x5c8a6c(0x26d)]);});},0x3e8);},0xc8);})):_0x51deb3[_0x5c4905(0x12a)](_0x51deb3[_0x5c4905(0x2a1)],_0x192769)?(window['printSelectedTrain']=_0x59ab84,import(_0x51deb3[_0x5c4905(0x287)])[_0x5c4905(0x12f)](_0x4543b5=>{const _0x1a5d60=_0x5c4905,_0xf5aa53={'jVshb':_0x1a5d60(0x1c5)};_0x4543b5[_0x1a5d60(0x15b)]();const _0x6fa991=document[_0x1a5d60(0x272)](_0x51deb3[_0x1a5d60(0x112)]),_0x2fe931=[];_0x6fa991['forEach'](_0x458f83=>{const _0x35f22c=_0x1a5d60,_0x484c13=_0x458f83['id'][_0x35f22c(0x2a0)](/content-dm-(\d+)/);if(_0x484c13){_0x2fe931[_0x35f22c(0x271)](_0x484c13[0x1]),_0x458f83[_0x35f22c(0x174)]['remove'](_0xf5aa53[_0x35f22c(0x2b7)]);const _0x50a07d=document['getElementById'](_0x35f22c(0x15d)+_0x484c13[0x1]);_0x50a07d&&(_0x50a07d[_0x35f22c(0x2c8)]='▼');}}),_0x51deb3['abNVg'](setTimeout,()=>{const _0x36107e=_0x1a5d60;window[_0x36107e(0x1c0)](),_0x51deb3[_0x36107e(0xd3)](setTimeout,()=>{const _0x2c7cb7=_0x36107e;_0x2fe931[_0x2c7cb7(0x114)](_0x4d1c80=>{const _0x33f34c=_0x2c7cb7,_0x25f616=document[_0x33f34c(0x1a4)](_0x33f34c(0x2d9)+_0x4d1c80),_0x3fc2f1=document[_0x33f34c(0x1a4)](_0x33f34c(0x15d)+_0x4d1c80);_0x25f616&&_0x25f616['classList'][_0x33f34c(0xed)]('collapsed'),_0x3fc2f1&&(_0x3fc2f1[_0x33f34c(0x2c8)]='▶');});},0x3e8);},0xc8);})[_0x5c4905(0x226)](_0x9cf2fe=>{const _0x298d26=_0x5c4905;console[_0x298d26(0x2d1)](_0x51deb3[_0x298d26(0x190)],_0x9cf2fe),window[_0x298d26(0x1c0)]();})[_0x5c4905(0x2b5)](()=>{const _0x22b814=_0x5c4905;_0x51deb3[_0x22b814(0x262)](setTimeout,()=>{const _0x19d748=_0x22b814;window['printSelectedTrain']=null,import(_0x51deb3[_0x19d748(0x287)])['then'](_0x16ab8f=>_0x16ab8f['renderDetergentMaco']())[_0x19d748(0x226)](()=>{});},0x4b0);})):_0x51deb3['aZuph'](_0x5c4905(0x167),_0x192769)?(window[_0x5c4905(0x145)]=_0x59ab84,console['log'](_0x51deb3['wgPlR'],_0x59ab84),import(_0x5c4905(0xea))[_0x5c4905(0x12f)](_0x4fd852=>{const _0x33af4c=_0x5c4905,_0x10404c={'gVoiJ':'trainSummaryContainer','MtlYh':_0x51deb3[_0x33af4c(0x292)],'uOFkc':_0x51deb3[_0x33af4c(0x2d0)],'gYzVj':_0x51deb3['zxoyl'],'BdFag':function(_0xfb175b,_0xd0b278){return _0xfb175b>_0xd0b278;},'vhKHO':function(_0x565b01,_0x208fcd){return _0x51deb3['tavwW'](_0x565b01,_0x208fcd);},'xfkvZ':_0x33af4c(0x1b7),'miWdF':_0x51deb3[_0x33af4c(0x2a5)],'eiBaY':function(_0xe64124,_0x505522){const _0x1948a5=_0x33af4c;return _0x51deb3[_0x1948a5(0x202)](_0xe64124,_0x505522);},'KIVzJ':_0x33af4c(0x284),'JIInX':function(_0x120b12,_0x16f0ea,_0x1a608c){const _0x131f46=_0x33af4c;return _0x51deb3[_0x131f46(0xd3)](_0x120b12,_0x16f0ea,_0x1a608c);}};_0x4fd852['renderTrainSummary'](),_0x51deb3[_0x33af4c(0x2e1)](setTimeout,()=>{const _0x2bd2c1=_0x33af4c,_0x1f5bc2=document[_0x2bd2c1(0x1a4)](_0x10404c[_0x2bd2c1(0xd8)]),_0x55cb17=document[_0x2bd2c1(0x1a4)](_0x10404c[_0x2bd2c1(0x2c3)]);if(console[_0x2bd2c1(0x205)](_0x2bd2c1(0x216),_0x1f5bc2?_0x1f5bc2[_0x2bd2c1(0x1f0)][_0x2bd2c1(0x1d2)]:_0x10404c[_0x2bd2c1(0x137)]),console['log'](_0x10404c[_0x2bd2c1(0x2df)],_0x55cb17?_0x55cb17[_0x2bd2c1(0x1f0)][_0x2bd2c1(0x1d2)]:_0x10404c[_0x2bd2c1(0x137)]),console[_0x2bd2c1(0x205)](_0x2bd2c1(0xf6),!!_0x1f5bc2&&_0x10404c['BdFag'](_0x1f5bc2[_0x2bd2c1(0x128)][_0x2bd2c1(0x10f)],0x0)),!_0x1f5bc2||_0x10404c['vhKHO'](_0x10404c['xfkvZ'],_0x1f5bc2['style'][_0x2bd2c1(0x1d2)]))return console[_0x2bd2c1(0x25c)](_0x10404c['miWdF']),void _0x10404c['eiBaY'](alert,_0x10404c[_0x2bd2c1(0xd2)]);window[_0x2bd2c1(0x1c0)](),_0x10404c[_0x2bd2c1(0x28b)](setTimeout,()=>{const _0x4b895e=_0x2bd2c1;window['printSelectedTrain']=null,_0x4fd852[_0x4b895e(0x2f8)]();},0x3e8);},0x1f4);})[_0x5c4905(0x226)](_0x5fb95d=>{const _0x18c63e=_0x5c4905;console[_0x18c63e(0x2d1)](_0x51deb3[_0x18c63e(0x13d)],_0x5fb95d),alert(_0x51deb3[_0x18c63e(0x253)](_0x51deb3[_0x18c63e(0x103)],_0x5fb95d[_0x18c63e(0x130)]));})):_0x51deb3['FIHKt'](setTimeout,()=>{window['print']();},0x64);}export function toggleColumn(_0x34e3f0,_0x1e873d){const _0x3046da=a13_0x1da86d,_0x570cd0={'QHzyR':function(_0x464ea8,_0xf0527a){return _0x464ea8===_0xf0527a;},'AHQSr':_0x3046da(0x2b1),'uviGK':_0x3046da(0x140),'azGJb':function(_0x3994e5,_0x11e429){return _0x3994e5!==_0x11e429;},'HQzzM':function(_0x160d0c,_0x462492){return _0x160d0c(_0x462492);},'fOCFU':_0x3046da(0x14d),'jTtxR':_0x3046da(0x147),'yCPOp':'./worstCaseView.js','Keeei':function(_0x3d2910,_0x165405){return _0x3d2910!==_0x165405;},'LCyHe':function(_0x1735f4,_0x8ab756){return _0x1735f4(_0x8ab756);}};if(_0x570cd0[_0x3046da(0x16a)](_0x570cd0[_0x3046da(0x116)],_0x34e3f0)||_0x570cd0['QHzyR'](_0x570cd0[_0x3046da(0x150)],_0x34e3f0)){['productRegister',_0x3046da(0x147)]['forEach'](_0x58cbd4=>{const _0x579cae=_0x3046da;document[_0x579cae(0x272)]('#'+_0x58cbd4+_0x579cae(0x1f2)+_0x58cbd4+_0x579cae(0x302))['forEach'](_0x358415=>{const _0x30c33a=_0x579cae;_0x358415['classList'][_0x30c33a(0x18b)](_0x30c33a(0x220)+_0x34e3f0);}),document['querySelectorAll']('#'+_0x58cbd4+_0x579cae(0x1e0)+_0x58cbd4+_0x579cae(0x15a))['forEach'](_0x24e34c=>{const _0x597853=_0x579cae;_0x24e34c&&_0x24e34c[_0x597853(0x174)][_0x597853(0x18b)](_0x597853(0x220)+_0x34e3f0);});});const _0x3b3f8a=_0x570cd0[_0x3046da(0x11c)](null,document[_0x3046da(0x196)](_0x3046da(0x2b3)+_0x34e3f0));localStorage['setItem'](_0x3046da(0xdf)+_0x34e3f0+_0x3046da(0x142),_0x3b3f8a),_0x570cd0[_0x3046da(0x1f3)](updateToggleIcons,_0x570cd0[_0x3046da(0x2ac)]),updateToggleIcons(_0x570cd0['jTtxR']),import(_0x3046da(0x23a))['then'](_0x55a678=>{_0x55a678['renderWorstCaseByTrain']();}),import(_0x570cd0[_0x3046da(0x165)])[_0x3046da(0x12f)](_0xb0dfc6=>{const _0x2486c8=_0x3046da;_0xb0dfc6[_0x2486c8(0x26e)]&&_0xb0dfc6[_0x2486c8(0x26e)]();});}else{document[_0x3046da(0x272)]('#'+_0x1e873d+_0x3046da(0x1f2)+_0x1e873d+_0x3046da(0x302))['forEach'](_0x2bae22=>{const _0x256982=_0x3046da;_0x2bae22[_0x256982(0x174)][_0x256982(0x18b)](_0x256982(0x220)+_0x34e3f0);});const _0x33d7c9=_0x570cd0[_0x3046da(0x180)](null,document['querySelector']('#'+_0x1e873d+_0x3046da(0x251)+_0x34e3f0));localStorage[_0x3046da(0x1d4)](_0x1e873d+'-'+_0x34e3f0+'Hidden',_0x33d7c9),_0x570cd0['LCyHe'](updateToggleIcons,_0x1e873d);}}export function toggleColumnVisibilityDropdown(){const _0x3cb95b=a13_0x1da86d,_0xb9695d={'KvHrw':'#columnVisibilityDropdown','TNmsW':_0x3cb95b(0x171),'vwoHv':_0x3cb95b(0x212),'SPSAZ':_0x3cb95b(0x131),'cdsAe':'columnVisibilityDropdown'},_0x2a8b67=document[_0x3cb95b(0x1a4)](_0xb9695d[_0x3cb95b(0x23c)]);_0x2a8b67[_0x3cb95b(0x174)][_0x3cb95b(0x18b)](_0xb9695d[_0x3cb95b(0x241)]),_0x2a8b67[_0x3cb95b(0x174)][_0x3cb95b(0x26b)](_0x3cb95b(0x212))||document[_0x3cb95b(0x16b)](_0xb9695d[_0x3cb95b(0x10b)],function _0x2690a5(_0x6c59ee){const _0x39b24c=_0x3cb95b;_0x6c59ee[_0x39b24c(0x242)][_0x39b24c(0x1db)](_0xb9695d['KvHrw'])||_0x6c59ee[_0x39b24c(0x242)]['closest'](_0xb9695d[_0x39b24c(0x210)])||(_0x2a8b67['classList']['add'](_0xb9695d[_0x39b24c(0x241)]),document[_0x39b24c(0x2cf)](_0xb9695d[_0x39b24c(0x10b)],_0x2690a5));});}export function updateToggleIcons(_0x162fef){const _0x2374bd=a13_0x1da86d,_0x5b06b0={'urkgX':_0x2374bd(0xee),'EigyX':_0x2374bd(0x1ac),'WqPbl':_0x2374bd(0x11f),'IFZbl':function(_0x4d9fcc,_0x29cc08){return _0x4d9fcc===_0x29cc08;},'XJgoK':function(_0x17596a,_0x1a3d96){return _0x17596a===_0x1a3d96;},'hHhHk':'true','MdWlx':function(_0x71453c,_0x6acf8){return _0x71453c===_0x6acf8;},'uQedk':_0x2374bd(0xe4),'MyJup':_0x2374bd(0x22b),'Wlklc':_0x2374bd(0x132)},_0x56452b=document[_0x2374bd(0x1a4)](_0x162fef);if(!_0x56452b)return;let _0x48a278,_0x125625;if(_0x2374bd(0x147)===_0x162fef){const _0x56b6c4=localStorage[_0x2374bd(0x252)](_0x5b06b0['WqPbl']),_0x1e89f5=localStorage['getItem'](_0x2374bd(0x27f));if(_0x5b06b0['IFZbl'](null,_0x56b6c4)&&_0x5b06b0[_0x2374bd(0x264)](null,_0x1e89f5))_0x48a278=!0x1,_0x125625=!0x1;else{const _0x3b6c12=_0x5b06b0[_0x2374bd(0x194)](_0x5b06b0[_0x2374bd(0x15e)],_0x56b6c4),_0x6f487e=_0x5b06b0[_0x2374bd(0x194)](_0x2374bd(0x266),_0x1e89f5);_0x3b6c12&&_0x6f487e?(_0x48a278=!0x1,_0x125625=!0x0):(_0x48a278=_0x3b6c12,_0x125625=_0x6f487e);}}else{const _0x586be1=localStorage[_0x2374bd(0x252)](_0x162fef+_0x2374bd(0x123)),_0x3fcfdf=localStorage[_0x2374bd(0x252)](_0x162fef+_0x2374bd(0x1a5));_0x48a278=_0x5b06b0[_0x2374bd(0xf9)](_0x5b06b0[_0x2374bd(0x15e)],_0x586be1),_0x125625=_0x5b06b0['IFZbl']('true',_0x3fcfdf);}const _0x45e12a=_0x56452b[_0x2374bd(0x196)](_0x2374bd(0x1ff)),_0x475638=_0x56452b['querySelector'](_0x2374bd(0x24d));_0x45e12a&&(_0x45e12a[_0x2374bd(0x128)]=_0x48a278?_0x5b06b0['uQedk']:_0x5b06b0[_0x2374bd(0x2e5)]),_0x475638&&(_0x475638[_0x2374bd(0x128)]=_0x125625?_0x2374bd(0x259):_0x5b06b0[_0x2374bd(0x26c)]),document[_0x2374bd(0x272)]('#'+_0x162fef+_0x2374bd(0x1f2)+_0x162fef+_0x2374bd(0x302))['forEach'](_0x4ea8bb=>{const _0x130f97=_0x2374bd;_0x4ea8bb&&(_0x4ea8bb[_0x130f97(0x174)][_0x130f97(0x18b)](_0x5b06b0['urkgX'],_0x48a278),_0x4ea8bb[_0x130f97(0x174)][_0x130f97(0x18b)](_0x130f97(0x1ac),_0x125625));}),document[_0x2374bd(0x272)]('#'+_0x162fef+',\x20#'+_0x162fef+'\x20.train-content-inner')[_0x2374bd(0x114)](_0x4aa5fa=>{const _0x5a0be4=_0x2374bd;_0x4aa5fa&&(_0x4aa5fa[_0x5a0be4(0x174)][_0x5a0be4(0x18b)](_0x5b06b0['urkgX'],_0x48a278),_0x4aa5fa[_0x5a0be4(0x174)][_0x5a0be4(0x18b)](_0x5b06b0[_0x5a0be4(0x17e)],_0x125625));});}export function exportToExcel(){const _0x54ad9b=a13_0x1da86d,_0x5ca414={'wDnit':function(_0x1abeb7,_0x215081){return _0x1abeb7+_0x215081;},'IoIkp':function(_0x38b56d,_0x3dfa6c){return _0x38b56d(_0x3dfa6c);},'rBNMu':function(_0x2a8212){return _0x2a8212();},'gArOT':function(_0x325b4a,_0x2b30ca,_0x35463b){return _0x325b4a(_0x2b30ca,_0x35463b);},'BrqLx':_0x54ad9b(0x139),'cnqxQ':_0x54ad9b(0x1e7),'jOOEJ':'MACO_All_Products_Report.xlsx','qfblS':_0x54ad9b(0x293),'VgLPy':function(_0x36916f,_0x5b2696,_0x39f051){return _0x36916f(_0x5b2696,_0x39f051);},'nAsLo':'Failed\x20to\x20export\x20data\x20to\x20Excel.','IWHTc':'./utils.js'};_0x5ca414[_0x54ad9b(0x182)](showLoader),import(_0x5ca414[_0x54ad9b(0x2ea)])[_0x54ad9b(0x12f)](_0x48f52f=>{const _0x5a1149=_0x54ad9b,{getProductTrainId:_0x440da5,calculateScores:_0x392011}=_0x48f52f,_0xdaf73f=[];if(a13_0x199d64[_0x5a1149(0x21d)][_0x5a1149(0x114)](_0x1b98d1=>{const _0x462bd8=_0x5a1149;let _0x271f74='No';_0x1b98d1[_0x462bd8(0x1ad)]&&(_0x271f74=_0x5ca414[_0x462bd8(0x217)](_0x462bd8(0x177),_0x1b98d1[_0x462bd8(0x16e)]?':\x20'+_0x1b98d1['criticalReason']:''));const _0xee6422=_0x5ca414[_0x462bd8(0x2c4)](_0x440da5,_0x1b98d1),_0x18e3a4=_0x1b98d1['date']?new Date(_0x1b98d1['date'])[_0x462bd8(0x21a)]():'';_0xdaf73f[_0x462bd8(0x271)]({'Date':_0x18e3a4,'Product\x20Code':_0x1b98d1[_0x462bd8(0x2d5)],'Product\x20Name':_0x1b98d1[_0x462bd8(0x246)],'Train\x20No.':_0xee6422,'Dosage\x20Form':_0x1b98d1['productType']||'','Batch\x20Size\x20(Kg)':_0x1b98d1['batchSizeKg'],'Special\x20Case\x20Product':_0x271f74,'Active\x20Ingredient':'','Solubility':'','Therapeutic\x20Dose\x20(mg/day)':'','Cleanability':'','PDE\x20(µg/day)':'','LD50\x20(mg/kg)':'','Solubility\x20Score':'','Therapeutic\x20Dose\x20Score':'','Cleanability\x20Score':'','Toxicity\x20Score':'','RPN':'','RPN\x20Rating':''}),_0x1b98d1[_0x462bd8(0x1d3)][_0x462bd8(0x114)](_0x2f3195=>{const _0x5b6836=_0x462bd8,_0x2e4af=_0x392011(_0x2f3195);_0xdaf73f[_0x5b6836(0x271)]({'Date':'','Product\x20Code':'','Product\x20Name':_0x5b6836(0x18c)+_0x2f3195[_0x5b6836(0x246)],'Train\x20No.':'','Dosage\x20Form':'','Batch\x20Size\x20(Kg)':'','Special\x20Case\x20Product':'','Active\x20Ingredient':_0x2f3195[_0x5b6836(0x246)],'Solubility':_0x2f3195[_0x5b6836(0xf1)]||'','Therapeutic\x20Dose\x20(mg/day)':_0x2f3195[_0x5b6836(0x201)]||'','Cleanability':_0x2f3195[_0x5b6836(0x2ad)]||'','PDE\x20(µg/day)':_0x2f3195[_0x5b6836(0x2b1)]||'','LD50\x20(mg/kg)':_0x2f3195[_0x5b6836(0x140)]||'','Solubility\x20Score':_0x2e4af['solubilityScore']||'','Therapeutic\x20Dose\x20Score':_0x2e4af[_0x5b6836(0x184)]||'','Cleanability\x20Score':_0x2e4af[_0x5b6836(0x28a)]||'','Toxicity\x20Score':_0x2e4af[_0x5b6836(0x12b)]||_0x2e4af[_0x5b6836(0x229)]||'','RPN':_0x2e4af[_0x5b6836(0x11b)],'RPN\x20Rating':_0x2e4af[_0x5b6836(0x100)]});});}),0x0===_0xdaf73f[_0x5a1149(0x10f)])return _0x5ca414[_0x5a1149(0x182)](hideLoader),void _0x5ca414[_0x5a1149(0x109)](showCustomAlert,_0x5a1149(0x17d),_0x5ca414[_0x5a1149(0x185)]);const _0x520a36=XLSX['utils']['json_to_sheet'](_0xdaf73f),_0x89d11f=XLSX[_0x5a1149(0x1cf)]['book_new']();XLSX['utils'][_0x5a1149(0x1fb)](_0x89d11f,_0x520a36,'MACO\x20Report');const _0x490cb6=Object[_0x5a1149(0x144)](_0xdaf73f[0x0])['map'](_0x1005bc=>({'wch':Math['max'](_0x1005bc['length'],..._0xdaf73f[_0x5a1149(0x13b)](_0x261c24=>String(_0x261c24[_0x1005bc]||'')[_0x5a1149(0x10f)]))+0x2}));_0x520a36[_0x5ca414[_0x5a1149(0x161)]]=_0x490cb6,XLSX[_0x5a1149(0x2af)](_0x89d11f,_0x5ca414[_0x5a1149(0x227)]),hideLoader();})[_0x54ad9b(0x226)](_0x21367d=>{const _0x242634=_0x54ad9b;console['error'](_0x5ca414[_0x242634(0x29a)],_0x21367d),_0x5ca414['rBNMu'](hideLoader),_0x5ca414['VgLPy'](showCustomAlert,_0x242634(0x1f6),_0x5ca414[_0x242634(0x234)]);});}function a13_0x3876(_0x3d8ee1,_0x7ecf5f){const _0x139a2e=a13_0x139a();return a13_0x3876=function(_0x3876d1,_0x122729){_0x3876d1=_0x3876d1-0xcf;let _0x403197=_0x139a2e[_0x3876d1];return _0x403197;},a13_0x3876(_0x3d8ee1,_0x7ecf5f);}export function exportAllToJson(){const _0x1d9208=a13_0x1da86d,_0x4694a3={'gLfYs':'maco_data_export.json','QwoWD':function(_0xfd3163,_0x2d0f73,_0x288347){return _0xfd3163(_0x2d0f73,_0x288347);},'GKkMf':_0x1d9208(0x1f6),'xhnOO':function(_0x4e0865,_0x280047){return _0x4e0865+_0x280047;},'onfAl':'Failed\x20to\x20export\x20data\x20to\x20JSON.','jErfZ':function(_0x523429){return _0x523429();}};showLoader();try{const _0x6ce3a7={'exportDate':new Date()[_0x1d9208(0x11a)](),'scoringCriteria':a13_0x199d64['scoringCriteria'],'products':a13_0x199d64[_0x1d9208(0x21d)],'machines':a13_0x199d64[_0x1d9208(0x206)],'detergentIngredients':a13_0x199d64[_0x1d9208(0x14f)]},_0x13b786=JSON[_0x1d9208(0x2ae)](_0x6ce3a7,null,0x2),_0x30be6e=new Blob([_0x13b786],{'type':_0x1d9208(0x29e)}),_0x2771c7=URL['createObjectURL'](_0x30be6e),_0x3ee1d1=document[_0x1d9208(0x2fe)]('a');_0x3ee1d1[_0x1d9208(0x1cd)]=_0x2771c7,_0x3ee1d1[_0x1d9208(0x24c)]=_0x4694a3[_0x1d9208(0x1ae)],document[_0x1d9208(0x1fd)]['appendChild'](_0x3ee1d1),_0x3ee1d1['click'](),document['body'][_0x1d9208(0x162)](_0x3ee1d1),URL['revokeObjectURL'](_0x2771c7);}catch(_0x3eabe6){_0x4694a3[_0x1d9208(0x1b5)](showCustomAlert,_0x4694a3['GKkMf'],_0x4694a3['xhnOO'](_0x4694a3['onfAl'],_0x3eabe6[_0x1d9208(0x130)]));}finally{_0x4694a3[_0x1d9208(0x231)](hideLoader);}}export function importFromJson(_0x2fed41){const _0xc615ee=a13_0x1da86d,_0x2530ac={'RoqNK':function(_0x4e9629){return _0x4e9629();},'DrfKh':function(_0xd4a133,_0x324a6b,_0x28aa94){return _0xd4a133(_0x324a6b,_0x28aa94);},'LMuWa':_0xc615ee(0x1f6),'xuvBW':_0xc615ee(0x21c)},_0x377699=_0x2fed41[_0xc615ee(0x242)][_0xc615ee(0x2da)][0x0];if(!_0x377699)return;const _0x33d4cc=new FileReader();_0x33d4cc[_0xc615ee(0x1bd)]=function(_0x402c09){const _0x5a3b66=_0xc615ee;try{const _0x18996a=JSON['parse'](_0x402c09[_0x5a3b66(0x242)][_0x5a3b66(0x215)]);_0x18996a&&_0x18996a[_0x5a3b66(0x21d)]&&_0x18996a[_0x5a3b66(0xe1)]&&_0x18996a[_0x5a3b66(0x206)]?(a13_0x199d64['setProducts'](_0x18996a['products']),a13_0x199d64[_0x5a3b66(0x219)](_0x18996a[_0x5a3b66(0x206)]),a13_0x199d64[_0x5a3b66(0x1f9)](_0x18996a[_0x5a3b66(0xe1)]),_0x18996a[_0x5a3b66(0x14f)]&&a13_0x199d64['setDetergentIngredients'](_0x18996a[_0x5a3b66(0x14f)]),saveStateForUndo(),_0x2530ac['RoqNK'](a13_0x386d6c),showCustomAlert(_0x5a3b66(0x1c9),'Data\x20imported\x20successfully.')):_0x2530ac[_0x5a3b66(0x228)](showCustomAlert,_0x2530ac[_0x5a3b66(0xd9)],_0x5a3b66(0xd4));}catch(_0x2a58ed){_0x2530ac[_0x5a3b66(0x228)](showCustomAlert,_0x2530ac[_0x5a3b66(0xd9)],_0x2530ac[_0x5a3b66(0x157)]);}finally{_0x2fed41[_0x5a3b66(0x242)][_0x5a3b66(0x1d0)]='';}},_0x33d4cc[_0xc615ee(0x27c)](_0x377699);}export function toggleOtherProductType(_0x3f0326,_0x498b74){const _0x1419d5=a13_0x1da86d,_0x3c4c5c={'LNrxa':_0x1419d5(0x1b3),'UGJka':_0x1419d5(0xf5),'iOPIT':_0x1419d5(0x105)},_0x58a6cf=document[_0x1419d5(0x1a4)](_0x498b74),_0x11e41f=_0x58a6cf[_0x1419d5(0x196)](_0x3c4c5c[_0x1419d5(0x1a9)]);_0x3c4c5c[_0x1419d5(0x2f9)]===_0x3f0326[_0x1419d5(0x1d0)]?(_0x58a6cf[_0x1419d5(0x1f0)][_0x1419d5(0x1d2)]=_0x3c4c5c[_0x1419d5(0x2f3)],_0x11e41f['required']=!0x0):(_0x58a6cf[_0x1419d5(0x1f0)][_0x1419d5(0x1d2)]=_0x1419d5(0x1b7),_0x11e41f[_0x1419d5(0x275)]=!0x1,_0x11e41f[_0x1419d5(0x1d0)]='');}export function toggleOtherMachineStage(_0x12856c,_0x4a92fa){const _0x3958c5=a13_0x1da86d,_0x39613d={'NlVsv':_0x3958c5(0x1b3),'PiJKy':function(_0x276cf7,_0x2e1b4c){return _0x276cf7===_0x2e1b4c;},'OxENt':_0x3958c5(0xf5),'hhGnk':_0x3958c5(0x105),'Zwpfc':'none'},_0x36e37b=document[_0x3958c5(0x1a4)](_0x4a92fa),_0x1824f7=_0x36e37b[_0x3958c5(0x196)](_0x39613d[_0x3958c5(0x277)]);_0x39613d[_0x3958c5(0x2f7)](_0x39613d['OxENt'],_0x12856c[_0x3958c5(0x1d0)])?(_0x36e37b[_0x3958c5(0x1f0)][_0x3958c5(0x1d2)]=_0x39613d[_0x3958c5(0x1d5)],_0x1824f7[_0x3958c5(0x275)]=!0x0):(_0x36e37b['style'][_0x3958c5(0x1d2)]=_0x39613d['Zwpfc'],_0x1824f7[_0x3958c5(0x275)]=!0x1,_0x1824f7[_0x3958c5(0x1d0)]='');}export function toggleOtherMachineGroup(_0x3d608b,_0x39ddc0){const _0x295ba5=a13_0x1da86d,_0x31b3fd={'fLTWL':'input','KxdeJ':function(_0xa6497f,_0x5a5455){return _0xa6497f===_0x5a5455;},'XhRed':_0x295ba5(0xf5),'UlWoG':_0x295ba5(0x105)},_0x403163=document['getElementById'](_0x39ddc0),_0x37f306=_0x403163[_0x295ba5(0x196)](_0x31b3fd['fLTWL']);_0x31b3fd[_0x295ba5(0x211)](_0x31b3fd[_0x295ba5(0x124)],_0x3d608b[_0x295ba5(0x1d0)])?(_0x403163[_0x295ba5(0x1f0)][_0x295ba5(0x1d2)]=_0x31b3fd[_0x295ba5(0x283)],_0x37f306[_0x295ba5(0x275)]=!0x0):(_0x403163[_0x295ba5(0x1f0)][_0x295ba5(0x1d2)]=_0x295ba5(0x1b7),_0x37f306[_0x295ba5(0x275)]=!0x1,_0x37f306[_0x295ba5(0x1d0)]='');}export function clampSafetyFactor(_0x57fcd6,_0x54255b){const _0x59cc45=a13_0x1da86d,_0x20be8a={'remQS':function(_0x46887d,_0x17d6e5){return _0x46887d(_0x17d6e5);},'zQZKj':function(_0x164804,_0x321ca3){return _0x164804>_0x321ca3;},'FWhFT':function(_0x429639,_0x2fd526){return _0x429639!==_0x2fd526;},'XOeQr':function(_0x4b088c,_0x625de6){return _0x4b088c(_0x625de6);},'fUCnc':_0x59cc45(0xd5)},_0x7ba18d=_0x20be8a[_0x59cc45(0x2c9)](parseFloat,_0x57fcd6[_0x59cc45(0x22c)]),_0x24060e=_0x20be8a['remQS'](parseFloat,_0x57fcd6[_0x59cc45(0x29d)]);let _0x364854=parseFloat(_0x57fcd6[_0x59cc45(0x1d0)]);isNaN(_0x364854)&&(_0x364854=_0x7ba18d),_0x364854<_0x7ba18d?_0x364854=_0x7ba18d:_0x20be8a[_0x59cc45(0x181)](_0x364854,_0x24060e)&&(_0x364854=_0x24060e),_0x20be8a[_0x59cc45(0x1dc)](_0x20be8a[_0x59cc45(0x168)](parseFloat,_0x57fcd6[_0x59cc45(0x1d0)]),_0x364854)&&(_0x57fcd6[_0x59cc45(0x1d0)]=_0x364854),_0x57fcd6['id'][_0x59cc45(0x223)](_0x20be8a[_0x59cc45(0x1b6)])?_0x20be8a[_0x59cc45(0x168)](recalculateProductMacoForTrain,_0x54255b):_0x57fcd6['id'][_0x59cc45(0x223)](_0x59cc45(0x10c))&&recalculateDetergentMacoForTrain(_0x54255b);}export function toggleTrain(_0x3c7532){const _0x107bf2=a13_0x1da86d,_0x2569b1={'TvitR':function(_0x4287e5,_0x5995f6){return _0x4287e5&&_0x5995f6;},'OHIcu':_0x107bf2(0x1c5)},_0x3d82f8=document[_0x107bf2(0x1a4)](_0x107bf2(0x2ba)+_0x3c7532),_0x1186a1=document[_0x107bf2(0x1a4)](_0x107bf2(0x2fa)+_0x3c7532);_0x2569b1[_0x107bf2(0x2c2)](_0x3d82f8,_0x1186a1)&&(_0x3d82f8['classList'][_0x107bf2(0x26b)](_0x2569b1[_0x107bf2(0xe7)])?(_0x3d82f8[_0x107bf2(0x174)][_0x107bf2(0x12d)](_0x2569b1[_0x107bf2(0xe7)]),_0x1186a1[_0x107bf2(0x2c8)]='▼'):(_0x3d82f8[_0x107bf2(0x174)][_0x107bf2(0xed)](_0x2569b1[_0x107bf2(0xe7)]),_0x1186a1[_0x107bf2(0x2c8)]='▶'));}export function toggleMacoBreakdown(_0x56d73d){const _0x4f42f4=a13_0x1da86d,_0xe94a21={'kRvWk':_0x4f42f4(0x212)},_0x39b077=document[_0x4f42f4(0x1a4)](_0x4f42f4(0x186)+_0x56d73d),_0x2fa06b=document['getElementById']('breakdown-toggle-btn-'+_0x56d73d);_0x39b077['classList'][_0x4f42f4(0x26b)](_0xe94a21[_0x4f42f4(0xf8)])?(_0x39b077[_0x4f42f4(0x174)][_0x4f42f4(0x12d)](_0xe94a21[_0x4f42f4(0xf8)]),_0x2fa06b[_0x4f42f4(0x2c8)]='Hide\x20MACO\x20Calculation\x20Breakdown'):(_0x39b077['classList'][_0x4f42f4(0xed)](_0x4f42f4(0x212)),_0x2fa06b[_0x4f42f4(0x2c8)]=_0x4f42f4(0x178));}export function exportWorstCaseToExcel(_0x16e81c=a13_0x1da86d(0x1e5)){const _0x334c0d=a13_0x1da86d,_0x57b7a0={'JLYOB':function(_0x1b3b33,_0x47b7ee){return _0x1b3b33(_0x47b7ee);},'EEbUI':function(_0x2376af,_0xa2852f){return _0x2376af!==_0xa2852f;},'vSwro':function(_0x2ed44f,_0x36f710,_0x3abdad){return _0x2ed44f(_0x36f710,_0x3abdad);},'sObsX':_0x334c0d(0x2f4),'roZYP':_0x334c0d(0x177),'sPIPi':function(_0x5b4049,_0x3df932){return _0x5b4049===_0x3df932;},'yfPav':function(_0x174c4c,_0x1180c5,_0x28aa12){return _0x174c4c(_0x1180c5,_0x28aa12);},'Vvuim':_0x334c0d(0x175),'WbNqt':function(_0x5250f8,_0x4c49c8){return _0x5250f8!==_0x4c49c8;},'xeXdr':_0x334c0d(0x1e5),'HHXaQ':function(_0x2209f2){return _0x2209f2();},'GaRba':function(_0x1f57e0,_0x557b0f){return _0x1f57e0===_0x557b0f;},'yCVsL':_0x334c0d(0x17d),'BHALv':'There\x20is\x20no\x20data\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','CrLpd':_0x334c0d(0x2ab),'ZidWY':'Error\x20exporting\x20worst\x20case\x20to\x20Excel:','gZqNS':_0x334c0d(0x1f6),'aMCcB':function(_0x2945aa){return _0x2945aa();},'chkgM':'./utils.js'};_0x57b7a0[_0x334c0d(0x1e1)](showLoader),import(_0x57b7a0[_0x334c0d(0x2fd)])[_0x334c0d(0x12f)](_0x24411f=>{const _0x2e4d44=_0x334c0d,_0x4842d9={'zBdkE':function(_0x16d189,_0x2252ed){return _0x57b7a0['JLYOB'](_0x16d189,_0x2252ed);},'mhlwg':function(_0x5ec061,_0x3e39a7){return _0x57b7a0['EEbUI'](_0x5ec061,_0x3e39a7);},'UGkBJ':function(_0x5917f6,_0x3dce84,_0x4faa01){return _0x57b7a0['vSwro'](_0x5917f6,_0x3dce84,_0x4faa01);},'TKtJx':_0x57b7a0[_0x2e4d44(0x1bf)],'REgNw':_0x57b7a0[_0x2e4d44(0x250)]},{getProductTrainId:_0x1a7b84,calculateScores:_0x15e523,getToxicityPreference:_0x320049}=_0x24411f,_0x24082a=[];let _0x2b993f=a13_0x199d64[_0x2e4d44(0x276)][_0x2e4d44(0x147)]||a13_0x199d64[_0x2e4d44(0x21d)];if(_0x57b7a0['sPIPi'](0x0,_0x2b993f[_0x2e4d44(0x10f)]))return hideLoader(),void _0x57b7a0[_0x2e4d44(0x2de)](showCustomAlert,'No\x20Data',_0x57b7a0[_0x2e4d44(0x247)]);const _0x43bf49={};_0x2b993f[_0x2e4d44(0x114)](_0x43aa2e=>{const _0x5bb1ee=_0x2e4d44,_0x4054a2=_0x4842d9[_0x5bb1ee(0xe5)](_0x1a7b84,_0x43aa2e);_0x4842d9[_0x5bb1ee(0x2bb)]('N/A',_0x4054a2)&&(_0x43bf49[_0x4054a2]||(_0x43bf49[_0x4054a2]=[]),_0x43bf49[_0x4054a2][_0x5bb1ee(0x271)](_0x43aa2e));});let _0xf5d2e3=_0x43bf49;if(_0x57b7a0[_0x2e4d44(0x2eb)](_0x57b7a0[_0x2e4d44(0x218)],_0x16e81c)&&(_0xf5d2e3={},Array['isArray'](_0x16e81c)?_0x16e81c[_0x2e4d44(0x114)](_0x245728=>{_0x43bf49[_0x245728]&&(_0xf5d2e3[_0x245728]=_0x43bf49[_0x245728]);}):_0x43bf49[_0x16e81c]&&(_0xf5d2e3={[_0x16e81c]:_0x43bf49[_0x16e81c]}),_0x57b7a0['sPIPi'](0x0,Object['keys'](_0xf5d2e3)['length'])))return _0x57b7a0['HHXaQ'](hideLoader),void _0x57b7a0[_0x2e4d44(0x2de)](showCustomAlert,'No\x20Data',(Array[_0x2e4d44(0x183)](_0x16e81c)?'Trains\x20'+_0x16e81c[_0x2e4d44(0x13f)](',\x20'):'Train\x20'+_0x16e81c)+_0x2e4d44(0x2be));const _0xbd37a1=_0x320049();if(Object[_0x2e4d44(0x144)](_0xf5d2e3)[_0x2e4d44(0x148)]((_0x4231de,_0x543906)=>_0x4231de-_0x543906)['forEach'](_0x24a87e=>{const _0x3904c6=_0x2e4d44,_0x28ee51={'viCQi':function(_0x5337ea,_0x44c6eb,_0x127e54){const _0x5d101f=a13_0x3876;return _0x4842d9[_0x5d101f(0x14e)](_0x5337ea,_0x44c6eb,_0x127e54);},'SOOtq':_0x4842d9['TKtJx'],'orKSs':_0x4842d9[_0x3904c6(0x2f5)]},_0x1129e0=_0xf5d2e3[_0x24a87e];_0x24082a[_0x3904c6(0x271)]({'Train':'Train\x20'+_0x24a87e+_0x3904c6(0x107),'Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),_0x1129e0[_0x3904c6(0x114)](_0x449ab2=>{const _0x3547dd=_0x3904c6,_0x42545c=_0x449ab2[_0x3547dd(0x1d3)][_0x3547dd(0x13b)](_0x14767c=>_0x15e523(_0x14767c,_0xbd37a1)[_0x3547dd(0x11b)]);_0x449ab2[_0x3547dd(0xd7)]=_0x42545c['length']>0x0?Math[_0x3547dd(0x29d)](..._0x42545c):0x0;}),_0x1129e0[_0x3904c6(0x148)]((_0x2a2259,_0x3492e9)=>_0x3492e9[_0x3904c6(0xd7)]-_0x2a2259['sortValue']),_0x1129e0[_0x3904c6(0x114)](_0x194b79=>{const _0x25f9f2=_0x3904c6,_0x40eb1f={'ersXC':function(_0x281fc3,_0x356ac5,_0x17f626){const _0x1236af=a13_0x3876;return _0x28ee51[_0x1236af(0x239)](_0x281fc3,_0x356ac5,_0x17f626);},'aYHAB':_0x28ee51[_0x25f9f2(0x1c6)]},_0xa29a34=_0x194b79[_0x25f9f2(0x1ad)]?_0x28ee51[_0x25f9f2(0x17c)]:'No';_0x24082a[_0x25f9f2(0x271)]({'Train':'','Product\x20Code':_0x194b79[_0x25f9f2(0x2d5)],'Product\x20Name':_0x194b79[_0x25f9f2(0x246)],'Highest\x20RPN':_0x194b79[_0x25f9f2(0xd7)],'Special\x20Case\x20Product':_0xa29a34,'Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),(_0x194b79[_0x25f9f2(0x1d3)]['sort']((_0x2774a0,_0x58953d)=>_0x15e523(_0x58953d,_0xbd37a1)[_0x25f9f2(0x11b)]-_0x15e523(_0x2774a0,_0xbd37a1)[_0x25f9f2(0x11b)])[_0x25f9f2(0x114)](_0x4e8cc2=>{const _0x355258=_0x25f9f2,_0x2a152e=_0x40eb1f['ersXC'](_0x15e523,_0x4e8cc2,_0xbd37a1);_0x24082a['push']({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':_0x4e8cc2[_0x355258(0x246)],'TD\x20Score':_0x2a152e['therapeuticDoseScore'],'Solubility\x20Score':_0x2a152e[_0x355258(0x106)],'Cleanability\x20Score':_0x2a152e[_0x355258(0x28a)],'PDE\x20Score':_0x2a152e[_0x355258(0x12b)]??_0x40eb1f[_0x355258(0x143)],'LD50\x20Score':_0x2a152e['ld50Score']??_0x40eb1f[_0x355258(0x143)],'RPN':_0x2a152e[_0x355258(0x11b)],'Rating':_0x2a152e[_0x355258(0x100)]});}),_0x24082a[_0x25f9f2(0x271)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}));});}),_0x57b7a0[_0x2e4d44(0x29f)](0x0,_0x24082a['length']))return _0x57b7a0[_0x2e4d44(0xfb)](hideLoader),void _0x57b7a0[_0x2e4d44(0x170)](showCustomAlert,_0x57b7a0['yCVsL'],_0x57b7a0['BHALv']);const _0x2f86fd=XLSX[_0x2e4d44(0x1cf)]['json_to_sheet'](_0x24082a),_0x4ef1ea=XLSX[_0x2e4d44(0x1cf)][_0x2e4d44(0x1a3)]();XLSX['utils'][_0x2e4d44(0x1fb)](_0x4ef1ea,_0x2f86fd,_0x57b7a0['CrLpd']);const _0x33737b=Object[_0x2e4d44(0x144)](_0x24082a[0x0])['map'](_0x486a72=>({'wch':Math[_0x2e4d44(0x29d)](_0x486a72[_0x2e4d44(0x10f)],..._0x24082a[_0x2e4d44(0x13b)](_0x29aefb=>String(_0x29aefb[_0x486a72]||'')[_0x2e4d44(0x10f)]))+0x2}));_0x2f86fd[_0x2e4d44(0x1e7)]=_0x33737b;const _0x5a9963=new Date()[_0x2e4d44(0x11a)]()[_0x2e4d44(0x2c6)]('T')[0x0];let _0x9713a3='';_0x57b7a0[_0x2e4d44(0xec)](_0x57b7a0[_0x2e4d44(0x218)],_0x16e81c)&&(_0x9713a3=Array[_0x2e4d44(0x183)](_0x16e81c)?_0x2e4d44(0x1da)+_0x16e81c['join']('_'):_0x2e4d44(0x2cb)+_0x16e81c),XLSX['writeFile'](_0x4ef1ea,_0x2e4d44(0xdc)+_0x9713a3+'_'+_0x5a9963+'.xlsx'),_0x57b7a0[_0x2e4d44(0xfb)](hideLoader);})[_0x334c0d(0x226)](_0x3ac237=>{const _0x2e1b34=_0x334c0d;console['error'](_0x57b7a0[_0x2e1b34(0x118)],_0x3ac237),_0x57b7a0['HHXaQ'](hideLoader),showCustomAlert(_0x57b7a0[_0x2e1b34(0x204)],_0x2e1b34(0x18d));});}export function exportMachinesToExcel(){const _0x306718=a13_0x1da86d,_0x1c82a3={'Xgsrk':function(_0x856383){return _0x856383();},'QlhVu':function(_0x3237a2,_0x45f502){return _0x3237a2===_0x45f502;},'XlcfF':function(_0x21fe94,_0xbbdd9,_0x2693b8){return _0x21fe94(_0xbbdd9,_0x2693b8);},'PgFEf':_0x306718(0x17d),'QlTGL':'Machines','snyKt':_0x306718(0x1e7),'jLrRI':_0x306718(0x154),'nwDNU':_0x306718(0x129),'LRrDY':function(_0x4cf3ec){return _0x4cf3ec();},'JgCje':'Error','FVAvx':_0x306718(0x19f)};_0x1c82a3[_0x306718(0x2a8)](showLoader);try{if(_0x1c82a3[_0x306718(0x222)](0x0,a13_0x199d64[_0x306718(0x206)][_0x306718(0x10f)]))return _0x1c82a3[_0x306718(0x2a8)](hideLoader),void _0x1c82a3[_0x306718(0x2e7)](showCustomAlert,_0x1c82a3['PgFEf'],_0x306718(0x1a1));const _0x1bfad9=[],_0x395975={};a13_0x199d64[_0x306718(0x206)]['forEach'](_0x48b7af=>{const _0x5f8122=_0x306718;_0x395975[_0x48b7af[_0x5f8122(0x2b2)]]||(_0x395975[_0x48b7af[_0x5f8122(0x2b2)]]=[]),_0x395975[_0x48b7af[_0x5f8122(0x2b2)]][_0x5f8122(0x271)](_0x48b7af);}),a13_0x199d64[_0x306718(0x20c)]['forEach'](_0x4946ce=>{const _0x3e1385=_0x306718;_0x395975[_0x4946ce]&&_0x395975[_0x4946ce][_0x3e1385(0x114)](_0x178b27=>{const _0x3c8bc5=_0x3e1385,_0x1e493a=a13_0x199d64[_0x3c8bc5(0x21d)][_0x3c8bc5(0x125)](_0x332e51=>_0x332e51[_0x3c8bc5(0x14c)]&&_0x332e51[_0x3c8bc5(0x14c)][_0x3c8bc5(0xeb)](_0x178b27['id'])),_0x421cad=_0x1e493a[_0x3c8bc5(0x13b)](_0x15b7d7=>_0x15b7d7[_0x3c8bc5(0x246)])[_0x3c8bc5(0x13f)](',\x20')||_0x3c8bc5(0x1c4),_0x40d7ee=_0x1e493a[_0x3c8bc5(0x10f)];_0x1bfad9[_0x3c8bc5(0x271)]({'Machine\x20Number':_0x178b27[_0x3c8bc5(0xe2)],'Machine\x20Name':_0x178b27[_0x3c8bc5(0x246)],'Stage':_0x178b27[_0x3c8bc5(0x2b2)],'Area\x20(sq\x20cm)':_0x178b27[_0x3c8bc5(0x2bc)],'Assigned\x20Products\x20Count':_0x40d7ee,'Assigned\x20Products':_0x421cad});});});const _0x5140ab=XLSX[_0x306718(0x1cf)][_0x306718(0x1f7)](_0x1bfad9),_0x1b4566=XLSX[_0x306718(0x1cf)]['book_new']();XLSX[_0x306718(0x1cf)][_0x306718(0x1fb)](_0x1b4566,_0x5140ab,_0x1c82a3[_0x306718(0x2c5)]);const _0x4e35e5=[{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0xf},{'wch':0x14},{'wch':0x32}];_0x5140ab[_0x1c82a3[_0x306718(0x102)]]=_0x4e35e5;const _0x3d49ea=new Date()[_0x306718(0x11a)]()[_0x306718(0x2c6)]('T')[0x0];XLSX[_0x306718(0x2af)](_0x1b4566,'MACO_Machines_'+_0x3d49ea+'.xlsx'),_0x1c82a3['Xgsrk'](hideLoader),_0x1c82a3[_0x306718(0x2e7)](showCustomAlert,_0x306718(0x1c9),_0x1c82a3[_0x306718(0x238)]);}catch(_0x474cff){console['error'](_0x1c82a3['nwDNU'],_0x474cff),_0x1c82a3[_0x306718(0x2d2)](hideLoader),_0x1c82a3[_0x306718(0x2e7)](showCustomAlert,_0x1c82a3[_0x306718(0x2c0)],_0x1c82a3['FVAvx']);}}export function exportProductMacoToExcel(_0x579866=a13_0x1da86d(0x1e5)){const _0x2c5829=a13_0x1da86d,_0x93caa4={'uQBOg':function(_0x15943c,_0x352f58){return _0x15943c/_0x352f58;},'cyLGh':function(_0x4ec7e9,_0x438b7a){return _0x4ec7e9*_0x438b7a;},'hRhKd':function(_0x410eb1,_0xd03e29){return _0x410eb1!==_0xd03e29;},'LHEuK':function(_0x2a9a21,_0x57a286,_0x3d6ceb){return _0x2a9a21(_0x57a286,_0x3d6ceb);},'dFJxF':_0x2c5829(0x1e2),'XWqpv':_0x2c5829(0x1fa),'JZegY':function(_0x352c3e,_0x5e86a3){return _0x352c3e==_0x5e86a3;},'ggVxB':'number','ojljx':function(_0x1102a8,_0xa7d89d){return _0x1102a8/_0xa7d89d;},'sGwHn':_0x2c5829(0x2f4),'GFJFp':function(_0x3c890c,_0x5badb5){return _0x3c890c!==_0x5badb5;},'uXhuI':function(_0x156ce5,_0x3b07d3){return _0x156ce5==_0x3b07d3;},'qxNzM':function(_0x45c7ff,_0x4f7829){return _0x45c7ff||_0x4f7829;},'buDFm':function(_0x14fd42){return _0x14fd42();},'LpZlf':function(_0x5d3ee7,_0x33dbea){return _0x5d3ee7===_0x33dbea;},'KbOfQ':function(_0x4ad4c4){return _0x4ad4c4();},'PNCuQ':'No\x20Data','DMmXw':'There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','eweLI':_0x2c5829(0x1e5),'JmCtw':function(_0x2db342,_0x4d055d){return _0x2db342===_0x4d055d;},'msofN':_0x2c5829(0x120),'JfNHN':'!cols','xhnlP':_0x2c5829(0x2a4),'zBVlB':function(_0x3596ac,_0x421626){return _0x3596ac!==_0x421626;},'HpXIi':function(_0x4010d1,_0x57ec9e,_0x1f26bc){return _0x4010d1(_0x57ec9e,_0x1f26bc);},'wDwqL':'Success','psGqo':'Product\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','ktcLE':_0x2c5829(0x1f6),'bzRML':_0x2c5829(0x111),'DAQtS':function(_0x1c4d36){return _0x1c4d36();}};_0x93caa4[_0x2c5829(0x17b)](showLoader),import(_0x2c5829(0xe3))['then'](_0x1e836f=>{const _0x48a26b=_0x2c5829,_0x281101={'PeUzv':function(_0x4e425b,_0x478ac2){const _0x44c587=a13_0x3876;return _0x93caa4[_0x44c587(0x2d7)](_0x4e425b,_0x478ac2);}},{getTrainData:_0x2c1d99,getWorstCaseProductType:_0x2fadaa,getMacoPerSwabForTrain:_0x375df3,getLargestEssaForLineAndDosageForm:_0x2caca6}=_0x1e836f,_0x5c48d6=_0x93caa4[_0x48a26b(0x1df)](_0x2c1d99);if(_0x93caa4[_0x48a26b(0x2ce)](0x0,_0x5c48d6[_0x48a26b(0x10f)]))return _0x93caa4[_0x48a26b(0x301)](hideLoader),void _0x93caa4[_0x48a26b(0x1bc)](showCustomAlert,_0x93caa4[_0x48a26b(0x1e6)],_0x93caa4['DMmXw']);let _0x2e0478=_0x5c48d6;if(_0x93caa4['eweLI']!==_0x579866&&(_0x2e0478=Array[_0x48a26b(0x183)](_0x579866)?_0x5c48d6['filter'](_0xf50b1e=>_0x579866[_0x48a26b(0xeb)](String(_0xf50b1e['id']))):_0x5c48d6[_0x48a26b(0x125)](_0x2e65ad=>String(_0x2e65ad['id'])===String(_0x579866))),_0x93caa4['JmCtw'](0x0,_0x2e0478['length']))return hideLoader(),void _0x93caa4[_0x48a26b(0x1bc)](showCustomAlert,_0x93caa4[_0x48a26b(0x1e6)],_0x93caa4['msofN']);const _0x133a27=[];_0x2e0478[_0x48a26b(0x114)](_0x4ceb59=>{const _0x2676fe=_0x48a26b,_0x4d2c2a=_0x2fadaa(_0x4ceb59['products'][_0x2676fe(0x13b)](_0x432df2=>_0x432df2[_0x2676fe(0x294)])),_0xe2239=(a13_0x199d64[_0x2676fe(0x2b0)][_0x4d2c2a]||a13_0x199d64[_0x2676fe(0x2b0)][_0x2676fe(0xf5)])[_0x2676fe(0x29d)],_0x5c92d1=_0x93caa4[_0x2676fe(0x25f)](_0x93caa4[_0x2676fe(0x176)](_0x4ceb59[_0x2676fe(0x188)],_0x4ceb59['minBsMddRatio']),_0xe2239),_0x235268=0xa*_0x4ceb59[_0x2676fe(0x22e)];let _0x2b25e5=_0x2676fe(0x2f4);_0x93caa4['hRhKd'](null,_0x4ceb59[_0x2676fe(0x151)])&&(_0x2b25e5=_0x93caa4['cyLGh'](_0x4ceb59[_0x2676fe(0x151)],_0x4ceb59[_0x2676fe(0x25e)]));const _0xf1e4a6=_0x93caa4[_0x2676fe(0x1bc)](_0x2caca6,_0x4ceb59,_0x5c48d6),_0xede0fc=_0x93caa4[_0x2676fe(0x176)](0.004,_0xf1e4a6),_0x3b78a2=[{'name':_0x93caa4[_0x2676fe(0x25a)],'value':_0x5c92d1},{'name':_0x93caa4[_0x2676fe(0x133)],'value':_0x235268},{'name':'Health-Based\x20Limit\x20(ADE)','value':_0x93caa4[_0x2676fe(0x200)](_0x93caa4[_0x2676fe(0x279)],typeof _0x2b25e5)?_0x2b25e5:0x1/0x0},{'name':_0x2676fe(0x261),'value':_0xede0fc}]['reduce']((_0x42c528,_0xc5104d)=>_0xc5104d[_0x2676fe(0x1d0)]<_0x42c528[_0x2676fe(0x1d0)]?_0xc5104d:_0x42c528),_0x4e7841=_0x3b78a2['value'],_0x5a6b81=_0xf1e4a6>0x0?_0x93caa4['ojljx'](_0x4e7841,_0xf1e4a6):0x0,_0x5738d9=_0x93caa4[_0x2676fe(0x176)](_0x5a6b81,_0x4ceb59['assumedSsa']),_0x8da62e=_0x4ceb59['machineIds']['map'](_0x5d4803=>{const _0x160012=_0x2676fe,_0x44a412=a13_0x199d64[_0x160012(0x206)]['find'](_0x286e36=>_0x286e36['id']===_0x5d4803);return _0x281101[_0x160012(0x2d3)](_0x44a412,{'name':'Unknown\x20(ID:\x20'+_0x5d4803+')','machineNumber':_0x160012(0x2f4)});}),_0x5ec023=_0x4ceb59['machineIds'][_0x2676fe(0x13b)](_0x443ac0=>{const _0x1f863b=_0x2676fe,_0x14b6fd=a13_0x199d64[_0x1f863b(0x206)][_0x1f863b(0x189)](_0x57a15e=>_0x57a15e['id']===_0x443ac0);return _0x14b6fd?_0x14b6fd[_0x1f863b(0x246)]:'Unknown\x20(ID:\x20'+_0x443ac0+')';})[_0x2676fe(0x13f)](',\x20'),_0x6df6f9=_0x4ceb59[_0x2676fe(0x21d)][_0x2676fe(0x13b)](_0x463f29=>_0x463f29[_0x2676fe(0x2d5)]+'\x20-\x20'+_0x463f29[_0x2676fe(0x246)])[_0x2676fe(0x13f)](';\x20'),_0x1271dc=_0x4ceb59[_0x2676fe(0x1c3)]?_0x4ceb59[_0x2676fe(0x1c3)][_0x2676fe(0x290)]+'\x20('+_0x4ceb59[_0x2676fe(0x1c3)][_0x2676fe(0x199)]+_0x2676fe(0x243)+_0x4ceb59[_0x2676fe(0x1c3)]['rpn']:_0x93caa4[_0x2676fe(0x17a)];_0x133a27[_0x2676fe(0x271)]({'Train':'T'+_0x4ceb59['id'],'Total\x20Products':_0x4ceb59[_0x2676fe(0x21d)][_0x2676fe(0x10f)],'Total\x20Machines':_0x8da62e[_0x2676fe(0x10f)],'Total\x20Area\x20(ESSA)\x20cm²':_0x4ceb59[_0x2676fe(0x2ec)][_0x2676fe(0x1d7)](),'Products':_0x6df6f9,'Machines':_0x5ec023,'Worst-Case\x20Dosage\x20Form':_0x4d2c2a,'Safety\x20Factor':_0xe2239,'Lowest\x20LTD\x20(mg)':_0x4ceb59[_0x2676fe(0x188)],'Min\x20Batch\x20Size\x20(kg)':_0x4ceb59[_0x2676fe(0x22e)],'Min\x20BS/MDD\x20Ratio':_0x4ceb59[_0x2676fe(0x25e)][_0x2676fe(0xfa)](0x2),'Lowest\x20PDE\x20(mg)':_0x93caa4[_0x2676fe(0x1e4)](null,_0x4ceb59[_0x2676fe(0x151)])?_0x4ceb59[_0x2676fe(0x151)]:_0x93caa4[_0x2676fe(0x17a)],'Worst-Case\x20Product\x20(by\x20RPN)':_0x1271dc,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x5c92d1['toFixed'](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x235268[_0x2676fe(0xfa)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x93caa4[_0x2676fe(0xd1)](_0x93caa4[_0x2676fe(0x279)],typeof _0x2b25e5)?_0x2b25e5[_0x2676fe(0xfa)](0x2):_0x2676fe(0x2f4),'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0xede0fc[_0x2676fe(0xfa)](0x2),'Selected\x20MACO\x20Method':_0x3b78a2[_0x2676fe(0x246)],'Final\x20MACO\x20(mg)':_0x4e7841[_0x2676fe(0xfa)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x5a6b81['toExponential'](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x5738d9[_0x2676fe(0xfa)](0x4)});});const _0x93ea3d=XLSX[_0x48a26b(0x1cf)][_0x48a26b(0x1f7)](_0x133a27),_0x25ff0e=XLSX[_0x48a26b(0x1cf)][_0x48a26b(0x1a3)]();XLSX[_0x48a26b(0x1cf)][_0x48a26b(0x1fb)](_0x25ff0e,_0x93ea3d,_0x48a26b(0x296)),_0x93ea3d[_0x93caa4[_0x48a26b(0x265)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0x12},{'wch':0xf},{'wch':0x12},{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0x12},{'wch':0x12}];const _0xa0f571=new Date()['toISOString']()[_0x48a26b(0x2c6)]('T')[0x0];let _0x359123=_0x93caa4[_0x48a26b(0x26a)];if(_0x93caa4['zBVlB'](_0x93caa4[_0x48a26b(0x13c)],_0x579866)){if(Array[_0x48a26b(0x183)](_0x579866))_0x359123+=_0x48a26b(0x1da)+_0x579866[_0x48a26b(0x148)]((_0x38f83c,_0x449fab)=>_0x38f83c-_0x449fab)['join']('_');else _0x359123+=_0x48a26b(0x2cb)+_0x579866;}_0x359123+='_'+_0xa0f571+_0x48a26b(0x1b0),XLSX[_0x48a26b(0x2af)](_0x25ff0e,_0x359123),hideLoader(),_0x93caa4[_0x48a26b(0x126)](showCustomAlert,_0x93caa4['wDwqL'],_0x93caa4[_0x48a26b(0x1ce)]);})[_0x2c5829(0x226)](_0x56cc37=>{const _0x2fd6e2=_0x2c5829;console[_0x2fd6e2(0x2d1)](_0x2fd6e2(0x1d8),_0x56cc37),_0x93caa4['buDFm'](hideLoader),showCustomAlert(_0x93caa4[_0x2fd6e2(0x295)],_0x93caa4[_0x2fd6e2(0x2b6)]);});}function a13_0x139a(){const _0x4e8bd9=['QWTeR','Error\x20loading\x20train\x20summary\x20view:','IFZbl','JfNHN','true','hAgDt','QczIb','Show','xhnlP','contains','Wlklc','XcAbX','renderRpnChart','TdovZ','macoProducts','push','querySelectorAll','sKZNi','yWDiU','required','viewProducts','NlVsv','UiIFR','ggVxB','NAVHX','BZJoq','readAsText','detergentMaco','YwYjb','productRegister-ld50Hidden','slice','duZvs','setDetergentIngredients','UlWoG','No\x20train\x20data\x20to\x20print.\x20Please\x20ensure\x20you\x20have\x20created\x20trains\x20first.','Error\x20loading\x20scoring\x20criteria','sQkHx','zLzzN','XXLNs','Top\x2010\x20RPN','cleanabilityScore','JIInX','There\x20are\x20no\x20summary\x20data\x20to\x20export.\x20Add\x20products\x20and\x20ingredients\x20first.','Error\x20creating\x20Product\x20Register\x20sheet:','zHpaW','macoForTrains','productName','pdeMg','HNGSk','Error\x20exporting\x20to\x20Excel:','productType','ktcLE','Product\x20MACO\x20Report','./macoProductView.js','Setting\x20printSelectedTrain\x20to:','renderMacoForTrains','qfblS','NZEJV','CwzNH','max','application/json','GaRba','match','AqSgG','qYOLz','JXlmx','Product_MACO_Report','Zddfn','acjbm','qAxqz','Xgsrk','Product\x20Register','yEaWs','Worst\x20Case\x20Products','fOCFU','cleanability','stringify','writeFile','safetyFactorConfig','pde','stage','#productRegister\x20.mainTable.hide-','GurhI','finally','bzRML','jVshb','PYlLU','Train\x20Summary\x20Report','content-','mhlwg','area','msjVy','\x20not\x20found\x20or\x20has\x20no\x20products.','renderWorstCaseByTrain','JgCje','LaslP','TvitR','MtlYh','IoIkp','QlTGL','split','cDbAm','textContent','remQS','There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','_Train_','SgzYa','wewvQ','LpZlf','removeEventListener','chbai','error','LRrDY','PeUzv','rebWx','productCode','YSZVp','qxNzM','setScoringWasInEditModeForPrint','content-dm-','files','Hide','IELJZ','MQArH','yfPav','gYzVj','Printing\x20view:','bvApN','Error\x20exporting\x20Train\x20Summary\x20to\x20Excel:','Failed\x20to\x20export\x20Summary\x20report\x20data\x20to\x20Excel.','NsfGB','MyJup','Unknown\x20(ID:\x20','XlcfF','DqMIw','tjplo','IWHTc','WbNqt','essa','mddMg','aguTA','assumedSsa','stage-','ohyYX','macoChartInstance','iOPIT','N/A','REgNw','macoDetergentIngredients','PiJKy','renderTrainSummary','UGJka','toggle-','oRoJm','severity','chkgM','createElement','djbgz','aZuph','KbOfQ','\x20.ingredients-sub-table','BELKB','qmrnV','uXhuI','KIVzJ','FIHKt','Invalid\x20JSON\x20file\x20structure.','product-sf-input','lVrGh','sortValue','gVoiJ','LMuWa','Error\x20exporting\x20Summary\x20to\x20Excel:','Train\x20Summary\x20data\x20exported\x20to\x20Excel\x20successfully!','MACO_Worst_Case_Products','macoScoringCriteria','Error\x20creating\x20Top\x2010\x20RPN\x20sheet:','productRegister-','UbgGl','scoringCriteria','machineNumber','./utils.js','Show\x20PDE','zBdkE','batchSizeKg','OHIcu','XjLow','pDiWW','./trainSummaryView.js','includes','EEbUI','add','hide-pde','qpcvO','Error\x20loading\x20train\x20summary:\x20','solubility','YIuwK','uInJt','ckIBC','Other','Container\x20has\x20content:','DKSBb','kRvWk','MdWlx','toFixed','HHXaQ','Failed\x20to\x20save\x20data\x20to\x20localStorage','No\x20reason\x20provided','All\x20Products','yCRGG','rpnRatingText','gZRkd','snyKt','kZpeC','button','block','solubilityScore','\x20-\x20Worst\x20Case\x20Analysis','scoringInEditMode','gArOT','wJVHs','SPSAZ','sf-input-train','utgbT','Error\x20exporting\x20Detergent\x20MACO\x20to\x20Excel:','length','Detergent\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','Failed\x20to\x20export\x20Product\x20MACO\x20data\x20to\x20Excel.','ijosc','history','forEach','setProducts','AHQSr','Wtehe','ZidWY','scoring-system','toISOString','rpn','azGJb','WIZPz','1602086lSgGZo','productRegister-pdeHidden','No\x20trains\x20match\x20the\x20selected\x20criteria.','Detergent\x20MACO','There\x20are\x20no\x20detergent\x20ingredients\x20configured.\x20Add\x20detergent\x20ingredients\x20first.','-pdeHidden','XhRed','filter','HpXIi','xPzbH','innerHTML','Error\x20exporting\x20machines\x20to\x20Excel:','tavwW','pdeScore','CHrke','remove','UlMmM','then','message','click','Hide\x20LD50','XWqpv','aDsZy','VqOCn','Failed\x20to\x20export\x20complete\x20report\x20to\x20Excel.','uOFkc','13882824vEgnqS','There\x20is\x20no\x20data\x20in\x20the\x20current\x20view\x20to\x20export.','Save\x20Error','map','eweLI','xApXU','sJNEI','join','ld50','xGaud','Hidden','aYHAB','keys','printSelectedTrain','occurrence','worstCaseProducts','sort','loader','PnlHz','toExponential','machineIds','productRegister','UGkBJ','detergentIngredients','uviGK','lowestPde','hjYvi','RkZnI','Machines\x20data\x20exported\x20to\x20Excel\x20successfully!','#macoForTrains\x20.train-content.collapsed','thLck','xuvBW','BnToC','Product\x20MACO','\x20.train-content-inner','renderDetergentMaco','Train\x20summary\x20container\x20is\x20hidden\x20or\x20missing','toggle-dm-','hHhHk','XxXNl','FXVXs','cnqxQ','removeChild','bQrKZ','machineStage-','yCPOp','oPYsx','trainSummary','XOeQr','redo-btn','QHzyR','addEventListener','Train:','HkaaT','criticalReason','BWZPH','vSwro','button[onclick=\x22toggleColumnVisibilityDropdown()\x22]','bgZIh','sf-input-train-','classList','There\x20are\x20no\x20products\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','cyLGh','Yes','Show\x20MACO\x20Calculation\x20Breakdown','DYQpn','sGwHn','DAQtS','orKSs','No\x20Data','EigyX','DlFPw','Keeei','zQZKj','rBNMu','isArray','therapeuticDoseScore','BrqLx','maco-breakdown-details-','./macoDetergentView.js','lowestLtd','find','QrqUA','toggle','\x20\x20└─\x20','Failed\x20to\x20export\x20worst\x20case\x20data\x20to\x20Excel.','wXDIJ','bUcrM','GBwda','qdzYw','KpnNI','Fzmof','XJgoK','dVPPO','querySelector','parse','gsMJd','ingredientName','setMachineStageDisplayOrder','iWllI','Critical\x20Products','WeFnV','parentElement','Failed\x20to\x20export\x20machines\x20data\x20to\x20Excel.','\x20-\x20','There\x20are\x20no\x20machines\x20to\x20export.','JzvMV','book_new','getElementById','-ld50Hidden','dark','xGVHX','bodyWeight','LNrxa','yfcQS','Error\x20creating\x20Train\x20Summary\x20sheet:','hide-ld50','isCritical','gLfYs','80004VYrQKo','.xlsx','MACO_Summary_Report_','LiBGT','input','Detergent_MACO_Report_','QwoWD','fUCnc','none','rzwQo','Error\x20creating\x20Product\x20MACO\x20sheet:','ffZFY','Nwlwj','LHEuK','onload','CLJjw','sObsX','print','ftRVv','historyIndex','worstProductRpn','None','collapsed','SOOtq','Error\x20loading\x20products','974764PSLYdK','Success','auCNR','AmvTF','zluNL','href','psGqo','utils','value','tpvnD','display','activeIngredients','setItem','hhGnk','mqSDm','toLocaleString','Error\x20exporting\x20Product\x20MACO\x20to\x20Excel:','FaczX','_Trains_','closest','FWhFT','mViff','flex','buDFm',',\x20#','aMCcB','0.1%\x20Therapeutic\x20Dose','FIxLD','GFJFp','all','PNCuQ','!cols','cAkSK','gGLgV','aWByZ','Ulvgt','LNSGK','number','reduce','noTrainSummaryMessage','style','trim','\x20.mainTable,\x20#','HQzzM','customAlertModal','gMAkK','Error','json_to_sheet','nKLUn','setScoringCriteria','10\x20ppm\x20Criterion','book_append_sheet','customAlertTitle','body','fGhUY','.toggle-pde','JZegY','therapeuticDose','zYADv','CdAGQ','gZqNS','log','machines','disabled','caVoF','macoMachines','documentElement','GviSn','machineStageDisplayOrder','Error\x20creating\x20Detergent\x20MACO\x20sheet:','EAVqS','twrhp','TNmsW','KxdeJ','hidden','#detergentMaco\x20.train-content.collapsed','517668nWiDOO','result','Container\x20display:','wDnit','xeXdr','setMachines','toLocaleDateString','Zgmvu','Failed\x20to\x20parse\x20JSON\x20file.','products','NIBZV','Failed\x20to\x20export\x20Detergent\x20MACO\x20data\x20to\x20Excel.','hide-','XdzKx','QlhVu','startsWith','SOlKv','133HSvwMu','catch','jOOEJ','DrfKh','ld50Score','#macoForTrains\x20[id^=\x22maco-breakdown-details-\x22].hidden','Hide\x20PDE','min','JowAR','minMbsKg','Complete_MACO_Report_','TZzRB','jErfZ','eWZmR','TqNGL','nAsLo','rimRR','VmhnM','ckUNk','jLrRI','viCQi','./worstCaseView.js','setHistory','cdsAe','No\x20trains\x20message\x20display:','ozShC','Awvtg','breakdown-toggle-btn-','vwoHv','target',')\x20-\x20RPN:\x20','Error\x20loading\x20machines','LAOiD','name','Vvuim','tfPBb','detection','KaVIN','PkvDi','download','.toggle-ld50','MggEK','2495565DzsJcJ','roZYP','\x20.mainTable.hide-','getItem','ocQzW','abdJd','GzjjP','MwdSJ','726578fpykcv','FuEyh','Show\x20LD50','dFJxF','KbodP','warn','flatMap','minBsMddRatio','uQBOg','nUCRk','Visual\x20Clean\x20Limit'];a13_0x139a=function(){return _0x4e8bd9;};return a13_0x139a();}export function exportDetergentMacoToExcel(_0x5e16a8=a13_0x1da86d(0x1e5)){const _0x2efe3d=a13_0x1da86d,_0x890bc={'rebWx':function(_0x88fecb,_0x5872c7){return _0x88fecb||_0x5872c7;},'sKZNi':_0x2efe3d(0x2f4),'JXlmx':function(_0x47c884,_0x13f533){return _0x47c884(_0x13f533);},'dVPPO':function(_0x33df21,_0x178f55){return _0x33df21/_0x178f55;},'duZvs':function(_0xbae4e,_0x45092e){return _0xbae4e*_0x45092e;},'KaVIN':function(_0x1de610){return _0x1de610();},'BnToC':function(_0x4a3cf7,_0x1800f0){return _0x4a3cf7!==_0x1800f0;},'WIZPz':_0x2efe3d(0x1e5),'YIuwK':function(_0x45ae24,_0x4a48ae){return _0x45ae24===_0x4a48ae;},'EAVqS':function(_0x80576c){return _0x80576c();},'BWZPH':function(_0xa72c34,_0x211030,_0x22d168){return _0xa72c34(_0x211030,_0x22d168);},'wewvQ':'There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','ERnxt':function(_0x3162c5,_0x26b467){return _0x3162c5===_0x26b467;},'aWByZ':_0x2efe3d(0x122),'GhBFH':function(_0x57289d,_0x1e2233){return _0x57289d(_0x1e2233);},'jMiLG':_0x2efe3d(0x1a8),'LNSGK':function(_0x418d2d,_0x28c45a){return _0x418d2d>_0x28c45a;},'upwIk':function(_0x19e3b4){return _0x19e3b4();},'mViff':function(_0x5a1b18,_0x1d9796,_0x2b1a8b){return _0x5a1b18(_0x1d9796,_0x2b1a8b);},'XXLNs':_0x2efe3d(0x1c9),'lTmjj':_0x2efe3d(0x10e),'CwzNH':function(_0x53627c){return _0x53627c();},'gsMJd':function(_0x5476c8,_0x1f7c8d,_0x112c9c){return _0x5476c8(_0x1f7c8d,_0x112c9c);},'Awvtg':_0x2efe3d(0x1f6),'xPzbH':_0x2efe3d(0x21f)};showLoader(),import('./utils.js')['then'](_0x4c5c14=>{const _0x224c7c=_0x2efe3d,_0x375a86={'GurhI':function(_0x2a08b0,_0x50b6b5){const _0x121979=a13_0x3876;return _0x890bc[_0x121979(0x2d4)](_0x2a08b0,_0x50b6b5);},'JowAR':_0x890bc[_0x224c7c(0x273)],'Zgmvu':function(_0x55916f,_0x44fec9){const _0xdc8b78=_0x224c7c;return _0x890bc[_0xdc8b78(0x2a3)](_0x55916f,_0x44fec9);},'ktxUV':function(_0xe52215,_0x9c814f){const _0x1c56d0=_0x224c7c;return _0x890bc[_0x1c56d0(0x195)](_0xe52215,_0x9c814f);},'xGVHX':function(_0x29ccbb,_0x585882){return _0x29ccbb*_0x585882;},'CHrke':function(_0xda042b,_0x1afc1a){return _0xda042b>_0x1afc1a;},'nKLUn':function(_0x9a7383,_0x3a1a91){const _0x1dc4c6=_0x224c7c;return _0x890bc[_0x1dc4c6(0x281)](_0x9a7383,_0x3a1a91);}},{getTrainData:_0x489282,getWorstCaseProductType:_0x4f5dc6}=_0x4c5c14;let _0x4af5e6=_0x890bc[_0x224c7c(0x24a)](_0x489282);if(_0x890bc[_0x224c7c(0x158)](_0x890bc[_0x224c7c(0x11d)],_0x5e16a8)&&(_0x4af5e6=Array['isArray'](_0x5e16a8)?_0x4af5e6['filter'](_0x43f1d2=>_0x5e16a8[_0x224c7c(0xeb)](String(_0x43f1d2['id']))):_0x4af5e6[_0x224c7c(0x125)](_0x5f3ff4=>String(_0x5f3ff4['id'])===String(_0x5e16a8))),_0x890bc[_0x224c7c(0xf2)](0x0,_0x4af5e6[_0x224c7c(0x10f)]))return _0x890bc[_0x224c7c(0x20e)](hideLoader),void _0x890bc[_0x224c7c(0x16f)](showCustomAlert,_0x224c7c(0x17d),_0x890bc[_0x224c7c(0x2cd)]);if(_0x890bc['ERnxt'](0x0,a13_0x199d64[_0x224c7c(0x14f)][_0x224c7c(0x10f)]))return hideLoader(),void showCustomAlert(_0x224c7c(0x17d),_0x890bc[_0x224c7c(0x1ea)]);const _0x87bf=[],_0x562b2c=_0x890bc['GhBFH'](parseFloat,document[_0x224c7c(0x1a4)](_0x890bc['jMiLG'])?.[_0x224c7c(0x1d0)])||0x46,_0x36ba88=a13_0x199d64['detergentIngredients'][_0x224c7c(0x13b)](_0x3bdc7f=>parseFloat(_0x3bdc7f[_0x224c7c(0x140)]))[_0x224c7c(0x125)](_0x31b50a=>!isNaN(_0x31b50a)),_0x22dfb5=_0x890bc[_0x224c7c(0x1ec)](_0x36ba88[_0x224c7c(0x10f)],0x0)?Math['min'](..._0x36ba88):0x0,_0x50c7e2=a13_0x199d64[_0x224c7c(0x14f)][_0x224c7c(0x13b)](_0x338c4e=>_0x338c4e[_0x224c7c(0x246)])['filter'](_0x59035e=>''!==_0x59035e[_0x224c7c(0x1f1)]())[_0x224c7c(0x13f)](',\x20');_0x4af5e6['forEach'](_0x1863ee=>{const _0x487688=_0x224c7c,_0x5cb7fe={'rcczp':function(_0x427cdf,_0x36db67){const _0x30d61a=a13_0x3876;return _0x375a86[_0x30d61a(0x2b4)](_0x427cdf,_0x36db67);},'mqSDm':_0x375a86[_0x487688(0x22d)]},_0x14777d=_0x375a86[_0x487688(0x21b)](_0x4f5dc6,_0x1863ee[_0x487688(0x21d)]['map'](_0x322004=>_0x322004[_0x487688(0x294)])),_0x37ea0f=a13_0x199d64[_0x487688(0x2b0)][_0x14777d]||a13_0x199d64[_0x487688(0x2b0)]['Other'],_0x250f77=document[_0x487688(0x1a4)](_0x487688(0x173)+_0x1863ee['id']),_0x2bbdb7=_0x250f77&&_0x375a86[_0x487688(0x21b)](parseFloat,_0x250f77[_0x487688(0x1d0)])||_0x37ea0f['max'],_0x93b352=_0x375a86['ktxUV'](_0x375a86[_0x487688(0x1a7)](0.0005,_0x22dfb5)*_0x562b2c,_0x2bbdb7),_0xc196ba=_0x375a86[_0x487688(0x1a7)](_0x93b352,_0x1863ee['minBsMddRatio']),_0x14f575=_0x4c5c14['getLargestEssaForLineAndDosageForm'](_0x1863ee,_0x4af5e6),_0x1fda52=_0x375a86[_0x487688(0x12c)](_0x14f575,0x0)?_0xc196ba/_0x14f575:0x0,_0x21b9fa=_0x375a86[_0x487688(0x1f8)](_0x1fda52,_0x1863ee[_0x487688(0x2ef)]),_0x2d7604=_0x1863ee[_0x487688(0x14c)][_0x487688(0x13b)](_0x5caee7=>{const _0x3e235a=_0x487688,_0x4756eb=a13_0x199d64[_0x3e235a(0x206)]['find'](_0x27e169=>_0x27e169['id']===_0x5caee7);return _0x5cb7fe['rcczp'](_0x4756eb,{'name':_0x3e235a(0x2e6)+_0x5caee7+')','machineNumber':_0x5cb7fe[_0x3e235a(0x1d6)]});}),_0x253670=_0x1863ee[_0x487688(0x14c)]['map'](_0x5590ed=>{const _0x50f81b=_0x487688,_0x3d801e=a13_0x199d64['machines'][_0x50f81b(0x189)](_0x78a4b3=>_0x78a4b3['id']===_0x5590ed);return _0x3d801e?_0x3d801e['name']:_0x50f81b(0x2e6)+_0x5590ed+')';})[_0x487688(0x13f)](',\x20'),_0x30b4a7=_0x1863ee[_0x487688(0x21d)][_0x487688(0x13b)](_0x551289=>_0x551289[_0x487688(0x2d5)]+_0x487688(0x1a0)+_0x551289['name'])[_0x487688(0x13f)](';\x20'),_0x1f4171=_0x1863ee[_0x487688(0x1c3)]?_0x1863ee[_0x487688(0x1c3)][_0x487688(0x290)]+'\x20('+_0x1863ee['worstProductRpn'][_0x487688(0x199)]+_0x487688(0x243)+_0x1863ee[_0x487688(0x1c3)]['rpn']:_0x375a86[_0x487688(0x22d)];_0x87bf['push']({'Train':'T'+_0x1863ee['id'],'Total\x20Products':_0x1863ee[_0x487688(0x21d)][_0x487688(0x10f)],'Total\x20Machines':_0x2d7604[_0x487688(0x10f)],'Total\x20Area\x20(ESSA)\x20cm²':_0x1863ee['essa'][_0x487688(0x1d7)](),'Products':_0x30b4a7,'Machines':_0x253670,'Worst-Case\x20Dosage\x20Form':_0x14777d,'Safety\x20Factor\x20Range':_0x37ea0f['min']+'\x20-\x20'+_0x37ea0f[_0x487688(0x29d)],'Applied\x20Safety\x20Factor':_0x2bbdb7,'Detergent\x20Ingredients':_0x50c7e2,'Body\x20Weight\x20(kg)':_0x562b2c,'Minimum\x20LD50\x20(mg/kg)':_0x22dfb5,'Min\x20Batch\x20Size\x20(kg)':_0x1863ee['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x1863ee[_0x487688(0x25e)][_0x487688(0xfa)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x1f4171,'ADI\x20(mg)':_0x93b352['toFixed'](0x4),'MACO\x20(mg)':_0xc196ba['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x1fda52[_0x487688(0x14b)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x21b9fa['toFixed'](0x4)});});const _0x5e9e6a=XLSX[_0x224c7c(0x1cf)][_0x224c7c(0x1f7)](_0x87bf),_0x2056ec=XLSX[_0x224c7c(0x1cf)][_0x224c7c(0x1a3)]();XLSX['utils'][_0x224c7c(0x1fb)](_0x2056ec,_0x5e9e6a,'Detergent\x20MACO\x20Report'),_0x5e9e6a[_0x224c7c(0x1e7)]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0x1e},{'wch':0xc},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0xc},{'wch':0xc},{'wch':0x12},{'wch':0x12}];const _0x413354=new Date()[_0x224c7c(0x11a)]()[_0x224c7c(0x2c6)]('T')[0x0];XLSX[_0x224c7c(0x2af)](_0x2056ec,_0x224c7c(0x1b4)+_0x413354+_0x224c7c(0x1b0)),_0x890bc['upwIk'](hideLoader),_0x890bc[_0x224c7c(0x1dd)](showCustomAlert,_0x890bc[_0x224c7c(0x288)],_0x224c7c(0x110));})[_0x2efe3d(0x226)](_0x1c55ea=>{const _0x217e26=_0x2efe3d;console[_0x217e26(0x2d1)](_0x890bc['lTmjj'],_0x1c55ea),_0x890bc[_0x217e26(0x29c)](hideLoader),_0x890bc[_0x217e26(0x198)](showCustomAlert,_0x890bc[_0x217e26(0x23f)],_0x890bc[_0x217e26(0x127)]);});}export function exportTrainSummaryToExcel(_0x44741f='all'){const _0x3f0c8f=a13_0x1da86d,_0x2c4fea={'thLck':_0x3f0c8f(0x2f4),'EBhvM':function(_0x3407c2,_0x1fb0fe){return _0x3407c2||_0x1fb0fe;},'VmhnM':function(_0x8dde48){return _0x8dde48();},'UiIFR':function(_0x65360e,_0x146b95,_0x3b71fc){return _0x65360e(_0x146b95,_0x3b71fc);},'oRoJm':_0x3f0c8f(0x17d),'rimRR':function(_0x434cca,_0x101d08){return _0x434cca!==_0x101d08;},'PYlLU':_0x3f0c8f(0x1e5),'Fzmof':function(_0x29b815){return _0x29b815();},'aguTA':_0x3f0c8f(0x120),'cAkSK':_0x3f0c8f(0x2b9),'RkZnI':_0x3f0c8f(0x1e7),'nUCRk':_0x3f0c8f(0xdb),'SOlKv':_0x3f0c8f(0x2e2),'qmrnV':function(_0xfb504a,_0x39eb62,_0x247f84){return _0xfb504a(_0x39eb62,_0x247f84);},'FXVXs':_0x3f0c8f(0x1f6),'xGaud':'Failed\x20to\x20export\x20Train\x20Summary\x20data\x20to\x20Excel.'};_0x2c4fea['VmhnM'](showLoader),import(_0x3f0c8f(0xe3))[_0x3f0c8f(0x12f)](_0x372923=>{const _0x1f597b=_0x3f0c8f,_0x3b1f7a={'DKSBb':function(_0x3c8d56,_0x12a0cb){return _0x2c4fea['EBhvM'](_0x3c8d56,_0x12a0cb);},'FIxLD':_0x2c4fea[_0x1f597b(0x156)]},{getTrainData:_0x1114ef}=_0x372923,_0x1aac77=_0x2c4fea[_0x1f597b(0x236)](_0x1114ef);if(0x0===_0x1aac77[_0x1f597b(0x10f)])return hideLoader(),void _0x2c4fea['UiIFR'](showCustomAlert,_0x2c4fea[_0x1f597b(0x2fb)],_0x1f597b(0x2ca));let _0x3e3050=_0x1aac77;if(_0x2c4fea[_0x1f597b(0x235)](_0x2c4fea[_0x1f597b(0x2b8)],_0x44741f)&&(_0x3e3050=Array[_0x1f597b(0x183)](_0x44741f)?_0x1aac77[_0x1f597b(0x125)](_0x4f9253=>_0x44741f[_0x1f597b(0xeb)](String(_0x4f9253['id']))):_0x1aac77[_0x1f597b(0x125)](_0x1e55b9=>String(_0x1e55b9['id'])===String(_0x44741f))),0x0===_0x3e3050['length'])return _0x2c4fea[_0x1f597b(0x193)](hideLoader),void _0x2c4fea[_0x1f597b(0x278)](showCustomAlert,_0x2c4fea[_0x1f597b(0x2fb)],_0x2c4fea[_0x1f597b(0x2ee)]);const _0x11c3dc=[];_0x3e3050[_0x1f597b(0x114)](_0x60922f=>{const _0x954f81=_0x1f597b,_0x3c5152=_0x60922f[_0x954f81(0x14c)][_0x954f81(0x13b)](_0x1eb10b=>{const _0x33477a=_0x954f81,_0x7aed91=a13_0x199d64[_0x33477a(0x206)]['find'](_0x2bf9de=>_0x2bf9de['id']===_0x1eb10b);return _0x3b1f7a[_0x33477a(0xf7)](_0x7aed91,{'id':_0x1eb10b,'name':_0x33477a(0x2e6)+_0x1eb10b+')','machineNumber':_0x3b1f7a[_0x33477a(0x1e3)]});}),_0x1d65e7=_0x60922f[_0x954f81(0x14c)][_0x954f81(0x13b)](_0x3dde49=>{const _0x301e69=_0x954f81,_0x10acd3=a13_0x199d64[_0x301e69(0x206)][_0x301e69(0x189)](_0x56c696=>_0x56c696['id']===_0x3dde49);return _0x10acd3?_0x10acd3['name']:_0x301e69(0x2e6)+_0x3dde49+')';})[_0x954f81(0x13f)](',\x20'),_0x9a271f=_0x60922f[_0x954f81(0x21d)]['map'](_0x51c26a=>_0x51c26a['productCode']+_0x954f81(0x1a0)+_0x51c26a[_0x954f81(0x246)])['join'](';\x20'),_0x17e9c5=_0x60922f['products'][_0x954f81(0x13b)](_0x1ef0cc=>_0x1ef0cc[_0x954f81(0x2d5)]+':\x20'+_0x1ef0cc[_0x954f81(0x246)])[_0x954f81(0x13f)]('\x0a'),_0x4e092d=_0x3c5152[_0x954f81(0x13b)](_0x444e88=>_0x444e88[_0x954f81(0xe2)]+':\x20'+_0x444e88[_0x954f81(0x246)])[_0x954f81(0x13f)]('\x0a');_0x11c3dc[_0x954f81(0x271)]({'Train\x20ID':'T'+_0x60922f['id'],'Products\x20Count':_0x60922f[_0x954f81(0x21d)][_0x954f81(0x10f)],'Machines\x20Count':_0x3c5152[_0x954f81(0x10f)],'Total\x20Area\x20(ESSA)\x20cm²':_0x60922f[_0x954f81(0x2ec)]['toLocaleString'](),'Products\x20(Code\x20-\x20Name)':_0x9a271f,'Machines\x20(Number\x20-\x20Name)':_0x1d65e7,'Products\x20Detailed':_0x17e9c5,'Machines\x20Detailed':_0x4e092d,'Min\x20Batch\x20Size\x20(kg)':_0x60922f[_0x954f81(0x22e)],'Min\x20BS/MDD\x20Ratio':_0x60922f[_0x954f81(0x25e)][_0x954f81(0xfa)](0x2),'Assumed\x20SSA\x20(cm²)':_0x60922f[_0x954f81(0x2ef)],'Lowest\x20LTD\x20(mg)':_0x60922f[_0x954f81(0x188)],'Lowest\x20PDE\x20(mg)':null!==_0x60922f['lowestPde']?_0x60922f['lowestPde']:'N/A','Worst\x20RPN\x20Product':_0x60922f[_0x954f81(0x1c3)]?_0x60922f[_0x954f81(0x1c3)][_0x954f81(0x290)]+'\x20('+_0x60922f[_0x954f81(0x1c3)][_0x954f81(0x199)]+_0x954f81(0x243)+_0x60922f[_0x954f81(0x1c3)]['rpn']:_0x2c4fea[_0x954f81(0x156)]});});const _0x4490f8=XLSX[_0x1f597b(0x1cf)][_0x1f597b(0x1f7)](_0x11c3dc),_0x4f1d30=XLSX[_0x1f597b(0x1cf)][_0x1f597b(0x1a3)]();XLSX[_0x1f597b(0x1cf)][_0x1f597b(0x1fb)](_0x4f1d30,_0x4490f8,_0x2c4fea[_0x1f597b(0x1e8)]),_0x4490f8[_0x2c4fea[_0x1f597b(0x153)]]=[{'wch':0xa},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x3c},{'wch':0x3c},{'wch':0x28},{'wch':0x28},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32}];const _0x2c68df=new Date()[_0x1f597b(0x11a)]()[_0x1f597b(0x2c6)]('T')[0x0];let _0x27c635='Train_Summary_Report';if(_0x2c4fea['rimRR'](_0x1f597b(0x1e5),_0x44741f)){if(Array['isArray'](_0x44741f))_0x27c635+=_0x1f597b(0x1da)+_0x44741f['sort']((_0x8c6f9f,_0x3d52a6)=>_0x8c6f9f-_0x3d52a6)[_0x1f597b(0x13f)]('_');else _0x27c635+=_0x1f597b(0x2cb)+_0x44741f;}_0x27c635+='_'+_0x2c68df+_0x1f597b(0x1b0),XLSX[_0x1f597b(0x2af)](_0x4f1d30,_0x27c635),_0x2c4fea[_0x1f597b(0x193)](hideLoader),showCustomAlert(_0x1f597b(0x1c9),_0x2c4fea[_0x1f597b(0x260)]);})[_0x3f0c8f(0x226)](_0x363383=>{const _0x210fb7=_0x3f0c8f;console[_0x210fb7(0x2d1)](_0x2c4fea[_0x210fb7(0x224)],_0x363383),_0x2c4fea[_0x210fb7(0x236)](hideLoader),_0x2c4fea[_0x210fb7(0xd0)](showCustomAlert,_0x2c4fea[_0x210fb7(0x160)],_0x2c4fea[_0x210fb7(0x141)]);});}export function exportSummaryToExcel(){const _0x360a6d=a13_0x1da86d,_0x536cc3={'acjbm':function(_0x6a5c03,_0x5cc9af){return _0x6a5c03(_0x5cc9af);},'SgzYa':function(_0x5de101,_0x17b91c){return _0x5de101>_0x17b91c;},'hjYvi':function(_0x4d5217,_0x181bc5){return _0x4d5217!==_0x181bc5;},'ffZFY':_0x360a6d(0x2f4),'caVoF':_0x360a6d(0x177),'FFclj':function(_0x267a3a,_0x1056b2){return _0x267a3a===_0x1056b2;},'nGJAl':function(_0x4d9a9f,_0x198ee0){return _0x4d9a9f===_0x198ee0;},'Ulvgt':function(_0x77d938){return _0x77d938();},'PkvDi':function(_0x3164db,_0x376a2c,_0x1f5f21){return _0x3164db(_0x376a2c,_0x1f5f21);},'poEYE':_0x360a6d(0x17d),'bgZIh':'!cols','cDbAm':_0x360a6d(0x289),'abdJd':function(_0xead884,_0x1e1a31){return _0xead884>_0x1e1a31;},'ckUNk':_0x360a6d(0x19c),'lVrGh':_0x360a6d(0xfe),'MQArH':function(_0x45b831,_0x2aff8c,_0xea96b6){return _0x45b831(_0x2aff8c,_0xea96b6);},'yEaWs':function(_0x127c31){return _0x127c31();},'TqNGL':_0x360a6d(0xe3)};_0x536cc3[_0x360a6d(0x2aa)](showLoader),import(_0x536cc3[_0x360a6d(0x233)])[_0x360a6d(0x12f)](_0x1deca8=>{const _0x19f6b2=_0x360a6d,_0x1dd76a={'KbodP':function(_0x3bab3a,_0x26794){return _0x3bab3a(_0x26794);},'OxFVR':function(_0xac3597,_0x57860f){const _0x1d26e5=a13_0x3876;return _0x536cc3[_0x1d26e5(0x2cc)](_0xac3597,_0x57860f);},'yWDiU':function(_0x4c610d,_0x542742){const _0x3acb0f=a13_0x3876;return _0x536cc3[_0x3acb0f(0x152)](_0x4c610d,_0x542742);},'TdovZ':_0x536cc3[_0x19f6b2(0x1ba)],'MwdSJ':_0x536cc3[_0x19f6b2(0x208)]},{getProductTrainId:_0x5cf1b7,calculateScores:_0x591f98}=_0x1deca8,_0x212ce4=a13_0x199d64[_0x19f6b2(0x21d)]['flatMap'](_0x3a104d=>{const _0x4ffafe=_0x19f6b2,_0x5ea11a=_0x536cc3[_0x4ffafe(0x2a6)](_0x5cf1b7,_0x3a104d);return _0x3a104d[_0x4ffafe(0x1d3)][_0x4ffafe(0x13b)](_0x3a03e3=>({'productName':_0x3a104d[_0x4ffafe(0x246)],'productCode':_0x3a104d['productCode'],'ingredientName':_0x3a03e3[_0x4ffafe(0x246)],'rpn':_0x591f98(_0x3a03e3)[_0x4ffafe(0x11b)],'trainId':'N/A'!==_0x5ea11a?'T'+_0x5ea11a:'N/A','scores':_0x591f98(_0x3a03e3)}));})[_0x19f6b2(0x148)]((_0x2d6362,_0x44562a)=>_0x44562a[_0x19f6b2(0x11b)]-_0x2d6362[_0x19f6b2(0x11b)])[_0x19f6b2(0x280)](0x0,0xa),_0x11e00f=a13_0x199d64[_0x19f6b2(0x21d)][_0x19f6b2(0x125)](_0x54b0ca=>_0x54b0ca[_0x19f6b2(0x1ad)]);if(_0x536cc3['FFclj'](0x0,_0x212ce4[_0x19f6b2(0x10f)])&&_0x536cc3['nGJAl'](0x0,_0x11e00f[_0x19f6b2(0x10f)]))return _0x536cc3[_0x19f6b2(0x1eb)](hideLoader),void _0x536cc3[_0x19f6b2(0x24b)](showCustomAlert,_0x536cc3['poEYE'],_0x19f6b2(0x28c));const _0x54f2c5=XLSX[_0x19f6b2(0x1cf)]['book_new']();if(_0x212ce4[_0x19f6b2(0x10f)]>0x0){const _0x19cb8a=_0x212ce4[_0x19f6b2(0x13b)]((_0x1b736a,_0x1f023e)=>({'Rank':_0x1f023e+0x1,'Product\x20Code':_0x1b736a['productCode'],'Product\x20Name':_0x1b736a['productName'],'Train':_0x1b736a['trainId'],'Ingredient':_0x1b736a[_0x19f6b2(0x199)],'RPN':_0x1b736a[_0x19f6b2(0x11b)]})),_0xcb52da=XLSX[_0x19f6b2(0x1cf)][_0x19f6b2(0x1f7)](_0x19cb8a),_0x3b6888=[{'wch':0x8},{'wch':0xf},{'wch':0x1e},{'wch':0xa},{'wch':0x19},{'wch':0x8}];_0xcb52da[_0x536cc3[_0x19f6b2(0x172)]]=_0x3b6888,XLSX[_0x19f6b2(0x1cf)][_0x19f6b2(0x1fb)](_0x54f2c5,_0xcb52da,_0x536cc3[_0x19f6b2(0x2c7)]);}if(_0x536cc3[_0x19f6b2(0x254)](_0x11e00f[_0x19f6b2(0x10f)],0x0)){const _0xf14b20=_0x11e00f[_0x19f6b2(0x13b)](_0x221d63=>({'Product\x20Code':_0x221d63[_0x19f6b2(0x2d5)],'Product\x20Name':_0x221d63[_0x19f6b2(0x246)],'Product\x20Type':_0x221d63['productType'],'Batch\x20Size\x20(kg)':_0x221d63[_0x19f6b2(0xe6)],'MDD\x20(mg)':_0x221d63[_0x19f6b2(0x2ed)],'Critical\x20Reason':_0x221d63[_0x19f6b2(0x16e)]||_0x19f6b2(0xfd),'Train':_0x19f6b2(0x2f4)!==_0x5cf1b7(_0x221d63)?'T'+_0x5cf1b7(_0x221d63):_0x19f6b2(0x2f4)})),_0x1b5819=XLSX['utils'][_0x19f6b2(0x1f7)](_0xf14b20),_0x4c868c=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32},{'wch':0xa}];_0x1b5819[_0x536cc3[_0x19f6b2(0x172)]]=_0x4c868c,XLSX[_0x19f6b2(0x1cf)][_0x19f6b2(0x1fb)](_0x54f2c5,_0x1b5819,_0x536cc3[_0x19f6b2(0x237)]);}const _0x43a52a=a13_0x199d64[_0x19f6b2(0x21d)][_0x19f6b2(0x13b)](_0x3787ad=>{const _0xadae3a=_0x19f6b2,_0x1ec78b={'LAOiD':function(_0x30e836,_0x4d34f4){return _0x1dd76a['KbodP'](_0x30e836,_0x4d34f4);},'JzvMV':function(_0x5d494b,_0x3a10f6){return _0x1dd76a['OxFVR'](_0x5d494b,_0x3a10f6);}},_0x7188d8=_0x1dd76a[_0xadae3a(0x25b)](_0x5cf1b7,_0x3787ad),_0xc05de5=_0x3787ad[_0xadae3a(0x1d3)]['reduce']((_0x2abd7d,_0x3fcb64)=>{const _0x7d36d3=_0xadae3a,_0x6e2ff0=_0x1ec78b[_0x7d36d3(0x245)](_0x591f98,_0x3fcb64)[_0x7d36d3(0x11b)];return _0x1ec78b[_0x7d36d3(0x1a2)](_0x6e2ff0,_0x2abd7d['rpn'])?{..._0x3fcb64,'rpn':_0x6e2ff0}:_0x2abd7d;},{'rpn':0x0,'name':_0xadae3a(0x2f4)});return{'Product\x20Code':_0x3787ad['productCode'],'Product\x20Name':_0x3787ad[_0xadae3a(0x246)],'Product\x20Type':_0x3787ad['productType'],'Batch\x20Size\x20(kg)':_0x3787ad[_0xadae3a(0xe6)],'MDD\x20(mg)':_0x3787ad['mddMg'],'Train':_0x1dd76a[_0xadae3a(0x274)](_0x1dd76a[_0xadae3a(0x26f)],_0x7188d8)?'T'+_0x7188d8:_0x1dd76a[_0xadae3a(0x26f)],'Is\x20Critical':_0x3787ad['isCritical']?_0x1dd76a[_0xadae3a(0x256)]:'No','Critical\x20Reason':_0x3787ad[_0xadae3a(0x16e)]||_0x1dd76a[_0xadae3a(0x26f)],'Ingredients\x20Count':_0x3787ad[_0xadae3a(0x1d3)][_0xadae3a(0x10f)],'Highest\x20RPN\x20Ingredient':_0xc05de5['name'],'Highest\x20RPN\x20Value':_0xc05de5['rpn']||0x0};}),_0x5c9772=XLSX[_0x19f6b2(0x1cf)][_0x19f6b2(0x1f7)](_0x43a52a);_0x5c9772[_0x536cc3[_0x19f6b2(0x172)]]=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xa},{'wch':0xa},{'wch':0x28},{'wch':0xc},{'wch':0x19},{'wch':0xc}],XLSX['utils'][_0x19f6b2(0x1fb)](_0x54f2c5,_0x5c9772,_0x536cc3[_0x19f6b2(0xd6)]);const _0x435eee=new Date()['toISOString']()['split']('T')[0x0];XLSX[_0x19f6b2(0x2af)](_0x54f2c5,_0x19f6b2(0x1b1)+_0x435eee+'.xlsx'),_0x536cc3[_0x19f6b2(0x1eb)](hideLoader),_0x536cc3[_0x19f6b2(0x24b)](showCustomAlert,_0x19f6b2(0x1c9),'Summary\x20report\x20data\x20exported\x20to\x20Excel\x20successfully!');})['catch'](_0x58f375=>{const _0x3fa698=_0x360a6d;console[_0x3fa698(0x2d1)](_0x3fa698(0xda),_0x58f375),hideLoader(),_0x536cc3[_0x3fa698(0x2dd)](showCustomAlert,_0x3fa698(0x1f6),_0x3fa698(0x2e3));});}export function exportAllTabsToExcel(){const _0x5aed9a=a13_0x1da86d,_0x181600={'HPnEK':function(_0x48ddeb,_0x5b8bd5){return _0x48ddeb||_0x5b8bd5;},'wXDIJ':function(_0x47ce87,_0x382056){return _0x47ce87(_0x382056);},'WeFnV':function(_0x4dfbbe,_0x596120){return _0x4dfbbe/_0x596120;},'KpnNI':function(_0x40e277,_0x33e390){return _0x40e277*_0x33e390;},'QrqUA':_0x5aed9a(0x2f4),'oPYsx':_0x5aed9a(0x1e2),'gZRkd':'10\x20ppm\x20Criterion','pzWaa':'Health-Based\x20Limit\x20(ADE)','FuEyh':function(_0x350cc4,_0x2256af){return _0x350cc4==_0x2256af;},'gGLgV':_0x5aed9a(0x1ed),'UbgGl':function(_0x1a317b,_0xa83a60){return _0x1a317b>_0xa83a60;},'FaczX':function(_0x38334a,_0x18969f){return _0x38334a!==_0x18969f;},'GviSn':function(_0x58fab3,_0x174cf5){return _0x58fab3==_0x174cf5;},'LiBGT':function(_0x5ec6d2,_0x571f48){return _0x5ec6d2(_0x571f48);},'qpcvO':function(_0x28a810,_0x39ae09){return _0x28a810/_0x39ae09;},'iWllI':function(_0x1a3b1c,_0x5241e4,_0x286cb9){return _0x1a3b1c(_0x5241e4,_0x286cb9);},'AmvTF':'Yes','PnlHz':function(_0x608a1f,_0x27584d){return _0x608a1f===_0x27584d;},'IELJZ':function(_0x5b07e1){return _0x5b07e1();},'yCRGG':_0x5aed9a(0x17d),'DqMIw':_0x5aed9a(0x2ca),'Nwlwj':_0x5aed9a(0x159),'zHpaW':_0x5aed9a(0x1a8),'eqeLy':_0x5aed9a(0x121),'chtOu':_0x5aed9a(0x1ab),'XxXNl':_0x5aed9a(0xde),'ftRVv':_0x5aed9a(0x19c),'NAVHX':'Error\x20creating\x20All\x20Products\x20sheet:','qaRpr':_0x5aed9a(0x1c9),'MggEK':'Complete\x20report\x20with\x20all\x20tabs\x20exported\x20to\x20Excel\x20successfully!','sQkHx':'Error','Wtehe':_0x5aed9a(0x136),'ckIBC':function(_0x340273){return _0x340273();},'rzwQo':_0x5aed9a(0xe3)};_0x181600[_0x5aed9a(0xf4)](showLoader),import(_0x181600[_0x5aed9a(0x1b8)])[_0x5aed9a(0x12f)](_0x26294a=>{const _0x1d660e=_0x5aed9a,_0x1f58b8={'tpvnD':function(_0x467ff4,_0xde2dd4){return _0x181600['HPnEK'](_0x467ff4,_0xde2dd4);},'uInJt':function(_0x1cd41c,_0xe63216){const _0x1fb136=a13_0x3876;return _0x181600[_0x1fb136(0x1d9)](_0x1cd41c,_0xe63216);},'qdzYw':_0x1d660e(0x2f4),'SdHBc':function(_0x145bc8,_0x40b6ac){const _0x263cdb=_0x1d660e;return _0x181600[_0x263cdb(0x1b2)](_0x145bc8,_0x40b6ac);},'RmnUO':function(_0x3a47b9,_0x567a32){const _0x3a031d=_0x1d660e;return _0x181600[_0x3a031d(0x18e)](_0x3a47b9,_0x567a32);},'fGhUY':_0x181600[_0x1d660e(0x1cb)],'eWZmR':'INGREDIENT','ahTuC':'PRODUCT'},{getTrainData:_0x1b4f4f,getWorstCaseProductType:_0x469adc,getProductTrainId:_0x24cca8,calculateScores:_0x29e113}=_0x26294a,_0xdf2d90=_0x1b4f4f();if(_0x181600[_0x1d660e(0x14a)](0x0,_0xdf2d90[_0x1d660e(0x10f)]))return _0x181600[_0x1d660e(0x2dc)](hideLoader),void _0x181600[_0x1d660e(0x19b)](showCustomAlert,_0x181600[_0x1d660e(0xff)],_0x181600[_0x1d660e(0x2e8)]);const _0x548652=XLSX[_0x1d660e(0x1cf)][_0x1d660e(0x1a3)]();try{const _0x52b5b2=[];_0xdf2d90['forEach'](_0x2ce6ae=>{const _0x2f32c0=_0x1d660e,_0x5d8d56={'hAgDt':function(_0x1fe4f6,_0x5dea46){return _0x181600['HPnEK'](_0x1fe4f6,_0x5dea46);}},_0x3542e0=_0x181600['wXDIJ'](_0x469adc,_0x2ce6ae[_0x2f32c0(0x21d)][_0x2f32c0(0x13b)](_0x33545b=>_0x33545b['productType'])),_0x11d066=(a13_0x199d64[_0x2f32c0(0x2b0)][_0x3542e0]||a13_0x199d64[_0x2f32c0(0x2b0)][_0x2f32c0(0xf5)])['max'],_0x35a668=_0x181600[_0x2f32c0(0x19d)](_0x2ce6ae[_0x2f32c0(0x188)]*_0x2ce6ae[_0x2f32c0(0x25e)],_0x11d066),_0x255302=_0x181600[_0x2f32c0(0x192)](0xa,_0x2ce6ae[_0x2f32c0(0x22e)]);let _0x27353a=_0x181600[_0x2f32c0(0x18a)];null!==_0x2ce6ae['lowestPde']&&(_0x27353a=_0x181600[_0x2f32c0(0x192)](_0x2ce6ae[_0x2f32c0(0x151)],_0x2ce6ae[_0x2f32c0(0x25e)]));const _0xb4d870=getLargestEssaForLineAndDosageForm(_0x2ce6ae,_0xdf2d90),_0x542560=_0x181600[_0x2f32c0(0x192)](0.004,_0xb4d870),_0x1d8b7a=[{'name':_0x181600[_0x2f32c0(0x166)],'value':_0x35a668},{'name':_0x181600[_0x2f32c0(0x101)],'value':_0x255302},{'name':_0x181600['pzWaa'],'value':_0x181600[_0x2f32c0(0x258)](_0x181600['gGLgV'],typeof _0x27353a)?_0x27353a:0x1/0x0},{'name':_0x2f32c0(0x261),'value':_0x542560}]['reduce']((_0x28d0be,_0x170b9a)=>_0x170b9a[_0x2f32c0(0x1d0)]<_0x28d0be[_0x2f32c0(0x1d0)]?_0x170b9a:_0x28d0be),_0x4276da=_0x1d8b7a[_0x2f32c0(0x1d0)],_0x5f23ad=_0x181600[_0x2f32c0(0xe0)](_0xb4d870,0x0)?_0x181600[_0x2f32c0(0x19d)](_0x4276da,_0xb4d870):0x0,_0x3e28c4=_0x5f23ad*_0x2ce6ae[_0x2f32c0(0x2ef)],_0x476dc4=_0x2ce6ae[_0x2f32c0(0x14c)][_0x2f32c0(0x13b)](_0x1a2747=>{const _0x5108f2=_0x2f32c0,_0x4e4e16=a13_0x199d64[_0x5108f2(0x206)]['find'](_0x1195c6=>_0x1195c6['id']===_0x1a2747);return _0x5d8d56[_0x5108f2(0x267)](_0x4e4e16,{'name':_0x5108f2(0x2e6)+_0x1a2747+')','machineNumber':_0x5108f2(0x2f4)});}),_0x3393a1=_0x2ce6ae[_0x2f32c0(0x14c)]['map'](_0x2a0c3f=>{const _0x3d1b36=_0x2f32c0,_0x29f97f=a13_0x199d64['machines'][_0x3d1b36(0x189)](_0x13d0b2=>_0x13d0b2['id']===_0x2a0c3f);return _0x29f97f?_0x29f97f[_0x3d1b36(0x246)]:_0x3d1b36(0x2e6)+_0x2a0c3f+')';})[_0x2f32c0(0x13f)](',\x20'),_0x505974=_0x2ce6ae[_0x2f32c0(0x21d)][_0x2f32c0(0x13b)](_0x5c2501=>_0x5c2501[_0x2f32c0(0x2d5)]+_0x2f32c0(0x1a0)+_0x5c2501[_0x2f32c0(0x246)])[_0x2f32c0(0x13f)](';\x20'),_0x3d63ee=_0x2ce6ae[_0x2f32c0(0x1c3)]?_0x2ce6ae['worstProductRpn']['productName']+'\x20('+_0x2ce6ae[_0x2f32c0(0x1c3)][_0x2f32c0(0x199)]+_0x2f32c0(0x243)+_0x2ce6ae['worstProductRpn'][_0x2f32c0(0x11b)]:_0x2f32c0(0x2f4);_0x52b5b2[_0x2f32c0(0x271)]({'Train':'T'+_0x2ce6ae['id'],'Total\x20Products':_0x2ce6ae['products'][_0x2f32c0(0x10f)],'Total\x20Machines':_0x476dc4['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x2ce6ae[_0x2f32c0(0x2ec)][_0x2f32c0(0x1d7)](),'Products':_0x505974,'Machines':_0x3393a1,'Worst-Case\x20Dosage\x20Form':_0x3542e0,'Safety\x20Factor':_0x11d066,'Lowest\x20LTD\x20(mg)':_0x2ce6ae[_0x2f32c0(0x188)],'Min\x20Batch\x20Size\x20(kg)':_0x2ce6ae[_0x2f32c0(0x22e)],'Min\x20BS/MDD\x20Ratio':_0x2ce6ae[_0x2f32c0(0x25e)][_0x2f32c0(0xfa)](0x2),'Lowest\x20PDE\x20(mg)':_0x181600[_0x2f32c0(0x1d9)](null,_0x2ce6ae[_0x2f32c0(0x151)])?_0x2ce6ae[_0x2f32c0(0x151)]:_0x181600[_0x2f32c0(0x18a)],'Worst-Case\x20Product\x20(by\x20RPN)':_0x3d63ee,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x35a668[_0x2f32c0(0xfa)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x255302['toFixed'](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x181600[_0x2f32c0(0x20b)](_0x181600[_0x2f32c0(0x1e9)],typeof _0x27353a)?_0x27353a[_0x2f32c0(0xfa)](0x2):_0x181600[_0x2f32c0(0x18a)],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x542560[_0x2f32c0(0xfa)](0x2),'Selected\x20MACO\x20Method':_0x1d8b7a[_0x2f32c0(0x246)],'Final\x20MACO\x20(mg)':_0x4276da[_0x2f32c0(0xfa)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x5f23ad[_0x2f32c0(0x14b)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x3e28c4['toFixed'](0x4)});});const _0x5efe8d=XLSX[_0x1d660e(0x1cf)][_0x1d660e(0x1f7)](_0x52b5b2);XLSX[_0x1d660e(0x1cf)][_0x1d660e(0x1fb)](_0x548652,_0x5efe8d,_0x181600[_0x1d660e(0x1bb)]);}catch(_0x57ed6f){console[_0x1d660e(0x2d1)](_0x1d660e(0x1b9),_0x57ed6f);}try{if(_0x181600[_0x1d660e(0xe0)](a13_0x199d64[_0x1d660e(0x14f)]['length'],0x0)){const _0x492795=parseFloat(document[_0x1d660e(0x1a4)](_0x181600[_0x1d660e(0x28e)])?.[_0x1d660e(0x1d0)])||0x46,_0x81bd72=a13_0x199d64[_0x1d660e(0x14f)][_0x1d660e(0x13b)](_0x369762=>parseFloat(_0x369762[_0x1d660e(0x140)]))[_0x1d660e(0x125)](_0x387335=>!isNaN(_0x387335)),_0x4ab4dd=_0x181600[_0x1d660e(0xe0)](_0x81bd72[_0x1d660e(0x10f)],0x0)?Math[_0x1d660e(0x22c)](..._0x81bd72):0x0,_0x179623=a13_0x199d64[_0x1d660e(0x14f)][_0x1d660e(0x13b)](_0x1859d4=>_0x1859d4[_0x1d660e(0x246)])[_0x1d660e(0x125)](_0x1db919=>''!==_0x1db919[_0x1d660e(0x1f1)]())[_0x1d660e(0x13f)](',\x20'),_0x483f57=[];_0xdf2d90[_0x1d660e(0x114)](_0x24c685=>{const _0x3974ba=_0x1d660e,_0x47c669=_0x181600[_0x3974ba(0x1b2)](_0x469adc,_0x24c685[_0x3974ba(0x21d)][_0x3974ba(0x13b)](_0x56cab3=>_0x56cab3[_0x3974ba(0x294)])),_0x577750=a13_0x199d64[_0x3974ba(0x2b0)][_0x47c669]||a13_0x199d64['safetyFactorConfig'][_0x3974ba(0xf5)],_0x576186=document[_0x3974ba(0x1a4)]('sf-input-train-'+_0x24c685['id']),_0x9e269f=_0x576186&&parseFloat(_0x576186[_0x3974ba(0x1d0)])||_0x577750[_0x3974ba(0x29d)],_0xfbc6c6=_0x181600[_0x3974ba(0xef)](_0x181600['KpnNI'](_0x181600[_0x3974ba(0x192)](0.0005,_0x4ab4dd),_0x492795),_0x9e269f),_0x373338=_0x181600[_0x3974ba(0x192)](_0xfbc6c6,_0x24c685['minBsMddRatio']),_0x166881=_0x181600[_0x3974ba(0x19b)](getLargestEssaForLineAndDosageForm,_0x24c685,_0xdf2d90),_0x5c207c=_0x166881>0x0?_0x373338/_0x166881:0x0,_0x763e=_0x181600[_0x3974ba(0x192)](_0x5c207c,_0x24c685[_0x3974ba(0x2ef)]),_0x5e0da6=_0x24c685['machineIds']['map'](_0x32bd2e=>{const _0x2f7e40=_0x3974ba,_0x2eef4=a13_0x199d64[_0x2f7e40(0x206)][_0x2f7e40(0x189)](_0x1b1129=>_0x1b1129['id']===_0x32bd2e);return _0x2eef4||{'name':_0x2f7e40(0x2e6)+_0x32bd2e+')','machineNumber':_0x2f7e40(0x2f4)};}),_0xdf80c=_0x24c685[_0x3974ba(0x14c)][_0x3974ba(0x13b)](_0x4f2833=>{const _0x36dd46=_0x3974ba,_0x52a782=a13_0x199d64['machines'][_0x36dd46(0x189)](_0x4dfe7d=>_0x4dfe7d['id']===_0x4f2833);return _0x52a782?_0x52a782[_0x36dd46(0x246)]:'Unknown\x20(ID:\x20'+_0x4f2833+')';})[_0x3974ba(0x13f)](',\x20'),_0x49c7f2=_0x24c685[_0x3974ba(0x21d)]['map'](_0x400517=>_0x400517['productCode']+_0x3974ba(0x1a0)+_0x400517[_0x3974ba(0x246)])[_0x3974ba(0x13f)](';\x20'),_0x43344e=_0x24c685['worstProductRpn']?_0x24c685[_0x3974ba(0x1c3)][_0x3974ba(0x290)]+'\x20('+_0x24c685['worstProductRpn'][_0x3974ba(0x199)]+_0x3974ba(0x243)+_0x24c685[_0x3974ba(0x1c3)][_0x3974ba(0x11b)]:_0x181600[_0x3974ba(0x18a)];_0x483f57['push']({'Train':'T'+_0x24c685['id'],'Total\x20Products':_0x24c685['products']['length'],'Total\x20Machines':_0x5e0da6[_0x3974ba(0x10f)],'Total\x20Area\x20(ESSA)\x20cm²':_0x24c685[_0x3974ba(0x2ec)][_0x3974ba(0x1d7)](),'Products':_0x49c7f2,'Machines':_0xdf80c,'Worst-Case\x20Dosage\x20Form':_0x47c669,'Safety\x20Factor\x20Range':_0x577750[_0x3974ba(0x22c)]+'\x20-\x20'+_0x577750[_0x3974ba(0x29d)],'Applied\x20Safety\x20Factor':_0x9e269f,'Detergent\x20Ingredients':_0x179623,'Body\x20Weight\x20(kg)':_0x492795,'Minimum\x20LD50\x20(mg/kg)':_0x4ab4dd,'Min\x20Batch\x20Size\x20(kg)':_0x24c685['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x24c685[_0x3974ba(0x25e)][_0x3974ba(0xfa)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x43344e,'ADI\x20(mg)':_0xfbc6c6[_0x3974ba(0xfa)](0x4),'MACO\x20(mg)':_0x373338['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x5c207c['toExponential'](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x763e['toFixed'](0x4)});});const _0x28ee23=XLSX[_0x1d660e(0x1cf)][_0x1d660e(0x1f7)](_0x483f57);XLSX[_0x1d660e(0x1cf)][_0x1d660e(0x1fb)](_0x548652,_0x28ee23,_0x181600['eqeLy']);}}catch(_0x5a4057){console['error'](_0x1d660e(0x20d),_0x5a4057);}try{const _0x1ef76c=[];_0xdf2d90[_0x1d660e(0x114)](_0x1c5d44=>{const _0x11c461=_0x1d660e,_0x182587={'BELKB':function(_0x21478e,_0x6107b4){const _0x38e2dd=a13_0x3876;return _0x1f58b8[_0x38e2dd(0x1d1)](_0x21478e,_0x6107b4);}},_0x43d616=_0x1c5d44[_0x11c461(0x14c)]['map'](_0x8cf1fb=>{const _0x4d8ab9=_0x11c461,_0xb8e3fc=a13_0x199d64[_0x4d8ab9(0x206)][_0x4d8ab9(0x189)](_0x2c49f8=>_0x2c49f8['id']===_0x8cf1fb);return _0x182587[_0x4d8ab9(0xcf)](_0xb8e3fc,{'id':_0x8cf1fb,'name':'Unknown\x20(ID:\x20'+_0x8cf1fb+')','machineNumber':_0x4d8ab9(0x2f4)});}),_0x44b9be=_0x1c5d44[_0x11c461(0x14c)][_0x11c461(0x13b)](_0x524b25=>{const _0x10b93f=_0x11c461,_0x304798=a13_0x199d64[_0x10b93f(0x206)][_0x10b93f(0x189)](_0x424d30=>_0x424d30['id']===_0x524b25);return _0x304798?_0x304798[_0x10b93f(0x246)]:_0x10b93f(0x2e6)+_0x524b25+')';})[_0x11c461(0x13f)](',\x20'),_0x177656=_0x1c5d44['products']['map'](_0x3f734e=>_0x3f734e[_0x11c461(0x2d5)]+_0x11c461(0x1a0)+_0x3f734e[_0x11c461(0x246)])[_0x11c461(0x13f)](';\x20'),_0x567765=_0x1c5d44[_0x11c461(0x21d)]['map'](_0xe61b48=>_0xe61b48[_0x11c461(0x2d5)]+':\x20'+_0xe61b48[_0x11c461(0x246)])[_0x11c461(0x13f)]('\x0a'),_0x523bf9=_0x43d616['map'](_0x7d8600=>_0x7d8600['machineNumber']+':\x20'+_0x7d8600[_0x11c461(0x246)])['join']('\x0a');_0x1ef76c[_0x11c461(0x271)]({'Train\x20ID':'T'+_0x1c5d44['id'],'Products\x20Count':_0x1c5d44[_0x11c461(0x21d)][_0x11c461(0x10f)],'Machines\x20Count':_0x43d616[_0x11c461(0x10f)],'Total\x20Area\x20(ESSA)\x20cm²':_0x1c5d44[_0x11c461(0x2ec)][_0x11c461(0x1d7)](),'Products\x20(Code\x20-\x20Name)':_0x177656,'Machines\x20(Number\x20-\x20Name)':_0x44b9be,'Products\x20Detailed':_0x567765,'Machines\x20Detailed':_0x523bf9,'Min\x20Batch\x20Size\x20(kg)':_0x1c5d44[_0x11c461(0x22e)],'Min\x20BS/MDD\x20Ratio':_0x1c5d44[_0x11c461(0x25e)][_0x11c461(0xfa)](0x2),'Assumed\x20SSA\x20(cm²)':_0x1c5d44[_0x11c461(0x2ef)],'Lowest\x20LTD\x20(mg)':_0x1c5d44[_0x11c461(0x188)],'Lowest\x20PDE\x20(mg)':_0x1f58b8[_0x11c461(0xf3)](null,_0x1c5d44[_0x11c461(0x151)])?_0x1c5d44[_0x11c461(0x151)]:_0x1f58b8[_0x11c461(0x191)],'Worst\x20RPN\x20Product':_0x1c5d44['worstProductRpn']?_0x1c5d44['worstProductRpn'][_0x11c461(0x290)]+'\x20('+_0x1c5d44['worstProductRpn'][_0x11c461(0x199)]+_0x11c461(0x243)+_0x1c5d44[_0x11c461(0x1c3)]['rpn']:_0x1f58b8['qdzYw']});});const _0x38c2cb=XLSX[_0x1d660e(0x1cf)][_0x1d660e(0x1f7)](_0x1ef76c);XLSX[_0x1d660e(0x1cf)]['book_append_sheet'](_0x548652,_0x38c2cb,'Train\x20Summary');}catch(_0x3fb4de){console[_0x1d660e(0x2d1)](_0x181600['chtOu'],_0x3fb4de);}try{const _0x4f248f=a13_0x199d64[_0x1d660e(0x21d)][_0x1d660e(0x25d)](_0x3473e4=>{const _0x52839c=_0x1d660e,_0x31bfc1=_0x181600[_0x52839c(0x1b2)](_0x24cca8,_0x3473e4);return _0x3473e4[_0x52839c(0x1d3)]['map'](_0x5ae672=>({'productName':_0x3473e4['name'],'productCode':_0x3473e4[_0x52839c(0x2d5)],'ingredientName':_0x5ae672[_0x52839c(0x246)],'rpn':_0x29e113(_0x5ae672)['rpn'],'trainId':'N/A'!==_0x31bfc1?'T'+_0x31bfc1:_0x52839c(0x2f4)}));})['sort']((_0x562c30,_0x4d0fe7)=>_0x4d0fe7[_0x1d660e(0x11b)]-_0x562c30['rpn'])[_0x1d660e(0x280)](0x0,0xa);if(_0x181600[_0x1d660e(0xe0)](_0x4f248f[_0x1d660e(0x10f)],0x0)){const _0x12edd7=_0x4f248f[_0x1d660e(0x13b)]((_0x1240a5,_0x1d2e72)=>({'Rank':_0x1d2e72+0x1,'Product\x20Code':_0x1240a5[_0x1d660e(0x2d5)],'Product\x20Name':_0x1240a5[_0x1d660e(0x290)],'Train':_0x1240a5['trainId'],'Ingredient':_0x1240a5['ingredientName'],'RPN':_0x1240a5[_0x1d660e(0x11b)]})),_0x486dbe=XLSX[_0x1d660e(0x1cf)][_0x1d660e(0x1f7)](_0x12edd7);XLSX[_0x1d660e(0x1cf)][_0x1d660e(0x1fb)](_0x548652,_0x486dbe,_0x1d660e(0x289));}}catch(_0x576aa7){console['error'](_0x181600[_0x1d660e(0x15f)],_0x576aa7);}try{const _0x57c1ca=a13_0x199d64[_0x1d660e(0x21d)][_0x1d660e(0x125)](_0x118831=>_0x118831[_0x1d660e(0x1ad)]);if(_0x181600['UbgGl'](_0x57c1ca[_0x1d660e(0x10f)],0x0)){const _0x21b1c6=_0x57c1ca[_0x1d660e(0x13b)](_0x4a2ffe=>({'Product\x20Code':_0x4a2ffe['productCode'],'Product\x20Name':_0x4a2ffe[_0x1d660e(0x246)],'Product\x20Type':_0x4a2ffe[_0x1d660e(0x294)],'Batch\x20Size\x20(kg)':_0x4a2ffe[_0x1d660e(0xe6)],'MDD\x20(mg)':_0x4a2ffe[_0x1d660e(0x2ed)],'Critical\x20Reason':_0x4a2ffe[_0x1d660e(0x16e)]||'No\x20reason\x20provided','Train':_0x1d660e(0x2f4)!==_0x24cca8(_0x4a2ffe)?'T'+_0x24cca8(_0x4a2ffe):_0x1d660e(0x2f4)})),_0x18814d=XLSX[_0x1d660e(0x1cf)][_0x1d660e(0x1f7)](_0x21b1c6);XLSX[_0x1d660e(0x1cf)][_0x1d660e(0x1fb)](_0x548652,_0x18814d,_0x181600[_0x1d660e(0x1c1)]);}}catch(_0x2adf7d){console['error']('Error\x20creating\x20Critical\x20Products\x20sheet:',_0x2adf7d);}try{const _0xb01af4=a13_0x199d64['products']['map'](_0x2c32e6=>{const _0x58093b=_0x1d660e,_0x108d1f={'PqeHG':function(_0x32d317,_0x2a028d){return _0x1f58b8['SdHBc'](_0x32d317,_0x2a028d);}},_0x16e399=_0x1f58b8['RmnUO'](_0x24cca8,_0x2c32e6),_0x240809=_0x2c32e6[_0x58093b(0x1d3)][_0x58093b(0x1ee)]((_0x46b839,_0x4fc723)=>{const _0x315e99=_0x58093b,_0x1d983b=_0x108d1f['PqeHG'](_0x29e113,_0x4fc723)[_0x315e99(0x11b)];return _0x1d983b>_0x46b839[_0x315e99(0x11b)]?{..._0x4fc723,'rpn':_0x1d983b}:_0x46b839;},{'rpn':0x0,'name':_0x1f58b8[_0x58093b(0x191)]});return{'Product\x20Code':_0x2c32e6[_0x58093b(0x2d5)],'Product\x20Name':_0x2c32e6[_0x58093b(0x246)],'Product\x20Type':_0x2c32e6[_0x58093b(0x294)],'Batch\x20Size\x20(kg)':_0x2c32e6[_0x58093b(0xe6)],'MDD\x20(mg)':_0x2c32e6[_0x58093b(0x2ed)],'Train':_0x1f58b8[_0x58093b(0x191)]!==_0x16e399?'T'+_0x16e399:_0x58093b(0x2f4),'Is\x20Critical':_0x2c32e6['isCritical']?_0x1f58b8[_0x58093b(0x1fe)]:'No','Critical\x20Reason':_0x2c32e6[_0x58093b(0x16e)]||_0x1f58b8[_0x58093b(0x191)],'Ingredients\x20Count':_0x2c32e6['activeIngredients'][_0x58093b(0x10f)],'Highest\x20RPN\x20Ingredient':_0x240809[_0x58093b(0x246)],'Highest\x20RPN\x20Value':_0x240809[_0x58093b(0x11b)]||0x0};}),_0x56e4b9=XLSX[_0x1d660e(0x1cf)]['json_to_sheet'](_0xb01af4);XLSX[_0x1d660e(0x1cf)][_0x1d660e(0x1fb)](_0x548652,_0x56e4b9,_0x1d660e(0xfe));}catch(_0x2ec524){console[_0x1d660e(0x2d1)](_0x181600[_0x1d660e(0x27a)],_0x2ec524);}try{const _0x12fe4f=[];a13_0x199d64['products']['forEach'](_0x989224=>{const _0xdd5f0e=_0x1d660e,_0x556f64=_0x24cca8(_0x989224),_0x11a207={'Product\x20Code':_0x989224[_0xdd5f0e(0x2d5)],'Product\x20Name':_0x989224[_0xdd5f0e(0x246)],'Product\x20Type':_0x989224[_0xdd5f0e(0x294)],'Batch\x20Size\x20(kg)':_0x989224[_0xdd5f0e(0xe6)],'MDD\x20(mg)':_0x989224['mddMg'],'Train':_0x1f58b8[_0xdd5f0e(0x191)]!==_0x556f64?'T'+_0x556f64:_0x1f58b8[_0xdd5f0e(0x191)],'Is\x20Critical':_0x989224[_0xdd5f0e(0x1ad)]?_0x1f58b8['fGhUY']:'No','Critical\x20Reason':_0x989224[_0xdd5f0e(0x16e)]||_0x1f58b8[_0xdd5f0e(0x191)],'Ingredient\x20Type':_0x1f58b8['ahTuC'],'Ingredient\x20Name':'','LTD\x20(mg)':'','PDE\x20(mg)':'','LD50\x20(mg/kg)':'','Severity':'','Occurrence':'','Detection':'','RPN':''};_0x12fe4f[_0xdd5f0e(0x271)](_0x11a207),_0x989224[_0xdd5f0e(0x1d3)][_0xdd5f0e(0x114)](_0x45b3a2=>{const _0x21a7f3=_0xdd5f0e,_0x58f6d8=_0x29e113(_0x45b3a2);_0x12fe4f[_0x21a7f3(0x271)]({'Product\x20Code':'','Product\x20Name':'','Product\x20Type':'','Batch\x20Size\x20(kg)':'','MDD\x20(mg)':'','Train':'','Is\x20Critical':'','Critical\x20Reason':'','Ingredient\x20Type':_0x1f58b8[_0x21a7f3(0x232)],'Ingredient\x20Name':_0x45b3a2['name'],'LTD\x20(mg)':_0x45b3a2['ltdMg']||_0x1f58b8['qdzYw'],'PDE\x20(mg)':_0x45b3a2[_0x21a7f3(0x291)]||_0x1f58b8[_0x21a7f3(0x191)],'LD50\x20(mg/kg)':_0x45b3a2[_0x21a7f3(0x140)]||_0x1f58b8[_0x21a7f3(0x191)],'Severity':_0x58f6d8[_0x21a7f3(0x2fc)],'Occurrence':_0x58f6d8[_0x21a7f3(0x146)],'Detection':_0x58f6d8[_0x21a7f3(0x249)],'RPN':_0x58f6d8['rpn']});});});const _0x131bf8=XLSX[_0x1d660e(0x1cf)][_0x1d660e(0x1f7)](_0x12fe4f);XLSX[_0x1d660e(0x1cf)][_0x1d660e(0x1fb)](_0x548652,_0x131bf8,_0x1d660e(0x2a9));}catch(_0x5e8e5f){console[_0x1d660e(0x2d1)](_0x1d660e(0x28d),_0x5e8e5f);}const _0x57c795=new Date()[_0x1d660e(0x11a)]()[_0x1d660e(0x2c6)]('T')[0x0];XLSX[_0x1d660e(0x2af)](_0x548652,_0x1d660e(0x22f)+_0x57c795+'.xlsx'),_0x181600[_0x1d660e(0x2dc)](hideLoader),_0x181600['iWllI'](showCustomAlert,_0x181600['qaRpr'],_0x181600[_0x1d660e(0x24e)]);})[_0x5aed9a(0x226)](_0x3e8275=>{const _0x3fa814=_0x5aed9a;console['error']('Error\x20exporting\x20all\x20tabs\x20to\x20Excel:',_0x3e8275),_0x181600[_0x3fa814(0x2dc)](hideLoader),showCustomAlert(_0x181600[_0x3fa814(0x286)],_0x181600[_0x3fa814(0x117)]);});}export function toggleStageSection(_0x3d152b){const _0x5dec50=a13_0x1da86d,_0x184279={'YSZVp':_0x5dec50(0x104),'qYOLz':_0x5dec50(0x2db)},_0x457f30=document[_0x5dec50(0x1a4)](_0x5dec50(0x2f0)+_0x3d152b),_0x3e7938=_0x5dec50(0x1b7)===_0x457f30[_0x5dec50(0x1f0)][_0x5dec50(0x1d2)];_0x457f30['style'][_0x5dec50(0x1d2)]=_0x3e7938?'':_0x5dec50(0x1b7),localStorage[_0x5dec50(0x1d4)](_0x5dec50(0x164)+_0x3d152b+'-hidden',!_0x3e7938);const _0x4f1ee9=_0x457f30[_0x5dec50(0x19e)][_0x5dec50(0x196)](_0x184279[_0x5dec50(0x2d6)]);_0x4f1ee9&&(_0x4f1ee9[_0x5dec50(0x2c8)]=_0x3e7938?_0x184279[_0x5dec50(0x2a2)]:_0x5dec50(0x269));}