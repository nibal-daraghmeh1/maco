const a12_0x35cd83=a12_0x4a84;(function(_0x3abb94,_0x543221){const _0x5ba2c6=a12_0x4a84,_0x47c139=_0x3abb94();while(!![]){try{const _0x49a3df=-parseInt(_0x5ba2c6(0x308))/0x1*(parseInt(_0x5ba2c6(0x175))/0x2)+-parseInt(_0x5ba2c6(0x232))/0x3*(-parseInt(_0x5ba2c6(0x1fd))/0x4)+-parseInt(_0x5ba2c6(0x2d7))/0x5+parseInt(_0x5ba2c6(0x2c0))/0x6+parseInt(_0x5ba2c6(0x34e))/0x7+-parseInt(_0x5ba2c6(0x1a1))/0x8+parseInt(_0x5ba2c6(0x1b5))/0x9;if(_0x49a3df===_0x543221)break;else _0x47c139['push'](_0x47c139['shift']());}catch(_0x206e8c){_0x47c139['push'](_0x47c139['shift']());}}}(a12_0x38ed,0x50020));function a12_0x4a84(_0xdc1078,_0xb36889){const _0x38ed08=a12_0x38ed();return a12_0x4a84=function(_0x4a8461,_0x229e18){_0x4a8461=_0x4a8461-0x12e;let _0x5f2274=_0x38ed08[_0x4a8461];return _0x5f2274;},a12_0x4a84(_0xdc1078,_0xb36889);}import*as a12_0x2a5c73 from'./state.js';import{fullAppRender as a12_0x1182c2}from'./app.js';import{generateTrainMap as a12_0x5e39f2}from'./utils.js';import{toggleScoringEditMode as a12_0x224b7f}from'./scoringView.js';import{renderRpnChart as a12_0x3bd01b}from'./worstCaseView.js';import{renderMacoChart as a12_0x103301}from'./dashboardView.js';const s=document[a12_0x35cd83(0x255)]('loader');export const showLoader=()=>s[a12_0x35cd83(0x13b)][a12_0x35cd83(0x329)]='flex';export const hideLoader=()=>s[a12_0x35cd83(0x13b)]['display']=a12_0x35cd83(0x2d1);export function showCustomAlert(_0x53f882,_0x67d958){const _0x1cb80a=a12_0x35cd83,_0x960017={'tXZmK':'customAlertTitle','OElZM':'customAlertMessage','evIQT':_0x1cb80a(0x1ae)};document[_0x1cb80a(0x255)](_0x960017[_0x1cb80a(0x16c)])[_0x1cb80a(0x236)]=_0x53f882,document[_0x1cb80a(0x255)](_0x960017['OElZM'])[_0x1cb80a(0x236)]=_0x67d958,document['getElementById'](_0x960017[_0x1cb80a(0x1e1)])[_0x1cb80a(0x13b)][_0x1cb80a(0x329)]=_0x1cb80a(0x283);}export const hideModal=_0x4baeaa=>document[a12_0x35cd83(0x255)](_0x4baeaa)['style'][a12_0x35cd83(0x329)]=a12_0x35cd83(0x2d1);export function saveAllDataToLocalStorage(){const _0x5a224e=a12_0x35cd83,_0xeb147e={'PGJJO':'macoMachines','jOoQb':_0x5a224e(0x356),'SZMdk':_0x5a224e(0x29a),'WDphd':_0x5a224e(0x19d),'fjrCj':function(_0x595e0d,_0x202f65,_0x2f87a0){return _0x595e0d(_0x202f65,_0x2f87a0);},'zahAM':_0x5a224e(0x227),'cSCuf':_0x5a224e(0x23b)};try{localStorage[_0x5a224e(0x347)](_0x5a224e(0x334),JSON[_0x5a224e(0x1ec)](a12_0x2a5c73[_0x5a224e(0x321)])),localStorage[_0x5a224e(0x347)](_0xeb147e[_0x5a224e(0x2fa)],JSON[_0x5a224e(0x1ec)](a12_0x2a5c73[_0x5a224e(0x2d9)])),localStorage[_0x5a224e(0x347)](_0xeb147e[_0x5a224e(0x1be)],JSON[_0x5a224e(0x1ec)](a12_0x2a5c73['scoringCriteria'])),localStorage['setItem']('macoDetergentIngredients',JSON[_0x5a224e(0x1ec)](a12_0x2a5c73['detergentIngredients'])),localStorage['setItem'](_0xeb147e['SZMdk'],JSON[_0x5a224e(0x1ec)](a12_0x2a5c73[_0x5a224e(0x29a)]));}catch(_0xe64142){console['error'](_0xeb147e['WDphd'],_0xe64142),_0xeb147e[_0x5a224e(0x193)](showCustomAlert,_0xeb147e[_0x5a224e(0x292)],_0xeb147e[_0x5a224e(0x1dc)]);}}export function loadAllDataFromLocalStorage(){const _0x38c40b=a12_0x35cd83,_0x2dcfda={'xkyeI':_0x38c40b(0x334),'xQTuG':'macoMachines','XrmQv':_0x38c40b(0x356),'tsqnc':_0x38c40b(0x2e0),'vfZjf':_0x38c40b(0x31c),'kQAHc':_0x38c40b(0x28b),'XVNHn':_0x38c40b(0x282),'UyyHp':_0x38c40b(0x231)},_0x3cfa18=localStorage[_0x38c40b(0x235)](_0x2dcfda[_0x38c40b(0x261)]),_0x14e78b=localStorage[_0x38c40b(0x235)](_0x2dcfda[_0x38c40b(0x2a7)]),_0x400e9d=localStorage[_0x38c40b(0x235)](_0x2dcfda[_0x38c40b(0x23c)]),_0x3f6126=localStorage['getItem'](_0x2dcfda[_0x38c40b(0x12f)]),_0x1cbdbb=localStorage[_0x38c40b(0x235)](_0x38c40b(0x29a));if(_0x3cfa18)try{a12_0x2a5c73[_0x38c40b(0x1ee)](JSON[_0x38c40b(0x2de)](_0x3cfa18));}catch(_0x1a3afc){console[_0x38c40b(0x17b)](_0x2dcfda[_0x38c40b(0x230)],_0x1a3afc);}if(_0x14e78b)try{a12_0x2a5c73[_0x38c40b(0x35f)](JSON[_0x38c40b(0x2de)](_0x14e78b));}catch(_0x4d8112){console[_0x38c40b(0x17b)](_0x2dcfda['kQAHc'],_0x4d8112);}if(_0x400e9d)try{a12_0x2a5c73[_0x38c40b(0x2f8)](JSON[_0x38c40b(0x2de)](_0x400e9d));}catch(_0x1875e5){console['error'](_0x38c40b(0x328),_0x1875e5);}if(_0x3f6126)try{a12_0x2a5c73[_0x38c40b(0x2d6)](JSON[_0x38c40b(0x2de)](_0x3f6126));}catch(_0x5dd7d4){console[_0x38c40b(0x17b)](_0x2dcfda[_0x38c40b(0x2ba)],_0x5dd7d4);}if(_0x1cbdbb)try{a12_0x2a5c73[_0x38c40b(0x358)](JSON[_0x38c40b(0x2de)](_0x1cbdbb));}catch(_0x5aaf95){console[_0x38c40b(0x17b)](_0x2dcfda[_0x38c40b(0x35e)],_0x5aaf95);}}function a12_0x38ed(){const _0x5b304a=['#macoForTrains\x20[id^=\x22maco-breakdown-details-\x22].hidden','Worst\x20Case\x20Products','SugpT','giibX','isGroup','xQTuG','click','body','There\x20are\x20no\x20products\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','apdAI','Top\x2010\x20RPN','hZnol','Failed\x20to\x20export\x20Train\x20Summary\x20data\x20to\x20Excel.','TzdpQ','KBhlx','keys','push','VXVxH','sort','Detergent\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','redo-btn','OWcsz','documentElement','readAsText','XVNHn','QWlFS','YlCaL','edVcS',')\x20-\x20RPN:\x20','LEKcO','1043874KZBbzH','JWtCB','lHWUS','json_to_sheet','None','.xlsx','includes','PmrDT','toggle','FWFDO','./macoDetergentView.js','Complete\x20report\x20with\x20all\x20tabs\x20exported\x20to\x20Excel\x20successfully!','PKmJo','enyqJ','./worstCaseView.js','-hidden','maco-breakdown-details-','none','theme-toggle-light-icon','OGmCV','CkYOm','safetyFactorConfig','setDetergentIngredients','1233045dbOPyk','iSyMU','machines','renderMacoForTrains','appendChild','Product\x20MACO\x20Report','HaoBI','parse','#columnVisibilityDropdown','macoDetergentIngredients','qgiJC','Error\x20exporting\x20all\x20tabs\x20to\x20Excel:','\x20.mainTable,\x20#','gmkJI','No\x20Data','DicmW','contains','uMWUp','rwflr','Error\x20exporting\x20Product\x20MACO\x20to\x20Excel:','YwJsn','qBjFi','trainSummary','wPnqS','cujRo','TiQpO','HqAVE','JXaaq','Jmqaz','DeRGY','./macoProductView.js','stage','Show\x20PDE','setScoringCriteria','files','PGJJO','FRnMs','mgxoy','ld50Score','DrTEo','shGcy','Train\x20Summary\x20Report','cSGxD','DdQLW','Wiibb','LdszB','woOPc','block','qiVwq','8372pBUhFH','pbPfr','product-sf-input','twoZW','HjnSk','Complete_MACO_Report_','.toggle-ld50','!cols','lowestLtd',',\x20#','message','bYFYk','filter','YhnFF','OwknA','min','nTWyn','yvFtT','No\x20trains\x20message\x20display:','productRegister-','Error\x20loading\x20products','machineStage-','xBPbQ','ImQhm','sortValue','products','Show\x20MACO\x20Calculation\x20Breakdown','cleanability','PRODUCT','input','tglEx','columnVisibilityDropdown','Error\x20loading\x20scoring\x20criteria','display','machineCount','Train\x20summary\x20container\x20is\x20hidden\x20or\x20missing','Ebroe','ZHYmi','RVUtx','zdbnq','eXzHM','Opsal','Hxdgj','Detergent\x20MACO\x20Report','macoProducts','bOCiI','uevOl','sf-input-train','join','isArray','etJcj','Hide\x20LD50','_Trains_','printing-','remove','#detergentMaco\x20.train-content.collapsed','mddMg','hyfNe','content-dm-','SJatY','wXTcS','rJTvf','match','setItem','zGxEU','10\x20ppm\x20Criterion','writeFile','bOmsa','No\x20reason\x20provided','Summary\x20report\x20data\x20exported\x20to\x20Excel\x20successfully!','357105fsJxLs','machineNumber','reduce','#productRegister\x20.mainTable.hide-','There\x20are\x20no\x20machines\x20to\x20export.','PNtNa','Failed\x20to\x20export\x20data\x20to\x20Excel.','bStKL','macoScoringCriteria','zLEjS','setMachineStageDisplayOrder','Product\x20MACO','removeEventListener','pfLWj','Success','\x20.mainTable.hide-','UyyHp','setMachines','xdoJw','book_append_sheet','hidden','ahrcM','yJNvP','SkLXj','essa','There\x20is\x20no\x20data\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','DXJmN','PPyQJ','MACO_Worst_Case_Products','tsqnc','value','PJbck','CJREK','Error','ld50','toggle-pm-','cSpzC','JDwls','XnKjV','yysgr','0.1%\x20Therapeutic\x20Dose','style','JvwVX','detection','lowestPde','Failed\x20to\x20export\x20machines\x20data\x20to\x20Excel.','Zfzby','Machines\x20data\x20exported\x20to\x20Excel\x20successfully!','Show','QaBze','renderRpnChart','Mpunq','WMEkc','xmvzF','content-','xnyhM','add','XylBm','rIRGR','bpakJ','severity','forEach','JYzbl','NqicN','JPEcc','FskXr','scoringCriteria','wkBjF','productRegister-ld50Hidden','startsWith','bRmOv','YAjkj','otAiS','history','gLdpq','Container\x20display:','PQFca','Error\x20creating\x20Product\x20MACO\x20sheet:','KTcAJ','warn','corDC','SvJEY','Failed\x20to\x20export\x20complete\x20report\x20to\x20Excel.','rpnRatingText','All\x20Products','ingredientName','then','result','pycfZ','wfWZs','tXZmK','ATLlu','consolidateMachinesByGroup','group','njBls','all','FGmzd','bTwdG','wTvfn','156AyrCtO','xWeAY','split','button[onclick=\x22toggleColumnVisibilityDropdown()\x22]','msQGs','find','error','pdeMg','pVarH','toISOString','qZcba','Error\x20exporting\x20Detergent\x20MACO\x20to\x20Excel:','productType','KFWJZ','WBVHI','Unknown\x20(ID:\x20','Failed\x20to\x20export\x20data\x20to\x20JSON.','therapeuticDoseScore','FxARy','No\x20trains\x20match\x20the\x20selected\x20criteria.','HTrLF','GKFOP','ULPht','.toggle-pde','dhehR','gjARZ','addEventListener','MACO\x20Report','RaFpQ','scoring-system','fjrCj','theme-toggle-dark-icon','qJDRZ','rpn','Product\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','productCode','Failed\x20to\x20export\x20Product\x20MACO\x20data\x20to\x20Excel.','NwStw','flatMap','Error\x20loading\x20train\x20summary:\x20','Failed\x20to\x20save\x20data\x20to\x20localStorage','Product\x20Register','DTKJy','DYhwO','1594808oafzTf','toLocaleString','collapsed','GoiGK','fAGQN','print','_Train_','SlIWO','djIBY','renderDetergentMaco','Error\x20exporting\x20Summary\x20to\x20Excel:','DDzpu','log','customAlertModal','length','Visual\x20Clean\x20Limit','Cbwdd','IzRhb','ofnVN','AHDFP','8109612ReVpgm','DEjmf','rmGXQ','oayzh','unBPS','FzyAx','max','DPMAB','Failed\x20to\x20export\x20Summary\x20report\x20data\x20to\x20Excel.','jOoQb','hide-ld50','Error\x20creating\x20Train\x20Summary\x20sheet:','\x20→\x20','nOOFi','dark','historyIndex','printSelectedTrain','NjOqO','Yes','DARRC','fgFTl','MACO_Machines_','not\x20found','bodyWeight','createElement','ngROh','\x20.ingredients-sub-table','Invalid\x20JSON\x20file\x20structure.','-ld50Hidden','CWgBF','HIKpT','MyWPR','tfvVs','detergentIngredients','qoGUD','solubilityScore','utils','TXBbT','bMvrK','cSCuf','ihsoM','GnMjX','pvvon','hpXdZ','evIQT','Hide','pde','There\x20are\x20no\x20detergent\x20ingredients\x20configured.\x20Add\x20detergent\x20ingredients\x20first.','ZSoXK','hDLxA','ppKYw','Data\x20imported\x20successfully.','querySelectorAll','book_new','assumedSsa','stringify','tRXzt','setProducts','Trains\x20','worstCaseProducts','Rbgfo','slice','TbZLA','GpVdy','Failed\x20to\x20export\x20Detergent\x20MACO\x20data\x20to\x20Excel.','buDkH','zaaOl','XKOlK','cleanabilityScore','jGGDM','name','\x20-\x20','664DGwbaG','\x20not\x20found\x20or\x20has\x20no\x20products.','aePLW','./utils.js','hide-pde','number','querySelector','JykSQ','occurrence','toggle-','zHYRz','fAjXQ','Health-Based\x20Limit\x20(ADE)','ziDSX','TPTHD','nIgsf','Other','kALip','required','hide-','Error\x20loading\x20train\x20summary\x20view:','minBsMddRatio','classList','isCritical','minMbsKg','pmFsC','activeIngredients','Error\x20exporting\x20machines\x20to\x20Excel:','setScoringWasInEditModeForPrint','zaAUC','iJrVs','aEkOR','href','productRegister-pdeHidden','zGOUK','mNxQE','INGREDIENT','DixON','Setting\x20printSelectedTrain\x20to:','equdU','CYfrF','MYCFp','Save\x20Error','Product_MACO_Report','Error\x20creating\x20Detergent\x20MACO\x20sheet:','Hidden','SDymU','toExponential','BLtlm','WAHrc','\x20.train-content-inner','vfZjf','Error\x20loading\x20machine\x20stage\x20order','5433WGoJZU','nfRml','toggle-dm-','getItem','textContent','GGzji','FwvCc','scoringInEditMode','N/A','Could\x20not\x20save\x20data.\x20Storage\x20might\x20be\x20full.','XrmQv','batchSizeKg','kyjsV','FcmFP','content-pm-','udhsA','qVZpf','WpaEw','kNzxn','hELPd','target','yVwjM','xjZga','dZpos','WTCCV','trainSummaryContainer','Train\x20Summary','wzgyy','EOyfP','map','onload','RtkJm','bRorS','itBtl','WrEOK','getElementById','Train\x20','innerHTML','qqxUD','MsOac','tLNjK','application/json','breakdown-toggle-btn-','Error\x20exporting\x20Train\x20Summary\x20to\x20Excel:','closest','TizVw','Error\x20creating\x20All\x20Products\x20sheet:','xkyeI','therapeuticDose','toFixed','disabled','stage-','cdyGJ','xfxCS','TTSrd','ZDoEt','zuEdk','GcGxg','iOvHk','DrgyE','fVQLZ','Error\x20creating\x20Product\x20Register\x20sheet:','MACO_Summary_Report_','AzpBM','Show\x20LD50','aZpBO','cNFNS','vsWkL','machineIds','AAhNd','pdeScore','ThfYS','AbERU','HSntL','renderWorstCaseByTrain','trainId','PCfhz','catch','XcaZX','renderTrainSummary','Error\x20loading\x20detergent\x20ingredients','flex','date','LtJmN','gUUkF','BoQif','Detergent\x20MACO','setHistory','removeChild','Error\x20loading\x20machines','XAzxF','LWFYN','productName','MACO_All_Products_Report.xlsx','Train:','worstProductRpn','zahAM','criticalReason','tEyWq','Error\x20exporting\x20worst\x20case\x20to\x20Excel:','qlJKK','HvURV','There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','Vrgiz','machineStageDisplayOrder','VkGUg','DrKut','StxiM','macoForTrains','Critical\x20Products','jFswA','aPPwT'];a12_0x38ed=function(){return _0x5b304a;};return a12_0x38ed();}export function saveStateForUndo(){const _0x52b14a=a12_0x35cd83,_0x3a7b35={'ihsoM':function(_0x48d3be){return _0x48d3be();},'zHYRz':function(_0x3ec2b3,_0x452716){return _0x3ec2b3-_0x452716;}};_0x3a7b35[_0x52b14a(0x1dd)](a12_0x5e39f2);const _0x45c752=a12_0x2a5c73[_0x52b14a(0x15b)]['slice'](0x0,a12_0x2a5c73['historyIndex']+0x1),_0x4a3675={'products':JSON['parse'](JSON['stringify'](a12_0x2a5c73['products'])),'machines':JSON[_0x52b14a(0x2de)](JSON['stringify'](a12_0x2a5c73[_0x52b14a(0x2d9)])),'scoringCriteria':JSON[_0x52b14a(0x2de)](JSON[_0x52b14a(0x1ec)](a12_0x2a5c73[_0x52b14a(0x154)])),'detergentIngredients':JSON[_0x52b14a(0x2de)](JSON[_0x52b14a(0x1ec)](a12_0x2a5c73[_0x52b14a(0x1d6)]))};_0x45c752[_0x52b14a(0x2b2)](_0x4a3675),a12_0x2a5c73['setHistory'](_0x45c752,_0x3a7b35[_0x52b14a(0x207)](_0x45c752[_0x52b14a(0x1af)],0x1)),_0x3a7b35[_0x52b14a(0x1dd)](updateUndoRedoButtons),_0x3a7b35[_0x52b14a(0x1dd)](saveAllDataToLocalStorage);}export function updateUndoRedoButtons(){const _0x41da43=a12_0x35cd83,_0x3814fa={'FJZyE':'undo-btn','LRTKP':function(_0x298ce7,_0x1c6390){return _0x298ce7<=_0x1c6390;},'DicmW':function(_0x5df176,_0x33d359){return _0x5df176>=_0x33d359;},'nfRml':function(_0x292a2a,_0xc34c91){return _0x292a2a-_0xc34c91;}},_0xa8d2c4=document[_0x41da43(0x255)](_0x3814fa['FJZyE']),_0x3efbfd=document['getElementById'](_0x41da43(0x2b6));_0xa8d2c4&&(_0xa8d2c4[_0x41da43(0x264)]=_0x3814fa['LRTKP'](a12_0x2a5c73['historyIndex'],0x0)),_0x3efbfd&&(_0x3efbfd[_0x41da43(0x264)]=_0x3814fa[_0x41da43(0x2e6)](a12_0x2a5c73[_0x41da43(0x1c4)],_0x3814fa[_0x41da43(0x233)](a12_0x2a5c73[_0x41da43(0x15b)][_0x41da43(0x1af)],0x1)));}export function undoChange(){const _0x40b02b=a12_0x35cd83,_0x298284={'GKFOP':function(_0x2e6f62,_0x1fc7a4){return _0x2e6f62-_0x1fc7a4;},'giibX':function(_0x2f2e75){return _0x2f2e75();},'DXJmN':function(_0x165949){return _0x165949();}};if(a12_0x2a5c73[_0x40b02b(0x1c4)]>0x0){const _0x2bae70=_0x298284[_0x40b02b(0x18a)](a12_0x2a5c73['historyIndex'],0x1),_0x27a7a3=a12_0x2a5c73[_0x40b02b(0x15b)][_0x2bae70];a12_0x2a5c73[_0x40b02b(0x1ee)](JSON[_0x40b02b(0x2de)](JSON['stringify'](_0x27a7a3[_0x40b02b(0x321)]))),a12_0x2a5c73['setMachines'](JSON[_0x40b02b(0x2de)](JSON[_0x40b02b(0x1ec)](_0x27a7a3[_0x40b02b(0x2d9)]))),a12_0x2a5c73[_0x40b02b(0x2f8)](JSON['parse'](JSON[_0x40b02b(0x1ec)](_0x27a7a3['scoringCriteria']))),a12_0x2a5c73[_0x40b02b(0x2d6)](JSON['parse'](JSON[_0x40b02b(0x1ec)](_0x27a7a3[_0x40b02b(0x1d6)]))),a12_0x2a5c73[_0x40b02b(0x289)](a12_0x2a5c73[_0x40b02b(0x15b)],_0x2bae70),a12_0x2a5c73['scoringInEditMode']&&a12_0x224b7f(!0x1),_0x298284[_0x40b02b(0x2a5)](a12_0x1182c2),_0x298284[_0x40b02b(0x368)](updateUndoRedoButtons),_0x298284['giibX'](saveAllDataToLocalStorage);}}export function redoChange(){const _0x3ee26b=a12_0x35cd83,_0xdfdbe7={'RQbUY':function(_0x290535,_0x353345){return _0x290535<_0x353345;},'Eciyb':function(_0x7d6e49,_0x23b7c1){return _0x7d6e49-_0x23b7c1;},'oEeJL':function(_0x96e2dc,_0x59b48f){return _0x96e2dc+_0x59b48f;},'yysgr':function(_0x4906cd,_0x190636){return _0x4906cd(_0x190636);},'Vrgiz':function(_0x6982f8){return _0x6982f8();}};if(_0xdfdbe7['RQbUY'](a12_0x2a5c73[_0x3ee26b(0x1c4)],_0xdfdbe7['Eciyb'](a12_0x2a5c73[_0x3ee26b(0x15b)]['length'],0x1))){const _0x2700d2=_0xdfdbe7['oEeJL'](a12_0x2a5c73[_0x3ee26b(0x1c4)],0x1),_0x1b6d8b=a12_0x2a5c73['history'][_0x2700d2];a12_0x2a5c73['setProducts'](JSON[_0x3ee26b(0x2de)](JSON[_0x3ee26b(0x1ec)](_0x1b6d8b[_0x3ee26b(0x321)]))),a12_0x2a5c73[_0x3ee26b(0x35f)](JSON['parse'](JSON[_0x3ee26b(0x1ec)](_0x1b6d8b['machines']))),a12_0x2a5c73['setScoringCriteria'](JSON[_0x3ee26b(0x2de)](JSON[_0x3ee26b(0x1ec)](_0x1b6d8b[_0x3ee26b(0x154)]))),a12_0x2a5c73[_0x3ee26b(0x2d6)](JSON[_0x3ee26b(0x2de)](JSON['stringify'](_0x1b6d8b[_0x3ee26b(0x1d6)]))),a12_0x2a5c73['setHistory'](a12_0x2a5c73[_0x3ee26b(0x15b)],_0x2700d2),a12_0x2a5c73[_0x3ee26b(0x239)]&&_0xdfdbe7[_0x3ee26b(0x139)](a12_0x224b7f,!0x1),_0xdfdbe7['Vrgiz'](a12_0x1182c2),_0xdfdbe7[_0x3ee26b(0x299)](updateUndoRedoButtons),_0xdfdbe7[_0x3ee26b(0x299)](saveAllDataToLocalStorage);}}export function toggleDarkMode(_0x469083){const _0x92959c=a12_0x35cd83,_0x441279={'HIKpT':_0x92959c(0x194),'SugpT':_0x92959c(0x1c3),'BNBKF':_0x92959c(0x362),'wfWZs':function(_0xd17a10){return _0xd17a10();}},_0x37bf68=document[_0x92959c(0x255)](_0x92959c(0x2d2)),_0x955db9=document['getElementById'](_0x441279[_0x92959c(0x1d3)]);_0x469083?(document[_0x92959c(0x2b8)]['classList'][_0x92959c(0x14a)](_0x441279[_0x92959c(0x2a4)]),_0x37bf68&&_0x37bf68[_0x92959c(0x213)][_0x92959c(0x14a)](_0x92959c(0x362)),_0x955db9&&_0x955db9[_0x92959c(0x213)][_0x92959c(0x33e)](_0x92959c(0x362))):(document[_0x92959c(0x2b8)][_0x92959c(0x213)][_0x92959c(0x33e)](_0x92959c(0x1c3)),_0x37bf68&&_0x37bf68[_0x92959c(0x213)][_0x92959c(0x33e)](_0x441279['BNBKF']),_0x955db9&&_0x955db9['classList'][_0x92959c(0x14a)]('hidden')),a12_0x2a5c73['rpnChartInstance']&&_0x441279[_0x92959c(0x16b)](a12_0x3bd01b),a12_0x2a5c73['macoChartInstance']&&_0x441279['wfWZs'](a12_0x103301);}export function printCurrentView(_0x21b9cb,_0x1659aa=a12_0x35cd83(0x171)){const _0x15b39e=a12_0x35cd83,_0x1f5fff={'shGcy':function(_0x599435,_0x52e6aa,_0x38a5c6){return _0x599435(_0x52e6aa,_0x38a5c6);},'bqCCQ':_0x15b39e(0x1a3),'QaBze':_0x15b39e(0x2a2),'pkmPW':function(_0x165b92,_0x53737a,_0x5cddcb){return _0x165b92(_0x53737a,_0x5cddcb);},'FxARy':function(_0x506474,_0xc6d7da,_0x26daea){return _0x506474(_0xc6d7da,_0x26daea);},'TzdpQ':_0x15b39e(0x33f),'kCahk':'Error\x20loading\x20detergent\x20view\x20for\x20print:','aPPwT':function(_0x1f85a7,_0x4ed539,_0x5388fa){return _0x1f85a7(_0x4ed539,_0x5388fa);},'qiVwq':_0x15b39e(0x24b),'XnKjV':_0x15b39e(0x15d),'udhsA':_0x15b39e(0x31a),'RtkJm':_0x15b39e(0x1cb),'SvJEY':'Container\x20has\x20content:','zGOUK':function(_0x4e44ff,_0x5a7a98){return _0x4e44ff>_0x5a7a98;},'hyfNe':function(_0x2e11e2,_0x2f998d){return _0x2e11e2===_0x2f998d;},'wXTcS':_0x15b39e(0x32b),'DrKut':function(_0x59e157,_0x5b9769){return _0x59e157(_0x5b9769);},'FwvCc':'No\x20train\x20data\x20to\x20print.\x20Please\x20ensure\x20you\x20have\x20created\x20trains\x20first.','PPyQJ':_0x15b39e(0x211),'cSGxD':function(_0x494bfc,_0x149885){return _0x494bfc(_0x149885);},'JQuLG':function(_0x4a4c76,_0x212ce3){return _0x4a4c76+_0x212ce3;},'SJatY':_0x15b39e(0x19c),'BoQif':_0x15b39e(0x192),'IzRhb':'Printing\x20view:','msQGs':_0x15b39e(0x290),'JWtCB':_0x15b39e(0x1f0),'cujRo':'detergentMaco','gPhqz':_0x15b39e(0x2ed),'HdBQe':_0x15b39e(0x223),'DeRGY':'./trainSummaryView.js'};_0x1f5fff['hyfNe'](_0x1f5fff[_0x15b39e(0x287)],_0x21b9cb)&&a12_0x2a5c73[_0x15b39e(0x239)]&&(a12_0x2a5c73[_0x15b39e(0x219)](!0x0),_0x1f5fff[_0x15b39e(0x301)](a12_0x224b7f,!0x1)),console[_0x15b39e(0x1ad)](_0x1f5fff[_0x15b39e(0x1b2)],_0x21b9cb,_0x1f5fff[_0x15b39e(0x179)],_0x1659aa),document['body']['classList'][_0x15b39e(0x14a)](_0x15b39e(0x33d)+_0x21b9cb),_0x1f5fff[_0x15b39e(0x341)](_0x1f5fff[_0x15b39e(0x2c1)],_0x21b9cb)?import(_0x15b39e(0x2ce))[_0x15b39e(0x168)](_0x2a1ca7=>{const _0x1cb81d=_0x15b39e;window[_0x1cb81d(0x1c5)]=_0x1659aa,_0x2a1ca7[_0x1cb81d(0x27c)](),_0x1f5fff[_0x1cb81d(0x2ff)](setTimeout,()=>{const _0x44a0fe=_0x1cb81d;window[_0x44a0fe(0x1a6)]();},0xc8);}):_0x15b39e(0x29e)===_0x21b9cb?(window[_0x15b39e(0x1c5)]=_0x1659aa,import(_0x15b39e(0x2f5))[_0x15b39e(0x168)](_0x7c720c=>{const _0x327347=_0x15b39e,_0x50b4bf={'ThfYS':_0x1f5fff['bqCCQ'],'rKLZo':'Hide\x20MACO\x20Calculation\x20Breakdown'};_0x7c720c[_0x327347(0x2da)]();const _0x4603de=document[_0x327347(0x1e9)]('#macoForTrains\x20.train-content.collapsed'),_0x59f1d1=[];_0x4603de['forEach'](_0x14c6a7=>{const _0x4f248d=_0x327347,_0x54bd44=_0x14c6a7['id'][_0x4f248d(0x346)](/content-pm-(\d+)/);if(_0x54bd44){_0x59f1d1['push'](_0x54bd44[0x1]),_0x14c6a7[_0x4f248d(0x213)][_0x4f248d(0x33e)](_0x50b4bf[_0x4f248d(0x279)]);const _0x2e0f74=document[_0x4f248d(0x255)](_0x4f248d(0x135)+_0x54bd44[0x1]);_0x2e0f74&&(_0x2e0f74[_0x4f248d(0x236)]='▼');}});const _0x18cd2d=document[_0x327347(0x1e9)](_0x1f5fff[_0x327347(0x143)]),_0x54ab24=[];_0x18cd2d['forEach'](_0x134651=>{const _0x45d711=_0x327347,_0x33b847=_0x134651['id'][_0x45d711(0x346)](/maco-breakdown-details-(\d+)/);if(_0x33b847){_0x54ab24[_0x45d711(0x2b2)](_0x33b847[0x1]),_0x134651['classList'][_0x45d711(0x33e)](_0x45d711(0x362));const _0x180167=document['getElementById']('breakdown-toggle-btn-'+_0x33b847[0x1]);_0x180167&&(_0x180167[_0x45d711(0x236)]=_0x50b4bf['rKLZo']);}}),_0x1f5fff['pkmPW'](setTimeout,()=>{const _0x1e0257=_0x327347;window[_0x1e0257(0x1a6)](),setTimeout(()=>{const _0x58ee6b=_0x1e0257,_0xedefb0={'ATLlu':_0x58ee6b(0x1a3)};_0x59f1d1[_0x58ee6b(0x14f)](_0x31d4f8=>{const _0x3126f5=_0x58ee6b,_0x336601=document['getElementById'](_0x3126f5(0x240)+_0x31d4f8),_0x25aecf=document[_0x3126f5(0x255)](_0x3126f5(0x135)+_0x31d4f8);_0x336601&&_0x336601[_0x3126f5(0x213)]['add'](_0xedefb0[_0x3126f5(0x16d)]),_0x25aecf&&(_0x25aecf[_0x3126f5(0x236)]='▶');}),_0x54ab24['forEach'](_0x18c75a=>{const _0x3b2505=_0x58ee6b,_0x31fc62=document[_0x3b2505(0x255)](_0x3b2505(0x2d0)+_0x18c75a),_0x28e8f7=document[_0x3b2505(0x255)]('breakdown-toggle-btn-'+_0x18c75a);_0x31fc62&&_0x31fc62[_0x3b2505(0x213)]['add'](_0x3b2505(0x362)),_0x28e8f7&&(_0x28e8f7['textContent']=_0x3b2505(0x322));});},0x3e8);},0xc8);})):_0x1f5fff['hyfNe'](_0x1f5fff[_0x15b39e(0x2ef)],_0x21b9cb)?(window[_0x15b39e(0x1c5)]=_0x1659aa,import(_0x15b39e(0x2ca))[_0x15b39e(0x168)](_0x160fd7=>{const _0x3aeb7c=_0x15b39e,_0x5f4b21={'bOCiI':_0x3aeb7c(0x1a3),'yvFtT':function(_0x28b7f6,_0x41e6b0,_0x37ebc9){const _0x5d914b=_0x3aeb7c;return _0x1f5fff[_0x5d914b(0x187)](_0x28b7f6,_0x41e6b0,_0x37ebc9);}};_0x160fd7[_0x3aeb7c(0x1aa)]();const _0x595f55=document['querySelectorAll'](_0x1f5fff[_0x3aeb7c(0x2af)]),_0x7ca719=[];_0x595f55['forEach'](_0x4cbb23=>{const _0x4036f6=_0x3aeb7c,_0x3b0669=_0x4cbb23['id'][_0x4036f6(0x346)](/content-dm-(\d+)/);if(_0x3b0669){_0x7ca719[_0x4036f6(0x2b2)](_0x3b0669[0x1]),_0x4cbb23[_0x4036f6(0x213)][_0x4036f6(0x33e)](_0x5f4b21['bOCiI']);const _0x27b7c8=document[_0x4036f6(0x255)](_0x4036f6(0x234)+_0x3b0669[0x1]);_0x27b7c8&&(_0x27b7c8[_0x4036f6(0x236)]='▼');}}),_0x1f5fff[_0x3aeb7c(0x2ff)](setTimeout,()=>{const _0x251e44=_0x3aeb7c,_0x2d0d36={'JPEcc':_0x5f4b21[_0x251e44(0x335)]};window['print'](),_0x5f4b21[_0x251e44(0x319)](setTimeout,()=>{const _0x5d39a7=_0x251e44,_0x56f750={'qoGUD':_0x2d0d36[_0x5d39a7(0x152)]};_0x7ca719[_0x5d39a7(0x14f)](_0x383eb7=>{const _0x512f74=_0x5d39a7,_0x40fbe0=document[_0x512f74(0x255)](_0x512f74(0x342)+_0x383eb7),_0x23965e=document[_0x512f74(0x255)](_0x512f74(0x234)+_0x383eb7);_0x40fbe0&&_0x40fbe0[_0x512f74(0x213)][_0x512f74(0x14a)](_0x56f750[_0x512f74(0x1d7)]),_0x23965e&&(_0x23965e['textContent']='▶');});},0x3e8);},0xc8);})[_0x15b39e(0x27f)](_0x566c52=>{const _0x1bcd23=_0x15b39e;console[_0x1bcd23(0x17b)](_0x1f5fff['kCahk'],_0x566c52),window[_0x1bcd23(0x1a6)]();})['finally'](()=>{const _0x3b1b1a=_0x15b39e;_0x1f5fff[_0x3b1b1a(0x2a1)](setTimeout,()=>{const _0xa1d74e=_0x3b1b1a;window[_0xa1d74e(0x1c5)]=null,import(_0xa1d74e(0x2ca))[_0xa1d74e(0x168)](_0x33151c=>_0x33151c[_0xa1d74e(0x1aa)]())['catch'](()=>{});},0x4b0);})):_0x1f5fff['gPhqz']===_0x21b9cb?(window[_0x15b39e(0x1c5)]=_0x1659aa,console[_0x15b39e(0x1ad)](_0x1f5fff['HdBQe'],_0x1659aa),import(_0x1f5fff[_0x15b39e(0x2f4)])[_0x15b39e(0x168)](_0x33632e=>{const _0x57dda7=_0x15b39e;_0x33632e[_0x57dda7(0x281)](),setTimeout(()=>{const _0x48eb71=_0x57dda7,_0x596cbc=document[_0x48eb71(0x255)](_0x1f5fff[_0x48eb71(0x307)]),_0x466eec=document[_0x48eb71(0x255)]('noTrainSummaryMessage');if(console[_0x48eb71(0x1ad)](_0x1f5fff[_0x48eb71(0x138)],_0x596cbc?_0x596cbc[_0x48eb71(0x13b)]['display']:_0x48eb71(0x1cb)),console[_0x48eb71(0x1ad)](_0x1f5fff[_0x48eb71(0x241)],_0x466eec?_0x466eec[_0x48eb71(0x13b)][_0x48eb71(0x329)]:_0x1f5fff[_0x48eb71(0x251)]),console['log'](_0x1f5fff[_0x48eb71(0x163)],!!_0x596cbc&&_0x1f5fff[_0x48eb71(0x21f)](_0x596cbc[_0x48eb71(0x257)][_0x48eb71(0x1af)],0x0)),!_0x596cbc||_0x1f5fff[_0x48eb71(0x341)](_0x48eb71(0x2d1),_0x596cbc[_0x48eb71(0x13b)]['display']))return console[_0x48eb71(0x161)](_0x1f5fff[_0x48eb71(0x344)]),void _0x1f5fff[_0x48eb71(0x29c)](alert,_0x1f5fff[_0x48eb71(0x238)]);window[_0x48eb71(0x1a6)](),_0x1f5fff[_0x48eb71(0x2a1)](setTimeout,()=>{window['printSelectedTrain']=null,_0x33632e['renderTrainSummary']();},0x3e8);},0x1f4);})['catch'](_0x4f098e=>{const _0x269361=_0x15b39e;console[_0x269361(0x17b)](_0x1f5fff[_0x269361(0x369)],_0x4f098e),_0x1f5fff[_0x269361(0x301)](alert,_0x1f5fff['JQuLG'](_0x1f5fff[_0x269361(0x343)],_0x4f098e[_0x269361(0x312)]));})):setTimeout(()=>{window['print']();},0x64);}export function toggleColumn(_0x5a5817,_0x3c54a8){const _0x17762b=a12_0x35cd83,_0x1ce6c2={'FNVMw':function(_0xb7d1af,_0x2119af){return _0xb7d1af===_0x2119af;},'qJDRZ':_0x17762b(0x134),'GGzji':'productRegister','rwflr':'worstCaseProducts','xfxCS':function(_0x20aa53,_0x1009ea){return _0x20aa53!==_0x1009ea;},'rIRGR':function(_0x556271,_0x3f2d90){return _0x556271(_0x3f2d90);},'mNxQE':'./worstCaseView.js'};if(_0x17762b(0x1e3)===_0x5a5817||_0x1ce6c2['FNVMw'](_0x1ce6c2[_0x17762b(0x195)],_0x5a5817)){[_0x1ce6c2[_0x17762b(0x237)],_0x1ce6c2[_0x17762b(0x2e9)]]['forEach'](_0x3e9701=>{const _0x3d6667=_0x17762b;document[_0x3d6667(0x1e9)]('#'+_0x3e9701+_0x3d6667(0x2e3)+_0x3e9701+_0x3d6667(0x1cf))[_0x3d6667(0x14f)](_0x2d3f80=>{const _0x4e3d38=_0x3d6667;_0x2d3f80['classList'][_0x4e3d38(0x2c8)](_0x4e3d38(0x210)+_0x5a5817);}),document[_0x3d6667(0x1e9)]('#'+_0x3e9701+_0x3d6667(0x311)+_0x3e9701+'\x20.train-content-inner')[_0x3d6667(0x14f)](_0xfa4d69=>{const _0x504537=_0x3d6667;_0xfa4d69&&_0xfa4d69[_0x504537(0x213)][_0x504537(0x2c8)](_0x504537(0x210)+_0x5a5817);});});const _0x46d52d=_0x1ce6c2[_0x17762b(0x267)](null,document[_0x17762b(0x203)](_0x17762b(0x351)+_0x5a5817));localStorage[_0x17762b(0x347)](_0x17762b(0x31b)+_0x5a5817+_0x17762b(0x22a),_0x46d52d),_0x1ce6c2[_0x17762b(0x14c)](updateToggleIcons,_0x1ce6c2[_0x17762b(0x237)]),_0x1ce6c2[_0x17762b(0x14c)](updateToggleIcons,_0x17762b(0x1f0)),import('./worstCaseView.js')[_0x17762b(0x168)](_0xb1baf0=>{const _0x48b931=_0x17762b;_0xb1baf0[_0x48b931(0x27c)]();}),import(_0x1ce6c2[_0x17762b(0x220)])[_0x17762b(0x168)](_0x5333b5=>{const _0x4ac3f0=_0x17762b;_0x5333b5[_0x4ac3f0(0x144)]&&_0x5333b5[_0x4ac3f0(0x144)]();});}else{document['querySelectorAll']('#'+_0x3c54a8+'\x20.mainTable,\x20#'+_0x3c54a8+_0x17762b(0x1cf))[_0x17762b(0x14f)](_0x4df023=>{const _0x142063=_0x17762b;_0x4df023['classList'][_0x142063(0x2c8)](_0x142063(0x210)+_0x5a5817);});const _0x1629b1=null!==document[_0x17762b(0x203)]('#'+_0x3c54a8+_0x17762b(0x35d)+_0x5a5817);localStorage['setItem'](_0x3c54a8+'-'+_0x5a5817+_0x17762b(0x22a),_0x1629b1),_0x1ce6c2[_0x17762b(0x14c)](updateToggleIcons,_0x3c54a8);}}export function toggleColumnVisibilityDropdown(){const _0x1cad23=a12_0x35cd83,_0x4b3386={'DrTEo':_0x1cad23(0x178),'iJrVs':_0x1cad23(0x362),'TiQpO':'click','wDETZ':_0x1cad23(0x327)},_0x3bdc2b=document[_0x1cad23(0x255)](_0x4b3386['wDETZ']);_0x3bdc2b['classList'][_0x1cad23(0x2c8)](_0x4b3386[_0x1cad23(0x21b)]),_0x3bdc2b[_0x1cad23(0x213)][_0x1cad23(0x2e7)](_0x4b3386['iJrVs'])||document[_0x1cad23(0x18f)](_0x1cad23(0x2a8),function _0x5a1e78(_0x5409e0){const _0x3abce6=_0x1cad23;_0x5409e0[_0x3abce6(0x246)][_0x3abce6(0x25e)](_0x3abce6(0x2df))||_0x5409e0['target'][_0x3abce6(0x25e)](_0x4b3386[_0x3abce6(0x2fe)])||(_0x3bdc2b[_0x3abce6(0x213)][_0x3abce6(0x14a)](_0x4b3386[_0x3abce6(0x21b)]),document[_0x3abce6(0x35a)](_0x4b3386[_0x3abce6(0x2f0)],_0x5a1e78));});}export function updateToggleIcons(_0x1d8be3){const _0x3ac92f=a12_0x35cd83,_0x11dfc8={'rJTvf':_0x3ac92f(0x201),'FskXr':_0x3ac92f(0x1bf),'ofnVN':_0x3ac92f(0x1f0),'iCoSD':_0x3ac92f(0x21e),'AbERU':_0x3ac92f(0x156),'oayzh':function(_0xbd517f,_0x3539c5){return _0xbd517f===_0x3539c5;},'aEkOR':function(_0x25f6ac,_0x4619fb){return _0x25f6ac===_0x4619fb;},'Rbgfo':'true','ahrcM':function(_0xf3c367,_0x4616e0){return _0xf3c367&&_0x4616e0;},'YwJsn':function(_0x3e7f7c,_0xaeb482){return _0x3e7f7c===_0xaeb482;},'DrgyE':_0x3ac92f(0x30e),'fAGQN':_0x3ac92f(0x2f7),'pmFsC':'Hide\x20PDE','WTCCV':_0x3ac92f(0x33b)},_0x470353=document[_0x3ac92f(0x255)](_0x1d8be3);if(!_0x470353)return;let _0x263147,_0x88b8fc;if(_0x11dfc8[_0x3ac92f(0x1b3)]===_0x1d8be3){const _0x24de83=localStorage['getItem'](_0x11dfc8['iCoSD']),_0x1727b8=localStorage[_0x3ac92f(0x235)](_0x11dfc8[_0x3ac92f(0x27a)]);if(null===_0x24de83&&_0x11dfc8[_0x3ac92f(0x1b8)](null,_0x1727b8))_0x263147=!0x1,_0x88b8fc=!0x1;else{const _0x5a1a79=_0x11dfc8[_0x3ac92f(0x21c)](_0x11dfc8[_0x3ac92f(0x1f1)],_0x24de83),_0x12250a=_0x11dfc8[_0x3ac92f(0x1b8)](_0x11dfc8[_0x3ac92f(0x1f1)],_0x1727b8);_0x11dfc8[_0x3ac92f(0x363)](_0x5a1a79,_0x12250a)?(_0x263147=!0x1,_0x88b8fc=!0x0):(_0x263147=_0x5a1a79,_0x88b8fc=_0x12250a);}}else{const _0x526625=localStorage[_0x3ac92f(0x235)](_0x1d8be3+'-pdeHidden'),_0x4b1958=localStorage[_0x3ac92f(0x235)](_0x1d8be3+_0x3ac92f(0x1d1));_0x263147=_0x11dfc8[_0x3ac92f(0x1f1)]===_0x526625,_0x88b8fc=_0x11dfc8[_0x3ac92f(0x2eb)](_0x11dfc8['Rbgfo'],_0x4b1958);}const _0x21ce12=_0x470353['querySelector'](_0x3ac92f(0x18c)),_0x57d7ad=_0x470353['querySelector'](_0x11dfc8[_0x3ac92f(0x26d)]);_0x21ce12&&(_0x21ce12['innerHTML']=_0x263147?_0x11dfc8[_0x3ac92f(0x1a5)]:_0x11dfc8[_0x3ac92f(0x216)]),_0x57d7ad&&(_0x57d7ad[_0x3ac92f(0x257)]=_0x88b8fc?_0x3ac92f(0x272):_0x11dfc8[_0x3ac92f(0x24a)]),document[_0x3ac92f(0x1e9)]('#'+_0x1d8be3+_0x3ac92f(0x2e3)+_0x1d8be3+_0x3ac92f(0x1cf))[_0x3ac92f(0x14f)](_0xb66e06=>{const _0x2ff0c2=_0x3ac92f;_0xb66e06&&(_0xb66e06[_0x2ff0c2(0x213)]['toggle'](_0x11dfc8[_0x2ff0c2(0x345)],_0x263147),_0xb66e06[_0x2ff0c2(0x213)][_0x2ff0c2(0x2c8)](_0x11dfc8[_0x2ff0c2(0x153)],_0x88b8fc));}),document[_0x3ac92f(0x1e9)]('#'+_0x1d8be3+_0x3ac92f(0x311)+_0x1d8be3+_0x3ac92f(0x22f))[_0x3ac92f(0x14f)](_0x53a90e=>{const _0x370df1=_0x3ac92f;_0x53a90e&&(_0x53a90e[_0x370df1(0x213)]['toggle'](_0x370df1(0x201),_0x263147),_0x53a90e['classList'][_0x370df1(0x2c8)](_0x11dfc8[_0x370df1(0x153)],_0x88b8fc));});}export function exportToExcel(){const _0x4a1a6d=a12_0x35cd83,_0xde4494={'FWFDO':function(_0x14942a,_0x5b6228){return _0x14942a(_0x5b6228);},'ULPht':function(_0x1e528f,_0x1db8d2){return _0x1e528f+_0x1db8d2;},'DDUpP':_0x4a1a6d(0x1c7),'unBPS':function(_0x4c08f5,_0x461d33){return _0x4c08f5(_0x461d33);},'tLNjK':function(_0xf19ee2,_0x1c60d8){return _0xf19ee2===_0x1c60d8;},'xnyhM':function(_0x2f3d44){return _0x2f3d44();},'JXaaq':function(_0x13e1a0,_0x5356a5,_0x2dd11c){return _0x13e1a0(_0x5356a5,_0x2dd11c);},'DixON':_0x4a1a6d(0x30f),'woOPc':_0x4a1a6d(0x28f),'PKmJo':'Error\x20exporting\x20to\x20Excel:','hELPd':function(_0x1990b5,_0x4d144a,_0x343ece){return _0x1990b5(_0x4d144a,_0x343ece);},'JozhY':_0x4a1a6d(0x133),'xWeAY':_0x4a1a6d(0x354)};showLoader(),import(_0x4a1a6d(0x200))[_0x4a1a6d(0x168)](_0x331bad=>{const _0xe717be=_0x4a1a6d,{getProductTrainId:_0x250789,calculateScores:_0x676c0c}=_0x331bad,_0x81e08d=[];if(a12_0x2a5c73[_0xe717be(0x321)][_0xe717be(0x14f)](_0x46f1a3=>{const _0xa7bda4=_0xe717be,_0x3051b3={'bpakJ':function(_0x3991ce,_0x270be6){const _0x1ccef1=a12_0x4a84;return _0xde4494[_0x1ccef1(0x2c9)](_0x3991ce,_0x270be6);}};let _0xf6e442='No';_0x46f1a3['isCritical']&&(_0xf6e442=_0xde4494[_0xa7bda4(0x18b)](_0xde4494['DDUpP'],_0x46f1a3[_0xa7bda4(0x293)]?':\x20'+_0x46f1a3[_0xa7bda4(0x293)]:''));const _0x39ae0a=_0xde4494[_0xa7bda4(0x1b9)](_0x250789,_0x46f1a3),_0x449577=_0x46f1a3['date']?new Date(_0x46f1a3[_0xa7bda4(0x284)])['toLocaleDateString']():'';_0x81e08d[_0xa7bda4(0x2b2)]({'Date':_0x449577,'Product\x20Code':_0x46f1a3[_0xa7bda4(0x198)],'Product\x20Name':_0x46f1a3[_0xa7bda4(0x1fb)],'Train\x20No.':_0x39ae0a,'Dosage\x20Form':_0x46f1a3[_0xa7bda4(0x181)]||'','Batch\x20Size\x20(Kg)':_0x46f1a3[_0xa7bda4(0x23d)],'Special\x20Case\x20Product':_0xf6e442,'Active\x20Ingredient':'','Solubility':'','Therapeutic\x20Dose\x20(mg/day)':'','Cleanability':'','PDE\x20(µg/day)':'','LD50\x20(mg/kg)':'','Solubility\x20Score':'','Therapeutic\x20Dose\x20Score':'','Cleanability\x20Score':'','Toxicity\x20Score':'','RPN':'','RPN\x20Rating':''}),_0x46f1a3[_0xa7bda4(0x217)][_0xa7bda4(0x14f)](_0x3f812c=>{const _0x2328a5=_0xa7bda4,_0x287127=_0x3051b3[_0x2328a5(0x14d)](_0x676c0c,_0x3f812c);_0x81e08d[_0x2328a5(0x2b2)]({'Date':'','Product\x20Code':'','Product\x20Name':'\x20\x20└─\x20'+_0x3f812c[_0x2328a5(0x1fb)],'Train\x20No.':'','Dosage\x20Form':'','Batch\x20Size\x20(Kg)':'','Special\x20Case\x20Product':'','Active\x20Ingredient':_0x3f812c[_0x2328a5(0x1fb)],'Solubility':_0x3f812c['solubility']||'','Therapeutic\x20Dose\x20(mg/day)':_0x3f812c[_0x2328a5(0x262)]||'','Cleanability':_0x3f812c[_0x2328a5(0x323)]||'','PDE\x20(µg/day)':_0x3f812c['pde']||'','LD50\x20(mg/kg)':_0x3f812c['ld50']||'','Solubility\x20Score':_0x287127[_0x2328a5(0x1d8)]||'','Therapeutic\x20Dose\x20Score':_0x287127[_0x2328a5(0x186)]||'','Cleanability\x20Score':_0x287127[_0x2328a5(0x1f9)]||'','Toxicity\x20Score':_0x287127['pdeScore']||_0x287127[_0x2328a5(0x2fd)]||'','RPN':_0x287127[_0x2328a5(0x196)],'RPN\x20Rating':_0x287127[_0x2328a5(0x165)]});});}),_0xde4494[_0xe717be(0x25a)](0x0,_0x81e08d[_0xe717be(0x1af)]))return _0xde4494[_0xe717be(0x149)](hideLoader),void _0xde4494[_0xe717be(0x2f2)](showCustomAlert,_0xe717be(0x2e5),'There\x20is\x20no\x20data\x20in\x20the\x20current\x20view\x20to\x20export.');const _0x1e765d=XLSX['utils'][_0xe717be(0x2c3)](_0x81e08d),_0x451196=XLSX[_0xe717be(0x1d9)][_0xe717be(0x1ea)]();XLSX[_0xe717be(0x1d9)][_0xe717be(0x361)](_0x451196,_0x1e765d,_0xe717be(0x190));const _0x2bea45=Object[_0xe717be(0x2b1)](_0x81e08d[0x0])['map'](_0x45fc0d=>({'wch':Math[_0xe717be(0x1bb)](_0x45fc0d['length'],..._0x81e08d['map'](_0x30872c=>String(_0x30872c[_0x45fc0d]||'')[_0xe717be(0x1af)]))+0x2}));_0x1e765d[_0xde4494[_0xe717be(0x222)]]=_0x2bea45,XLSX['writeFile'](_0x451196,_0xde4494[_0xe717be(0x305)]),_0xde4494[_0xe717be(0x149)](hideLoader);})[_0x4a1a6d(0x27f)](_0x4807f0=>{const _0x480a5e=_0x4a1a6d;console[_0x480a5e(0x17b)](_0xde4494[_0x480a5e(0x2cc)],_0x4807f0),hideLoader(),_0xde4494[_0x480a5e(0x245)](showCustomAlert,_0xde4494['JozhY'],_0xde4494[_0x480a5e(0x176)]);});}export function exportAllToJson(){const _0x349c76=a12_0x35cd83,_0x29974b={'tNVHA':'maco_data_export.json','hDLxA':function(_0x3d182a,_0x56a32a,_0x136f5){return _0x3d182a(_0x56a32a,_0x136f5);},'iSyMU':function(_0x5e0c8d,_0x3d6956){return _0x5e0c8d+_0x3d6956;},'AXXic':_0x349c76(0x185),'DYhwO':function(_0x5c7281){return _0x5c7281();}};showLoader();try{const _0x505031={'exportDate':new Date()[_0x349c76(0x17e)](),'scoringCriteria':a12_0x2a5c73[_0x349c76(0x154)],'products':a12_0x2a5c73[_0x349c76(0x321)],'machines':a12_0x2a5c73[_0x349c76(0x2d9)],'detergentIngredients':a12_0x2a5c73[_0x349c76(0x1d6)]},_0x555669=JSON[_0x349c76(0x1ec)](_0x505031,null,0x2),_0x2e5f83=new Blob([_0x555669],{'type':_0x349c76(0x25b)}),_0x3e03a2=URL['createObjectURL'](_0x2e5f83),_0x130280=document[_0x349c76(0x1cd)]('a');_0x130280[_0x349c76(0x21d)]=_0x3e03a2,_0x130280['download']=_0x29974b['tNVHA'],document[_0x349c76(0x2a9)][_0x349c76(0x2db)](_0x130280),_0x130280[_0x349c76(0x2a8)](),document[_0x349c76(0x2a9)][_0x349c76(0x28a)](_0x130280),URL['revokeObjectURL'](_0x3e03a2);}catch(_0x32dffe){_0x29974b[_0x349c76(0x1e6)](showCustomAlert,'Error',_0x29974b[_0x349c76(0x2d8)](_0x29974b['AXXic'],_0x32dffe[_0x349c76(0x312)]));}finally{_0x29974b[_0x349c76(0x1a0)](hideLoader);}}export function importFromJson(_0x399615){const _0x2b791a=a12_0x35cd83,_0x37c809={'XylBm':function(_0x366511){return _0x366511();},'lHWUS':function(_0x2d08c7,_0x79f469,_0x5f2af8){return _0x2d08c7(_0x79f469,_0x5f2af8);},'qZcba':_0x2b791a(0x1e8),'etJcj':_0x2b791a(0x133),'wzgyy':_0x2b791a(0x1d0)},_0x383f12=_0x399615[_0x2b791a(0x246)][_0x2b791a(0x2f9)][0x0];if(!_0x383f12)return;const _0x44648d=new FileReader();_0x44648d[_0x2b791a(0x250)]=function(_0x3f91c0){const _0x206852=_0x2b791a;try{const _0x2e0a0c=JSON['parse'](_0x3f91c0[_0x206852(0x246)][_0x206852(0x169)]);_0x2e0a0c&&_0x2e0a0c[_0x206852(0x321)]&&_0x2e0a0c[_0x206852(0x154)]&&_0x2e0a0c[_0x206852(0x2d9)]?(a12_0x2a5c73['setProducts'](_0x2e0a0c[_0x206852(0x321)]),a12_0x2a5c73[_0x206852(0x35f)](_0x2e0a0c['machines']),a12_0x2a5c73['setScoringCriteria'](_0x2e0a0c[_0x206852(0x154)]),_0x2e0a0c[_0x206852(0x1d6)]&&a12_0x2a5c73[_0x206852(0x2d6)](_0x2e0a0c[_0x206852(0x1d6)]),_0x37c809[_0x206852(0x14b)](saveStateForUndo),_0x37c809[_0x206852(0x14b)](a12_0x1182c2),_0x37c809[_0x206852(0x2c2)](showCustomAlert,'Success',_0x37c809[_0x206852(0x17f)])):_0x37c809[_0x206852(0x2c2)](showCustomAlert,_0x37c809[_0x206852(0x33a)],_0x37c809[_0x206852(0x24d)]);}catch(_0xb9e11f){_0x37c809[_0x206852(0x2c2)](showCustomAlert,_0x37c809['etJcj'],'Failed\x20to\x20parse\x20JSON\x20file.');}finally{_0x399615[_0x206852(0x246)]['value']='';}},_0x44648d[_0x2b791a(0x2b9)](_0x383f12);}export function toggleOtherProductType(_0x424d66,_0x18efb5){const _0x8f287d=a12_0x35cd83,_0x2356e2={'JRvik':_0x8f287d(0x325),'wTvfn':function(_0x3ddd60,_0x89f483){return _0x3ddd60===_0x89f483;},'LepJF':_0x8f287d(0x306)},_0x511659=document['getElementById'](_0x18efb5),_0x183657=_0x511659[_0x8f287d(0x203)](_0x2356e2['JRvik']);_0x2356e2[_0x8f287d(0x174)](_0x8f287d(0x20d),_0x424d66['value'])?(_0x511659[_0x8f287d(0x13b)]['display']=_0x2356e2['LepJF'],_0x183657[_0x8f287d(0x20f)]=!0x0):(_0x511659[_0x8f287d(0x13b)]['display']=_0x8f287d(0x2d1),_0x183657[_0x8f287d(0x20f)]=!0x1,_0x183657['value']='');}export function toggleOtherMachineStage(_0x459bdc,_0x510412){const _0x3b69b5=a12_0x35cd83,_0x1d4d92={'QySWZ':_0x3b69b5(0x325),'NqicN':function(_0x593128,_0x3d33f2){return _0x593128===_0x3d33f2;},'SlIWO':_0x3b69b5(0x20d),'buDkH':'block','AzpBM':_0x3b69b5(0x2d1)},_0x21d4da=document['getElementById'](_0x510412),_0x5636c4=_0x21d4da[_0x3b69b5(0x203)](_0x1d4d92['QySWZ']);_0x1d4d92[_0x3b69b5(0x151)](_0x1d4d92[_0x3b69b5(0x1a8)],_0x459bdc['value'])?(_0x21d4da[_0x3b69b5(0x13b)][_0x3b69b5(0x329)]=_0x1d4d92[_0x3b69b5(0x1f6)],_0x5636c4[_0x3b69b5(0x20f)]=!0x0):(_0x21d4da[_0x3b69b5(0x13b)][_0x3b69b5(0x329)]=_0x1d4d92[_0x3b69b5(0x271)],_0x5636c4['required']=!0x1,_0x5636c4[_0x3b69b5(0x130)]='');}export function toggleOtherMachineGroup(_0x4f4689,_0x1490e2){const _0x207958=a12_0x35cd83,_0x51234c={'aZpBO':function(_0x42fc37,_0x44e66b){return _0x42fc37===_0x44e66b;},'WBVHI':_0x207958(0x20d),'gzREL':'block','Zfzby':_0x207958(0x2d1)},_0x163e59=document['getElementById'](_0x1490e2),_0x24579f=_0x163e59[_0x207958(0x203)](_0x207958(0x325));_0x51234c[_0x207958(0x273)](_0x51234c[_0x207958(0x183)],_0x4f4689[_0x207958(0x130)])?(_0x163e59[_0x207958(0x13b)][_0x207958(0x329)]=_0x51234c['gzREL'],_0x24579f['required']=!0x0):(_0x163e59[_0x207958(0x13b)][_0x207958(0x329)]=_0x51234c[_0x207958(0x140)],_0x24579f[_0x207958(0x20f)]=!0x1,_0x24579f[_0x207958(0x130)]='');}export function clampSafetyFactor(_0x4fc148,_0x5487dd){const _0x4dbd36=a12_0x35cd83,_0x495d7a={'mgxoy':function(_0x309c07,_0x52f95b){return _0x309c07(_0x52f95b);},'uFKNh':function(_0x4bf75a,_0x421adc){return _0x4bf75a<_0x421adc;},'YhnFF':function(_0x538731,_0x2fda16){return _0x538731>_0x2fda16;},'ppKYw':function(_0x34ea0d,_0x441203){return _0x34ea0d!==_0x441203;},'YlCaL':function(_0xedffc9,_0x4d905e){return _0xedffc9(_0x4d905e);},'uPUkL':_0x4dbd36(0x30a),'Ebroe':function(_0x420de4,_0x5610a5){return _0x420de4(_0x5610a5);}},_0x2d85ea=_0x495d7a[_0x4dbd36(0x2fc)](parseFloat,_0x4fc148['min']),_0x2462f9=_0x495d7a[_0x4dbd36(0x2fc)](parseFloat,_0x4fc148[_0x4dbd36(0x1bb)]);let _0x4d6b06=parseFloat(_0x4fc148[_0x4dbd36(0x130)]);_0x495d7a[_0x4dbd36(0x2fc)](isNaN,_0x4d6b06)&&(_0x4d6b06=_0x2d85ea),_0x495d7a['uFKNh'](_0x4d6b06,_0x2d85ea)?_0x4d6b06=_0x2d85ea:_0x495d7a[_0x4dbd36(0x315)](_0x4d6b06,_0x2462f9)&&(_0x4d6b06=_0x2462f9),_0x495d7a[_0x4dbd36(0x1e7)](_0x495d7a[_0x4dbd36(0x2bc)](parseFloat,_0x4fc148['value']),_0x4d6b06)&&(_0x4fc148[_0x4dbd36(0x130)]=_0x4d6b06),_0x4fc148['id'][_0x4dbd36(0x157)](_0x495d7a['uPUkL'])?recalculateProductMacoForTrain(_0x5487dd):_0x4fc148['id'][_0x4dbd36(0x157)](_0x4dbd36(0x337))&&_0x495d7a[_0x4dbd36(0x32c)](recalculateDetergentMacoForTrain,_0x5487dd);}export function toggleTrain(_0x43d942){const _0x57a3cc=a12_0x35cd83,_0xe7acc7={'AHDFP':function(_0x1c5ab2,_0x359e6d){return _0x1c5ab2&&_0x359e6d;},'gLdpq':'collapsed'},_0x3be3dd=document['getElementById'](_0x57a3cc(0x148)+_0x43d942),_0x36c1b4=document[_0x57a3cc(0x255)](_0x57a3cc(0x206)+_0x43d942);_0xe7acc7[_0x57a3cc(0x1b4)](_0x3be3dd,_0x36c1b4)&&(_0x3be3dd[_0x57a3cc(0x213)][_0x57a3cc(0x2e7)](_0xe7acc7[_0x57a3cc(0x15c)])?(_0x3be3dd['classList']['remove'](_0xe7acc7[_0x57a3cc(0x15c)]),_0x36c1b4[_0x57a3cc(0x236)]='▼'):(_0x3be3dd[_0x57a3cc(0x213)][_0x57a3cc(0x14a)](_0xe7acc7['gLdpq']),_0x36c1b4[_0x57a3cc(0x236)]='▶'));}export function toggleMacoBreakdown(_0x564fc9){const _0x31c51c=a12_0x35cd83,_0xb1ae7={'KFWJZ':_0x31c51c(0x362),'fgFTl':'Hide\x20MACO\x20Calculation\x20Breakdown','FGmzd':_0x31c51c(0x322)},_0x5e6887=document[_0x31c51c(0x255)](_0x31c51c(0x2d0)+_0x564fc9),_0x745bf1=document[_0x31c51c(0x255)](_0x31c51c(0x25c)+_0x564fc9);_0x5e6887[_0x31c51c(0x213)]['contains'](_0x31c51c(0x362))?(_0x5e6887[_0x31c51c(0x213)][_0x31c51c(0x33e)](_0xb1ae7[_0x31c51c(0x182)]),_0x745bf1['textContent']=_0xb1ae7[_0x31c51c(0x1c9)]):(_0x5e6887[_0x31c51c(0x213)][_0x31c51c(0x14a)](_0xb1ae7['KFWJZ']),_0x745bf1[_0x31c51c(0x236)]=_0xb1ae7[_0x31c51c(0x172)]);}export function exportWorstCaseToExcel(_0x292e32=a12_0x35cd83(0x171)){const _0x6b2fe6=a12_0x35cd83,_0x15689a={'OjsxG':function(_0x353f18,_0x14ec71){return _0x353f18(_0x14ec71);},'eoFqV':function(_0x154de6,_0x3c22cd){return _0x154de6!==_0x3c22cd;},'OYlEy':'N/A','TizVw':function(_0x17bdd9,_0x40a1b9){return _0x17bdd9>_0x40a1b9;},'HsyeV':_0x6b2fe6(0x1c7),'pfLWj':function(_0x1a2b0a,_0x4e3365){return _0x1a2b0a===_0x4e3365;},'AAhNd':function(_0x52afa2,_0x6f7922,_0x415ec2){return _0x52afa2(_0x6f7922,_0x415ec2);},'bTwdG':_0x6b2fe6(0x2e5),'TTSrd':function(_0x4674d1){return _0x4674d1();},'itBtl':function(_0x2d60bb,_0x54039d){return _0x2d60bb===_0x54039d;},'NwStw':function(_0x4abd44){return _0x4abd44();},'pvvon':_0x6b2fe6(0x367),'aTYKt':_0x6b2fe6(0x30f),'pyqAf':'all','NSwnl':_0x6b2fe6(0x200)};_0x15689a['NwStw'](showLoader),import(_0x15689a['NSwnl'])[_0x6b2fe6(0x168)](_0x4dd6e2=>{const _0x5e6dc5=_0x6b2fe6,{getProductTrainId:_0x4049b0,calculateScores:_0x2e3059,getToxicityPreference:_0x45cd12}=_0x4dd6e2,_0x3ba96d=[];let _0x26e6a3=a12_0x2a5c73['viewProducts'][_0x5e6dc5(0x1f0)]||a12_0x2a5c73[_0x5e6dc5(0x321)];if(_0x15689a[_0x5e6dc5(0x35b)](0x0,_0x26e6a3['length']))return hideLoader(),void _0x15689a['AAhNd'](showCustomAlert,_0x5e6dc5(0x2e5),_0x5e6dc5(0x2aa));const _0x552d1a={};_0x26e6a3['forEach'](_0x42f2fe=>{const _0x128cb8=_0x5e6dc5,_0x512682=_0x15689a['OjsxG'](_0x4049b0,_0x42f2fe);_0x15689a['eoFqV'](_0x15689a['OYlEy'],_0x512682)&&(_0x552d1a[_0x512682]||(_0x552d1a[_0x512682]=[]),_0x552d1a[_0x512682][_0x128cb8(0x2b2)](_0x42f2fe));});let _0x410406=_0x552d1a;if(_0x5e6dc5(0x171)!==_0x292e32&&(_0x410406={},Array[_0x5e6dc5(0x339)](_0x292e32)?_0x292e32[_0x5e6dc5(0x14f)](_0x36f1fc=>{_0x552d1a[_0x36f1fc]&&(_0x410406[_0x36f1fc]=_0x552d1a[_0x36f1fc]);}):_0x552d1a[_0x292e32]&&(_0x410406={[_0x292e32]:_0x552d1a[_0x292e32]}),_0x15689a['pfLWj'](0x0,Object[_0x5e6dc5(0x2b1)](_0x410406)[_0x5e6dc5(0x1af)])))return hideLoader(),void _0x15689a[_0x5e6dc5(0x277)](showCustomAlert,_0x15689a[_0x5e6dc5(0x173)],(Array[_0x5e6dc5(0x339)](_0x292e32)?_0x5e6dc5(0x1ef)+_0x292e32[_0x5e6dc5(0x338)](',\x20'):_0x5e6dc5(0x256)+_0x292e32)+_0x5e6dc5(0x1fe));const _0x5afe45=_0x15689a[_0x5e6dc5(0x268)](_0x45cd12);if(Object['keys'](_0x410406)[_0x5e6dc5(0x2b4)]((_0x4c9d2b,_0x3effb9)=>_0x4c9d2b-_0x3effb9)['forEach'](_0x14bd0e=>{const _0x2fcc79=_0x5e6dc5,_0x275a90={'LEKcO':function(_0x368491,_0x52f7bf){const _0x9867b4=a12_0x4a84;return _0x15689a[_0x9867b4(0x25f)](_0x368491,_0x52f7bf);},'iOvHk':function(_0x28ad81,_0x5c09c8,_0x28f2b3){return _0x28ad81(_0x5c09c8,_0x28f2b3);},'corDC':_0x15689a['OYlEy'],'ZmJQh':_0x15689a['HsyeV']},_0x429cc5=_0x410406[_0x14bd0e];_0x3ba96d[_0x2fcc79(0x2b2)]({'Train':_0x2fcc79(0x256)+_0x14bd0e+'\x20-\x20Worst\x20Case\x20Analysis','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),_0x429cc5[_0x2fcc79(0x14f)](_0x1a5223=>{const _0x45ef3e=_0x2fcc79,_0x5df46a=_0x1a5223[_0x45ef3e(0x217)]['map'](_0x589e74=>_0x2e3059(_0x589e74,_0x5afe45)[_0x45ef3e(0x196)]);_0x1a5223[_0x45ef3e(0x320)]=_0x275a90[_0x45ef3e(0x2bf)](_0x5df46a[_0x45ef3e(0x1af)],0x0)?Math['max'](..._0x5df46a):0x0;}),_0x429cc5['sort']((_0x6ce417,_0x5da1de)=>_0x5da1de[_0x2fcc79(0x320)]-_0x6ce417['sortValue']),_0x429cc5[_0x2fcc79(0x14f)](_0x19093f=>{const _0x11db0b=_0x2fcc79,_0x51d0a6={'OGmCV':function(_0x467e51,_0x502f7f,_0x1ccd05){const _0x4addba=a12_0x4a84;return _0x275a90[_0x4addba(0x26c)](_0x467e51,_0x502f7f,_0x1ccd05);},'zLEjS':_0x275a90[_0x11db0b(0x162)]},_0x53fa08=_0x19093f[_0x11db0b(0x214)]?_0x275a90['ZmJQh']:'No';_0x3ba96d['push']({'Train':'','Product\x20Code':_0x19093f[_0x11db0b(0x198)],'Product\x20Name':_0x19093f[_0x11db0b(0x1fb)],'Highest\x20RPN':_0x19093f[_0x11db0b(0x320)],'Special\x20Case\x20Product':_0x53fa08,'Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),(_0x19093f[_0x11db0b(0x217)][_0x11db0b(0x2b4)]((_0xfa748,_0x197bad)=>_0x2e3059(_0x197bad,_0x5afe45)[_0x11db0b(0x196)]-_0x2e3059(_0xfa748,_0x5afe45)['rpn'])[_0x11db0b(0x14f)](_0x5c341a=>{const _0x168f44=_0x11db0b,_0x494326=_0x51d0a6[_0x168f44(0x2d3)](_0x2e3059,_0x5c341a,_0x5afe45);_0x3ba96d[_0x168f44(0x2b2)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':_0x5c341a[_0x168f44(0x1fb)],'TD\x20Score':_0x494326['therapeuticDoseScore'],'Solubility\x20Score':_0x494326[_0x168f44(0x1d8)],'Cleanability\x20Score':_0x494326['cleanabilityScore'],'PDE\x20Score':_0x494326[_0x168f44(0x278)]??_0x51d0a6[_0x168f44(0x357)],'LD50\x20Score':_0x494326[_0x168f44(0x2fd)]??_0x51d0a6[_0x168f44(0x357)],'RPN':_0x494326[_0x168f44(0x196)],'Rating':_0x494326[_0x168f44(0x165)]});}),_0x3ba96d['push']({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}));});}),_0x15689a[_0x5e6dc5(0x253)](0x0,_0x3ba96d[_0x5e6dc5(0x1af)]))return _0x15689a['NwStw'](hideLoader),void _0x15689a[_0x5e6dc5(0x277)](showCustomAlert,_0x15689a[_0x5e6dc5(0x173)],_0x15689a[_0x5e6dc5(0x1df)]);const _0x493a85=XLSX[_0x5e6dc5(0x1d9)][_0x5e6dc5(0x2c3)](_0x3ba96d),_0x186965=XLSX[_0x5e6dc5(0x1d9)][_0x5e6dc5(0x1ea)]();XLSX['utils'][_0x5e6dc5(0x361)](_0x186965,_0x493a85,_0x5e6dc5(0x2a3));const _0x3c5d5d=Object[_0x5e6dc5(0x2b1)](_0x3ba96d[0x0])[_0x5e6dc5(0x24f)](_0x531725=>({'wch':Math[_0x5e6dc5(0x1bb)](_0x531725[_0x5e6dc5(0x1af)],..._0x3ba96d[_0x5e6dc5(0x24f)](_0x260c92=>String(_0x260c92[_0x531725]||'')[_0x5e6dc5(0x1af)]))+0x2}));_0x493a85[_0x15689a['aTYKt']]=_0x3c5d5d;const _0x37e8a6=new Date()[_0x5e6dc5(0x17e)]()[_0x5e6dc5(0x177)]('T')[0x0];let _0x46e13e='';_0x15689a['pyqAf']!==_0x292e32&&(_0x46e13e=Array['isArray'](_0x292e32)?_0x5e6dc5(0x33c)+_0x292e32['join']('_'):_0x5e6dc5(0x1a7)+_0x292e32),XLSX[_0x5e6dc5(0x34a)](_0x186965,_0x5e6dc5(0x12e)+_0x46e13e+'_'+_0x37e8a6+_0x5e6dc5(0x2c5)),hideLoader();})[_0x6b2fe6(0x27f)](_0x5ddef2=>{const _0x2fee4a=_0x6b2fe6;console[_0x2fee4a(0x17b)](_0x2fee4a(0x295),_0x5ddef2),_0x15689a[_0x2fee4a(0x19a)](hideLoader),showCustomAlert(_0x2fee4a(0x133),'Failed\x20to\x20export\x20worst\x20case\x20data\x20to\x20Excel.');});}export function exportMachinesToExcel(){const _0x2f6dce=a12_0x35cd83,_0x421db6={'bMvrK':function(_0x33c937){return _0x33c937();},'JvwVX':function(_0x33d46d,_0x3dbe82,_0x42bdf2){return _0x33d46d(_0x3dbe82,_0x42bdf2);},'EDtWB':'No\x20Data','HSntL':_0x2f6dce(0x352),'PCfhz':_0x2f6dce(0x30f),'Dshhn':function(_0x26ec23){return _0x26ec23();},'VkGUg':'Success','edVcS':_0x2f6dce(0x141),'gTyDt':_0x2f6dce(0x218),'VXVxH':function(_0x4c1b4a){return _0x4c1b4a();},'gUUkF':function(_0x2a17d2,_0x5bf192,_0x5db603){return _0x2a17d2(_0x5bf192,_0x5db603);},'dZpos':'Error','kNzxn':_0x2f6dce(0x13f)};_0x421db6[_0x2f6dce(0x1db)](showLoader);try{if(0x0===a12_0x2a5c73[_0x2f6dce(0x2d9)][_0x2f6dce(0x1af)])return hideLoader(),void _0x421db6['JvwVX'](showCustomAlert,_0x421db6['EDtWB'],_0x421db6[_0x2f6dce(0x27b)]);const _0x33fec8=[],_0x54fa9c={};a12_0x2a5c73[_0x2f6dce(0x2d9)][_0x2f6dce(0x14f)](_0x2b52d0=>{const _0x3c65b1=_0x2f6dce;_0x54fa9c[_0x2b52d0[_0x3c65b1(0x2f6)]]||(_0x54fa9c[_0x2b52d0[_0x3c65b1(0x2f6)]]=[]),_0x54fa9c[_0x2b52d0[_0x3c65b1(0x2f6)]][_0x3c65b1(0x2b2)](_0x2b52d0);}),a12_0x2a5c73['machineStageDisplayOrder']['forEach'](_0x5c0886=>{const _0x324401=_0x2f6dce,_0x5998f8={'DEjmf':_0x324401(0x2c4)};_0x54fa9c[_0x5c0886]&&_0x54fa9c[_0x5c0886][_0x324401(0x14f)](_0x57cd84=>{const _0x36ff5b=_0x324401,_0x3e6114=a12_0x2a5c73[_0x36ff5b(0x321)][_0x36ff5b(0x314)](_0x3ac5b3=>_0x3ac5b3[_0x36ff5b(0x276)]&&_0x3ac5b3[_0x36ff5b(0x276)]['includes'](_0x57cd84['id'])),_0x2825b7=_0x3e6114[_0x36ff5b(0x24f)](_0x1f44a7=>_0x1f44a7['name'])[_0x36ff5b(0x338)](',\x20')||_0x5998f8[_0x36ff5b(0x1b6)],_0x5929c5=_0x3e6114['length'];_0x33fec8['push']({'Machine\x20Number':_0x57cd84[_0x36ff5b(0x34f)],'Machine\x20Name':_0x57cd84[_0x36ff5b(0x1fb)],'Stage':_0x57cd84[_0x36ff5b(0x2f6)],'Area\x20(sq\x20cm)':_0x57cd84['area'],'Assigned\x20Products\x20Count':_0x5929c5,'Assigned\x20Products':_0x2825b7});});});const _0x566bd6=XLSX[_0x2f6dce(0x1d9)][_0x2f6dce(0x2c3)](_0x33fec8),_0xc7199b=XLSX[_0x2f6dce(0x1d9)]['book_new']();XLSX['utils'][_0x2f6dce(0x361)](_0xc7199b,_0x566bd6,'Machines');const _0x149ccc=[{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0xf},{'wch':0x14},{'wch':0x32}];_0x566bd6[_0x421db6[_0x2f6dce(0x27e)]]=_0x149ccc;const _0x507ad4=new Date()['toISOString']()['split']('T')[0x0];XLSX['writeFile'](_0xc7199b,_0x2f6dce(0x1ca)+_0x507ad4+'.xlsx'),_0x421db6['Dshhn'](hideLoader),_0x421db6[_0x2f6dce(0x13c)](showCustomAlert,_0x421db6[_0x2f6dce(0x29b)],_0x421db6[_0x2f6dce(0x2bd)]);}catch(_0x419315){console[_0x2f6dce(0x17b)](_0x421db6['gTyDt'],_0x419315),_0x421db6[_0x2f6dce(0x2b3)](hideLoader),_0x421db6[_0x2f6dce(0x286)](showCustomAlert,_0x421db6[_0x2f6dce(0x249)],_0x421db6[_0x2f6dce(0x244)]);}}export function exportProductMacoToExcel(_0x3729fe=a12_0x35cd83(0x171)){const _0x806175=a12_0x35cd83,_0x212505={'EOyfP':_0x806175(0x23a),'bRorS':function(_0x2aa969,_0x103425){return _0x2aa969/_0x103425;},'CYfrF':function(_0xb1c0ae,_0x2a0bd9){return _0xb1c0ae!==_0x2a0bd9;},'HOLLP':function(_0x1ca114,_0x55db6b){return _0x1ca114*_0x55db6b;},'zQBcX':_0x806175(0x209),'AufZZ':function(_0x45447a,_0x1ef86a){return _0x45447a==_0x1ef86a;},'DPMAB':_0x806175(0x202),'zyasa':_0x806175(0x1b0),'oDeNA':function(_0x2340aa,_0x1d37f3){return _0x2340aa>_0x1d37f3;},'XKOlK':function(_0x12b04d,_0x510dbe){return _0x12b04d!==_0x510dbe;},'BLtlm':function(_0x256d14){return _0x256d14();},'PmrDT':function(_0x4586fd,_0x3b6814){return _0x4586fd===_0x3b6814;},'bOmsa':function(_0x35af3e,_0x43c871,_0x5ca1ef){return _0x35af3e(_0x43c871,_0x5ca1ef);},'GcGxg':_0x806175(0x298),'equdU':function(_0x575aab,_0x4e9a79,_0x56ef2c){return _0x575aab(_0x4e9a79,_0x56ef2c);},'rmGXQ':_0x806175(0x2e5),'yVwjM':_0x806175(0x188),'RaFpQ':_0x806175(0x2dc),'gmkJI':_0x806175(0x30f),'xBPbQ':_0x806175(0x228),'QWlFS':_0x806175(0x171),'twoZW':_0x806175(0x2ea),'jtyyO':function(_0x26cb47){return _0x26cb47();},'xmvzF':function(_0x41d2b8,_0xd60650,_0x2c5429){return _0x41d2b8(_0xd60650,_0x2c5429);},'nNAxL':_0x806175(0x133)};showLoader(),import(_0x806175(0x200))[_0x806175(0x168)](_0x24823d=>{const _0x1357f6=_0x806175,_0x5191ef={'LWFYN':_0x212505[_0x1357f6(0x24e)],'cXlBL':function(_0x10073f,_0x32d914){const _0x2c0512=_0x1357f6;return _0x212505[_0x2c0512(0x252)](_0x10073f,_0x32d914);},'xjZga':function(_0x2bc2dc,_0x333109){const _0x595a37=_0x1357f6;return _0x212505[_0x595a37(0x225)](_0x2bc2dc,_0x333109);},'OwknA':function(_0x47b8ab,_0x25681a){return _0x212505['HOLLP'](_0x47b8ab,_0x25681a);},'CJREK':_0x1357f6(0x349),'tfvVs':_0x212505['zQBcX'],'SkLXj':function(_0x318efe,_0x4084de){return _0x212505['AufZZ'](_0x318efe,_0x4084de);},'zaaOl':_0x212505[_0x1357f6(0x1bc)],'qDWfW':function(_0x4d3ffd,_0x3b7ff4){const _0x229535=_0x1357f6;return _0x212505[_0x229535(0x252)](_0x4d3ffd,_0x3b7ff4);},'KBhlx':_0x212505['zyasa'],'pycfZ':function(_0xabea18,_0x41d8be){return _0x212505['oDeNA'](_0xabea18,_0x41d8be);},'lZdvj':_0x1357f6(0x1c1),'LtJmN':function(_0xa8efb2,_0x4f09a1){const _0x574c51=_0x1357f6;return _0x212505[_0x574c51(0x1f8)](_0xa8efb2,_0x4f09a1);},'bYFYk':function(_0x316589,_0x4d9d65){return _0x316589==_0x4d9d65;}},{getTrainData:_0x183c7f,getWorstCaseProductType:_0x312c7a,getMacoPerSwabForTrain:_0x1425e7}=_0x24823d,_0x5a7b22=_0x212505['BLtlm'](_0x183c7f);if(_0x212505[_0x1357f6(0x2c7)](0x0,_0x5a7b22[_0x1357f6(0x1af)]))return hideLoader(),void _0x212505[_0x1357f6(0x34b)](showCustomAlert,'No\x20Data',_0x212505[_0x1357f6(0x26b)]);let _0xeaa087=_0x5a7b22;if(_0x1357f6(0x171)!==_0x3729fe&&(_0xeaa087=Array[_0x1357f6(0x339)](_0x3729fe)?_0x5a7b22[_0x1357f6(0x314)](_0x36750e=>_0x3729fe[_0x1357f6(0x2c6)](String(_0x36750e['id']))):_0x5a7b22[_0x1357f6(0x314)](_0x2a2279=>String(_0x2a2279['id'])===String(_0x3729fe))),_0x212505['PmrDT'](0x0,_0xeaa087[_0x1357f6(0x1af)]))return _0x212505[_0x1357f6(0x22d)](hideLoader),void _0x212505[_0x1357f6(0x224)](showCustomAlert,_0x212505[_0x1357f6(0x1b7)],_0x212505[_0x1357f6(0x247)]);const _0x2d03f8=[],_0x3d53cd=_0x5a7b22[_0x1357f6(0x350)]((_0x25ffe9,_0x58fcd7)=>_0x58fcd7[_0x1357f6(0x366)]>_0x25ffe9[_0x1357f6(0x366)]?_0x58fcd7:_0x25ffe9)[_0x1357f6(0x366)];_0xeaa087['forEach'](_0x20a85a=>{const _0x807eb0=_0x1357f6,_0x2706bb={'wZjcD':function(_0x2692b3,_0x1490ce){return _0x2692b3||_0x1490ce;},'rPJtZ':_0x5191ef[_0x807eb0(0x28d)]},_0x3025cf=_0x312c7a(_0x20a85a['products'][_0x807eb0(0x24f)](_0x4274e8=>_0x4274e8[_0x807eb0(0x181)])),_0x33b912=(a12_0x2a5c73[_0x807eb0(0x2d5)][_0x3025cf]||a12_0x2a5c73[_0x807eb0(0x2d5)][_0x807eb0(0x20d)])[_0x807eb0(0x1bb)],_0x3d574b=_0x5191ef['cXlBL'](_0x20a85a[_0x807eb0(0x310)]*_0x20a85a['minBsMddRatio'],_0x33b912),_0x273b7d=0xa*_0x20a85a[_0x807eb0(0x215)];let _0x4c6d93=_0x5191ef[_0x807eb0(0x28d)];_0x5191ef[_0x807eb0(0x248)](null,_0x20a85a[_0x807eb0(0x13e)])&&(_0x4c6d93=_0x20a85a['lowestPde']*_0x20a85a[_0x807eb0(0x212)]);const _0x4a6b1f=_0x5191ef[_0x807eb0(0x316)](0.004,_0x3d53cd),_0xf7df1f=[{'name':_0x807eb0(0x13a),'value':_0x3d574b},{'name':_0x5191ef[_0x807eb0(0x132)],'value':_0x273b7d},{'name':_0x5191ef[_0x807eb0(0x1d5)],'value':_0x5191ef[_0x807eb0(0x365)](_0x5191ef['zaaOl'],typeof _0x4c6d93)?_0x4c6d93:_0x5191ef['qDWfW'](0x1,0x0)},{'name':_0x5191ef[_0x807eb0(0x2b0)],'value':_0x4a6b1f}][_0x807eb0(0x350)]((_0xc1e7db,_0x61cb0e)=>_0x61cb0e[_0x807eb0(0x130)]<_0xc1e7db['value']?_0x61cb0e:_0xc1e7db),_0x18aa54=_0xf7df1f['value'],_0x243309=_0x5191ef[_0x807eb0(0x16a)](_0x3d53cd,0x0)?_0x18aa54/_0x3d53cd:0x0,_0x728b03=_0x5191ef['OwknA'](_0x243309,_0x20a85a[_0x807eb0(0x1eb)]),_0x4fef51=_0x20a85a[_0x807eb0(0x276)][_0x807eb0(0x24f)](_0x32642d=>{const _0x3070e4=_0x807eb0,_0x55d12a=a12_0x2a5c73['machines'][_0x3070e4(0x17a)](_0x2dd74c=>_0x2dd74c['id']===_0x32642d);return _0x2706bb['wZjcD'](_0x55d12a,{'name':'Unknown\x20(ID:\x20'+_0x32642d+')','machineNumber':_0x2706bb['rPJtZ']});}),_0x1f51e5=_0x24823d[_0x807eb0(0x16e)](_0x20a85a['machineIds'])[_0x807eb0(0x24f)](_0x4c51e8=>_0x4c51e8['isGroup']?_0x4c51e8[_0x807eb0(0x16f)]+'\x20('+_0x4c51e8[_0x807eb0(0x32a)]+'x)':_0x4c51e8['name'])[_0x807eb0(0x338)](_0x5191ef['lZdvj']),_0xd81975=_0x20a85a[_0x807eb0(0x321)][_0x807eb0(0x24f)](_0x2cacd9=>_0x2cacd9[_0x807eb0(0x198)]+_0x807eb0(0x1fc)+_0x2cacd9[_0x807eb0(0x1fb)])[_0x807eb0(0x338)](';\x20'),_0x256886=_0x20a85a[_0x807eb0(0x291)]?_0x20a85a['worstProductRpn']['productName']+'\x20('+_0x20a85a[_0x807eb0(0x291)][_0x807eb0(0x167)]+_0x807eb0(0x2be)+_0x20a85a['worstProductRpn'][_0x807eb0(0x196)]:_0x807eb0(0x23a);_0x2d03f8[_0x807eb0(0x2b2)]({'Train':'T'+_0x20a85a['id'],'Total\x20Products':_0x20a85a[_0x807eb0(0x321)]['length'],'Total\x20Machines':_0x4fef51[_0x807eb0(0x1af)],'Total\x20Area\x20(ESSA)\x20cm²':_0x20a85a[_0x807eb0(0x366)][_0x807eb0(0x1a2)](),'Products':_0xd81975,'Machines':_0x1f51e5,'Worst-Case\x20Dosage\x20Form':_0x3025cf,'Safety\x20Factor':_0x33b912,'Lowest\x20LTD\x20(mg)':_0x20a85a['lowestLtd'],'Min\x20Batch\x20Size\x20(kg)':_0x20a85a[_0x807eb0(0x215)],'Min\x20BS/MDD\x20Ratio':_0x20a85a[_0x807eb0(0x212)][_0x807eb0(0x263)](0x2),'Lowest\x20PDE\x20(mg)':_0x5191ef[_0x807eb0(0x285)](null,_0x20a85a[_0x807eb0(0x13e)])?_0x20a85a['lowestPde']:_0x5191ef[_0x807eb0(0x28d)],'Worst-Case\x20Product\x20(by\x20RPN)':_0x256886,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x3d574b['toFixed'](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x273b7d[_0x807eb0(0x263)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x5191ef[_0x807eb0(0x313)](_0x5191ef[_0x807eb0(0x1f7)],typeof _0x4c6d93)?_0x4c6d93[_0x807eb0(0x263)](0x2):_0x5191ef[_0x807eb0(0x28d)],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x4a6b1f[_0x807eb0(0x263)](0x2),'Selected\x20MACO\x20Method':_0xf7df1f[_0x807eb0(0x1fb)],'Final\x20MACO\x20(mg)':_0x18aa54[_0x807eb0(0x263)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x243309[_0x807eb0(0x22c)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x728b03[_0x807eb0(0x263)](0x4)});});const _0x837455=XLSX['utils'][_0x1357f6(0x2c3)](_0x2d03f8),_0x13d9c0=XLSX[_0x1357f6(0x1d9)][_0x1357f6(0x1ea)]();XLSX[_0x1357f6(0x1d9)]['book_append_sheet'](_0x13d9c0,_0x837455,_0x212505[_0x1357f6(0x191)]),_0x837455[_0x212505[_0x1357f6(0x2e4)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0x12},{'wch':0xf},{'wch':0x12},{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0x12},{'wch':0x12}];const _0x1170d7=new Date()[_0x1357f6(0x17e)]()['split']('T')[0x0];let _0x36a83e=_0x212505[_0x1357f6(0x31e)];if(_0x212505['XKOlK'](_0x212505[_0x1357f6(0x2bb)],_0x3729fe)){if(Array[_0x1357f6(0x339)](_0x3729fe))_0x36a83e+='_Trains_'+_0x3729fe[_0x1357f6(0x2b4)]((_0x38edf8,_0x55b050)=>_0x38edf8-_0x55b050)[_0x1357f6(0x338)]('_');else _0x36a83e+=_0x1357f6(0x1a7)+_0x3729fe;}_0x36a83e+='_'+_0x1170d7+_0x1357f6(0x2c5),XLSX[_0x1357f6(0x34a)](_0x13d9c0,_0x36a83e),_0x212505[_0x1357f6(0x22d)](hideLoader),_0x212505[_0x1357f6(0x224)](showCustomAlert,_0x1357f6(0x35c),_0x1357f6(0x197));})[_0x806175(0x27f)](_0xcfca70=>{const _0x47d566=_0x806175;console[_0x47d566(0x17b)](_0x212505[_0x47d566(0x30b)],_0xcfca70),_0x212505['jtyyO'](hideLoader),_0x212505[_0x47d566(0x147)](showCustomAlert,_0x212505['nNAxL'],_0x47d566(0x199));});}export function exportDetergentMacoToExcel(_0x1daa48=a12_0x35cd83(0x171)){const _0x374153=a12_0x35cd83,_0x30c625={'XcaZX':function(_0x1f1446,_0x332668){return _0x1f1446(_0x332668);},'HTrLF':function(_0x43eac9,_0x541425){return _0x43eac9/_0x541425;},'OWcsz':function(_0x2227cf,_0x337d97){return _0x2227cf*_0x337d97;},'hpXdZ':function(_0x26e33c,_0x2709bb){return _0x26e33c*_0x2709bb;},'ZSoXK':function(_0x1bdcd8,_0x3587c9){return _0x1bdcd8>_0x3587c9;},'foMjd':function(_0x501f86,_0x4493e0){return _0x501f86*_0x4493e0;},'zaAUC':_0x374153(0x1c1),'zeZTe':_0x374153(0x23a),'GnMjX':function(_0x2a17b8){return _0x2a17b8();},'bFXlE':function(_0x1cf034,_0x3976bc){return _0x1cf034!==_0x3976bc;},'uMWUp':_0x374153(0x171),'FcmFP':function(_0x19c70f){return _0x19c70f();},'kSTWD':function(_0x15e6ea,_0x3d4962,_0x247959){return _0x15e6ea(_0x3d4962,_0x247959);},'zGxEU':_0x374153(0x2e5),'Opsal':'There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','qqxUD':function(_0x1bcdd4,_0x347b06){return _0x1bcdd4===_0x347b06;},'avwxS':function(_0xb48131,_0x5da364,_0x1d3655){return _0xb48131(_0x5da364,_0x1d3655);},'eXzHM':function(_0x5f4583,_0x3da375){return _0x5f4583>_0x3da375;},'aePLW':'!cols','DdQLW':'Success','JYzbl':_0x374153(0x2b5),'wkBjF':function(_0x41842e){return _0x41842e();},'pVarH':function(_0x3eaecc,_0x2e33c6,_0x300751){return _0x3eaecc(_0x2e33c6,_0x300751);},'nTWyn':_0x374153(0x200)};_0x30c625[_0x374153(0x155)](showLoader),import(_0x30c625[_0x374153(0x318)])[_0x374153(0x168)](_0x186a39=>{const _0x154e51=_0x374153,{getTrainData:_0x44de88,getWorstCaseProductType:_0x590503}=_0x186a39;let _0x3962fa=_0x30c625[_0x154e51(0x1de)](_0x44de88);if(_0x30c625['bFXlE'](_0x30c625[_0x154e51(0x2e8)],_0x1daa48)&&(_0x3962fa=Array['isArray'](_0x1daa48)?_0x3962fa[_0x154e51(0x314)](_0x4f2722=>_0x1daa48['includes'](String(_0x4f2722['id']))):_0x3962fa[_0x154e51(0x314)](_0x4345f9=>String(_0x4345f9['id'])===String(_0x1daa48))),0x0===_0x3962fa['length'])return _0x30c625[_0x154e51(0x23f)](hideLoader),void _0x30c625['kSTWD'](showCustomAlert,_0x30c625[_0x154e51(0x348)],_0x30c625[_0x154e51(0x331)]);if(_0x30c625[_0x154e51(0x258)](0x0,a12_0x2a5c73[_0x154e51(0x1d6)]['length']))return hideLoader(),void _0x30c625['avwxS'](showCustomAlert,_0x30c625[_0x154e51(0x348)],_0x154e51(0x1e4));const _0x4bb912=[],_0x33d434=_0x3962fa['length']>0x0?Math[_0x154e51(0x1bb)](..._0x3962fa['map'](_0x1544ad=>_0x1544ad[_0x154e51(0x366)])):0x0,_0xfe4d01=_0x30c625[_0x154e51(0x280)](parseFloat,document['getElementById'](_0x154e51(0x1cc))?.[_0x154e51(0x130)])||0x46,_0x5d2643=a12_0x2a5c73['detergentIngredients'][_0x154e51(0x24f)](_0x270512=>parseFloat(_0x270512['ld50']))[_0x154e51(0x314)](_0x489840=>!isNaN(_0x489840)),_0x48d882=_0x30c625[_0x154e51(0x330)](_0x5d2643[_0x154e51(0x1af)],0x0)?Math[_0x154e51(0x317)](..._0x5d2643):0x0,_0x597902=a12_0x2a5c73[_0x154e51(0x1d6)][_0x154e51(0x24f)](_0xc175c0=>_0xc175c0['name'])['filter'](_0x209c53=>''!==_0x209c53['trim']())['join'](',\x20');_0x3962fa[_0x154e51(0x14f)](_0x29785b=>{const _0x2a898e=_0x154e51,_0x16da8e=_0x30c625['XcaZX'](_0x590503,_0x29785b[_0x2a898e(0x321)]['map'](_0x58ab12=>_0x58ab12[_0x2a898e(0x181)])),_0x3e2988=a12_0x2a5c73[_0x2a898e(0x2d5)][_0x16da8e]||a12_0x2a5c73[_0x2a898e(0x2d5)][_0x2a898e(0x20d)],_0x1c5447=document[_0x2a898e(0x255)]('sf-input-train-'+_0x29785b['id']),_0x436304=_0x1c5447&&parseFloat(_0x1c5447[_0x2a898e(0x130)])||_0x3e2988['max'],_0x18ea5b=_0x30c625[_0x2a898e(0x189)](_0x30c625[_0x2a898e(0x2b7)](0.0005*_0x48d882,_0xfe4d01),_0x436304),_0x29cfbd=_0x30c625[_0x2a898e(0x1e0)](_0x18ea5b,_0x29785b[_0x2a898e(0x212)]),_0x2b9d96=_0x30c625[_0x2a898e(0x1e5)](_0x33d434,0x0)?_0x30c625['HTrLF'](_0x29cfbd,_0x33d434):0x0,_0x2d6702=_0x30c625['foMjd'](_0x2b9d96,_0x29785b[_0x2a898e(0x1eb)]),_0x1d355a=_0x29785b['machineIds'][_0x2a898e(0x24f)](_0xcc73ec=>{const _0x5f4328=_0x2a898e,_0x51713f=a12_0x2a5c73[_0x5f4328(0x2d9)][_0x5f4328(0x17a)](_0x181b48=>_0x181b48['id']===_0xcc73ec);return _0x51713f||{'name':'Unknown\x20(ID:\x20'+_0xcc73ec+')','machineNumber':_0x5f4328(0x23a)};}),_0x514ca5=_0x186a39[_0x2a898e(0x16e)](_0x29785b[_0x2a898e(0x276)])[_0x2a898e(0x24f)](_0x1d8478=>_0x1d8478[_0x2a898e(0x2a6)]?_0x1d8478[_0x2a898e(0x16f)]+'\x20('+_0x1d8478['machineCount']+'x)':_0x1d8478['name'])[_0x2a898e(0x338)](_0x30c625[_0x2a898e(0x21a)]),_0x552719=_0x29785b['products'][_0x2a898e(0x24f)](_0x4864c0=>_0x4864c0['productCode']+_0x2a898e(0x1fc)+_0x4864c0[_0x2a898e(0x1fb)])[_0x2a898e(0x338)](';\x20'),_0x356c1e=_0x29785b[_0x2a898e(0x291)]?_0x29785b[_0x2a898e(0x291)][_0x2a898e(0x28e)]+'\x20('+_0x29785b['worstProductRpn'][_0x2a898e(0x167)]+_0x2a898e(0x2be)+_0x29785b[_0x2a898e(0x291)][_0x2a898e(0x196)]:_0x30c625['zeZTe'];_0x4bb912[_0x2a898e(0x2b2)]({'Train':'T'+_0x29785b['id'],'Total\x20Products':_0x29785b['products'][_0x2a898e(0x1af)],'Total\x20Machines':_0x1d355a[_0x2a898e(0x1af)],'Total\x20Area\x20(ESSA)\x20cm²':_0x29785b[_0x2a898e(0x366)][_0x2a898e(0x1a2)](),'Products':_0x552719,'Machines':_0x514ca5,'Worst-Case\x20Dosage\x20Form':_0x16da8e,'Safety\x20Factor\x20Range':_0x3e2988['min']+_0x2a898e(0x1fc)+_0x3e2988[_0x2a898e(0x1bb)],'Applied\x20Safety\x20Factor':_0x436304,'Detergent\x20Ingredients':_0x597902,'Body\x20Weight\x20(kg)':_0xfe4d01,'Minimum\x20LD50\x20(mg/kg)':_0x48d882,'Min\x20Batch\x20Size\x20(kg)':_0x29785b[_0x2a898e(0x215)],'Min\x20BS/MDD\x20Ratio':_0x29785b['minBsMddRatio']['toFixed'](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x356c1e,'ADI\x20(mg)':_0x18ea5b[_0x2a898e(0x263)](0x4),'MACO\x20(mg)':_0x29cfbd[_0x2a898e(0x263)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x2b9d96[_0x2a898e(0x22c)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x2d6702[_0x2a898e(0x263)](0x4)});});const _0x1ee308=XLSX['utils'][_0x154e51(0x2c3)](_0x4bb912),_0x774ed1=XLSX['utils'][_0x154e51(0x1ea)]();XLSX['utils'][_0x154e51(0x361)](_0x774ed1,_0x1ee308,_0x154e51(0x333)),_0x1ee308[_0x30c625[_0x154e51(0x1ff)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0x1e},{'wch':0xc},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0xc},{'wch':0xc},{'wch':0x12},{'wch':0x12}];const _0x3236e5=new Date()[_0x154e51(0x17e)]()[_0x154e51(0x177)]('T')[0x0];XLSX['writeFile'](_0x774ed1,'Detergent_MACO_Report_'+_0x3236e5+_0x154e51(0x2c5)),_0x30c625[_0x154e51(0x23f)](hideLoader),_0x30c625['kSTWD'](showCustomAlert,_0x30c625[_0x154e51(0x302)],_0x30c625[_0x154e51(0x150)]);})[_0x374153(0x27f)](_0x55000d=>{const _0x119f8e=_0x374153;console[_0x119f8e(0x17b)](_0x119f8e(0x180),_0x55000d),_0x30c625['wkBjF'](hideLoader),_0x30c625[_0x119f8e(0x17d)](showCustomAlert,_0x119f8e(0x133),_0x119f8e(0x1f5));});}export function exportTrainSummaryToExcel(_0x38b085='all'){const _0x82c9bd=a12_0x35cd83,_0x3582b2={'Mpunq':_0x82c9bd(0x23a),'qVZpf':function(_0x1415b4){return _0x1415b4();},'MYCFp':function(_0x2ac7d7,_0x3334dd){return _0x2ac7d7===_0x3334dd;},'NjOqO':function(_0x9362c9,_0x17fff8,_0x7eed71){return _0x9362c9(_0x17fff8,_0x7eed71);},'pbPfr':_0x82c9bd(0x2e5),'xdoJw':_0x82c9bd(0x298),'zdbnq':function(_0x40d981,_0x1d0b7f){return _0x40d981!==_0x1d0b7f;},'kALip':_0x82c9bd(0x171),'ZDoEt':function(_0x3d7a37,_0x360e4b){return _0x3d7a37===_0x360e4b;},'ImQhm':_0x82c9bd(0x188),'cNFNS':_0x82c9bd(0x300),'PNtNa':'!cols','WAGsK':'Train_Summary_Report','DTKJy':function(_0x49af66){return _0x49af66();},'GBPHc':function(_0x3ef2f9,_0x468649,_0x3a8d58){return _0x3ef2f9(_0x468649,_0x3a8d58);},'tEyWq':_0x82c9bd(0x35c),'qgiJC':'Train\x20Summary\x20data\x20exported\x20to\x20Excel\x20successfully!','TbZLA':_0x82c9bd(0x25d),'bRmOv':_0x82c9bd(0x133),'kyjsV':_0x82c9bd(0x2ae),'MyWPR':_0x82c9bd(0x200)};_0x3582b2['qVZpf'](showLoader),import(_0x3582b2[_0x82c9bd(0x1d4)])[_0x82c9bd(0x168)](_0x4b7d96=>{const _0x4b7197=_0x82c9bd,_0x1f8ecb={'Wiibb':_0x3582b2[_0x4b7197(0x145)]},{getTrainData:_0x31bb6b}=_0x4b7d96,_0x31308a=_0x3582b2[_0x4b7197(0x242)](_0x31bb6b);if(_0x3582b2[_0x4b7197(0x226)](0x0,_0x31308a['length']))return hideLoader(),void _0x3582b2[_0x4b7197(0x1c6)](showCustomAlert,_0x3582b2[_0x4b7197(0x309)],_0x3582b2[_0x4b7197(0x360)]);let _0x590ade=_0x31308a;if(_0x3582b2[_0x4b7197(0x32f)](_0x3582b2['kALip'],_0x38b085)&&(_0x590ade=Array[_0x4b7197(0x339)](_0x38b085)?_0x31308a['filter'](_0x3d906d=>_0x38b085['includes'](String(_0x3d906d['id']))):_0x31308a[_0x4b7197(0x314)](_0x22fccf=>String(_0x22fccf['id'])===String(_0x38b085))),_0x3582b2[_0x4b7197(0x269)](0x0,_0x590ade[_0x4b7197(0x1af)]))return _0x3582b2[_0x4b7197(0x242)](hideLoader),void _0x3582b2['NjOqO'](showCustomAlert,_0x3582b2[_0x4b7197(0x309)],_0x3582b2[_0x4b7197(0x31f)]);const _0x1301ac=[];_0x590ade[_0x4b7197(0x14f)](_0x3419ea=>{const _0x1cd495=_0x4b7197,_0x565e8b={'JDwls':function(_0x2d3c7f,_0x301f45){return _0x2d3c7f||_0x301f45;}},_0x1b5e0d=_0x3419ea[_0x1cd495(0x276)][_0x1cd495(0x24f)](_0x52793f=>{const _0x3ade01=_0x1cd495,_0x444909=a12_0x2a5c73[_0x3ade01(0x2d9)][_0x3ade01(0x17a)](_0x4b976d=>_0x4b976d['id']===_0x52793f);return _0x565e8b[_0x3ade01(0x137)](_0x444909,{'id':_0x52793f,'name':'Unknown\x20(ID:\x20'+_0x52793f+')','machineNumber':_0x3ade01(0x23a)});}),_0x33bea2=_0x4b7d96[_0x1cd495(0x16e)](_0x3419ea['machineIds'])[_0x1cd495(0x24f)](_0x2c05ae=>_0x2c05ae[_0x1cd495(0x2a6)]?_0x2c05ae['group']+'\x20('+_0x2c05ae[_0x1cd495(0x32a)]+'x)':_0x2c05ae[_0x1cd495(0x1fb)])[_0x1cd495(0x338)](_0x1cd495(0x1c1)),_0x1e3850=_0x3419ea[_0x1cd495(0x321)]['map'](_0x2c6afc=>_0x2c6afc['productCode']+_0x1cd495(0x1fc)+_0x2c6afc[_0x1cd495(0x1fb)])[_0x1cd495(0x338)](';\x20'),_0x321cfa=_0x3419ea['products'][_0x1cd495(0x24f)](_0x3b1c22=>_0x3b1c22[_0x1cd495(0x198)]+':\x20'+_0x3b1c22[_0x1cd495(0x1fb)])[_0x1cd495(0x338)]('\x0a'),_0x46ef1a=_0x1b5e0d[_0x1cd495(0x24f)](_0x5c2cbb=>_0x5c2cbb[_0x1cd495(0x34f)]+':\x20'+_0x5c2cbb['name'])[_0x1cd495(0x338)]('\x0a');_0x1301ac['push']({'Train\x20ID':'T'+_0x3419ea['id'],'Products\x20Count':_0x3419ea[_0x1cd495(0x321)][_0x1cd495(0x1af)],'Machines\x20Count':_0x1b5e0d[_0x1cd495(0x1af)],'Total\x20Area\x20(ESSA)\x20cm²':_0x3419ea[_0x1cd495(0x366)]['toLocaleString'](),'Products\x20(Code\x20-\x20Name)':_0x1e3850,'Machines\x20(Number\x20-\x20Name)':_0x33bea2,'Products\x20Detailed':_0x321cfa,'Machines\x20Detailed':_0x46ef1a,'Min\x20Batch\x20Size\x20(kg)':_0x3419ea['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x3419ea[_0x1cd495(0x212)]['toFixed'](0x2),'Assumed\x20SSA\x20(cm²)':_0x3419ea['assumedSsa'],'Lowest\x20LTD\x20(mg)':_0x3419ea[_0x1cd495(0x310)],'Lowest\x20PDE\x20(mg)':null!==_0x3419ea['lowestPde']?_0x3419ea['lowestPde']:_0x1f8ecb[_0x1cd495(0x303)],'Worst\x20RPN\x20Product':_0x3419ea['worstProductRpn']?_0x3419ea['worstProductRpn'][_0x1cd495(0x28e)]+'\x20('+_0x3419ea[_0x1cd495(0x291)][_0x1cd495(0x167)]+_0x1cd495(0x2be)+_0x3419ea['worstProductRpn'][_0x1cd495(0x196)]:_0x1f8ecb[_0x1cd495(0x303)]});});const _0x358c02=XLSX[_0x4b7197(0x1d9)]['json_to_sheet'](_0x1301ac),_0x59baf6=XLSX['utils'][_0x4b7197(0x1ea)]();XLSX['utils'][_0x4b7197(0x361)](_0x59baf6,_0x358c02,_0x3582b2[_0x4b7197(0x274)]),_0x358c02[_0x3582b2[_0x4b7197(0x353)]]=[{'wch':0xa},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x3c},{'wch':0x3c},{'wch':0x28},{'wch':0x28},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32}];const _0x3a9e17=new Date()[_0x4b7197(0x17e)]()[_0x4b7197(0x177)]('T')[0x0];let _0x501126=_0x3582b2['WAGsK'];if(_0x3582b2[_0x4b7197(0x20e)]!==_0x38b085){if(Array[_0x4b7197(0x339)](_0x38b085))_0x501126+=_0x4b7197(0x33c)+_0x38b085['sort']((_0x138b2c,_0x5b91a2)=>_0x138b2c-_0x5b91a2)[_0x4b7197(0x338)]('_');else _0x501126+=_0x4b7197(0x1a7)+_0x38b085;}_0x501126+='_'+_0x3a9e17+_0x4b7197(0x2c5),XLSX[_0x4b7197(0x34a)](_0x59baf6,_0x501126),_0x3582b2[_0x4b7197(0x19f)](hideLoader),_0x3582b2['GBPHc'](showCustomAlert,_0x3582b2[_0x4b7197(0x294)],_0x3582b2[_0x4b7197(0x2e1)]);})[_0x82c9bd(0x27f)](_0x41eda8=>{const _0x1c33ba=_0x82c9bd;console['error'](_0x3582b2[_0x1c33ba(0x1f3)],_0x41eda8),_0x3582b2[_0x1c33ba(0x19f)](hideLoader),showCustomAlert(_0x3582b2[_0x1c33ba(0x158)],_0x3582b2[_0x1c33ba(0x23e)]);});}export function exportSummaryToExcel(){const _0x1ac8cc=a12_0x35cd83,_0x294c56={'enyqJ':function(_0x1cfdd0,_0x58bb71){return _0x1cfdd0(_0x58bb71);},'HjnSk':_0x1ac8cc(0x23a),'RVUtx':function(_0x4d93a5,_0x574114){return _0x4d93a5!==_0x574114;},'FzyAx':_0x1ac8cc(0x1c7),'cJOFe':function(_0x3a6af5,_0x2a6177){return _0x3a6af5===_0x2a6177;},'nOOFi':_0x1ac8cc(0x2e5),'lSnBz':function(_0x2797ab,_0x46668d){return _0x2797ab>_0x46668d;},'PJbck':_0x1ac8cc(0x30f),'vsWkL':_0x1ac8cc(0x2ac),'MsOac':_0x1ac8cc(0x29f),'nIgsf':_0x1ac8cc(0x166),'fAjXQ':function(_0x495726){return _0x495726();},'jHhex':function(_0xd0dedf,_0x1f5d69,_0x7a4eb8){return _0xd0dedf(_0x1f5d69,_0x7a4eb8);},'DARRC':_0x1ac8cc(0x34d),'HqAVE':_0x1ac8cc(0x1ab),'wEWCf':function(_0x228e76,_0x53865d,_0x317d99){return _0x228e76(_0x53865d,_0x317d99);},'LdszB':_0x1ac8cc(0x1bd),'XAzxF':_0x1ac8cc(0x200)};_0x294c56[_0x1ac8cc(0x208)](showLoader),import(_0x294c56[_0x1ac8cc(0x28c)])[_0x1ac8cc(0x168)](_0x56c3e1=>{const _0x5dfaeb=_0x1ac8cc,_0x5cc23d={'njBls':function(_0x1e71e2,_0x1a0114){return _0x1e71e2(_0x1a0114);},'bStKL':function(_0x1c2b50,_0x548b31){return _0x1c2b50>_0x548b31;}},{getProductTrainId:_0x3102ad,calculateScores:_0x201ffb}=_0x56c3e1,_0x10cb4f=a12_0x2a5c73[_0x5dfaeb(0x321)][_0x5dfaeb(0x19b)](_0x2a0a34=>{const _0x591887=_0x5dfaeb,_0x53dd1e=_0x294c56[_0x591887(0x2cd)](_0x3102ad,_0x2a0a34);return _0x2a0a34[_0x591887(0x217)][_0x591887(0x24f)](_0x36e854=>({'productName':_0x2a0a34[_0x591887(0x1fb)],'productCode':_0x2a0a34['productCode'],'ingredientName':_0x36e854[_0x591887(0x1fb)],'rpn':_0x201ffb(_0x36e854)[_0x591887(0x196)],'trainId':_0x591887(0x23a)!==_0x53dd1e?'T'+_0x53dd1e:_0x591887(0x23a),'scores':_0x201ffb(_0x36e854)}));})[_0x5dfaeb(0x2b4)]((_0x278143,_0x3e1999)=>_0x3e1999[_0x5dfaeb(0x196)]-_0x278143[_0x5dfaeb(0x196)])[_0x5dfaeb(0x1f2)](0x0,0xa),_0x5e53e7=a12_0x2a5c73[_0x5dfaeb(0x321)][_0x5dfaeb(0x314)](_0x3e82c7=>_0x3e82c7[_0x5dfaeb(0x214)]);if(0x0===_0x10cb4f['length']&&_0x294c56['cJOFe'](0x0,_0x5e53e7[_0x5dfaeb(0x1af)]))return hideLoader(),void showCustomAlert(_0x294c56[_0x5dfaeb(0x1c2)],'There\x20are\x20no\x20summary\x20data\x20to\x20export.\x20Add\x20products\x20and\x20ingredients\x20first.');const _0x5f3016=XLSX[_0x5dfaeb(0x1d9)][_0x5dfaeb(0x1ea)]();if(_0x294c56['lSnBz'](_0x10cb4f[_0x5dfaeb(0x1af)],0x0)){const _0x17f9cb=_0x10cb4f['map']((_0x519cb1,_0x44999a)=>({'Rank':_0x44999a+0x1,'Product\x20Code':_0x519cb1[_0x5dfaeb(0x198)],'Product\x20Name':_0x519cb1['productName'],'Train':_0x519cb1[_0x5dfaeb(0x27d)],'Ingredient':_0x519cb1[_0x5dfaeb(0x167)],'RPN':_0x519cb1[_0x5dfaeb(0x196)]})),_0x4b1ab8=XLSX['utils'][_0x5dfaeb(0x2c3)](_0x17f9cb),_0x4d7d33=[{'wch':0x8},{'wch':0xf},{'wch':0x1e},{'wch':0xa},{'wch':0x19},{'wch':0x8}];_0x4b1ab8[_0x294c56[_0x5dfaeb(0x131)]]=_0x4d7d33,XLSX[_0x5dfaeb(0x1d9)][_0x5dfaeb(0x361)](_0x5f3016,_0x4b1ab8,_0x294c56[_0x5dfaeb(0x275)]);}if(_0x5e53e7[_0x5dfaeb(0x1af)]>0x0){const _0x411e1b=_0x5e53e7['map'](_0x1327c6=>({'Product\x20Code':_0x1327c6[_0x5dfaeb(0x198)],'Product\x20Name':_0x1327c6[_0x5dfaeb(0x1fb)],'Product\x20Type':_0x1327c6[_0x5dfaeb(0x181)],'Batch\x20Size\x20(kg)':_0x1327c6[_0x5dfaeb(0x23d)],'MDD\x20(mg)':_0x1327c6[_0x5dfaeb(0x340)],'Critical\x20Reason':_0x1327c6['criticalReason']||_0x5dfaeb(0x34c),'Train':'N/A'!==_0x3102ad(_0x1327c6)?'T'+_0x3102ad(_0x1327c6):'N/A'})),_0x2ab443=XLSX[_0x5dfaeb(0x1d9)][_0x5dfaeb(0x2c3)](_0x411e1b),_0x34b66c=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32},{'wch':0xa}];_0x2ab443[_0x294c56[_0x5dfaeb(0x131)]]=_0x34b66c,XLSX[_0x5dfaeb(0x1d9)][_0x5dfaeb(0x361)](_0x5f3016,_0x2ab443,_0x294c56[_0x5dfaeb(0x259)]);}const _0x287798=a12_0x2a5c73[_0x5dfaeb(0x321)][_0x5dfaeb(0x24f)](_0x1402f7=>{const _0x3b94cf=_0x5dfaeb,_0x11a220=_0x294c56[_0x3b94cf(0x2cd)](_0x3102ad,_0x1402f7),_0x265e4c=_0x1402f7['activeIngredients'][_0x3b94cf(0x350)]((_0x4615a7,_0x47ec87)=>{const _0x2212c9=_0x3b94cf,_0xbcbbdb=_0x5cc23d[_0x2212c9(0x170)](_0x201ffb,_0x47ec87)[_0x2212c9(0x196)];return _0x5cc23d[_0x2212c9(0x355)](_0xbcbbdb,_0x4615a7[_0x2212c9(0x196)])?{..._0x47ec87,'rpn':_0xbcbbdb}:_0x4615a7;},{'rpn':0x0,'name':_0x294c56[_0x3b94cf(0x30c)]});return{'Product\x20Code':_0x1402f7[_0x3b94cf(0x198)],'Product\x20Name':_0x1402f7[_0x3b94cf(0x1fb)],'Product\x20Type':_0x1402f7[_0x3b94cf(0x181)],'Batch\x20Size\x20(kg)':_0x1402f7[_0x3b94cf(0x23d)],'MDD\x20(mg)':_0x1402f7[_0x3b94cf(0x340)],'Train':_0x294c56[_0x3b94cf(0x32e)](_0x294c56[_0x3b94cf(0x30c)],_0x11a220)?'T'+_0x11a220:_0x294c56[_0x3b94cf(0x30c)],'Is\x20Critical':_0x1402f7[_0x3b94cf(0x214)]?_0x294c56[_0x3b94cf(0x1ba)]:'No','Critical\x20Reason':_0x1402f7[_0x3b94cf(0x293)]||_0x3b94cf(0x23a),'Ingredients\x20Count':_0x1402f7[_0x3b94cf(0x217)]['length'],'Highest\x20RPN\x20Ingredient':_0x265e4c[_0x3b94cf(0x1fb)],'Highest\x20RPN\x20Value':_0x265e4c[_0x3b94cf(0x196)]||0x0};}),_0x3174e3=XLSX[_0x5dfaeb(0x1d9)][_0x5dfaeb(0x2c3)](_0x287798);_0x3174e3['!cols']=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xa},{'wch':0xa},{'wch':0x28},{'wch':0xc},{'wch':0x19},{'wch':0xc}],XLSX[_0x5dfaeb(0x1d9)][_0x5dfaeb(0x361)](_0x5f3016,_0x3174e3,_0x294c56[_0x5dfaeb(0x20c)]);const _0x76890f=new Date()[_0x5dfaeb(0x17e)]()[_0x5dfaeb(0x177)]('T')[0x0];XLSX[_0x5dfaeb(0x34a)](_0x5f3016,_0x5dfaeb(0x270)+_0x76890f+_0x5dfaeb(0x2c5)),_0x294c56[_0x5dfaeb(0x208)](hideLoader),_0x294c56['jHhex'](showCustomAlert,_0x5dfaeb(0x35c),_0x294c56[_0x5dfaeb(0x1c8)]);})[_0x1ac8cc(0x27f)](_0x3b5e57=>{const _0x49f6ed=_0x1ac8cc;console['error'](_0x294c56[_0x49f6ed(0x2f1)],_0x3b5e57),_0x294c56[_0x49f6ed(0x208)](hideLoader),_0x294c56['wEWCf'](showCustomAlert,_0x49f6ed(0x133),_0x294c56[_0x49f6ed(0x304)]);});}export function exportAllTabsToExcel(){const _0x1cdb72=a12_0x35cd83,_0xf8f9df={'PQFca':function(_0x35d35e,_0x19724a){return _0x35d35e(_0x19724a);},'StxiM':function(_0x39257c,_0x5ba01c){return _0x39257c/_0x5ba01c;},'ziDSX':function(_0x39858f,_0x5d9cd0){return _0x39858f*_0x5d9cd0;},'wPnqS':_0x1cdb72(0x23a),'WMEkc':function(_0x103ecc,_0x473939){return _0x103ecc!==_0x473939;},'Jmqaz':_0x1cdb72(0x13a),'SxzLQ':_0x1cdb72(0x349),'qBjFi':function(_0x5f50ca,_0x30686e){return _0x5f50ca==_0x30686e;},'cdyGJ':'number','jFswA':function(_0x4f9d58,_0x44247e){return _0x4f9d58/_0x44247e;},'cSpzC':function(_0x22e406,_0x446641){return _0x22e406>_0x446641;},'TPTHD':'\x20→\x20','gbNQw':function(_0x5d544d,_0x25d071){return _0x5d544d(_0x25d071);},'WpaEw':function(_0x492407,_0x68d692){return _0x492407/_0x68d692;},'tRXzt':function(_0x34224c,_0x573fff){return _0x34224c*_0x573fff;},'Cbwdd':function(_0x2f42c7,_0x330323){return _0x2f42c7>_0x330323;},'GpVdy':function(_0x3e5292,_0x2af14b){return _0x3e5292*_0x2af14b;},'WrEOK':function(_0x58eb14,_0x3b9fe9){return _0x58eb14!==_0x3b9fe9;},'JBJxA':function(_0x3169ed,_0x4fe3ad){return _0x3169ed(_0x4fe3ad);},'yJNvP':function(_0xc1a3f2,_0x4ab8ad){return _0xc1a3f2||_0x4ab8ad;},'CWgBF':function(_0x2c1d78,_0x55b625){return _0x2c1d78!==_0x55b625;},'ySEcY':_0x1cdb72(0x324),'otAiS':function(_0xc827c){return _0xc827c();},'ngROh':function(_0x52eec8,_0x57482e){return _0x52eec8===_0x57482e;},'kwBbD':function(_0xf2e05){return _0xf2e05();},'qlJKK':function(_0x3dfc63,_0x553fce,_0x4d1bb9){return _0x3dfc63(_0x553fce,_0x4d1bb9);},'hZnol':_0x1cdb72(0x2e5),'wlEqg':_0x1cdb72(0x298),'mkhIF':_0x1cdb72(0x359),'CkYOm':_0x1cdb72(0x15f),'ZHYmi':function(_0x280b3e,_0x35a3af){return _0x280b3e>_0x35a3af;},'vnlRc':_0x1cdb72(0x229),'HvURV':_0x1cdb72(0x24c),'iEzZD':_0x1cdb72(0x1c0),'JykSQ':function(_0x2dd8fe,_0x1e26a5){return _0x2dd8fe>_0x1e26a5;},'agZBU':'Error\x20creating\x20Top\x2010\x20RPN\x20sheet:','jGGDM':'Critical\x20Products','OFlqQ':'Error\x20creating\x20Critical\x20Products\x20sheet:','HaoBI':'All\x20Products','dNztH':_0x1cdb72(0x260),'vSthk':_0x1cdb72(0x19e),'djIBY':function(_0x509739,_0x45a127,_0x4ab572){return _0x509739(_0x45a127,_0x4ab572);},'Hxdgj':'Success','qvGIV':_0x1cdb72(0x2cb),'fVQLZ':_0x1cdb72(0x2e2),'uevOl':function(_0x50a503){return _0x50a503();},'FRnMs':_0x1cdb72(0x133),'dhehR':_0x1cdb72(0x164),'VaFEA':_0x1cdb72(0x200)};showLoader(),import(_0xf8f9df['VaFEA'])['then'](_0x39edfb=>{const _0x1fdfa1=_0x1cdb72,_0x1c0c1a={'hmKkd':function(_0x2d2de1,_0x2e7cd0){const _0x545702=a12_0x4a84;return _0xf8f9df[_0x545702(0x364)](_0x2d2de1,_0x2e7cd0);},'zuEdk':_0xf8f9df[_0x1fdfa1(0x2ee)],'TXBbT':function(_0x28297a,_0x3d95db){return _0x28297a||_0x3d95db;},'IiAfQ':function(_0x521773,_0x4abd30){const _0x13d995=_0x1fdfa1;return _0xf8f9df[_0x13d995(0x364)](_0x521773,_0x4abd30);},'DDzpu':function(_0x318c45,_0x4de7d3){return _0xf8f9df['gbNQw'](_0x318c45,_0x4de7d3);},'SDymU':function(_0x218771,_0x707373){return _0xf8f9df['CWgBF'](_0x218771,_0x707373);},'YAjkj':_0x1fdfa1(0x221),'CBmXT':function(_0x6f13c0,_0xffc6c3){const _0x266e05=_0x1fdfa1;return _0xf8f9df[_0x266e05(0x1d2)](_0x6f13c0,_0xffc6c3);},'gjARZ':_0x1fdfa1(0x1c7),'WAHrc':_0xf8f9df['ySEcY']},{getTrainData:_0x440c45,getWorstCaseProductType:_0x4b4918,getProductTrainId:_0x2ba209,calculateScores:_0x5f21fc}=_0x39edfb,_0x31dbc2=_0xf8f9df[_0x1fdfa1(0x15a)](_0x440c45);if(_0xf8f9df[_0x1fdfa1(0x1ce)](0x0,_0x31dbc2['length']))return _0xf8f9df['kwBbD'](hideLoader),void _0xf8f9df[_0x1fdfa1(0x296)](showCustomAlert,_0xf8f9df[_0x1fdfa1(0x2ad)],_0xf8f9df['wlEqg']);const _0x2a7bf1=XLSX[_0x1fdfa1(0x1d9)][_0x1fdfa1(0x1ea)]();try{const _0x38ee78=_0x31dbc2[_0x1fdfa1(0x350)]((_0x414a7b,_0x4211b0)=>_0x4211b0[_0x1fdfa1(0x366)]>_0x414a7b[_0x1fdfa1(0x366)]?_0x4211b0:_0x414a7b)['essa'],_0x1e94ea=[];_0x31dbc2[_0x1fdfa1(0x14f)](_0x29ebd3=>{const _0x68bc54=_0x1fdfa1,_0x215f54=_0xf8f9df[_0x68bc54(0x15e)](_0x4b4918,_0x29ebd3['products'][_0x68bc54(0x24f)](_0x41a636=>_0x41a636['productType'])),_0x5ccf73=(a12_0x2a5c73['safetyFactorConfig'][_0x215f54]||a12_0x2a5c73['safetyFactorConfig'][_0x68bc54(0x20d)])[_0x68bc54(0x1bb)],_0x3ae770=_0xf8f9df[_0x68bc54(0x29d)](_0xf8f9df[_0x68bc54(0x20a)](_0x29ebd3[_0x68bc54(0x310)],_0x29ebd3['minBsMddRatio']),_0x5ccf73),_0x4c1322=_0xf8f9df[_0x68bc54(0x20a)](0xa,_0x29ebd3[_0x68bc54(0x215)]);let _0x22ca3e=_0xf8f9df[_0x68bc54(0x2ee)];_0xf8f9df[_0x68bc54(0x146)](null,_0x29ebd3['lowestPde'])&&(_0x22ca3e=_0x29ebd3['lowestPde']*_0x29ebd3['minBsMddRatio']);const _0x144ca1=0.004*_0x38ee78,_0x15a304=[{'name':_0xf8f9df[_0x68bc54(0x2f3)],'value':_0x3ae770},{'name':_0xf8f9df['SxzLQ'],'value':_0x4c1322},{'name':_0x68bc54(0x209),'value':_0xf8f9df[_0x68bc54(0x2ec)](_0xf8f9df[_0x68bc54(0x266)],typeof _0x22ca3e)?_0x22ca3e:_0xf8f9df[_0x68bc54(0x2a0)](0x1,0x0)},{'name':_0x68bc54(0x1b0),'value':_0x144ca1}]['reduce']((_0x4582d1,_0x5e3d09)=>_0x5e3d09[_0x68bc54(0x130)]<_0x4582d1[_0x68bc54(0x130)]?_0x5e3d09:_0x4582d1),_0x3964d1=_0x15a304['value'],_0x174ece=_0xf8f9df[_0x68bc54(0x136)](_0x38ee78,0x0)?_0xf8f9df[_0x68bc54(0x2a0)](_0x3964d1,_0x38ee78):0x0,_0x1ea051=_0xf8f9df[_0x68bc54(0x20a)](_0x174ece,_0x29ebd3['assumedSsa']),_0x3ca736=_0x29ebd3[_0x68bc54(0x276)][_0x68bc54(0x24f)](_0x4aa36e=>{const _0x4eaaed=_0x68bc54,_0x297dd2=a12_0x2a5c73[_0x4eaaed(0x2d9)][_0x4eaaed(0x17a)](_0x2c820c=>_0x2c820c['id']===_0x4aa36e);return _0x1c0c1a['hmKkd'](_0x297dd2,{'name':_0x4eaaed(0x184)+_0x4aa36e+')','machineNumber':_0x1c0c1a[_0x4eaaed(0x26a)]});}),_0x5645c9=_0x39edfb[_0x68bc54(0x16e)](_0x29ebd3['machineIds'])['map'](_0x2a9342=>_0x2a9342[_0x68bc54(0x2a6)]?_0x2a9342[_0x68bc54(0x16f)]+'\x20('+_0x2a9342[_0x68bc54(0x32a)]+'x)':_0x2a9342[_0x68bc54(0x1fb)])[_0x68bc54(0x338)](_0xf8f9df['TPTHD']),_0x3364ae=_0x29ebd3[_0x68bc54(0x321)]['map'](_0x221107=>_0x221107[_0x68bc54(0x198)]+'\x20-\x20'+_0x221107[_0x68bc54(0x1fb)])[_0x68bc54(0x338)](';\x20'),_0x147a49=_0x29ebd3[_0x68bc54(0x291)]?_0x29ebd3['worstProductRpn'][_0x68bc54(0x28e)]+'\x20('+_0x29ebd3['worstProductRpn']['ingredientName']+')\x20-\x20RPN:\x20'+_0x29ebd3[_0x68bc54(0x291)][_0x68bc54(0x196)]:_0xf8f9df[_0x68bc54(0x2ee)];_0x1e94ea['push']({'Train':'T'+_0x29ebd3['id'],'Total\x20Products':_0x29ebd3[_0x68bc54(0x321)][_0x68bc54(0x1af)],'Total\x20Machines':_0x3ca736['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x29ebd3[_0x68bc54(0x366)]['toLocaleString'](),'Products':_0x3364ae,'Machines':_0x5645c9,'Worst-Case\x20Dosage\x20Form':_0x215f54,'Safety\x20Factor':_0x5ccf73,'Lowest\x20LTD\x20(mg)':_0x29ebd3['lowestLtd'],'Min\x20Batch\x20Size\x20(kg)':_0x29ebd3['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x29ebd3[_0x68bc54(0x212)][_0x68bc54(0x263)](0x2),'Lowest\x20PDE\x20(mg)':null!==_0x29ebd3[_0x68bc54(0x13e)]?_0x29ebd3[_0x68bc54(0x13e)]:_0xf8f9df[_0x68bc54(0x2ee)],'Worst-Case\x20Product\x20(by\x20RPN)':_0x147a49,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x3ae770[_0x68bc54(0x263)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x4c1322[_0x68bc54(0x263)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0xf8f9df['qBjFi'](_0xf8f9df['cdyGJ'],typeof _0x22ca3e)?_0x22ca3e['toFixed'](0x2):_0x68bc54(0x23a),'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x144ca1[_0x68bc54(0x263)](0x2),'Selected\x20MACO\x20Method':_0x15a304[_0x68bc54(0x1fb)],'Final\x20MACO\x20(mg)':_0x3964d1[_0x68bc54(0x263)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x174ece[_0x68bc54(0x22c)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x1ea051[_0x68bc54(0x263)](0x4)});});const _0x899bcc=XLSX[_0x1fdfa1(0x1d9)]['json_to_sheet'](_0x1e94ea);XLSX[_0x1fdfa1(0x1d9)][_0x1fdfa1(0x361)](_0x2a7bf1,_0x899bcc,_0xf8f9df['mkhIF']);}catch(_0x2504f7){console[_0x1fdfa1(0x17b)](_0xf8f9df[_0x1fdfa1(0x2d4)],_0x2504f7);}try{if(a12_0x2a5c73[_0x1fdfa1(0x1d6)][_0x1fdfa1(0x1af)]>0x0){const _0x561884=_0xf8f9df[_0x1fdfa1(0x32d)](_0x31dbc2[_0x1fdfa1(0x1af)],0x0)?Math[_0x1fdfa1(0x1bb)](..._0x31dbc2[_0x1fdfa1(0x24f)](_0x3a53ad=>_0x3a53ad[_0x1fdfa1(0x366)])):0x0,_0x189821=parseFloat(document[_0x1fdfa1(0x255)]('bodyWeight')?.[_0x1fdfa1(0x130)])||0x46,_0xdbf2ed=a12_0x2a5c73[_0x1fdfa1(0x1d6)][_0x1fdfa1(0x24f)](_0x218d94=>parseFloat(_0x218d94[_0x1fdfa1(0x134)]))[_0x1fdfa1(0x314)](_0x145e99=>!isNaN(_0x145e99)),_0x551e6a=_0xf8f9df[_0x1fdfa1(0x1b1)](_0xdbf2ed[_0x1fdfa1(0x1af)],0x0)?Math[_0x1fdfa1(0x317)](..._0xdbf2ed):0x0,_0x460258=a12_0x2a5c73[_0x1fdfa1(0x1d6)][_0x1fdfa1(0x24f)](_0x173efd=>_0x173efd['name'])[_0x1fdfa1(0x314)](_0x3ee935=>''!==_0x3ee935['trim']())[_0x1fdfa1(0x338)](',\x20'),_0x3c8ec8=[];_0x31dbc2[_0x1fdfa1(0x14f)](_0x204387=>{const _0x35a3fd=_0x1fdfa1,_0x478ddd=_0xf8f9df['gbNQw'](_0x4b4918,_0x204387[_0x35a3fd(0x321)][_0x35a3fd(0x24f)](_0x2f0efb=>_0x2f0efb[_0x35a3fd(0x181)])),_0x210a3b=a12_0x2a5c73['safetyFactorConfig'][_0x478ddd]||a12_0x2a5c73['safetyFactorConfig'][_0x35a3fd(0x20d)],_0x53b600=document[_0x35a3fd(0x255)]('sf-input-train-'+_0x204387['id']),_0x2fddac=_0x53b600&&parseFloat(_0x53b600[_0x35a3fd(0x130)])||_0x210a3b[_0x35a3fd(0x1bb)],_0x49c728=_0xf8f9df[_0x35a3fd(0x243)](_0xf8f9df[_0x35a3fd(0x1ed)](_0xf8f9df[_0x35a3fd(0x20a)](0.0005,_0x551e6a),_0x189821),_0x2fddac),_0x489624=_0xf8f9df[_0x35a3fd(0x20a)](_0x49c728,_0x204387[_0x35a3fd(0x212)]),_0x1206e5=_0xf8f9df['Cbwdd'](_0x561884,0x0)?_0xf8f9df[_0x35a3fd(0x243)](_0x489624,_0x561884):0x0,_0x3ba02f=_0xf8f9df[_0x35a3fd(0x1f4)](_0x1206e5,_0x204387[_0x35a3fd(0x1eb)]),_0x4fb64a=_0x204387[_0x35a3fd(0x276)][_0x35a3fd(0x24f)](_0x67a587=>{const _0x33651e=_0x35a3fd,_0x403827=a12_0x2a5c73[_0x33651e(0x2d9)][_0x33651e(0x17a)](_0x6a0d5e=>_0x6a0d5e['id']===_0x67a587);return _0x1c0c1a[_0x33651e(0x1da)](_0x403827,{'name':_0x33651e(0x184)+_0x67a587+')','machineNumber':_0x1c0c1a[_0x33651e(0x26a)]});}),_0x816f3b=_0x39edfb[_0x35a3fd(0x16e)](_0x204387[_0x35a3fd(0x276)])[_0x35a3fd(0x24f)](_0x4fdec0=>_0x4fdec0['isGroup']?_0x4fdec0['group']+'\x20('+_0x4fdec0['machineCount']+'x)':_0x4fdec0['name'])[_0x35a3fd(0x338)](_0xf8f9df[_0x35a3fd(0x20b)]),_0x44009e=_0x204387[_0x35a3fd(0x321)]['map'](_0x320ba2=>_0x320ba2[_0x35a3fd(0x198)]+'\x20-\x20'+_0x320ba2['name'])['join'](';\x20'),_0x24422a=_0x204387['worstProductRpn']?_0x204387['worstProductRpn'][_0x35a3fd(0x28e)]+'\x20('+_0x204387[_0x35a3fd(0x291)]['ingredientName']+_0x35a3fd(0x2be)+_0x204387[_0x35a3fd(0x291)]['rpn']:_0x35a3fd(0x23a);_0x3c8ec8['push']({'Train':'T'+_0x204387['id'],'Total\x20Products':_0x204387[_0x35a3fd(0x321)][_0x35a3fd(0x1af)],'Total\x20Machines':_0x4fb64a['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x204387[_0x35a3fd(0x366)][_0x35a3fd(0x1a2)](),'Products':_0x44009e,'Machines':_0x816f3b,'Worst-Case\x20Dosage\x20Form':_0x478ddd,'Safety\x20Factor\x20Range':_0x210a3b['min']+'\x20-\x20'+_0x210a3b[_0x35a3fd(0x1bb)],'Applied\x20Safety\x20Factor':_0x2fddac,'Detergent\x20Ingredients':_0x460258,'Body\x20Weight\x20(kg)':_0x189821,'Minimum\x20LD50\x20(mg/kg)':_0x551e6a,'Min\x20Batch\x20Size\x20(kg)':_0x204387['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x204387['minBsMddRatio'][_0x35a3fd(0x263)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x24422a,'ADI\x20(mg)':_0x49c728[_0x35a3fd(0x263)](0x4),'MACO\x20(mg)':_0x489624[_0x35a3fd(0x263)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x1206e5['toExponential'](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x3ba02f[_0x35a3fd(0x263)](0x4)});});const _0x35ed58=XLSX[_0x1fdfa1(0x1d9)][_0x1fdfa1(0x2c3)](_0x3c8ec8);XLSX[_0x1fdfa1(0x1d9)]['book_append_sheet'](_0x2a7bf1,_0x35ed58,_0x1fdfa1(0x288));}}catch(_0x5332b5){console['error'](_0xf8f9df['vnlRc'],_0x5332b5);}try{const _0x49c86e=[];_0x31dbc2[_0x1fdfa1(0x14f)](_0x38fd35=>{const _0x269c59=_0x1fdfa1,_0x2fb891=_0x38fd35[_0x269c59(0x276)][_0x269c59(0x24f)](_0x3f7c66=>{const _0x5c7d1e=_0x269c59,_0x56330f=a12_0x2a5c73[_0x5c7d1e(0x2d9)]['find'](_0x3cc9bf=>_0x3cc9bf['id']===_0x3f7c66);return _0x1c0c1a['IiAfQ'](_0x56330f,{'id':_0x3f7c66,'name':_0x5c7d1e(0x184)+_0x3f7c66+')','machineNumber':_0x1c0c1a[_0x5c7d1e(0x26a)]});}),_0xf87f49=_0x39edfb[_0x269c59(0x16e)](_0x38fd35[_0x269c59(0x276)])[_0x269c59(0x24f)](_0x329c8d=>_0x329c8d[_0x269c59(0x2a6)]?_0x329c8d[_0x269c59(0x16f)]+'\x20('+_0x329c8d[_0x269c59(0x32a)]+'x)':_0x329c8d[_0x269c59(0x1fb)])[_0x269c59(0x338)](_0xf8f9df[_0x269c59(0x20b)]),_0x224fc8=_0x38fd35[_0x269c59(0x321)][_0x269c59(0x24f)](_0x16f76c=>_0x16f76c[_0x269c59(0x198)]+_0x269c59(0x1fc)+_0x16f76c['name'])[_0x269c59(0x338)](';\x20'),_0x109e35=_0x38fd35[_0x269c59(0x321)][_0x269c59(0x24f)](_0x5d9aaa=>_0x5d9aaa[_0x269c59(0x198)]+':\x20'+_0x5d9aaa[_0x269c59(0x1fb)])['join']('\x0a'),_0x5b324f=_0x2fb891[_0x269c59(0x24f)](_0x13a86b=>_0x13a86b['machineNumber']+':\x20'+_0x13a86b['name'])[_0x269c59(0x338)]('\x0a');_0x49c86e['push']({'Train\x20ID':'T'+_0x38fd35['id'],'Products\x20Count':_0x38fd35['products'][_0x269c59(0x1af)],'Machines\x20Count':_0x2fb891[_0x269c59(0x1af)],'Total\x20Area\x20(ESSA)\x20cm²':_0x38fd35[_0x269c59(0x366)][_0x269c59(0x1a2)](),'Products\x20(Code\x20-\x20Name)':_0x224fc8,'Machines\x20(Number\x20-\x20Name)':_0xf87f49,'Products\x20Detailed':_0x109e35,'Machines\x20Detailed':_0x5b324f,'Min\x20Batch\x20Size\x20(kg)':_0x38fd35[_0x269c59(0x215)],'Min\x20BS/MDD\x20Ratio':_0x38fd35['minBsMddRatio'][_0x269c59(0x263)](0x2),'Assumed\x20SSA\x20(cm²)':_0x38fd35[_0x269c59(0x1eb)],'Lowest\x20LTD\x20(mg)':_0x38fd35['lowestLtd'],'Lowest\x20PDE\x20(mg)':_0xf8f9df[_0x269c59(0x254)](null,_0x38fd35[_0x269c59(0x13e)])?_0x38fd35['lowestPde']:_0xf8f9df['wPnqS'],'Worst\x20RPN\x20Product':_0x38fd35[_0x269c59(0x291)]?_0x38fd35[_0x269c59(0x291)]['productName']+'\x20('+_0x38fd35[_0x269c59(0x291)][_0x269c59(0x167)]+_0x269c59(0x2be)+_0x38fd35[_0x269c59(0x291)]['rpn']:_0xf8f9df[_0x269c59(0x2ee)]});});const _0x175b77=XLSX[_0x1fdfa1(0x1d9)][_0x1fdfa1(0x2c3)](_0x49c86e);XLSX['utils'][_0x1fdfa1(0x361)](_0x2a7bf1,_0x175b77,_0xf8f9df[_0x1fdfa1(0x297)]);}catch(_0x38b1a2){console[_0x1fdfa1(0x17b)](_0xf8f9df['iEzZD'],_0x38b1a2);}try{const _0x33ee15=a12_0x2a5c73[_0x1fdfa1(0x321)][_0x1fdfa1(0x19b)](_0x388100=>{const _0x4aa1be=_0x1fdfa1,_0x224d9d=_0xf8f9df['JBJxA'](_0x2ba209,_0x388100);return _0x388100['activeIngredients'][_0x4aa1be(0x24f)](_0x438b1b=>({'productName':_0x388100['name'],'productCode':_0x388100[_0x4aa1be(0x198)],'ingredientName':_0x438b1b['name'],'rpn':_0x5f21fc(_0x438b1b)[_0x4aa1be(0x196)],'trainId':_0x4aa1be(0x23a)!==_0x224d9d?'T'+_0x224d9d:_0x4aa1be(0x23a)}));})[_0x1fdfa1(0x2b4)]((_0x4c883e,_0x6ff5d4)=>_0x6ff5d4[_0x1fdfa1(0x196)]-_0x4c883e[_0x1fdfa1(0x196)])[_0x1fdfa1(0x1f2)](0x0,0xa);if(_0xf8f9df[_0x1fdfa1(0x204)](_0x33ee15['length'],0x0)){const _0x5e6573=_0x33ee15[_0x1fdfa1(0x24f)]((_0x442a58,_0x56134e)=>({'Rank':_0x56134e+0x1,'Product\x20Code':_0x442a58[_0x1fdfa1(0x198)],'Product\x20Name':_0x442a58['productName'],'Train':_0x442a58[_0x1fdfa1(0x27d)],'Ingredient':_0x442a58[_0x1fdfa1(0x167)],'RPN':_0x442a58[_0x1fdfa1(0x196)]})),_0x431903=XLSX[_0x1fdfa1(0x1d9)]['json_to_sheet'](_0x5e6573);XLSX[_0x1fdfa1(0x1d9)][_0x1fdfa1(0x361)](_0x2a7bf1,_0x431903,_0x1fdfa1(0x2ac));}}catch(_0x40109b){console[_0x1fdfa1(0x17b)](_0xf8f9df['agZBU'],_0x40109b);}try{const _0x11f009=a12_0x2a5c73[_0x1fdfa1(0x321)][_0x1fdfa1(0x314)](_0x52fa47=>_0x52fa47['isCritical']);if(_0xf8f9df[_0x1fdfa1(0x1b1)](_0x11f009['length'],0x0)){const _0x3491b0=_0x11f009[_0x1fdfa1(0x24f)](_0xe1c72=>({'Product\x20Code':_0xe1c72[_0x1fdfa1(0x198)],'Product\x20Name':_0xe1c72[_0x1fdfa1(0x1fb)],'Product\x20Type':_0xe1c72['productType'],'Batch\x20Size\x20(kg)':_0xe1c72[_0x1fdfa1(0x23d)],'MDD\x20(mg)':_0xe1c72[_0x1fdfa1(0x340)],'Critical\x20Reason':_0xe1c72[_0x1fdfa1(0x293)]||'No\x20reason\x20provided','Train':_0x1fdfa1(0x23a)!==_0x2ba209(_0xe1c72)?'T'+_0x2ba209(_0xe1c72):_0x1fdfa1(0x23a)})),_0x212365=XLSX[_0x1fdfa1(0x1d9)]['json_to_sheet'](_0x3491b0);XLSX[_0x1fdfa1(0x1d9)][_0x1fdfa1(0x361)](_0x2a7bf1,_0x212365,_0xf8f9df[_0x1fdfa1(0x1fa)]);}}catch(_0x5dc0a7){console[_0x1fdfa1(0x17b)](_0xf8f9df['OFlqQ'],_0x5dc0a7);}try{const _0x5ee0d5=a12_0x2a5c73[_0x1fdfa1(0x321)][_0x1fdfa1(0x24f)](_0x5a4e2d=>{const _0x24ca63=_0x1fdfa1,_0x3cc7c8=_0x1c0c1a[_0x24ca63(0x1ac)](_0x2ba209,_0x5a4e2d),_0x2816c4=_0x5a4e2d[_0x24ca63(0x217)][_0x24ca63(0x350)]((_0x5dbcf8,_0x548810)=>{const _0x4971e9=_0x24ca63,_0x2c03a7=_0x1c0c1a[_0x4971e9(0x1ac)](_0x5f21fc,_0x548810)['rpn'];return _0x2c03a7>_0x5dbcf8['rpn']?{..._0x548810,'rpn':_0x2c03a7}:_0x5dbcf8;},{'rpn':0x0,'name':'N/A'});return{'Product\x20Code':_0x5a4e2d['productCode'],'Product\x20Name':_0x5a4e2d[_0x24ca63(0x1fb)],'Product\x20Type':_0x5a4e2d['productType'],'Batch\x20Size\x20(kg)':_0x5a4e2d[_0x24ca63(0x23d)],'MDD\x20(mg)':_0x5a4e2d[_0x24ca63(0x340)],'Train':_0x1c0c1a[_0x24ca63(0x22b)](_0x1c0c1a[_0x24ca63(0x26a)],_0x3cc7c8)?'T'+_0x3cc7c8:_0x1c0c1a[_0x24ca63(0x26a)],'Is\x20Critical':_0x5a4e2d['isCritical']?_0x24ca63(0x1c7):'No','Critical\x20Reason':_0x5a4e2d[_0x24ca63(0x293)]||_0x1c0c1a[_0x24ca63(0x26a)],'Ingredients\x20Count':_0x5a4e2d[_0x24ca63(0x217)]['length'],'Highest\x20RPN\x20Ingredient':_0x2816c4[_0x24ca63(0x1fb)],'Highest\x20RPN\x20Value':_0x2816c4[_0x24ca63(0x196)]||0x0};}),_0x40cf37=XLSX['utils'][_0x1fdfa1(0x2c3)](_0x5ee0d5);XLSX[_0x1fdfa1(0x1d9)][_0x1fdfa1(0x361)](_0x2a7bf1,_0x40cf37,_0xf8f9df[_0x1fdfa1(0x2dd)]);}catch(_0x16910d){console[_0x1fdfa1(0x17b)](_0xf8f9df['dNztH'],_0x16910d);}try{const _0x4dd900=[];a12_0x2a5c73['products'][_0x1fdfa1(0x14f)](_0x2d5d39=>{const _0x1632ea=_0x1fdfa1,_0x1b037d=_0x1c0c1a[_0x1632ea(0x1ac)](_0x2ba209,_0x2d5d39),_0x1bf888={'Product\x20Code':_0x2d5d39['productCode'],'Product\x20Name':_0x2d5d39[_0x1632ea(0x1fb)],'Product\x20Type':_0x2d5d39[_0x1632ea(0x181)],'Batch\x20Size\x20(kg)':_0x2d5d39[_0x1632ea(0x23d)],'MDD\x20(mg)':_0x2d5d39[_0x1632ea(0x340)],'Train':_0x1c0c1a['CBmXT'](_0x1c0c1a[_0x1632ea(0x26a)],_0x1b037d)?'T'+_0x1b037d:_0x1c0c1a[_0x1632ea(0x26a)],'Is\x20Critical':_0x2d5d39[_0x1632ea(0x214)]?_0x1c0c1a[_0x1632ea(0x18e)]:'No','Critical\x20Reason':_0x2d5d39[_0x1632ea(0x293)]||_0x1c0c1a[_0x1632ea(0x26a)],'Ingredient\x20Type':_0x1c0c1a[_0x1632ea(0x22e)],'Ingredient\x20Name':'','LTD\x20(mg)':'','PDE\x20(mg)':'','LD50\x20(mg/kg)':'','Severity':'','Occurrence':'','Detection':'','RPN':''};_0x4dd900[_0x1632ea(0x2b2)](_0x1bf888),_0x2d5d39[_0x1632ea(0x217)][_0x1632ea(0x14f)](_0x10552e=>{const _0x4d0dbd=_0x1632ea,_0x40bdf4=_0x1c0c1a[_0x4d0dbd(0x1ac)](_0x5f21fc,_0x10552e);_0x4dd900[_0x4d0dbd(0x2b2)]({'Product\x20Code':'','Product\x20Name':'','Product\x20Type':'','Batch\x20Size\x20(kg)':'','MDD\x20(mg)':'','Train':'','Is\x20Critical':'','Critical\x20Reason':'','Ingredient\x20Type':_0x1c0c1a[_0x4d0dbd(0x159)],'Ingredient\x20Name':_0x10552e[_0x4d0dbd(0x1fb)],'LTD\x20(mg)':_0x10552e['ltdMg']||_0x1c0c1a[_0x4d0dbd(0x26a)],'PDE\x20(mg)':_0x10552e[_0x4d0dbd(0x17c)]||_0x1c0c1a[_0x4d0dbd(0x26a)],'LD50\x20(mg/kg)':_0x10552e[_0x4d0dbd(0x134)]||_0x1c0c1a[_0x4d0dbd(0x26a)],'Severity':_0x40bdf4[_0x4d0dbd(0x14e)],'Occurrence':_0x40bdf4[_0x4d0dbd(0x205)],'Detection':_0x40bdf4[_0x4d0dbd(0x13d)],'RPN':_0x40bdf4[_0x4d0dbd(0x196)]});});});const _0x29e373=XLSX['utils'][_0x1fdfa1(0x2c3)](_0x4dd900);XLSX[_0x1fdfa1(0x1d9)]['book_append_sheet'](_0x2a7bf1,_0x29e373,_0xf8f9df['vSthk']);}catch(_0x5f3a5a){console[_0x1fdfa1(0x17b)](_0x1fdfa1(0x26f),_0x5f3a5a);}const _0x3b9244=new Date()['toISOString']()[_0x1fdfa1(0x177)]('T')[0x0];XLSX['writeFile'](_0x2a7bf1,_0x1fdfa1(0x30d)+_0x3b9244+_0x1fdfa1(0x2c5)),_0xf8f9df['kwBbD'](hideLoader),_0xf8f9df[_0x1fdfa1(0x1a9)](showCustomAlert,_0xf8f9df[_0x1fdfa1(0x332)],_0xf8f9df['qvGIV']);})[_0x1cdb72(0x27f)](_0x19b301=>{const _0x2bc856=_0x1cdb72;console[_0x2bc856(0x17b)](_0xf8f9df[_0x2bc856(0x26e)],_0x19b301),_0xf8f9df[_0x2bc856(0x336)](hideLoader),showCustomAlert(_0xf8f9df[_0x2bc856(0x2fb)],_0xf8f9df[_0x2bc856(0x18d)]);});}export function toggleStageSection(_0x3a38f4){const _0x374e83=a12_0x35cd83,_0x416411={'KTcAJ':_0x374e83(0x2d1),'apdAI':'button','tglEx':_0x374e83(0x1e2),'GoiGK':_0x374e83(0x142)},_0x395d55=document[_0x374e83(0x255)](_0x374e83(0x265)+_0x3a38f4),_0x454f20=_0x416411[_0x374e83(0x160)]===_0x395d55['style']['display'];_0x395d55[_0x374e83(0x13b)][_0x374e83(0x329)]=_0x454f20?'':_0x416411[_0x374e83(0x160)],localStorage[_0x374e83(0x347)](_0x374e83(0x31d)+_0x3a38f4+_0x374e83(0x2cf),!_0x454f20);const _0x5bd666=_0x395d55['parentElement']['querySelector'](_0x416411[_0x374e83(0x2ab)]);_0x5bd666&&(_0x5bd666[_0x374e83(0x236)]=_0x454f20?_0x416411[_0x374e83(0x326)]:_0x416411[_0x374e83(0x1a4)]);}