const a12_0x3bc3c7=a12_0x4a07;(function(_0x3f99aa,_0x4f3d29){const _0x43f773=a12_0x4a07,_0xe77c92=_0x3f99aa();while(!![]){try{const _0x3ac89e=parseInt(_0x43f773(0x25e))/0x1+-parseInt(_0x43f773(0x157))/0x2*(parseInt(_0x43f773(0x1b3))/0x3)+-parseInt(_0x43f773(0xe1))/0x4+parseInt(_0x43f773(0x1fe))/0x5+parseInt(_0x43f773(0x273))/0x6+-parseInt(_0x43f773(0x303))/0x7+-parseInt(_0x43f773(0x318))/0x8;if(_0x3ac89e===_0x4f3d29)break;else _0xe77c92['push'](_0xe77c92['shift']());}catch(_0x3a020a){_0xe77c92['push'](_0xe77c92['shift']());}}}(a12_0x478f,0xbc4b1));import*as a12_0x275932 from'./state.js';import{fullAppRender as a12_0x333cd5}from'./app.js';import{generateTrainMap as a12_0x199969}from'./utils.js';import{toggleScoringEditMode as a12_0x3719fb}from'./scoringView.js';import{renderRpnChart as a12_0x485c3f}from'./worstCaseView.js';import{renderMacoChart as a12_0x228813}from'./dashboardView.js';const s=document[a12_0x3bc3c7(0x2d7)](a12_0x3bc3c7(0x28b));export const showLoader=()=>s['style'][a12_0x3bc3c7(0xde)]=a12_0x3bc3c7(0x17f);export const hideLoader=()=>s[a12_0x3bc3c7(0x136)][a12_0x3bc3c7(0xde)]=a12_0x3bc3c7(0x2d6);export function showCustomAlert(_0x263b62,_0x5c2d86){const _0x18009d=a12_0x3bc3c7,_0x179e88={'rtCiR':_0x18009d(0x17f)};document[_0x18009d(0x2d7)]('customAlertTitle')['textContent']=_0x263b62,document[_0x18009d(0x2d7)](_0x18009d(0x1ec))[_0x18009d(0x18b)]=_0x5c2d86,document['getElementById'](_0x18009d(0x1b9))[_0x18009d(0x136)][_0x18009d(0xde)]=_0x179e88[_0x18009d(0x258)];}export const hideModal=_0x2d445d=>document[a12_0x3bc3c7(0x2d7)](_0x2d445d)[a12_0x3bc3c7(0x136)][a12_0x3bc3c7(0xde)]='none';export function saveAllDataToLocalStorage(){const _0x2244fe=a12_0x3bc3c7,_0x49e884={'tybSU':_0x2244fe(0x222),'bOvCC':_0x2244fe(0x1eb),'rJyFk':'macoDetergentIngredients','jTqCL':'machineStageDisplayOrder','iSRPm':_0x2244fe(0xf1),'nUCzY':function(_0x5ab734,_0x1b5cb6,_0x3eb973){return _0x5ab734(_0x1b5cb6,_0x3eb973);},'UdOcY':_0x2244fe(0xe3)};try{localStorage[_0x2244fe(0x2e6)](_0x49e884[_0x2244fe(0x1e8)],JSON['stringify'](a12_0x275932[_0x2244fe(0x2b5)])),localStorage['setItem'](_0x49e884['bOvCC'],JSON[_0x2244fe(0xec)](a12_0x275932['machines'])),localStorage[_0x2244fe(0x2e6)]('macoScoringCriteria',JSON[_0x2244fe(0xec)](a12_0x275932[_0x2244fe(0xe4)])),localStorage[_0x2244fe(0x2e6)](_0x49e884[_0x2244fe(0x177)],JSON['stringify'](a12_0x275932['detergentIngredients'])),localStorage[_0x2244fe(0x2e6)](_0x49e884[_0x2244fe(0x2e9)],JSON[_0x2244fe(0xec)](a12_0x275932['machineStageDisplayOrder']));}catch(_0x493f76){console[_0x2244fe(0xce)](_0x49e884['iSRPm'],_0x493f76),_0x49e884['nUCzY'](showCustomAlert,_0x49e884[_0x2244fe(0x2e5)],_0x2244fe(0x2ac));}}export function loadAllDataFromLocalStorage(){const _0x54893f=a12_0x3bc3c7,_0x36a09f={'VBkSd':_0x54893f(0x1eb),'NpNUk':_0x54893f(0x278),'Qczoh':'macoDetergentIngredients','VWAMd':_0x54893f(0x235),'jBolE':'Error\x20loading\x20products','UJltt':_0x54893f(0x23e),'fKTrE':_0x54893f(0x2d0),'WSSMk':_0x54893f(0x2f6),'kjVQc':_0x54893f(0x272)},_0x1c2c8b=localStorage[_0x54893f(0x285)](_0x54893f(0x222)),_0x53df32=localStorage['getItem'](_0x36a09f['VBkSd']),_0x1e0151=localStorage['getItem'](_0x36a09f['NpNUk']),_0x48e945=localStorage[_0x54893f(0x285)](_0x36a09f['Qczoh']),_0x35e27c=localStorage[_0x54893f(0x285)](_0x36a09f[_0x54893f(0x2f1)]);if(_0x1c2c8b)try{a12_0x275932['setProducts'](JSON[_0x54893f(0x2cd)](_0x1c2c8b));}catch(_0x18d7d9){console['error'](_0x36a09f[_0x54893f(0x1cb)],_0x18d7d9);}if(_0x53df32)try{a12_0x275932[_0x54893f(0x167)](JSON['parse'](_0x53df32));}catch(_0xdfcd74){console['error'](_0x36a09f[_0x54893f(0x307)],_0xdfcd74);}if(_0x1e0151)try{a12_0x275932['setScoringCriteria'](JSON['parse'](_0x1e0151));}catch(_0x5dbdca){console[_0x54893f(0xce)](_0x36a09f[_0x54893f(0x23f)],_0x5dbdca);}if(_0x48e945)try{a12_0x275932[_0x54893f(0x110)](JSON[_0x54893f(0x2cd)](_0x48e945));}catch(_0x43d5b7){console[_0x54893f(0xce)](_0x36a09f[_0x54893f(0x286)],_0x43d5b7);}if(_0x35e27c)try{a12_0x275932[_0x54893f(0x19c)](JSON[_0x54893f(0x2cd)](_0x35e27c));}catch(_0x376693){console['error'](_0x36a09f[_0x54893f(0x104)],_0x376693);}}export function saveStateForUndo(){const _0x89a111=a12_0x3bc3c7,_0x2233fa={'qnDcK':function(_0x271a1d,_0x424f73){return _0x271a1d+_0x424f73;},'AdMBZ':function(_0x2d7a04){return _0x2d7a04();},'zxDPm':function(_0x11a651){return _0x11a651();}};a12_0x199969();const _0x13cf55=a12_0x275932['history'][_0x89a111(0xd4)](0x0,_0x2233fa[_0x89a111(0x107)](a12_0x275932[_0x89a111(0x26f)],0x1)),_0x2f243a={'products':JSON[_0x89a111(0x2cd)](JSON[_0x89a111(0xec)](a12_0x275932[_0x89a111(0x2b5)])),'machines':JSON['parse'](JSON[_0x89a111(0xec)](a12_0x275932[_0x89a111(0x1aa)])),'scoringCriteria':JSON[_0x89a111(0x2cd)](JSON[_0x89a111(0xec)](a12_0x275932[_0x89a111(0xe4)])),'detergentIngredients':JSON[_0x89a111(0x2cd)](JSON[_0x89a111(0xec)](a12_0x275932[_0x89a111(0x297)]))};_0x13cf55[_0x89a111(0x2a0)](_0x2f243a),a12_0x275932['setHistory'](_0x13cf55,_0x13cf55[_0x89a111(0x1fa)]-0x1),_0x2233fa[_0x89a111(0x115)](updateUndoRedoButtons),_0x2233fa[_0x89a111(0x20f)](saveAllDataToLocalStorage);}export function updateUndoRedoButtons(){const _0x2dddaa=a12_0x3bc3c7,_0x575b9e={'TMuAK':_0x2dddaa(0x2b2),'tHGpO':_0x2dddaa(0x1c4),'zrMsC':function(_0x526b56,_0x2be654){return _0x526b56<=_0x2be654;},'fxVwX':function(_0x19ab1f,_0x286f79){return _0x19ab1f>=_0x286f79;},'fsggo':function(_0x560a68,_0x4eaf58){return _0x560a68-_0x4eaf58;}},_0x1f2515=document[_0x2dddaa(0x2d7)](_0x575b9e[_0x2dddaa(0x2fc)]),_0x58bc6f=document['getElementById'](_0x575b9e[_0x2dddaa(0x27f)]);_0x1f2515&&(_0x1f2515[_0x2dddaa(0x19b)]=_0x575b9e[_0x2dddaa(0x1d9)](a12_0x275932[_0x2dddaa(0x26f)],0x0)),_0x58bc6f&&(_0x58bc6f['disabled']=_0x575b9e[_0x2dddaa(0x1c6)](a12_0x275932[_0x2dddaa(0x26f)],_0x575b9e[_0x2dddaa(0x213)](a12_0x275932[_0x2dddaa(0xcf)][_0x2dddaa(0x1fa)],0x1)));}export function undoChange(){const _0x214846=a12_0x3bc3c7,_0x5736c9={'ifYsj':function(_0x2ebd50,_0x2549f2){return _0x2ebd50>_0x2549f2;},'JXuiJ':function(_0x545061,_0x475a05){return _0x545061-_0x475a05;},'TVoBY':function(_0xd42da5,_0x1b64b6){return _0xd42da5(_0x1b64b6);},'ASYyE':function(_0x3e416e){return _0x3e416e();}};if(_0x5736c9[_0x214846(0x274)](a12_0x275932[_0x214846(0x26f)],0x0)){const _0x16198a=_0x5736c9[_0x214846(0x114)](a12_0x275932[_0x214846(0x26f)],0x1),_0x3b613a=a12_0x275932[_0x214846(0xcf)][_0x16198a];a12_0x275932[_0x214846(0x16c)](JSON[_0x214846(0x2cd)](JSON['stringify'](_0x3b613a['products']))),a12_0x275932[_0x214846(0x167)](JSON[_0x214846(0x2cd)](JSON[_0x214846(0xec)](_0x3b613a[_0x214846(0x1aa)]))),a12_0x275932[_0x214846(0x2b1)](JSON[_0x214846(0x2cd)](JSON[_0x214846(0xec)](_0x3b613a[_0x214846(0xe4)]))),a12_0x275932['setDetergentIngredients'](JSON[_0x214846(0x2cd)](JSON[_0x214846(0xec)](_0x3b613a[_0x214846(0x297)]))),a12_0x275932[_0x214846(0x2d5)](a12_0x275932['history'],_0x16198a),a12_0x275932['scoringInEditMode']&&_0x5736c9[_0x214846(0xe5)](a12_0x3719fb,!0x1),a12_0x333cd5(),_0x5736c9[_0x214846(0x1dc)](updateUndoRedoButtons),_0x5736c9['ASYyE'](saveAllDataToLocalStorage);}}export function redoChange(){const _0x307bc2=a12_0x3bc3c7,_0x522e52={'nBjKt':function(_0x26d64e,_0x440999){return _0x26d64e<_0x440999;},'kDJww':function(_0x531499,_0x1f9aa6){return _0x531499-_0x1f9aa6;},'TIsNg':function(_0x47edfe,_0x2c20f9){return _0x47edfe+_0x2c20f9;},'RhWgx':function(_0x35b182){return _0x35b182();}};if(_0x522e52[_0x307bc2(0x25b)](a12_0x275932[_0x307bc2(0x26f)],_0x522e52['kDJww'](a12_0x275932['history'][_0x307bc2(0x1fa)],0x1))){const _0x30b6f9=_0x522e52[_0x307bc2(0xfa)](a12_0x275932[_0x307bc2(0x26f)],0x1),_0x1e0a50=a12_0x275932['history'][_0x30b6f9];a12_0x275932[_0x307bc2(0x16c)](JSON['parse'](JSON[_0x307bc2(0xec)](_0x1e0a50[_0x307bc2(0x2b5)]))),a12_0x275932[_0x307bc2(0x167)](JSON[_0x307bc2(0x2cd)](JSON[_0x307bc2(0xec)](_0x1e0a50['machines']))),a12_0x275932['setScoringCriteria'](JSON[_0x307bc2(0x2cd)](JSON[_0x307bc2(0xec)](_0x1e0a50[_0x307bc2(0xe4)]))),a12_0x275932['setDetergentIngredients'](JSON['parse'](JSON[_0x307bc2(0xec)](_0x1e0a50[_0x307bc2(0x297)]))),a12_0x275932[_0x307bc2(0x2d5)](a12_0x275932['history'],_0x30b6f9),a12_0x275932[_0x307bc2(0x12b)]&&a12_0x3719fb(!0x1),_0x522e52[_0x307bc2(0x301)](a12_0x333cd5),_0x522e52[_0x307bc2(0x301)](updateUndoRedoButtons),_0x522e52[_0x307bc2(0x301)](saveAllDataToLocalStorage);}}function a12_0x4a07(_0x165592,_0xe4687f){const _0x478ffc=a12_0x478f();return a12_0x4a07=function(_0x4a07d6,_0x2a2e72){_0x4a07d6=_0x4a07d6-0xca;let _0x39c117=_0x478ffc[_0x4a07d6];return _0x39c117;},a12_0x4a07(_0x165592,_0xe4687f);}export function toggleDarkMode(_0x44e1c7){const _0x30810c=a12_0x3bc3c7,_0x290a3f={'NjQiG':'theme-toggle-light-icon','dhBQq':_0x30810c(0x21c),'sqkiN':_0x30810c(0x215),'LGjUR':_0x30810c(0x188),'mMYOU':function(_0x1cfc4d){return _0x1cfc4d();}},_0x12c789=document[_0x30810c(0x2d7)](_0x290a3f[_0x30810c(0x243)]),_0x13c58d=document[_0x30810c(0x2d7)](_0x290a3f[_0x30810c(0xd7)]);_0x44e1c7?(document[_0x30810c(0x2ee)][_0x30810c(0x31a)]['add'](_0x290a3f['sqkiN']),_0x12c789&&_0x12c789[_0x30810c(0x31a)][_0x30810c(0x1b4)](_0x290a3f[_0x30810c(0x1c0)]),_0x13c58d&&_0x13c58d[_0x30810c(0x31a)]['remove'](_0x30810c(0x188))):(document['documentElement']['classList'][_0x30810c(0x30b)](_0x30810c(0x215)),_0x12c789&&_0x12c789[_0x30810c(0x31a)][_0x30810c(0x30b)](_0x290a3f['LGjUR']),_0x13c58d&&_0x13c58d[_0x30810c(0x31a)][_0x30810c(0x1b4)](_0x290a3f[_0x30810c(0x1c0)])),a12_0x275932[_0x30810c(0x11b)]&&_0x290a3f[_0x30810c(0x147)](a12_0x485c3f),a12_0x275932[_0x30810c(0x142)]&&a12_0x228813();}export function printCurrentView(_0x1dc656,_0x46581e=a12_0x3bc3c7(0x1e0)){const _0xf281f7=a12_0x3bc3c7,_0x3f9354={'fGbnV':function(_0x3c7ba7,_0x103ea2,_0xc25be){return _0x3c7ba7(_0x103ea2,_0xc25be);},'zzgjC':_0xf281f7(0x188),'uMUoZ':'Hide\x20MACO\x20Calculation\x20Breakdown','GLHNz':_0xf281f7(0x24e),'LGEmX':_0xf281f7(0x1bd),'omuHo':function(_0x269e9b,_0x447598,_0x2827e1){return _0x269e9b(_0x447598,_0x2827e1);},'vnKyN':_0xf281f7(0xf6),'pNclY':'./macoDetergentView.js','sHlLr':_0xf281f7(0x16e),'pZcro':_0xf281f7(0x148),'YfPaH':function(_0x4d0d17,_0xd339d0){return _0x4d0d17>_0xd339d0;},'YTZvK':_0xf281f7(0x1a5),'UKKnh':function(_0x3e1ad0,_0x49451c){return _0x3e1ad0(_0x49451c);},'nRGiq':_0xf281f7(0xf8),'qsrOI':function(_0x3388e9,_0x118a2b,_0x5b7e3d){return _0x3388e9(_0x118a2b,_0x5b7e3d);},'ZlbfX':_0xf281f7(0x256),'sMZsj':function(_0x7664dd,_0x4d6a20){return _0x7664dd(_0x4d6a20);},'DFOVH':function(_0x50ce72,_0x45347c){return _0x50ce72+_0x45347c;},'XnSxz':'scoring-system','FZzYz':function(_0x3098c1,_0x3972d9){return _0x3098c1(_0x3972d9);},'rOWtE':_0xf281f7(0x1a2),'ieQVd':function(_0x5ba558,_0x263c5b){return _0x5ba558===_0x263c5b;},'nAprh':_0xf281f7(0x25f),'syPUd':'macoForTrains','ZxEnl':_0xf281f7(0x304),'Ntvpf':_0xf281f7(0x295),'QVuLq':_0xf281f7(0x209),'YoyVz':'./trainSummaryView.js'};_0x3f9354['XnSxz']===_0x1dc656&&a12_0x275932[_0xf281f7(0x12b)]&&(a12_0x275932[_0xf281f7(0x2c2)](!0x0),_0x3f9354['FZzYz'](a12_0x3719fb,!0x1)),console[_0xf281f7(0x29b)](_0xf281f7(0x28c),_0x1dc656,_0x3f9354[_0xf281f7(0x1e5)],_0x46581e),document[_0xf281f7(0x281)][_0xf281f7(0x31a)][_0xf281f7(0x1b4)](_0xf281f7(0x2f7)+_0x1dc656),_0x3f9354[_0xf281f7(0x22d)](_0x3f9354[_0xf281f7(0xdd)],_0x1dc656)?import(_0xf281f7(0x2ad))[_0xf281f7(0x2e7)](_0x49e1bf=>{const _0xe38f9e=_0xf281f7;window[_0xe38f9e(0x261)]=_0x46581e,_0x49e1bf[_0xe38f9e(0x200)](),_0x3f9354[_0xe38f9e(0xeb)](setTimeout,()=>{const _0xd1a589=_0xe38f9e;window[_0xd1a589(0x1ef)]();},0xc8);}):_0x3f9354[_0xf281f7(0x288)]===_0x1dc656?(window[_0xf281f7(0x261)]=_0x46581e,import(_0x3f9354[_0xf281f7(0x300)])[_0xf281f7(0x2e7)](_0x25e816=>{const _0x1d47fa=_0xf281f7,_0x24ee38={'JjfcD':_0x3f9354['zzgjC'],'XcyBn':_0x3f9354['uMUoZ']};_0x25e816['renderMacoForTrains']();const _0xd3c7b7=document[_0x1d47fa(0x1f0)](_0x1d47fa(0x2aa)),_0x460617=[];_0xd3c7b7[_0x1d47fa(0x291)](_0x45ad6d=>{const _0x2d39c0=_0x1d47fa,_0x2780b7=_0x45ad6d['id']['match'](/content-pm-(\d+)/);if(_0x2780b7){_0x460617[_0x2d39c0(0x2a0)](_0x2780b7[0x1]),_0x45ad6d[_0x2d39c0(0x31a)]['remove'](_0x2d39c0(0x1bd));const _0x2b87c1=document[_0x2d39c0(0x2d7)](_0x2d39c0(0x2fd)+_0x2780b7[0x1]);_0x2b87c1&&(_0x2b87c1[_0x2d39c0(0x18b)]='▼');}});const _0x2ee88d=document[_0x1d47fa(0x1f0)](_0x3f9354[_0x1d47fa(0x171)]),_0x100db0=[];_0x2ee88d['forEach'](_0x55f20f=>{const _0x1196da=_0x1d47fa,_0x2e8e90=_0x55f20f['id']['match'](/maco-breakdown-details-(\d+)/);if(_0x2e8e90){_0x100db0['push'](_0x2e8e90[0x1]),_0x55f20f['classList']['remove'](_0x24ee38[_0x1196da(0x2d2)]);const _0x5ecbd0=document[_0x1196da(0x2d7)](_0x1196da(0x29a)+_0x2e8e90[0x1]);_0x5ecbd0&&(_0x5ecbd0[_0x1196da(0x18b)]=_0x24ee38[_0x1196da(0x1dd)]);}}),_0x3f9354[_0x1d47fa(0xeb)](setTimeout,()=>{const _0x5c5295=_0x1d47fa;window[_0x5c5295(0x1ef)](),setTimeout(()=>{const _0x566c76=_0x5c5295;_0x460617[_0x566c76(0x291)](_0x384ca5=>{const _0x3710a0=_0x566c76,_0x1a8c3a=document[_0x3710a0(0x2d7)](_0x3710a0(0x21b)+_0x384ca5),_0x9e582b=document['getElementById'](_0x3710a0(0x2fd)+_0x384ca5);_0x1a8c3a&&_0x1a8c3a[_0x3710a0(0x31a)][_0x3710a0(0x1b4)](_0x3710a0(0x1bd)),_0x9e582b&&(_0x9e582b[_0x3710a0(0x18b)]='▶');}),_0x100db0[_0x566c76(0x291)](_0x45d240=>{const _0x134a1c=_0x566c76,_0x1a1047=document['getElementById'](_0x134a1c(0x267)+_0x45d240),_0x19fa59=document[_0x134a1c(0x2d7)](_0x134a1c(0x29a)+_0x45d240);_0x1a1047&&_0x1a1047[_0x134a1c(0x31a)][_0x134a1c(0x1b4)]('hidden'),_0x19fa59&&(_0x19fa59[_0x134a1c(0x18b)]=_0x134a1c(0x1b7));});},0x3e8);},0xc8);})):_0x3f9354[_0xf281f7(0x22d)]('detergentMaco',_0x1dc656)?(window[_0xf281f7(0x261)]=_0x46581e,import(_0x3f9354[_0xf281f7(0x10e)])['then'](_0x4d581e=>{const _0x275f9b=_0xf281f7,_0x1880e0={'UvAtX':_0x3f9354[_0x275f9b(0x112)],'Hvbpj':function(_0x3c4e56,_0x1325da,_0x4308b6){const _0x852904=_0x275f9b;return _0x3f9354[_0x852904(0x1db)](_0x3c4e56,_0x1325da,_0x4308b6);}};_0x4d581e[_0x275f9b(0x2ef)]();const _0x2293f2=document[_0x275f9b(0x1f0)](_0x275f9b(0x299)),_0x386cc0=[];_0x2293f2[_0x275f9b(0x291)](_0x1d18bd=>{const _0x4a13ce=_0x275f9b,_0x536a8a=_0x1d18bd['id']['match'](/content-dm-(\d+)/);if(_0x536a8a){_0x386cc0[_0x4a13ce(0x2a0)](_0x536a8a[0x1]),_0x1d18bd[_0x4a13ce(0x31a)][_0x4a13ce(0x30b)](_0x3f9354[_0x4a13ce(0x112)]);const _0xf42332=document[_0x4a13ce(0x2d7)](_0x4a13ce(0x1b8)+_0x536a8a[0x1]);_0xf42332&&(_0xf42332[_0x4a13ce(0x18b)]='▼');}}),_0x3f9354['fGbnV'](setTimeout,()=>{const _0xa04d0f=_0x275f9b,_0x2a52c8={'YuMxO':_0x1880e0[_0xa04d0f(0x2b6)]};window[_0xa04d0f(0x1ef)](),_0x1880e0[_0xa04d0f(0x100)](setTimeout,()=>{const _0x3d779a=_0xa04d0f,_0x596568={'kaljH':_0x2a52c8['YuMxO']};_0x386cc0[_0x3d779a(0x291)](_0x28d700=>{const _0x1da8d3=_0x3d779a,_0x33e2b3=document[_0x1da8d3(0x2d7)](_0x1da8d3(0x1d6)+_0x28d700),_0x3fc8ae=document[_0x1da8d3(0x2d7)](_0x1da8d3(0x1b8)+_0x28d700);_0x33e2b3&&_0x33e2b3[_0x1da8d3(0x31a)][_0x1da8d3(0x1b4)](_0x596568[_0x1da8d3(0xdc)]),_0x3fc8ae&&(_0x3fc8ae[_0x1da8d3(0x18b)]='▶');});},0x3e8);},0xc8);})['catch'](_0x3b7e24=>{const _0x217e0f=_0xf281f7;console[_0x217e0f(0xce)](_0x3f9354[_0x217e0f(0x319)],_0x3b7e24),window['print']();})[_0xf281f7(0x133)](()=>{const _0x45faa8=_0xf281f7;_0x3f9354[_0x45faa8(0xeb)](setTimeout,()=>{const _0x297028=_0x45faa8;window[_0x297028(0x261)]=null,import(_0x3f9354[_0x297028(0x10e)])[_0x297028(0x2e7)](_0x3bb88d=>_0x3bb88d[_0x297028(0x2ef)]())[_0x297028(0x15c)](()=>{});},0x4b0);})):_0x3f9354[_0xf281f7(0x2a8)]===_0x1dc656?(window[_0xf281f7(0x261)]=_0x46581e,console[_0xf281f7(0x29b)](_0x3f9354[_0xf281f7(0x289)],_0x46581e),import(_0x3f9354['YoyVz'])[_0xf281f7(0x2e7)](_0x515346=>{const _0x2ef8f7=_0xf281f7,_0x6a1e69={'JaCXl':_0x3f9354[_0x2ef8f7(0x199)],'FKyUc':'not\x20found','DXaSk':_0x3f9354[_0x2ef8f7(0x22e)],'ISvRR':function(_0x2f1f8a,_0x3e8824){return _0x3f9354['YfPaH'](_0x2f1f8a,_0x3e8824);},'tHYqU':_0x3f9354['YTZvK'],'URjRe':function(_0x3b0e9f,_0x59a602){return _0x3f9354['UKKnh'](_0x3b0e9f,_0x59a602);},'Eqfeh':_0x3f9354['nRGiq'],'MlNaT':function(_0x58c4b1,_0x1c5325,_0x4d554c){const _0x2fe300=_0x2ef8f7;return _0x3f9354[_0x2fe300(0x1db)](_0x58c4b1,_0x1c5325,_0x4d554c);}};_0x515346[_0x2ef8f7(0x15e)](),_0x3f9354[_0x2ef8f7(0x1af)](setTimeout,()=>{const _0xae536=_0x2ef8f7,_0x514f9a=document[_0xae536(0x2d7)](_0x6a1e69[_0xae536(0x11d)]),_0x26ee6b=document[_0xae536(0x2d7)](_0xae536(0x128));if(console[_0xae536(0x29b)](_0xae536(0x216),_0x514f9a?_0x514f9a[_0xae536(0x136)][_0xae536(0xde)]:_0x6a1e69[_0xae536(0x1ba)]),console[_0xae536(0x29b)](_0xae536(0x193),_0x26ee6b?_0x26ee6b[_0xae536(0x136)][_0xae536(0xde)]:'not\x20found'),console[_0xae536(0x29b)](_0x6a1e69[_0xae536(0x159)],!!_0x514f9a&&_0x6a1e69['ISvRR'](_0x514f9a[_0xae536(0x255)][_0xae536(0x1fa)],0x0)),!_0x514f9a||_0xae536(0x2d6)===_0x514f9a['style'][_0xae536(0xde)])return console[_0xae536(0x111)](_0x6a1e69[_0xae536(0x282)]),void _0x6a1e69['URjRe'](alert,_0x6a1e69[_0xae536(0x185)]);window['print'](),_0x6a1e69[_0xae536(0x29e)](setTimeout,()=>{const _0x198604=_0xae536;window[_0x198604(0x261)]=null,_0x515346['renderTrainSummary']();},0x3e8);},0x1f4);})[_0xf281f7(0x15c)](_0x1e7fd5=>{const _0x5bd636=_0xf281f7;console['error'](_0x3f9354[_0x5bd636(0xf9)],_0x1e7fd5),_0x3f9354[_0x5bd636(0x2a3)](alert,_0x3f9354[_0x5bd636(0x164)](_0x5bd636(0x219),_0x1e7fd5[_0x5bd636(0x1c8)]));})):setTimeout(()=>{const _0x5ab13b=_0xf281f7;window[_0x5ab13b(0x1ef)]();},0x64);}export function toggleColumn(_0x4daa7e,_0x4032da){const _0x152df4=a12_0x3bc3c7,_0x5bc043={'pyFmv':_0x152df4(0x183),'bxYld':'ld50','bBOdp':_0x152df4(0x2c1),'tzDFn':_0x152df4(0x25f),'anKmF':function(_0xab0621,_0x207246){return _0xab0621!==_0x207246;},'gNHmW':function(_0x5d647a,_0x1eaf93){return _0x5d647a!==_0x1eaf93;},'GInmS':function(_0x480617,_0x29dc9d){return _0x480617(_0x29dc9d);}};if(_0x5bc043[_0x152df4(0x202)]===_0x4daa7e||_0x5bc043[_0x152df4(0x2df)]===_0x4daa7e){[_0x5bc043[_0x152df4(0xd6)],_0x5bc043['tzDFn']]['forEach'](_0x1b4136=>{const _0x1e33d8=_0x152df4;document[_0x1e33d8(0x1f0)]('#'+_0x1b4136+'\x20.mainTable,\x20#'+_0x1b4136+_0x1e33d8(0x119))[_0x1e33d8(0x291)](_0x325436=>{const _0x5b2482=_0x1e33d8;_0x325436[_0x5b2482(0x31a)]['toggle']('hide-'+_0x4daa7e);}),document['querySelectorAll']('#'+_0x1b4136+_0x1e33d8(0x234)+_0x1b4136+_0x1e33d8(0x10b))['forEach'](_0x491e29=>{const _0x43a172=_0x1e33d8;_0x491e29&&_0x491e29[_0x43a172(0x31a)][_0x43a172(0x21e)]('hide-'+_0x4daa7e);});});const _0x2c4a0b=_0x5bc043[_0x152df4(0x12f)](null,document['querySelector']('#productRegister\x20.mainTable.hide-'+_0x4daa7e));localStorage[_0x152df4(0x2e6)]('productRegister-'+_0x4daa7e+_0x152df4(0xef),_0x2c4a0b),updateToggleIcons(_0x5bc043['bBOdp']),updateToggleIcons(_0x5bc043[_0x152df4(0x2f9)]),import(_0x152df4(0x2ad))[_0x152df4(0x2e7)](_0x198e41=>{const _0x33919f=_0x152df4;_0x198e41[_0x33919f(0x200)]();}),import(_0x152df4(0x2ad))[_0x152df4(0x2e7)](_0xe0a512=>{const _0x3a11c5=_0x152df4;_0xe0a512[_0x3a11c5(0x194)]&&_0xe0a512['renderRpnChart']();});}else{document[_0x152df4(0x1f0)]('#'+_0x4032da+_0x152df4(0x271)+_0x4032da+_0x152df4(0x119))[_0x152df4(0x291)](_0x377ecc=>{const _0x487f29=_0x152df4;_0x377ecc[_0x487f29(0x31a)]['toggle'](_0x487f29(0x198)+_0x4daa7e);});const _0x461c05=_0x5bc043[_0x152df4(0xe6)](null,document['querySelector']('#'+_0x4032da+_0x152df4(0x24c)+_0x4daa7e));localStorage[_0x152df4(0x2e6)](_0x4032da+'-'+_0x4daa7e+_0x152df4(0xef),_0x461c05),_0x5bc043[_0x152df4(0x305)](updateToggleIcons,_0x4032da);}}export function toggleColumnVisibilityDropdown(){const _0x2cc6f3=a12_0x3bc3c7,_0x202c65={'PiNSb':_0x2cc6f3(0x156),'WViNb':_0x2cc6f3(0x2a4),'wbSCW':_0x2cc6f3(0x23b),'zshPz':'columnVisibilityDropdown','YAnYq':_0x2cc6f3(0x188)},_0x5247ab=document[_0x2cc6f3(0x2d7)](_0x202c65[_0x2cc6f3(0x18e)]);_0x5247ab[_0x2cc6f3(0x31a)]['toggle'](_0x2cc6f3(0x188)),_0x5247ab[_0x2cc6f3(0x31a)]['contains'](_0x202c65['YAnYq'])||document[_0x2cc6f3(0x17d)](_0x2cc6f3(0x23b),function _0xb7c691(_0x4c2597){const _0x4d0b43=_0x2cc6f3;_0x4c2597['target'][_0x4d0b43(0x1f8)](_0x202c65['PiNSb'])||_0x4c2597['target'][_0x4d0b43(0x1f8)](_0x202c65[_0x4d0b43(0x287)])||(_0x5247ab[_0x4d0b43(0x31a)][_0x4d0b43(0x1b4)](_0x4d0b43(0x188)),document['removeEventListener'](_0x202c65['wbSCW'],_0xb7c691));});}export function updateToggleIcons(_0x3b3bc7){const _0x49821e=a12_0x3bc3c7,_0x358d23={'RNFJz':_0x49821e(0x313),'rxpma':_0x49821e(0x309),'VrNhM':function(_0xa8a068,_0x148982){return _0xa8a068===_0x148982;},'DAqKQ':_0x49821e(0x25f),'OpNJD':_0x49821e(0x1d1),'KXCum':'productRegister-ld50Hidden','khdpE':function(_0x30a072,_0x14b77c){return _0x30a072===_0x14b77c;},'nLUcu':_0x49821e(0x2e3),'SPcwU':function(_0x4b1df,_0x1eddcf){return _0x4b1df&&_0x1eddcf;},'GAIPS':_0x49821e(0x30e),'NqZkQ':_0x49821e(0x1f7)},_0x3df986=document[_0x49821e(0x2d7)](_0x3b3bc7);if(!_0x3df986)return;let _0x209214,_0x292732;if(_0x358d23['VrNhM'](_0x358d23[_0x49821e(0x2ca)],_0x3b3bc7)){const _0x5ee29f=localStorage[_0x49821e(0x285)](_0x358d23[_0x49821e(0x2bf)]),_0x4d6bc6=localStorage[_0x49821e(0x285)](_0x358d23[_0x49821e(0x118)]);if(null===_0x5ee29f&&_0x358d23[_0x49821e(0x2dd)](null,_0x4d6bc6))_0x209214=!0x1,_0x292732=!0x1;else{const _0x51b3e4=_0x358d23[_0x49821e(0x25d)]===_0x5ee29f,_0xfef056=_0x358d23[_0x49821e(0x2dd)](_0x358d23[_0x49821e(0x25d)],_0x4d6bc6);_0x358d23['SPcwU'](_0x51b3e4,_0xfef056)?(_0x209214=!0x1,_0x292732=!0x0):(_0x209214=_0x51b3e4,_0x292732=_0xfef056);}}else{const _0x9320e1=localStorage[_0x49821e(0x285)](_0x3b3bc7+_0x49821e(0x1d0)),_0x45db4c=localStorage[_0x49821e(0x285)](_0x3b3bc7+_0x49821e(0x19f));_0x209214=_0x358d23['VrNhM'](_0x358d23[_0x49821e(0x25d)],_0x9320e1),_0x292732=_0x358d23['VrNhM'](_0x358d23['nLUcu'],_0x45db4c);}const _0x4e768d=_0x3df986[_0x49821e(0x182)](_0x49821e(0x2c8)),_0x28e5a2=_0x3df986[_0x49821e(0x182)](_0x358d23[_0x49821e(0x179)]);_0x4e768d&&(_0x4e768d[_0x49821e(0x255)]=_0x209214?_0x49821e(0x139):_0x358d23['NqZkQ']),_0x28e5a2&&(_0x28e5a2[_0x49821e(0x255)]=_0x292732?_0x49821e(0x205):_0x49821e(0x294)),document[_0x49821e(0x1f0)]('#'+_0x3b3bc7+_0x49821e(0x271)+_0x3b3bc7+_0x49821e(0x119))[_0x49821e(0x291)](_0x3785fd=>{const _0x6e16a2=_0x49821e;_0x3785fd&&(_0x3785fd['classList'][_0x6e16a2(0x21e)](_0x358d23['RNFJz'],_0x209214),_0x3785fd[_0x6e16a2(0x31a)][_0x6e16a2(0x21e)](_0x6e16a2(0x309),_0x292732));}),document[_0x49821e(0x1f0)]('#'+_0x3b3bc7+_0x49821e(0x234)+_0x3b3bc7+_0x49821e(0x10b))[_0x49821e(0x291)](_0x2c2076=>{const _0x59d1a8=_0x49821e;_0x2c2076&&(_0x2c2076['classList'][_0x59d1a8(0x21e)](_0x358d23[_0x59d1a8(0x178)],_0x209214),_0x2c2076[_0x59d1a8(0x31a)][_0x59d1a8(0x21e)](_0x358d23[_0x59d1a8(0x21d)],_0x292732));});}export function exportToExcel(){const _0x5d6af6=a12_0x3bc3c7,_0x23a60c={'ggZMz':function(_0x182237,_0x45a2cb){return _0x182237(_0x45a2cb);},'vNqtd':function(_0x27336c,_0x175dec){return _0x27336c+_0x175dec;},'KdNSv':'Yes','Vfqmv':function(_0x1cc616,_0x55807a){return _0x1cc616===_0x55807a;},'pwJux':function(_0x25ff8a){return _0x25ff8a();},'HRQBa':function(_0x5e2155,_0x2d8ead,_0x550518){return _0x5e2155(_0x2d8ead,_0x550518);},'IvsJb':'No\x20Data','cdlWd':_0x5d6af6(0x252),'msgbp':_0x5d6af6(0x28d),'ENVKj':_0x5d6af6(0x1ad),'rQWgh':_0x5d6af6(0x214),'doiiL':function(_0xe271be){return _0xe271be();},'ZIcaC':function(_0x5dfa66){return _0x5dfa66();},'OIFZp':function(_0x20bb10,_0x4b131e,_0x4e7fe5){return _0x20bb10(_0x4b131e,_0x4e7fe5);},'nWyeU':function(_0x4dd846){return _0x4dd846();},'pTvyS':_0x5d6af6(0x1ae)};_0x23a60c['nWyeU'](showLoader),import(_0x23a60c[_0x5d6af6(0x248)])[_0x5d6af6(0x2e7)](_0x7d7208=>{const _0x216d67=_0x5d6af6,{getProductTrainId:_0x3b6be8,calculateScores:_0x4bea39}=_0x7d7208,_0x3d3c89=[];if(a12_0x275932[_0x216d67(0x2b5)][_0x216d67(0x291)](_0x5bde56=>{const _0xb8b520=_0x216d67,_0x358fbe={'AHsMd':function(_0x41b997,_0x20b502){const _0x312708=a12_0x4a07;return _0x23a60c[_0x312708(0x120)](_0x41b997,_0x20b502);}};let _0xad338c='No';_0x5bde56[_0xb8b520(0x27a)]&&(_0xad338c=_0x23a60c['vNqtd'](_0x23a60c[_0xb8b520(0x2f2)],_0x5bde56['criticalReason']?':\x20'+_0x5bde56[_0xb8b520(0x13c)]:''));const _0x5dd246=_0x3b6be8(_0x5bde56),_0x4f75c6=_0x5bde56[_0xb8b520(0x1e7)]?new Date(_0x5bde56['date'])[_0xb8b520(0x260)]():'';_0x3d3c89['push']({'Date':_0x4f75c6,'Product\x20Code':_0x5bde56['productCode'],'Product\x20Name':_0x5bde56['name'],'Train\x20No.':_0x5dd246,'Dosage\x20Form':_0x5bde56[_0xb8b520(0x20e)]||'','Batch\x20Size\x20(Kg)':_0x5bde56['batchSizeKg'],'Special\x20Case\x20Product':_0xad338c,'Active\x20Ingredient':'','Solubility':'','Therapeutic\x20Dose\x20(mg/day)':'','Cleanability':'','PDE\x20(µg/day)':'','LD50\x20(mg/kg)':'','Solubility\x20Score':'','Therapeutic\x20Dose\x20Score':'','Cleanability\x20Score':'','Toxicity\x20Score':'','RPN':'','RPN\x20Rating':''}),_0x5bde56[_0xb8b520(0x315)]['forEach'](_0x3aa457=>{const _0x1ae037=_0xb8b520,_0x455e8b=_0x358fbe[_0x1ae037(0x1f2)](_0x4bea39,_0x3aa457);_0x3d3c89[_0x1ae037(0x2a0)]({'Date':'','Product\x20Code':'','Product\x20Name':_0x1ae037(0x1a8)+_0x3aa457['name'],'Train\x20No.':'','Dosage\x20Form':'','Batch\x20Size\x20(Kg)':'','Special\x20Case\x20Product':'','Active\x20Ingredient':_0x3aa457[_0x1ae037(0x2e8)],'Solubility':_0x3aa457[_0x1ae037(0x2c3)]||'','Therapeutic\x20Dose\x20(mg/day)':_0x3aa457[_0x1ae037(0xf3)]||'','Cleanability':_0x3aa457['cleanability']||'','PDE\x20(µg/day)':_0x3aa457[_0x1ae037(0x183)]||'','LD50\x20(mg/kg)':_0x3aa457[_0x1ae037(0x14c)]||'','Solubility\x20Score':_0x455e8b[_0x1ae037(0x2cb)]||'','Therapeutic\x20Dose\x20Score':_0x455e8b[_0x1ae037(0x25a)]||'','Cleanability\x20Score':_0x455e8b['cleanabilityScore']||'','Toxicity\x20Score':_0x455e8b[_0x1ae037(0x317)]||_0x455e8b[_0x1ae037(0x1d5)]||'','RPN':_0x455e8b['rpn'],'RPN\x20Rating':_0x455e8b[_0x1ae037(0x30f)]});});}),_0x23a60c[_0x216d67(0x2b3)](0x0,_0x3d3c89['length']))return _0x23a60c[_0x216d67(0x226)](hideLoader),void _0x23a60c[_0x216d67(0x1ca)](showCustomAlert,_0x23a60c['IvsJb'],_0x23a60c[_0x216d67(0x1b6)]);const _0x3858c5=XLSX['utils'][_0x216d67(0x2c9)](_0x3d3c89),_0x17c653=XLSX[_0x216d67(0x168)][_0x216d67(0x155)]();XLSX[_0x216d67(0x168)][_0x216d67(0x174)](_0x17c653,_0x3858c5,_0x23a60c[_0x216d67(0x20a)]);const _0x37c70f=Object[_0x216d67(0x152)](_0x3d3c89[0x0])[_0x216d67(0x2be)](_0x5e39dc=>({'wch':Math[_0x216d67(0x2d1)](_0x5e39dc[_0x216d67(0x1fa)],..._0x3d3c89[_0x216d67(0x2be)](_0x5c1ba0=>String(_0x5c1ba0[_0x5e39dc]||'')['length']))+0x2}));_0x3858c5[_0x23a60c[_0x216d67(0x134)]]=_0x37c70f,XLSX['writeFile'](_0x17c653,_0x23a60c[_0x216d67(0x17a)]),_0x23a60c[_0x216d67(0x117)](hideLoader);})[_0x5d6af6(0x15c)](_0x2ef9d3=>{const _0x3b3880=_0x5d6af6;console[_0x3b3880(0xce)](_0x3b3880(0x14b),_0x2ef9d3),_0x23a60c[_0x3b3880(0x161)](hideLoader),_0x23a60c['OIFZp'](showCustomAlert,'Error',_0x3b3880(0x163));});}export function exportAllToJson(){const _0x126736=a12_0x3bc3c7,_0x53fdd8={'NpRDK':function(_0x1150c5){return _0x1150c5();},'gpaGI':function(_0x26cc5a,_0x3c2d78,_0xc270d7){return _0x26cc5a(_0x3c2d78,_0xc270d7);},'KwnMR':_0x126736(0x2c5),'rnaAn':_0x126736(0x1df)};_0x53fdd8[_0x126736(0x1bf)](showLoader);try{const _0xf941bc={'exportDate':new Date()[_0x126736(0x109)](),'scoringCriteria':a12_0x275932[_0x126736(0xe4)],'products':a12_0x275932['products'],'machines':a12_0x275932['machines'],'detergentIngredients':a12_0x275932[_0x126736(0x297)]},_0x364beb=JSON['stringify'](_0xf941bc,null,0x2),_0x916ff5=new Blob([_0x364beb],{'type':_0x126736(0x17e)}),_0x26e0d1=URL[_0x126736(0x149)](_0x916ff5),_0x1abe37=document[_0x126736(0x29f)]('a');_0x1abe37[_0x126736(0xf4)]=_0x26e0d1,_0x1abe37[_0x126736(0x254)]=_0x126736(0x2a9),document[_0x126736(0x281)][_0x126736(0x203)](_0x1abe37),_0x1abe37['click'](),document[_0x126736(0x281)][_0x126736(0x27e)](_0x1abe37),URL[_0x126736(0xdb)](_0x26e0d1);}catch(_0x18e942){_0x53fdd8[_0x126736(0x23d)](showCustomAlert,_0x53fdd8[_0x126736(0x1fc)],_0x53fdd8['rnaAn']+_0x18e942['message']);}finally{_0x53fdd8[_0x126736(0x1bf)](hideLoader);}}export function importFromJson(_0x50639d){const _0x32332b=a12_0x3bc3c7,_0x46331d={'dKUIl':function(_0x391472){return _0x391472();},'MIeVU':function(_0x531e3f){return _0x531e3f();},'KnFBF':_0x32332b(0x232),'OQpVW':_0x32332b(0x2ce),'Qbdaz':function(_0x3ef2a3,_0x1caf11,_0x562c79){return _0x3ef2a3(_0x1caf11,_0x562c79);},'idVbv':_0x32332b(0x201)},_0x251bf1=_0x50639d[_0x32332b(0xcc)][_0x32332b(0x206)][0x0];if(!_0x251bf1)return;const _0x2c5fb4=new FileReader();_0x2c5fb4[_0x32332b(0x263)]=function(_0x1416f8){const _0xcbc110=_0x32332b;try{const _0xe2d557=JSON[_0xcbc110(0x2cd)](_0x1416f8['target'][_0xcbc110(0x123)]);_0xe2d557&&_0xe2d557[_0xcbc110(0x2b5)]&&_0xe2d557['scoringCriteria']&&_0xe2d557['machines']?(a12_0x275932[_0xcbc110(0x16c)](_0xe2d557['products']),a12_0x275932[_0xcbc110(0x167)](_0xe2d557['machines']),a12_0x275932[_0xcbc110(0x2b1)](_0xe2d557['scoringCriteria']),_0xe2d557[_0xcbc110(0x297)]&&a12_0x275932['setDetergentIngredients'](_0xe2d557[_0xcbc110(0x297)]),_0x46331d['dKUIl'](saveStateForUndo),_0x46331d['MIeVU'](a12_0x333cd5),showCustomAlert(_0x46331d['KnFBF'],_0x46331d[_0xcbc110(0x264)])):_0x46331d[_0xcbc110(0x2a2)](showCustomAlert,_0xcbc110(0x2c5),_0x46331d['idVbv']);}catch(_0x701d3){showCustomAlert(_0xcbc110(0x2c5),_0xcbc110(0x1c1));}finally{_0x50639d[_0xcbc110(0xcc)][_0xcbc110(0x293)]='';}},_0x2c5fb4[_0x32332b(0x2a5)](_0x251bf1);}export function toggleOtherProductType(_0x40ec2d,_0x149929){const _0x254f40=a12_0x3bc3c7,_0x505214={'yLdjW':'input','aflNF':_0x254f40(0x279),'rOVoM':_0x254f40(0x2d6)},_0x2459d3=document['getElementById'](_0x149929),_0x1692ff=_0x2459d3['querySelector'](_0x505214['yLdjW']);_0x505214['aflNF']===_0x40ec2d['value']?(_0x2459d3['style']['display']=_0x254f40(0x29d),_0x1692ff['required']=!0x0):(_0x2459d3[_0x254f40(0x136)][_0x254f40(0xde)]=_0x505214[_0x254f40(0x22f)],_0x1692ff['required']=!0x1,_0x1692ff['value']='');}export function toggleOtherMachineStage(_0x42fd92,_0x538ca6){const _0x17068a=a12_0x3bc3c7,_0x7947a={'JZmkV':_0x17068a(0x20c),'tFJrP':function(_0x58d8f9,_0x113c82){return _0x58d8f9===_0x113c82;},'EzUNP':'Other','WfYDc':_0x17068a(0x29d)},_0x1cb24f=document['getElementById'](_0x538ca6),_0x29f716=_0x1cb24f[_0x17068a(0x182)](_0x7947a[_0x17068a(0x18c)]);_0x7947a['tFJrP'](_0x7947a[_0x17068a(0x1b5)],_0x42fd92['value'])?(_0x1cb24f[_0x17068a(0x136)][_0x17068a(0xde)]=_0x7947a[_0x17068a(0xf2)],_0x29f716[_0x17068a(0x11c)]=!0x0):(_0x1cb24f['style'][_0x17068a(0xde)]=_0x17068a(0x2d6),_0x29f716[_0x17068a(0x11c)]=!0x1,_0x29f716['value']='');}export function toggleOtherMachineGroup(_0x1a4285,_0x44b2bb){const _0x42413f=a12_0x3bc3c7,_0x287b94={'qyycn':_0x42413f(0x20c),'SYmGZ':_0x42413f(0x279),'URlIQ':_0x42413f(0x29d),'MHWCI':_0x42413f(0x2d6)},_0x579d68=document[_0x42413f(0x2d7)](_0x44b2bb),_0x2acfef=_0x579d68[_0x42413f(0x182)](_0x287b94[_0x42413f(0x1d4)]);_0x287b94['SYmGZ']===_0x1a4285[_0x42413f(0x293)]?(_0x579d68['style']['display']=_0x287b94[_0x42413f(0xd9)],_0x2acfef[_0x42413f(0x11c)]=!0x0):(_0x579d68['style'][_0x42413f(0xde)]=_0x287b94[_0x42413f(0x204)],_0x2acfef['required']=!0x1,_0x2acfef[_0x42413f(0x293)]='');}export function clampSafetyFactor(_0x4e9014,_0x4bef81){const _0x561bdb=a12_0x3bc3c7,_0x2ad126={'MFZfC':function(_0xf30076,_0x4b1efb){return _0xf30076(_0x4b1efb);},'TUcJd':function(_0x2aaeb5,_0x5d9110){return _0x2aaeb5>_0x5d9110;},'tjlzs':function(_0x33bdad,_0x2bf26d){return _0x33bdad(_0x2bf26d);},'MzJKG':_0x561bdb(0x1fb),'pwDTt':'sf-input-train'},_0x3b4419=_0x2ad126['MFZfC'](parseFloat,_0x4e9014[_0x561bdb(0x14d)]),_0x1c2826=_0x2ad126[_0x561bdb(0x137)](parseFloat,_0x4e9014['max']);let _0x27e2b5=_0x2ad126[_0x561bdb(0x137)](parseFloat,_0x4e9014[_0x561bdb(0x293)]);isNaN(_0x27e2b5)&&(_0x27e2b5=_0x3b4419),_0x27e2b5<_0x3b4419?_0x27e2b5=_0x3b4419:_0x2ad126[_0x561bdb(0x181)](_0x27e2b5,_0x1c2826)&&(_0x27e2b5=_0x1c2826),_0x2ad126[_0x561bdb(0x102)](parseFloat,_0x4e9014[_0x561bdb(0x293)])!==_0x27e2b5&&(_0x4e9014['value']=_0x27e2b5),_0x4e9014['id']['startsWith'](_0x2ad126[_0x561bdb(0x2cc)])?_0x2ad126[_0x561bdb(0x137)](recalculateProductMacoForTrain,_0x4bef81):_0x4e9014['id'][_0x561bdb(0x189)](_0x2ad126[_0x561bdb(0x1a9)])&&recalculateDetergentMacoForTrain(_0x4bef81);}export function toggleTrain(_0x8fe78d){const _0x4aa68e=a12_0x3bc3c7,_0x11712d={'pTduC':function(_0x48a598,_0xa57f2b){return _0x48a598&&_0xa57f2b;},'gWdpD':_0x4aa68e(0x1bd)},_0x1c98f8=document['getElementById'](_0x4aa68e(0x1c2)+_0x8fe78d),_0x1ac190=document[_0x4aa68e(0x2d7)](_0x4aa68e(0xd8)+_0x8fe78d);_0x11712d[_0x4aa68e(0x280)](_0x1c98f8,_0x1ac190)&&(_0x1c98f8[_0x4aa68e(0x31a)][_0x4aa68e(0x195)](_0x11712d[_0x4aa68e(0xcd)])?(_0x1c98f8[_0x4aa68e(0x31a)]['remove']('collapsed'),_0x1ac190['textContent']='▼'):(_0x1c98f8[_0x4aa68e(0x31a)][_0x4aa68e(0x1b4)](_0x11712d['gWdpD']),_0x1ac190[_0x4aa68e(0x18b)]='▶'));}export function toggleMacoBreakdown(_0x124089){const _0x37071e=a12_0x3bc3c7,_0x120079={'IFqlE':_0x37071e(0x188),'RsrvT':_0x37071e(0x17c),'jhEwb':_0x37071e(0x1b7)},_0x5368e3=document[_0x37071e(0x2d7)](_0x37071e(0x267)+_0x124089),_0x1bba86=document[_0x37071e(0x2d7)]('breakdown-toggle-btn-'+_0x124089);_0x5368e3[_0x37071e(0x31a)]['contains'](_0x120079[_0x37071e(0xff)])?(_0x5368e3[_0x37071e(0x31a)]['remove'](_0x120079[_0x37071e(0xff)]),_0x1bba86[_0x37071e(0x18b)]=_0x120079[_0x37071e(0x13b)]):(_0x5368e3['classList'][_0x37071e(0x1b4)](_0x120079[_0x37071e(0xff)]),_0x1bba86[_0x37071e(0x18b)]=_0x120079[_0x37071e(0x2d3)]);}export function exportWorstCaseToExcel(_0x220c7f=a12_0x3bc3c7(0x1e0)){const _0x2c1e4=a12_0x3bc3c7,_0x48758b={'ypuCt':function(_0x17a112,_0x355550){return _0x17a112!==_0x355550;},'HFTRk':function(_0x4ab75c,_0x205a19,_0x1c23f5){return _0x4ab75c(_0x205a19,_0x1c23f5);},'PywDy':function(_0x15e5bf,_0x4a5b50){return _0x15e5bf===_0x4a5b50;},'YOouB':function(_0x2b1d7b){return _0x2b1d7b();},'ieIfY':function(_0x1cfacf,_0x2e1f10,_0x5e3c76){return _0x1cfacf(_0x2e1f10,_0x5e3c76);},'hvYLD':'No\x20Data','ucRrF':_0x2c1e4(0xea),'zmwqt':_0x2c1e4(0x1e0),'ZBCvJ':function(_0x5ef648,_0x2396b5){return _0x5ef648===_0x2396b5;},'rmpdz':function(_0x1f2962,_0x19e579,_0x7cfc16){return _0x1f2962(_0x19e579,_0x7cfc16);},'cJcaH':function(_0x517434,_0x2fcf15){return _0x517434===_0x2fcf15;},'tXkAe':_0x2c1e4(0x2f5),'vzOKb':'!cols','pWVCO':_0x2c1e4(0x1de),'axEoC':function(_0x496e54){return _0x496e54();},'jUWaO':_0x2c1e4(0x227),'cUjmx':function(_0x197c96){return _0x197c96();}};_0x48758b[_0x2c1e4(0xe8)](showLoader),import('./utils.js')[_0x2c1e4(0x2e7)](_0x920aa3=>{const _0x258e29=_0x2c1e4,_0x355f3a={'hBucW':function(_0x3f1ba5,_0x4392ee){return _0x3f1ba5>_0x4392ee;},'RmZRx':function(_0x3eaee2,_0x1083a7,_0xb7a417){const _0x1a146d=a12_0x4a07;return _0x48758b[_0x1a146d(0x24f)](_0x3eaee2,_0x1083a7,_0xb7a417);}},{getProductTrainId:_0x40f298,calculateScores:_0x16bc9b,getToxicityPreference:_0x14ac4b}=_0x920aa3,_0x487e02=[];let _0x2f64c4=a12_0x275932[_0x258e29(0x13a)][_0x258e29(0x25f)]||a12_0x275932[_0x258e29(0x2b5)];if(_0x48758b['PywDy'](0x0,_0x2f64c4['length']))return _0x48758b['YOouB'](hideLoader),void _0x48758b['ieIfY'](showCustomAlert,_0x48758b['hvYLD'],_0x48758b[_0x258e29(0x30c)]);const _0xff1506={};_0x2f64c4[_0x258e29(0x291)](_0x1a12a0=>{const _0x5ec1b8=_0x258e29,_0x3c3d45=_0x40f298(_0x1a12a0);_0x48758b[_0x5ec1b8(0x223)](_0x5ec1b8(0x1cc),_0x3c3d45)&&(_0xff1506[_0x3c3d45]||(_0xff1506[_0x3c3d45]=[]),_0xff1506[_0x3c3d45]['push'](_0x1a12a0));});let _0x46ab34=_0xff1506;if(_0x48758b[_0x258e29(0xd2)]!==_0x220c7f&&(_0x46ab34={},Array[_0x258e29(0x1ac)](_0x220c7f)?_0x220c7f[_0x258e29(0x291)](_0xeb9db4=>{_0xff1506[_0xeb9db4]&&(_0x46ab34[_0xeb9db4]=_0xff1506[_0xeb9db4]);}):_0xff1506[_0x220c7f]&&(_0x46ab34={[_0x220c7f]:_0xff1506[_0x220c7f]}),_0x48758b[_0x258e29(0x2fb)](0x0,Object[_0x258e29(0x152)](_0x46ab34)[_0x258e29(0x1fa)])))return hideLoader(),void _0x48758b[_0x258e29(0x245)](showCustomAlert,_0x48758b['hvYLD'],(Array[_0x258e29(0x1ac)](_0x220c7f)?'Trains\x20'+_0x220c7f['join'](',\x20'):_0x258e29(0x31b)+_0x220c7f)+_0x258e29(0x1e6));const _0xe7e9fb=_0x14ac4b();if(Object['keys'](_0x46ab34)[_0x258e29(0x165)]((_0x4d8f02,_0x1ce3ed)=>_0x4d8f02-_0x1ce3ed)[_0x258e29(0x291)](_0x44f757=>{const _0x3ce25e=_0x258e29,_0xfd2c1d={'sDobr':function(_0x39afd3,_0x318746,_0x1f4fde){const _0x1ada40=a12_0x4a07;return _0x355f3a[_0x1ada40(0x2db)](_0x39afd3,_0x318746,_0x1f4fde);}},_0x3817a8=_0x46ab34[_0x44f757];_0x487e02[_0x3ce25e(0x2a0)]({'Train':_0x3ce25e(0x31b)+_0x44f757+_0x3ce25e(0x22c),'Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),_0x3817a8['forEach'](_0x3e5f3e=>{const _0x1eee7c=_0x3ce25e,_0x245722=_0x3e5f3e['activeIngredients'][_0x1eee7c(0x2be)](_0x1bc6f2=>_0x16bc9b(_0x1bc6f2,_0xe7e9fb)[_0x1eee7c(0xd1)]);_0x3e5f3e[_0x1eee7c(0x10a)]=_0x355f3a[_0x1eee7c(0x2f0)](_0x245722['length'],0x0)?Math[_0x1eee7c(0x2d1)](..._0x245722):0x0;}),_0x3817a8[_0x3ce25e(0x165)]((_0x931657,_0x55952f)=>_0x55952f['sortValue']-_0x931657[_0x3ce25e(0x10a)]),_0x3817a8[_0x3ce25e(0x291)](_0xf524a9=>{const _0xc93cde=_0x3ce25e,_0x517ccc=_0xf524a9[_0xc93cde(0x27a)]?_0xc93cde(0x1ab):'No';_0x487e02[_0xc93cde(0x2a0)]({'Train':'','Product\x20Code':_0xf524a9[_0xc93cde(0x1a3)],'Product\x20Name':_0xf524a9['name'],'Highest\x20RPN':_0xf524a9['sortValue'],'Special\x20Case\x20Product':_0x517ccc,'Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),(_0xf524a9[_0xc93cde(0x315)][_0xc93cde(0x165)]((_0x1f847c,_0x553667)=>_0x16bc9b(_0x553667,_0xe7e9fb)['rpn']-_0x16bc9b(_0x1f847c,_0xe7e9fb)[_0xc93cde(0xd1)])[_0xc93cde(0x291)](_0x3b9685=>{const _0x5ceb7f=_0xc93cde,_0x2ff8a6=_0xfd2c1d[_0x5ceb7f(0x16b)](_0x16bc9b,_0x3b9685,_0xe7e9fb);_0x487e02['push']({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':_0x3b9685[_0x5ceb7f(0x2e8)],'TD\x20Score':_0x2ff8a6['therapeuticDoseScore'],'Solubility\x20Score':_0x2ff8a6[_0x5ceb7f(0x2cb)],'Cleanability\x20Score':_0x2ff8a6[_0x5ceb7f(0x1e4)],'PDE\x20Score':_0x2ff8a6[_0x5ceb7f(0x317)]??_0x5ceb7f(0x1cc),'LD50\x20Score':_0x2ff8a6[_0x5ceb7f(0x1d5)]??'N/A','RPN':_0x2ff8a6[_0x5ceb7f(0xd1)],'Rating':_0x2ff8a6[_0x5ceb7f(0x30f)]});}),_0x487e02['push']({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}));});}),_0x48758b[_0x258e29(0x192)](0x0,_0x487e02['length']))return hideLoader(),void _0x48758b['HFTRk'](showCustomAlert,_0x48758b[_0x258e29(0x2bd)],_0x258e29(0x1e1));const _0x26fd66=XLSX[_0x258e29(0x168)][_0x258e29(0x2c9)](_0x487e02),_0x5549e6=XLSX[_0x258e29(0x168)][_0x258e29(0x155)]();XLSX[_0x258e29(0x168)][_0x258e29(0x174)](_0x5549e6,_0x26fd66,_0x48758b[_0x258e29(0x238)]);const _0xd231db=Object[_0x258e29(0x152)](_0x487e02[0x0])[_0x258e29(0x2be)](_0x1fb4cd=>({'wch':Math[_0x258e29(0x2d1)](_0x1fb4cd['length'],..._0x487e02[_0x258e29(0x2be)](_0x9a6691=>String(_0x9a6691[_0x1fb4cd]||'')[_0x258e29(0x1fa)]))+0x2}));_0x26fd66[_0x48758b[_0x258e29(0x224)]]=_0xd231db;const _0x35e0f8=new Date()[_0x258e29(0x109)]()['split']('T')[0x0];let _0x56f542='';_0x48758b['ypuCt'](_0x48758b[_0x258e29(0xd2)],_0x220c7f)&&(_0x56f542=Array['isArray'](_0x220c7f)?_0x258e29(0x1c5)+_0x220c7f['join']('_'):_0x258e29(0xfe)+_0x220c7f),XLSX['writeFile'](_0x5549e6,_0x258e29(0x11f)+_0x56f542+'_'+_0x35e0f8+'.xlsx'),hideLoader();})[_0x2c1e4(0x15c)](_0x5c2411=>{const _0x474b6c=_0x2c1e4;console[_0x474b6c(0xce)](_0x48758b[_0x474b6c(0x1f6)],_0x5c2411),_0x48758b[_0x474b6c(0x268)](hideLoader),_0x48758b['rmpdz'](showCustomAlert,'Error',_0x48758b[_0x474b6c(0x1da)]);});}export function exportMachinesToExcel(){const _0xfc17e7=a12_0x3bc3c7,_0x4ad4d0={'tlSvz':'None','wzbVk':function(_0x394691){return _0x394691();},'ZWkcY':function(_0x1d5e9f,_0x429d8b,_0x5b47a2){return _0x1d5e9f(_0x429d8b,_0x5b47a2);},'MiFEA':_0xfc17e7(0x196),'xMvmy':_0xfc17e7(0x1ee),'NMAYi':_0xfc17e7(0x106),'TnsKi':'Success','WmMHl':_0xfc17e7(0x146),'FxgNy':'Error\x20exporting\x20machines\x20to\x20Excel:','PDPoM':function(_0x36fbbb){return _0x36fbbb();},'DxeRj':_0xfc17e7(0x2c5)};showLoader();try{if(0x0===a12_0x275932[_0xfc17e7(0x1aa)][_0xfc17e7(0x1fa)])return _0x4ad4d0[_0xfc17e7(0x28a)](hideLoader),void _0x4ad4d0[_0xfc17e7(0x2e4)](showCustomAlert,_0x4ad4d0[_0xfc17e7(0x116)],_0x4ad4d0[_0xfc17e7(0x14f)]);const _0x5e3aea=[],_0xd38b50={};a12_0x275932[_0xfc17e7(0x1aa)][_0xfc17e7(0x291)](_0x72cdeb=>{const _0x5786f2=_0xfc17e7;_0xd38b50[_0x72cdeb[_0x5786f2(0xca)]]||(_0xd38b50[_0x72cdeb[_0x5786f2(0xca)]]=[]),_0xd38b50[_0x72cdeb[_0x5786f2(0xca)]]['push'](_0x72cdeb);}),a12_0x275932[_0xfc17e7(0x235)][_0xfc17e7(0x291)](_0x5daad6=>{const _0x920d4e=_0xfc17e7,_0x2165e8={'pfsvy':_0x4ad4d0[_0x920d4e(0x15a)]};_0xd38b50[_0x5daad6]&&_0xd38b50[_0x5daad6][_0x920d4e(0x291)](_0x24d9b0=>{const _0x3d712d=_0x920d4e,_0xa109b8=a12_0x275932[_0x3d712d(0x2b5)][_0x3d712d(0x1b2)](_0x56ce4b=>_0x56ce4b['machineIds']&&_0x56ce4b['machineIds'][_0x3d712d(0xdf)](_0x24d9b0['id'])),_0xa6802f=_0xa109b8[_0x3d712d(0x2be)](_0x1aa108=>_0x1aa108[_0x3d712d(0x2e8)])[_0x3d712d(0x26a)](',\x20')||_0x2165e8[_0x3d712d(0x186)],_0x1e2be4=_0xa109b8[_0x3d712d(0x1fa)];_0x5e3aea[_0x3d712d(0x2a0)]({'Machine\x20Number':_0x24d9b0[_0x3d712d(0x138)],'Machine\x20Name':_0x24d9b0[_0x3d712d(0x2e8)],'Stage':_0x24d9b0['stage'],'Area\x20(sq\x20cm)':_0x24d9b0['area'],'Assigned\x20Products\x20Count':_0x1e2be4,'Assigned\x20Products':_0xa6802f});});});const _0x1e3bab=XLSX['utils'][_0xfc17e7(0x2c9)](_0x5e3aea),_0x1d52ba=XLSX[_0xfc17e7(0x168)][_0xfc17e7(0x155)]();XLSX['utils']['book_append_sheet'](_0x1d52ba,_0x1e3bab,_0x4ad4d0['NMAYi']);const _0x50ecb7=[{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0xf},{'wch':0x14},{'wch':0x32}];_0x1e3bab['!cols']=_0x50ecb7;const _0x58192c=new Date()[_0xfc17e7(0x109)]()[_0xfc17e7(0x240)]('T')[0x0];XLSX[_0xfc17e7(0x2a6)](_0x1d52ba,'MACO_Machines_'+_0x58192c+_0xfc17e7(0xed)),_0x4ad4d0['wzbVk'](hideLoader),_0x4ad4d0[_0xfc17e7(0x2e4)](showCustomAlert,_0x4ad4d0['TnsKi'],_0x4ad4d0[_0xfc17e7(0x259)]);}catch(_0x32f523){console[_0xfc17e7(0xce)](_0x4ad4d0[_0xfc17e7(0x1e3)],_0x32f523),_0x4ad4d0[_0xfc17e7(0x2fa)](hideLoader),_0x4ad4d0[_0xfc17e7(0x2e4)](showCustomAlert,_0x4ad4d0[_0xfc17e7(0x176)],'Failed\x20to\x20export\x20machines\x20data\x20to\x20Excel.');}}export function exportProductMacoToExcel(_0x2b1c33=a12_0x3bc3c7(0x1e0)){const _0x133696=a12_0x3bc3c7,_0x112dfe={'TIgSR':_0x133696(0x1cc),'bUcpf':function(_0x274015,_0x57860c){return _0x274015(_0x57860c);},'OWqNQ':function(_0x3d0604,_0x242fc3){return _0x3d0604/_0x242fc3;},'zUxoE':function(_0x6cf18a,_0x400d39){return _0x6cf18a*_0x400d39;},'BbPeo':function(_0x78f508,_0x36511a){return _0x78f508*_0x36511a;},'ZKoCV':_0x133696(0x1b1),'RQwuz':_0x133696(0x126),'wHyxB':_0x133696(0x246),'uJlEn':_0x133696(0x27d),'YwNJg':_0x133696(0x108),'DWuWr':_0x133696(0x1cd),'dicfD':function(_0x1f6531){return _0x1f6531();},'shoyH':function(_0x57fb1d){return _0x57fb1d();},'wlWfE':function(_0x2b4497,_0x328a00,_0x55413d){return _0x2b4497(_0x328a00,_0x55413d);},'HtytV':_0x133696(0x196),'HPtRc':_0x133696(0x312),'mNgTU':function(_0x191e9d,_0x2a5a16){return _0x191e9d!==_0x2a5a16;},'hukyj':function(_0x37d601,_0x2d848e,_0x128906){return _0x37d601(_0x2d848e,_0x128906);},'sePYs':_0x133696(0xf5),'YlfNp':_0x133696(0x1cf),'BeJbw':_0x133696(0x1ad),'sWyqt':_0x133696(0xda),'jMbwP':function(_0x12cec2,_0x316de0){return _0x12cec2!==_0x316de0;},'gAVJD':_0x133696(0x1e0),'FXVJP':function(_0x1e1ad9){return _0x1e1ad9();},'vWWhB':function(_0x28bb10,_0xc057ae,_0x1fb7dc){return _0x28bb10(_0xc057ae,_0x1fb7dc);},'HWBCy':_0x133696(0x232),'JNkbP':_0x133696(0x145),'LiHCl':function(_0x26fe04){return _0x26fe04();},'wnWrR':'Failed\x20to\x20export\x20Product\x20MACO\x20data\x20to\x20Excel.','QrSRQ':'./utils.js'};_0x112dfe[_0x133696(0x212)](showLoader),import(_0x112dfe[_0x133696(0x230)])['then'](_0x4bfa4a=>{const _0x452b18=_0x133696,_0x5cd497={'oAqxE':function(_0x4f4c73,_0x45119f){return _0x4f4c73||_0x45119f;},'cqniC':_0x112dfe[_0x452b18(0xe2)],'QBNaI':function(_0x20ba69,_0x58d4aa){const _0x348575=_0x452b18;return _0x112dfe[_0x348575(0x284)](_0x20ba69,_0x58d4aa);},'GwiFU':function(_0x19603b,_0x1a2cd6){const _0x353e7e=_0x452b18;return _0x112dfe[_0x353e7e(0xcb)](_0x19603b,_0x1a2cd6);},'fUlfN':function(_0x20e6d1,_0x172e73){return _0x20e6d1*_0x172e73;},'GzNFB':function(_0x16768d,_0x47c74b){const _0x5e64bf=_0x452b18;return _0x112dfe[_0x5e64bf(0x10f)](_0x16768d,_0x47c74b);},'UcOow':function(_0x132d00,_0x316d35){return _0x132d00!==_0x316d35;},'qGqtp':function(_0x523bdc,_0x150c29){const _0x1ad3f7=_0x452b18;return _0x112dfe[_0x1ad3f7(0x191)](_0x523bdc,_0x150c29);},'tXdVJ':_0x112dfe['ZKoCV'],'TjalA':_0x112dfe[_0x452b18(0x1d3)],'yJjCZ':_0x112dfe[_0x452b18(0x208)],'RGwRZ':function(_0x1d959d,_0x18b7da){return _0x1d959d==_0x18b7da;},'wHMQI':_0x112dfe['uJlEn'],'mJWRK':function(_0x1e6d06,_0x27597e){const _0x5dcc21=_0x452b18;return _0x112dfe[_0x5dcc21(0xcb)](_0x1e6d06,_0x27597e);},'LusIj':_0x112dfe['YwNJg'],'SfoBr':function(_0x546355,_0x3dbb90){const _0x1356e8=_0x452b18;return _0x112dfe[_0x1356e8(0x10f)](_0x546355,_0x3dbb90);},'vVcrz':_0x112dfe[_0x452b18(0x1a4)]},{getTrainData:_0x560873,getWorstCaseProductType:_0x3c5196,getMacoPerSwabForTrain:_0x49c1f1}=_0x4bfa4a,_0xf8d24f=_0x112dfe[_0x452b18(0x13d)](_0x560873);if(0x0===_0xf8d24f[_0x452b18(0x1fa)])return _0x112dfe[_0x452b18(0x266)](hideLoader),void _0x112dfe[_0x452b18(0x210)](showCustomAlert,_0x112dfe[_0x452b18(0x1c7)],_0x112dfe[_0x452b18(0x2ae)]);let _0x2acacd=_0xf8d24f;if(_0x112dfe[_0x452b18(0x151)](_0x452b18(0x1e0),_0x2b1c33)&&(_0x2acacd=Array['isArray'](_0x2b1c33)?_0xf8d24f['filter'](_0x409f28=>_0x2b1c33[_0x452b18(0xdf)](String(_0x409f28['id']))):_0xf8d24f[_0x452b18(0x1b2)](_0x8ea020=>String(_0x8ea020['id'])===String(_0x2b1c33))),0x0===_0x2acacd[_0x452b18(0x1fa)])return _0x112dfe['dicfD'](hideLoader),void _0x112dfe[_0x452b18(0x2e2)](showCustomAlert,_0x112dfe[_0x452b18(0x1c7)],_0x112dfe[_0x452b18(0x2eb)]);const _0x31aa8d=[],_0x5f8411=_0xf8d24f[_0x452b18(0x1a0)]((_0xbf8657,_0x4f86cd)=>_0x4f86cd[_0x452b18(0x316)]>_0xbf8657['essa']?_0x4f86cd:_0xbf8657)['essa'];_0x2acacd[_0x452b18(0x291)](_0x8ac8bd=>{const _0x3b582d=_0x452b18,_0x30cf5e=_0x5cd497[_0x3b582d(0x20d)](_0x3c5196,_0x8ac8bd[_0x3b582d(0x2b5)][_0x3b582d(0x2be)](_0x1a9cea=>_0x1a9cea['productType'])),_0x1b9ef1=(a12_0x275932[_0x3b582d(0xe9)][_0x30cf5e]||a12_0x275932[_0x3b582d(0xe9)]['Other'])[_0x3b582d(0x2d1)],_0x5d4dc5=_0x5cd497[_0x3b582d(0x121)](_0x5cd497[_0x3b582d(0x247)](_0x8ac8bd[_0x3b582d(0x158)],_0x8ac8bd[_0x3b582d(0x1ff)]),_0x1b9ef1),_0x389d97=_0x5cd497['GzNFB'](0xa,_0x8ac8bd[_0x3b582d(0x103)]);let _0x156ce0=_0x5cd497[_0x3b582d(0x21f)];_0x5cd497['UcOow'](null,_0x8ac8bd['lowestPde'])&&(_0x156ce0=_0x5cd497[_0x3b582d(0x162)](_0x8ac8bd[_0x3b582d(0x19d)],_0x8ac8bd[_0x3b582d(0x1ff)]));const _0x4b1045=0.004*_0x5f8411,_0x308559=[{'name':_0x5cd497[_0x3b582d(0x23a)],'value':_0x5d4dc5},{'name':_0x5cd497[_0x3b582d(0x217)],'value':_0x389d97},{'name':_0x5cd497['yJjCZ'],'value':_0x5cd497[_0x3b582d(0x2b4)](_0x5cd497[_0x3b582d(0x15f)],typeof _0x156ce0)?_0x156ce0:_0x5cd497[_0x3b582d(0x298)](0x1,0x0)},{'name':_0x5cd497[_0x3b582d(0x30a)],'value':_0x4b1045}]['reduce']((_0x508593,_0x200a4a)=>_0x200a4a[_0x3b582d(0x293)]<_0x508593[_0x3b582d(0x293)]?_0x200a4a:_0x508593),_0x47ffa7=_0x308559[_0x3b582d(0x293)],_0x234475=_0x5f8411>0x0?_0x5cd497[_0x3b582d(0x121)](_0x47ffa7,_0x5f8411):0x0,_0x970826=_0x5cd497[_0x3b582d(0x2ff)](_0x234475,_0x8ac8bd[_0x3b582d(0x18a)]),_0x31526d=_0x8ac8bd[_0x3b582d(0x1ce)][_0x3b582d(0x2be)](_0x1276cb=>{const _0x59b7ed=_0x3b582d,_0x43956e=a12_0x275932[_0x59b7ed(0x1aa)][_0x59b7ed(0x292)](_0x4f4d0c=>_0x4f4d0c['id']===_0x1276cb);return _0x5cd497['oAqxE'](_0x43956e,{'name':'Unknown\x20(ID:\x20'+_0x1276cb+')','machineNumber':_0x5cd497[_0x59b7ed(0x21f)]});}),_0x4fa0bc=_0x4bfa4a[_0x3b582d(0x275)](_0x8ac8bd[_0x3b582d(0x1ce)])[_0x3b582d(0x2be)](_0x45f0a8=>_0x45f0a8['isGroup']?_0x45f0a8[_0x3b582d(0xfc)]+'\x20('+_0x45f0a8[_0x3b582d(0xd5)]+'x)':_0x45f0a8[_0x3b582d(0x2e8)])['join'](_0x5cd497['vVcrz']),_0xa42ca0=_0x8ac8bd[_0x3b582d(0x2b5)]['map'](_0x1c9bec=>_0x1c9bec[_0x3b582d(0x1a3)]+_0x3b582d(0x1d8)+_0x1c9bec['name'])['join'](';\x20'),_0x41b65e=_0x8ac8bd[_0x3b582d(0x1a7)]?_0x8ac8bd['worstProductRpn']['productName']+'\x20('+_0x8ac8bd['worstProductRpn'][_0x3b582d(0x207)]+_0x3b582d(0x20b)+_0x8ac8bd['worstProductRpn'][_0x3b582d(0xd1)]:_0x3b582d(0x1cc);_0x31aa8d[_0x3b582d(0x2a0)]({'Train':'T'+_0x8ac8bd['id'],'Total\x20Products':_0x8ac8bd['products'][_0x3b582d(0x1fa)],'Total\x20Machines':_0x31526d[_0x3b582d(0x1fa)],'Total\x20Area\x20(ESSA)\x20cm²':_0x8ac8bd['essa'][_0x3b582d(0x2fe)](),'Products':_0xa42ca0,'Machines':_0x4fa0bc,'Worst-Case\x20Dosage\x20Form':_0x30cf5e,'Safety\x20Factor':_0x1b9ef1,'Lowest\x20LTD\x20(mg)':_0x8ac8bd[_0x3b582d(0x158)],'Min\x20Batch\x20Size\x20(kg)':_0x8ac8bd[_0x3b582d(0x103)],'Min\x20BS/MDD\x20Ratio':_0x8ac8bd[_0x3b582d(0x1ff)][_0x3b582d(0x239)](0x2),'Lowest\x20PDE\x20(mg)':null!==_0x8ac8bd['lowestPde']?_0x8ac8bd[_0x3b582d(0x19d)]:_0x5cd497[_0x3b582d(0x21f)],'Worst-Case\x20Product\x20(by\x20RPN)':_0x41b65e,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x5d4dc5[_0x3b582d(0x239)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x389d97[_0x3b582d(0x239)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x5cd497[_0x3b582d(0x2b4)](_0x3b582d(0x27d),typeof _0x156ce0)?_0x156ce0['toFixed'](0x2):_0x3b582d(0x1cc),'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x4b1045['toFixed'](0x2),'Selected\x20MACO\x20Method':_0x308559[_0x3b582d(0x2e8)],'Final\x20MACO\x20(mg)':_0x47ffa7[_0x3b582d(0x239)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x234475[_0x3b582d(0x2ab)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x970826[_0x3b582d(0x239)](0x4)});});const _0x438c8d=XLSX[_0x452b18(0x168)][_0x452b18(0x2c9)](_0x31aa8d),_0x2c8496=XLSX[_0x452b18(0x168)][_0x452b18(0x155)]();XLSX[_0x452b18(0x168)][_0x452b18(0x174)](_0x2c8496,_0x438c8d,_0x112dfe[_0x452b18(0x15d)]),_0x438c8d[_0x112dfe[_0x452b18(0x242)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0x12},{'wch':0xf},{'wch':0x12},{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0x12},{'wch':0x12}];const _0x181e0f=new Date()[_0x452b18(0x109)]()[_0x452b18(0x240)]('T')[0x0];let _0x4d7bf0=_0x112dfe['sWyqt'];if(_0x112dfe[_0x452b18(0x2dc)](_0x112dfe[_0x452b18(0x130)],_0x2b1c33)){if(Array[_0x452b18(0x1ac)](_0x2b1c33))_0x4d7bf0+=_0x452b18(0x1c5)+_0x2b1c33[_0x452b18(0x165)]((_0x43664f,_0x1a50ec)=>_0x43664f-_0x1a50ec)[_0x452b18(0x26a)]('_');else _0x4d7bf0+='_Train_'+_0x2b1c33;}_0x4d7bf0+='_'+_0x181e0f+_0x452b18(0xed),XLSX[_0x452b18(0x2a6)](_0x2c8496,_0x4d7bf0),_0x112dfe[_0x452b18(0x143)](hideLoader),_0x112dfe['vWWhB'](showCustomAlert,_0x112dfe['HWBCy'],_0x112dfe[_0x452b18(0x187)]);})[_0x133696(0x15c)](_0x394119=>{const _0xc399c=_0x133696;console['error']('Error\x20exporting\x20Product\x20MACO\x20to\x20Excel:',_0x394119),_0x112dfe[_0xc399c(0x212)](hideLoader),_0x112dfe[_0xc399c(0x210)](showCustomAlert,_0xc399c(0x2c5),_0x112dfe[_0xc399c(0x153)]);});}export function exportDetergentMacoToExcel(_0xc0b460=a12_0x3bc3c7(0x1e0)){const _0x75abfc=a12_0x3bc3c7,_0x17d070={'pnenA':function(_0x3e2dd6,_0x2de6a0){return _0x3e2dd6||_0x2de6a0;},'oVGhV':function(_0x3d5766,_0x571688){return _0x3d5766(_0x571688);},'jHAgN':function(_0x2c2fd5,_0x53659a){return _0x2c2fd5/_0x53659a;},'WQQAi':_0x75abfc(0x1cd),'voEYG':function(_0x2e8916){return _0x2e8916();},'WEACI':function(_0x1c2175,_0x434f16){return _0x1c2175!==_0x434f16;},'WSuNP':function(_0x2afe82,_0x279a78){return _0x2afe82===_0x279a78;},'YbcsZ':function(_0x342d72){return _0x342d72();},'GKZEg':function(_0x4308b1,_0x177838,_0x35a803){return _0x4308b1(_0x177838,_0x35a803);},'uKOLS':'No\x20Data','SckWn':_0x75abfc(0x312),'VpIzK':function(_0x4c22fd,_0x4b39c1){return _0x4c22fd===_0x4b39c1;},'NIMMX':function(_0x15a876){return _0x15a876();},'TEgkf':_0x75abfc(0x184),'juGqL':function(_0x2ca43d,_0x3ceeaf){return _0x2ca43d>_0x3ceeaf;},'LnMUm':_0x75abfc(0x21a),'muwAE':_0x75abfc(0x1f3),'rctFU':'!cols','LYJzO':function(_0x384875,_0x270227,_0x4735dd){return _0x384875(_0x270227,_0x4735dd);},'VFVvB':'Success','rfWuv':_0x75abfc(0x302),'UqchU':_0x75abfc(0x2e0),'HhPvx':function(_0xd03364,_0x80c4,_0x2cf9f9){return _0xd03364(_0x80c4,_0x2cf9f9);},'GBWSY':'Failed\x20to\x20export\x20Detergent\x20MACO\x20data\x20to\x20Excel.','PIurB':function(_0xcac5ba){return _0xcac5ba();}};_0x17d070['PIurB'](showLoader),import('./utils.js')[_0x75abfc(0x2e7)](_0x100149=>{const _0x11eee9=_0x75abfc,_0x51a400={'tsasy':function(_0x2134a8,_0xeac47){const _0x54091b=a12_0x4a07;return _0x17d070[_0x54091b(0x132)](_0x2134a8,_0xeac47);},'QKKLp':function(_0xffcd84,_0xedb58c){const _0x49b9e8=a12_0x4a07;return _0x17d070[_0x49b9e8(0x2cf)](_0xffcd84,_0xedb58c);},'JKwTb':function(_0x2d61ff,_0x329d6d){const _0x5216d8=a12_0x4a07;return _0x17d070[_0x5216d8(0x18f)](_0x2d61ff,_0x329d6d);},'DdyvM':function(_0x4f2816,_0x216d1d){return _0x4f2816*_0x216d1d;},'DooTR':function(_0x2f2d51,_0x1a29c4){return _0x2f2d51*_0x1a29c4;},'uJkir':function(_0x46083f,_0x2706a2){return _0x46083f*_0x2706a2;},'xWPnL':function(_0x2138e6,_0x1d8c77){return _0x2138e6>_0x1d8c77;},'HKbCe':_0x17d070[_0x11eee9(0x1a6)],'oiLjt':_0x11eee9(0x1cc)},{getTrainData:_0x502eed,getWorstCaseProductType:_0x3947d0}=_0x100149;let _0x4e9c07=_0x17d070[_0x11eee9(0x11e)](_0x502eed);if(_0x17d070['WEACI'](_0x11eee9(0x1e0),_0xc0b460)&&(_0x4e9c07=Array[_0x11eee9(0x1ac)](_0xc0b460)?_0x4e9c07[_0x11eee9(0x1b2)](_0x59d8fd=>_0xc0b460[_0x11eee9(0xdf)](String(_0x59d8fd['id']))):_0x4e9c07['filter'](_0x50178b=>String(_0x50178b['id'])===String(_0xc0b460))),_0x17d070[_0x11eee9(0x1f4)](0x0,_0x4e9c07[_0x11eee9(0x1fa)]))return _0x17d070['YbcsZ'](hideLoader),void _0x17d070['GKZEg'](showCustomAlert,_0x17d070[_0x11eee9(0x253)],_0x17d070[_0x11eee9(0x1c9)]);if(_0x17d070['VpIzK'](0x0,a12_0x275932[_0x11eee9(0x297)][_0x11eee9(0x1fa)]))return _0x17d070['NIMMX'](hideLoader),void showCustomAlert(_0x17d070[_0x11eee9(0x253)],_0x17d070[_0x11eee9(0x1fd)]);const _0x582a3b=[],_0x5d318b=_0x17d070[_0x11eee9(0x26d)](_0x4e9c07[_0x11eee9(0x1fa)],0x0)?Math[_0x11eee9(0x2d1)](..._0x4e9c07[_0x11eee9(0x2be)](_0x46cc01=>_0x46cc01[_0x11eee9(0x316)])):0x0,_0x281c82=_0x17d070[_0x11eee9(0x2cf)](parseFloat,document[_0x11eee9(0x2d7)](_0x17d070[_0x11eee9(0x12c)])?.[_0x11eee9(0x293)])||0x46,_0x1a24f2=a12_0x275932[_0x11eee9(0x297)][_0x11eee9(0x2be)](_0x1a7bfd=>parseFloat(_0x1a7bfd['ld50']))['filter'](_0xba3ada=>!isNaN(_0xba3ada)),_0x14d7fc=_0x17d070[_0x11eee9(0x26d)](_0x1a24f2[_0x11eee9(0x1fa)],0x0)?Math[_0x11eee9(0x14d)](..._0x1a24f2):0x0,_0x30ba4c=a12_0x275932[_0x11eee9(0x297)][_0x11eee9(0x2be)](_0x14e5ed=>_0x14e5ed[_0x11eee9(0x2e8)])[_0x11eee9(0x1b2)](_0x388551=>''!==_0x388551['trim']())[_0x11eee9(0x26a)](',\x20');_0x4e9c07[_0x11eee9(0x291)](_0x1bcc70=>{const _0x5f378e=_0x11eee9,_0x1f2642=_0x51a400[_0x5f378e(0x2f4)](_0x3947d0,_0x1bcc70[_0x5f378e(0x2b5)]['map'](_0x3501f7=>_0x3501f7[_0x5f378e(0x20e)])),_0x287d71=a12_0x275932[_0x5f378e(0xe9)][_0x1f2642]||a12_0x275932['safetyFactorConfig'][_0x5f378e(0x279)],_0x2cc683=document[_0x5f378e(0x2d7)](_0x5f378e(0x2ec)+_0x1bcc70['id']),_0x3cc2c0=_0x2cc683&&parseFloat(_0x2cc683[_0x5f378e(0x293)])||_0x287d71['max'],_0x2f1c6d=_0x51a400[_0x5f378e(0x154)](_0x51a400['DdyvM'](_0x51a400[_0x5f378e(0x257)](0.0005,_0x14d7fc),_0x281c82),_0x3cc2c0),_0x2d24f1=_0x51a400['uJkir'](_0x2f1c6d,_0x1bcc70[_0x5f378e(0x1ff)]),_0x51a0e0=_0x51a400[_0x5f378e(0x2a1)](_0x5d318b,0x0)?_0x51a400[_0x5f378e(0x154)](_0x2d24f1,_0x5d318b):0x0,_0x3ccd7f=_0x51a400['DdyvM'](_0x51a0e0,_0x1bcc70['assumedSsa']),_0xf7949d=_0x1bcc70[_0x5f378e(0x1ce)]['map'](_0x4c5246=>{const _0x3d58a8=_0x5f378e,_0x43a150=a12_0x275932[_0x3d58a8(0x1aa)]['find'](_0x4ebe34=>_0x4ebe34['id']===_0x4c5246);return _0x51a400[_0x3d58a8(0x2d9)](_0x43a150,{'name':_0x3d58a8(0x29c)+_0x4c5246+')','machineNumber':_0x3d58a8(0x1cc)});}),_0x575852=_0x100149['consolidateMachinesByGroup'](_0x1bcc70[_0x5f378e(0x1ce)])[_0x5f378e(0x2be)](_0x229f8d=>_0x229f8d[_0x5f378e(0x129)]?_0x229f8d[_0x5f378e(0xfc)]+'\x20('+_0x229f8d[_0x5f378e(0xd5)]+'x)':_0x229f8d['name'])['join'](_0x51a400[_0x5f378e(0x26b)]),_0x916301=_0x1bcc70[_0x5f378e(0x2b5)][_0x5f378e(0x2be)](_0x3bdd4d=>_0x3bdd4d[_0x5f378e(0x1a3)]+_0x5f378e(0x1d8)+_0x3bdd4d[_0x5f378e(0x2e8)])['join'](';\x20'),_0x90928a=_0x1bcc70[_0x5f378e(0x1a7)]?_0x1bcc70[_0x5f378e(0x1a7)][_0x5f378e(0x26e)]+'\x20('+_0x1bcc70[_0x5f378e(0x1a7)]['ingredientName']+_0x5f378e(0x20b)+_0x1bcc70[_0x5f378e(0x1a7)][_0x5f378e(0xd1)]:_0x51a400['oiLjt'];_0x582a3b[_0x5f378e(0x2a0)]({'Train':'T'+_0x1bcc70['id'],'Total\x20Products':_0x1bcc70[_0x5f378e(0x2b5)][_0x5f378e(0x1fa)],'Total\x20Machines':_0xf7949d[_0x5f378e(0x1fa)],'Total\x20Area\x20(ESSA)\x20cm²':_0x1bcc70[_0x5f378e(0x316)][_0x5f378e(0x2fe)](),'Products':_0x916301,'Machines':_0x575852,'Worst-Case\x20Dosage\x20Form':_0x1f2642,'Safety\x20Factor\x20Range':_0x287d71[_0x5f378e(0x14d)]+_0x5f378e(0x1d8)+_0x287d71['max'],'Applied\x20Safety\x20Factor':_0x3cc2c0,'Detergent\x20Ingredients':_0x30ba4c,'Body\x20Weight\x20(kg)':_0x281c82,'Minimum\x20LD50\x20(mg/kg)':_0x14d7fc,'Min\x20Batch\x20Size\x20(kg)':_0x1bcc70[_0x5f378e(0x103)],'Min\x20BS/MDD\x20Ratio':_0x1bcc70['minBsMddRatio'][_0x5f378e(0x239)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x90928a,'ADI\x20(mg)':_0x2f1c6d[_0x5f378e(0x239)](0x4),'MACO\x20(mg)':_0x2d24f1['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x51a0e0[_0x5f378e(0x2ab)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x3ccd7f[_0x5f378e(0x239)](0x4)});});const _0x502e4d=XLSX[_0x11eee9(0x168)][_0x11eee9(0x2c9)](_0x582a3b),_0x50ba05=XLSX[_0x11eee9(0x168)][_0x11eee9(0x155)]();XLSX[_0x11eee9(0x168)]['book_append_sheet'](_0x50ba05,_0x502e4d,_0x17d070[_0x11eee9(0x16d)]),_0x502e4d[_0x17d070[_0x11eee9(0x1f1)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0x1e},{'wch':0xc},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0xc},{'wch':0xc},{'wch':0x12},{'wch':0x12}];const _0x4bea5f=new Date()[_0x11eee9(0x109)]()[_0x11eee9(0x240)]('T')[0x0];XLSX['writeFile'](_0x50ba05,'Detergent_MACO_Report_'+_0x4bea5f+'.xlsx'),_0x17d070[_0x11eee9(0x180)](hideLoader),_0x17d070[_0x11eee9(0x296)](showCustomAlert,_0x17d070[_0x11eee9(0x101)],_0x17d070['rfWuv']);})[_0x75abfc(0x15c)](_0x173f4d=>{const _0x3e8b28=_0x75abfc;console[_0x3e8b28(0xce)](_0x17d070[_0x3e8b28(0x172)],_0x173f4d),_0x17d070[_0x3e8b28(0x11e)](hideLoader),_0x17d070['HhPvx'](showCustomAlert,_0x3e8b28(0x2c5),_0x17d070['GBWSY']);});}export function exportTrainSummaryToExcel(_0x2f5057=a12_0x3bc3c7(0x1e0)){const _0x4079e0=a12_0x3bc3c7,_0x852c6f={'LLSRU':function(_0x2ecbff,_0x184592){return _0x2ecbff!==_0x184592;},'NxDQK':_0x4079e0(0x1cc),'RuJBt':function(_0x46b14c){return _0x46b14c();},'yJSjA':function(_0x566c1f,_0x12bc12,_0x2abf98){return _0x566c1f(_0x12bc12,_0x2abf98);},'dKQLG':_0x4079e0(0x196),'nSuJW':function(_0x4af47e,_0x3e4164){return _0x4af47e!==_0x3e4164;},'thlOK':_0x4079e0(0x1e0),'SdqBW':function(_0x3be274,_0x1a6776){return _0x3be274===_0x1a6776;},'YQGDa':_0x4079e0(0x2b8),'kaDQr':_0x4079e0(0x1ad),'zrFlf':_0x4079e0(0x190),'fETVo':function(_0x2d1ea4,_0x233458,_0x2e4e01){return _0x2d1ea4(_0x233458,_0x2e4e01);},'GRGDi':'Success','LwqlT':_0x4079e0(0x12e),'CzwcC':_0x4079e0(0x30d),'rcbcB':function(_0x1dffcb){return _0x1dffcb();},'HLCao':function(_0x127002,_0x338d92,_0x33f9e8){return _0x127002(_0x338d92,_0x33f9e8);},'iUgsQ':_0x4079e0(0x2c5),'PLDdL':_0x4079e0(0x24d),'cAfak':_0x4079e0(0x1ae)};showLoader(),import(_0x852c6f[_0x4079e0(0x10d)])[_0x4079e0(0x2e7)](_0x5c9841=>{const _0x2503ff=_0x4079e0,_0x27eac7={'PCWha':function(_0x4ad736,_0x5f2593){const _0x3e932b=a12_0x4a07;return _0x852c6f[_0x3e932b(0x1f9)](_0x4ad736,_0x5f2593);},'oGRnn':_0x852c6f[_0x2503ff(0x18d)]},{getTrainData:_0x34ac3f}=_0x5c9841,_0x386d60=_0x852c6f[_0x2503ff(0x150)](_0x34ac3f);if(0x0===_0x386d60[_0x2503ff(0x1fa)])return _0x852c6f[_0x2503ff(0x150)](hideLoader),void _0x852c6f[_0x2503ff(0x1ea)](showCustomAlert,_0x852c6f['dKQLG'],'There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.');let _0x19ca0c=_0x386d60;if(_0x852c6f[_0x2503ff(0x220)](_0x852c6f['thlOK'],_0x2f5057)&&(_0x19ca0c=Array[_0x2503ff(0x1ac)](_0x2f5057)?_0x386d60[_0x2503ff(0x1b2)](_0x11748f=>_0x2f5057[_0x2503ff(0xdf)](String(_0x11748f['id']))):_0x386d60[_0x2503ff(0x1b2)](_0x197350=>String(_0x197350['id'])===String(_0x2f5057))),_0x852c6f[_0x2503ff(0x311)](0x0,_0x19ca0c['length']))return _0x852c6f[_0x2503ff(0x150)](hideLoader),void _0x852c6f[_0x2503ff(0x1ea)](showCustomAlert,'No\x20Data',_0x2503ff(0xf5));const _0x2dd20e=[];_0x19ca0c['forEach'](_0x152f4a=>{const _0x2591a0=_0x2503ff,_0x1fd7c9=_0x152f4a['machineIds'][_0x2591a0(0x2be)](_0xfc0e43=>{const _0x4d04c5=_0x2591a0,_0x2897af=a12_0x275932[_0x4d04c5(0x1aa)][_0x4d04c5(0x292)](_0x473486=>_0x473486['id']===_0xfc0e43);return _0x2897af||{'id':_0xfc0e43,'name':_0x4d04c5(0x29c)+_0xfc0e43+')','machineNumber':_0x4d04c5(0x1cc)};}),_0x262638=_0x5c9841[_0x2591a0(0x275)](_0x152f4a[_0x2591a0(0x1ce)])[_0x2591a0(0x2be)](_0x3e5104=>_0x3e5104[_0x2591a0(0x129)]?_0x3e5104['group']+'\x20('+_0x3e5104[_0x2591a0(0xd5)]+'x)':_0x3e5104['name'])[_0x2591a0(0x26a)]('\x20→\x20'),_0xaf71a6=_0x152f4a[_0x2591a0(0x2b5)]['map'](_0x11161e=>_0x11161e[_0x2591a0(0x1a3)]+_0x2591a0(0x1d8)+_0x11161e[_0x2591a0(0x2e8)])[_0x2591a0(0x26a)](';\x20'),_0x3fcf4e=_0x152f4a[_0x2591a0(0x2b5)][_0x2591a0(0x2be)](_0x4cd26f=>_0x4cd26f[_0x2591a0(0x1a3)]+':\x20'+_0x4cd26f[_0x2591a0(0x2e8)])[_0x2591a0(0x26a)]('\x0a'),_0x79de24=_0x1fd7c9['map'](_0xdeae92=>_0xdeae92[_0x2591a0(0x138)]+':\x20'+_0xdeae92['name'])[_0x2591a0(0x26a)]('\x0a');_0x2dd20e['push']({'Train\x20ID':'T'+_0x152f4a['id'],'Products\x20Count':_0x152f4a['products'][_0x2591a0(0x1fa)],'Machines\x20Count':_0x1fd7c9['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x152f4a['essa']['toLocaleString'](),'Products\x20(Code\x20-\x20Name)':_0xaf71a6,'Machines\x20(Number\x20-\x20Name)':_0x262638,'Products\x20Detailed':_0x3fcf4e,'Machines\x20Detailed':_0x79de24,'Min\x20Batch\x20Size\x20(kg)':_0x152f4a['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x152f4a[_0x2591a0(0x1ff)][_0x2591a0(0x239)](0x2),'Assumed\x20SSA\x20(cm²)':_0x152f4a[_0x2591a0(0x18a)],'Lowest\x20LTD\x20(mg)':_0x152f4a[_0x2591a0(0x158)],'Lowest\x20PDE\x20(mg)':_0x27eac7[_0x2591a0(0x1d2)](null,_0x152f4a[_0x2591a0(0x19d)])?_0x152f4a[_0x2591a0(0x19d)]:_0x27eac7[_0x2591a0(0x173)],'Worst\x20RPN\x20Product':_0x152f4a[_0x2591a0(0x1a7)]?_0x152f4a[_0x2591a0(0x1a7)]['productName']+'\x20('+_0x152f4a[_0x2591a0(0x1a7)]['ingredientName']+')\x20-\x20RPN:\x20'+_0x152f4a[_0x2591a0(0x1a7)][_0x2591a0(0xd1)]:_0x2591a0(0x1cc)});});const _0x54115a=XLSX['utils']['json_to_sheet'](_0x2dd20e),_0xbb25eb=XLSX['utils'][_0x2503ff(0x155)]();XLSX[_0x2503ff(0x168)][_0x2503ff(0x174)](_0xbb25eb,_0x54115a,_0x852c6f[_0x2503ff(0x105)]),_0x54115a[_0x852c6f[_0x2503ff(0x17b)]]=[{'wch':0xa},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x3c},{'wch':0x3c},{'wch':0x28},{'wch':0x28},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32}];const _0x4396b8=new Date()[_0x2503ff(0x109)]()['split']('T')[0x0];let _0x31b807=_0x852c6f['zrFlf'];if(_0x852c6f['LLSRU'](_0x852c6f['thlOK'],_0x2f5057)){if(Array[_0x2503ff(0x1ac)](_0x2f5057))_0x31b807+=_0x2503ff(0x1c5)+_0x2f5057[_0x2503ff(0x165)]((_0xfa440,_0x507139)=>_0xfa440-_0x507139)[_0x2503ff(0x26a)]('_');else _0x31b807+='_Train_'+_0x2f5057;}_0x31b807+='_'+_0x4396b8+_0x2503ff(0xed),XLSX[_0x2503ff(0x2a6)](_0xbb25eb,_0x31b807),_0x852c6f[_0x2503ff(0x150)](hideLoader),_0x852c6f[_0x2503ff(0x251)](showCustomAlert,_0x852c6f[_0x2503ff(0x1ed)],_0x852c6f['LwqlT']);})[_0x4079e0(0x15c)](_0x42f304=>{const _0x19f2b0=_0x4079e0;console['error'](_0x852c6f[_0x19f2b0(0x1bc)],_0x42f304),_0x852c6f[_0x19f2b0(0x2af)](hideLoader),_0x852c6f['HLCao'](showCustomAlert,_0x852c6f['iUgsQ'],_0x852c6f[_0x19f2b0(0xfd)]);});}export function exportSummaryToExcel(){const _0x661a4d=a12_0x3bc3c7,_0x5cd308={'cPMTE':function(_0xf36e26,_0x3a83f8){return _0xf36e26(_0x3a83f8);},'GgAMa':function(_0x1c01a8,_0x15383a){return _0x1c01a8>_0x15383a;},'pMoIn':_0x661a4d(0x1cc),'pwkwS':_0x661a4d(0x1ab),'RAnel':function(_0x43047d,_0x34700c){return _0x43047d===_0x34700c;},'WGeMk':'There\x20are\x20no\x20summary\x20data\x20to\x20export.\x20Add\x20products\x20and\x20ingredients\x20first.','RrCoD':_0x661a4d(0x1ad),'ggSsP':_0x661a4d(0x25c),'IEmcZ':function(_0x552c64,_0x1ddf48){return _0x552c64>_0x1ddf48;},'ZxADx':_0x661a4d(0x314),'Gvxpn':_0x661a4d(0x231),'Wxgao':function(_0x2928f1){return _0x2928f1();},'pnYrm':function(_0x37ad50,_0xd65be3,_0x4a303b){return _0x37ad50(_0xd65be3,_0x4a303b);},'fUvCi':_0x661a4d(0x232),'Ndtjx':'Summary\x20report\x20data\x20exported\x20to\x20Excel\x20successfully!','lnuSt':'Error\x20exporting\x20Summary\x20to\x20Excel:','FCWhd':function(_0x39da32,_0x363e6a,_0x5fdd8){return _0x39da32(_0x363e6a,_0x5fdd8);},'wRocx':_0x661a4d(0x2c5),'UAJPF':'Failed\x20to\x20export\x20Summary\x20report\x20data\x20to\x20Excel.','nsoTo':_0x661a4d(0x1ae)};_0x5cd308[_0x661a4d(0x2d4)](showLoader),import(_0x5cd308[_0x661a4d(0x10c)])['then'](_0x2f7490=>{const _0x3af059=_0x661a4d,_0x33db38={'uznNT':function(_0x55cddb,_0x5dd7db){const _0x5cf097=a12_0x4a07;return _0x5cd308[_0x5cf097(0x229)](_0x55cddb,_0x5dd7db);},'RwOgf':function(_0x4fca92,_0x89c95){const _0x304c54=a12_0x4a07;return _0x5cd308[_0x304c54(0x22b)](_0x4fca92,_0x89c95);},'cuFRu':function(_0x2a82b7,_0xc7f711){return _0x2a82b7!==_0xc7f711;},'ioaVL':_0x5cd308[_0x3af059(0x19e)],'NiOne':_0x5cd308['pwkwS']},{getProductTrainId:_0x35b606,calculateScores:_0x414eb}=_0x2f7490,_0x2aae4d=a12_0x275932[_0x3af059(0x2b5)][_0x3af059(0x22a)](_0x23ce02=>{const _0x281cc9=_0x3af059,_0x478f38=_0x35b606(_0x23ce02);return _0x23ce02[_0x281cc9(0x315)][_0x281cc9(0x2be)](_0x3c7e54=>({'productName':_0x23ce02[_0x281cc9(0x2e8)],'productCode':_0x23ce02[_0x281cc9(0x1a3)],'ingredientName':_0x3c7e54['name'],'rpn':_0x414eb(_0x3c7e54)[_0x281cc9(0xd1)],'trainId':_0x281cc9(0x1cc)!==_0x478f38?'T'+_0x478f38:_0x281cc9(0x1cc),'scores':_0x414eb(_0x3c7e54)}));})[_0x3af059(0x165)]((_0x803fa9,_0x37b82f)=>_0x37b82f[_0x3af059(0xd1)]-_0x803fa9[_0x3af059(0xd1)])['slice'](0x0,0xa),_0x2131ae=a12_0x275932[_0x3af059(0x2b5)]['filter'](_0x4cec96=>_0x4cec96[_0x3af059(0x27a)]);if(_0x5cd308[_0x3af059(0x125)](0x0,_0x2aae4d['length'])&&_0x5cd308['RAnel'](0x0,_0x2131ae[_0x3af059(0x1fa)]))return hideLoader(),void showCustomAlert(_0x3af059(0x196),_0x5cd308[_0x3af059(0x24b)]);const _0x49bf53=XLSX['utils']['book_new']();if(_0x5cd308[_0x3af059(0x22b)](_0x2aae4d[_0x3af059(0x1fa)],0x0)){const _0x76d49e=_0x2aae4d['map']((_0x4fbf6c,_0x3b851b)=>({'Rank':_0x3b851b+0x1,'Product\x20Code':_0x4fbf6c[_0x3af059(0x1a3)],'Product\x20Name':_0x4fbf6c['productName'],'Train':_0x4fbf6c[_0x3af059(0xee)],'Ingredient':_0x4fbf6c[_0x3af059(0x207)],'RPN':_0x4fbf6c['rpn']})),_0x1db445=XLSX['utils'][_0x3af059(0x2c9)](_0x76d49e),_0x44a31f=[{'wch':0x8},{'wch':0xf},{'wch':0x1e},{'wch':0xa},{'wch':0x19},{'wch':0x8}];_0x1db445[_0x5cd308[_0x3af059(0x14a)]]=_0x44a31f,XLSX[_0x3af059(0x168)][_0x3af059(0x174)](_0x49bf53,_0x1db445,_0x5cd308[_0x3af059(0x135)]);}if(_0x5cd308[_0x3af059(0x1be)](_0x2131ae[_0x3af059(0x1fa)],0x0)){const _0x24ccfb=_0x2131ae['map'](_0x374076=>({'Product\x20Code':_0x374076[_0x3af059(0x1a3)],'Product\x20Name':_0x374076['name'],'Product\x20Type':_0x374076[_0x3af059(0x20e)],'Batch\x20Size\x20(kg)':_0x374076[_0x3af059(0x13f)],'MDD\x20(mg)':_0x374076[_0x3af059(0x290)],'Critical\x20Reason':_0x374076[_0x3af059(0x13c)]||_0x3af059(0x27b),'Train':_0x3af059(0x1cc)!==_0x35b606(_0x374076)?'T'+_0x35b606(_0x374076):_0x3af059(0x1cc)})),_0xce1c3c=XLSX['utils'][_0x3af059(0x2c9)](_0x24ccfb),_0xb6b9e=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32},{'wch':0xa}];_0xce1c3c[_0x5cd308[_0x3af059(0x14a)]]=_0xb6b9e,XLSX[_0x3af059(0x168)][_0x3af059(0x174)](_0x49bf53,_0xce1c3c,_0x5cd308['ZxADx']);}const _0x1cb8e6=a12_0x275932['products']['map'](_0xc848ee=>{const _0x4f0a52=_0x3af059,_0x13d7ce=_0x33db38['uznNT'](_0x35b606,_0xc848ee),_0x48366b=_0xc848ee[_0x4f0a52(0x315)][_0x4f0a52(0x1a0)]((_0x3676a9,_0x5ce62f)=>{const _0x14f785=_0x4f0a52,_0x21eb1a=_0x33db38[_0x14f785(0x24a)](_0x414eb,_0x5ce62f)[_0x14f785(0xd1)];return _0x33db38[_0x14f785(0x2a7)](_0x21eb1a,_0x3676a9[_0x14f785(0xd1)])?{..._0x5ce62f,'rpn':_0x21eb1a}:_0x3676a9;},{'rpn':0x0,'name':_0x4f0a52(0x1cc)});return{'Product\x20Code':_0xc848ee[_0x4f0a52(0x1a3)],'Product\x20Name':_0xc848ee[_0x4f0a52(0x2e8)],'Product\x20Type':_0xc848ee[_0x4f0a52(0x20e)],'Batch\x20Size\x20(kg)':_0xc848ee[_0x4f0a52(0x13f)],'MDD\x20(mg)':_0xc848ee['mddMg'],'Train':_0x33db38['cuFRu'](_0x33db38['ioaVL'],_0x13d7ce)?'T'+_0x13d7ce:_0x33db38['ioaVL'],'Is\x20Critical':_0xc848ee[_0x4f0a52(0x27a)]?_0x33db38[_0x4f0a52(0x2bc)]:'No','Critical\x20Reason':_0xc848ee[_0x4f0a52(0x13c)]||_0x33db38[_0x4f0a52(0x12d)],'Ingredients\x20Count':_0xc848ee[_0x4f0a52(0x315)][_0x4f0a52(0x1fa)],'Highest\x20RPN\x20Ingredient':_0x48366b['name'],'Highest\x20RPN\x20Value':_0x48366b[_0x4f0a52(0xd1)]||0x0};}),_0x2db2bd=XLSX['utils'][_0x3af059(0x2c9)](_0x1cb8e6);_0x2db2bd[_0x5cd308[_0x3af059(0x14a)]]=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xa},{'wch':0xa},{'wch':0x28},{'wch':0xc},{'wch':0x19},{'wch':0xc}],XLSX[_0x3af059(0x168)][_0x3af059(0x174)](_0x49bf53,_0x2db2bd,_0x5cd308[_0x3af059(0x2c7)]);const _0x257149=new Date()[_0x3af059(0x109)]()[_0x3af059(0x240)]('T')[0x0];XLSX[_0x3af059(0x2a6)](_0x49bf53,_0x3af059(0xe7)+_0x257149+_0x3af059(0xed)),_0x5cd308[_0x3af059(0x2d4)](hideLoader),_0x5cd308[_0x3af059(0x250)](showCustomAlert,_0x5cd308['fUvCi'],_0x5cd308[_0x3af059(0x1e2)]);})[_0x661a4d(0x15c)](_0x45fe31=>{const _0x1bacc2=_0x661a4d;console[_0x1bacc2(0xce)](_0x5cd308[_0x1bacc2(0x2c0)],_0x45fe31),_0x5cd308['Wxgao'](hideLoader),_0x5cd308[_0x1bacc2(0x277)](showCustomAlert,_0x5cd308['wRocx'],_0x5cd308[_0x1bacc2(0x122)]);});}export function exportAllTabsToExcel(){const _0xeb75fb=a12_0x3bc3c7,_0x3efa6c={'JGkSI':function(_0xd6a17d,_0x33bca8){return _0xd6a17d(_0x33bca8);},'nIlOt':function(_0x33db70,_0x18008d){return _0x33db70*_0x18008d;},'TUMOx':function(_0x5eb0b4,_0x49c2b0){return _0x5eb0b4*_0x49c2b0;},'yzBCb':function(_0xe00dcb,_0x5d7514){return _0xe00dcb>_0x5d7514;},'QBASh':function(_0x41c7e4,_0x343c68){return _0x41c7e4/_0x343c68;},'ASxjj':function(_0x18d442,_0x5146e7){return _0x18d442*_0x5146e7;},'ELFOd':_0xeb75fb(0x1cd),'EnZWC':_0xeb75fb(0x1cc),'NMxns':function(_0x2a815a,_0x5dbbef){return _0x2a815a!==_0x5dbbef;},'VsDxu':function(_0xa463ec,_0x446ddd){return _0xa463ec||_0x446ddd;},'QLQtS':function(_0x3d45c9,_0x3c4e6b){return _0x3d45c9/_0x3c4e6b;},'FxLYV':function(_0x83e6fc,_0xcd8788){return _0x83e6fc*_0xcd8788;},'dvBZI':function(_0x3754d6,_0x1ffd01){return _0x3754d6*_0x1ffd01;},'aUjdT':_0xeb75fb(0x1b1),'reMWG':function(_0x5bf0a0,_0x3b2cb5){return _0x5bf0a0==_0x3b2cb5;},'QNKbn':'number','mGfUZ':'Visual\x20Clean\x20Limit','xHJEj':function(_0x4c2a4b,_0x488d88){return _0x4c2a4b>_0x488d88;},'AhuNI':function(_0x532431,_0x195973){return _0x532431(_0x195973);},'kIxTR':function(_0x3837ae,_0x276571){return _0x3837ae(_0x276571);},'XsIEc':_0xeb75fb(0x1ab),'tLpvt':_0xeb75fb(0x175),'kUFIg':function(_0x21da7d){return _0x21da7d();},'OUAVV':function(_0x38f49a,_0x1d9dc3,_0x2ff24b){return _0x38f49a(_0x1d9dc3,_0x2ff24b);},'VhJSK':_0xeb75fb(0x196),'ggSZM':_0xeb75fb(0x312),'TMsNW':_0xeb75fb(0xf7),'HKVNc':'Error\x20creating\x20Product\x20MACO\x20sheet:','rkmjP':function(_0x29cef6,_0x4539db){return _0x29cef6>_0x4539db;},'fAJau':_0xeb75fb(0x21a),'ueGnd':_0xeb75fb(0x12a),'btnGo':'Train\x20Summary','MvQUP':_0xeb75fb(0xd0),'NYaap':_0xeb75fb(0x25c),'uMWiW':'Error\x20creating\x20Top\x2010\x20RPN\x20sheet:','hOkUZ':_0xeb75fb(0x314),'BwRWJ':_0xeb75fb(0x144),'dJOmB':_0xeb75fb(0x231),'SvLyG':_0xeb75fb(0x2da),'nYvIU':_0xeb75fb(0x26c),'isMJa':function(_0x12f105){return _0x12f105();},'NnqtJ':function(_0x16729b,_0xbc4213,_0x1c5a97){return _0x16729b(_0xbc4213,_0x1c5a97);},'EtJsM':'Error\x20exporting\x20all\x20tabs\x20to\x20Excel:','nUlrN':_0xeb75fb(0x2c5),'lgrLi':_0xeb75fb(0x1ae)};showLoader(),import(_0x3efa6c[_0xeb75fb(0x2d8)])['then'](_0x54cbbf=>{const _0x27a5b3=_0xeb75fb,_0xf4558f={'OaNHl':function(_0x58a5ad,_0x11c9c8){return _0x3efa6c['VsDxu'](_0x58a5ad,_0x11c9c8);},'kxMzQ':_0x3efa6c[_0x27a5b3(0x262)],'IUQHM':function(_0x2153d2,_0x40c441){const _0x50a9f5=_0x27a5b3;return _0x3efa6c[_0x50a9f5(0x28f)](_0x2153d2,_0x40c441);},'ZDJhS':function(_0x5da622,_0xbe31c3){const _0x397da5=_0x27a5b3;return _0x3efa6c[_0x397da5(0x170)](_0x5da622,_0xbe31c3);},'ZWZuU':function(_0x188b9a,_0xfebd09){return _0x3efa6c['FxLYV'](_0x188b9a,_0xfebd09);},'VEVUA':function(_0x5e2bec,_0x4cb778){return _0x5e2bec!==_0x4cb778;},'CHijX':function(_0xec419f,_0x175b3b){const _0x4879a2=_0x27a5b3;return _0x3efa6c[_0x4879a2(0x13e)](_0xec419f,_0x175b3b);},'Nkxjb':_0x3efa6c[_0x27a5b3(0x160)],'oUtVo':_0x27a5b3(0x246),'dlkYh':function(_0x1d59d3,_0x725ada){const _0x52edff=_0x27a5b3;return _0x3efa6c[_0x52edff(0x2c6)](_0x1d59d3,_0x725ada);},'ofwSM':_0x3efa6c[_0x27a5b3(0x16a)],'sqGHY':function(_0x4f1f51,_0x5a585e){return _0x4f1f51/_0x5a585e;},'jNKfz':_0x3efa6c[_0x27a5b3(0x197)],'nmeCV':function(_0x2f7400,_0x594b43){const _0x36bad6=_0x27a5b3;return _0x3efa6c[_0x36bad6(0x113)](_0x2f7400,_0x594b43);},'BxhXe':_0x3efa6c['ELFOd'],'uAqAc':function(_0x56b5cf,_0x343de6){const _0x1c1698=_0x27a5b3;return _0x3efa6c[_0x1c1698(0x237)](_0x56b5cf,_0x343de6);},'umPwQ':function(_0x379bab,_0x886079){const _0x4506be=_0x27a5b3;return _0x3efa6c[_0x4506be(0x237)](_0x379bab,_0x886079);},'tWVnj':function(_0x6ab811,_0x11efc5){const _0x21d494=_0x27a5b3;return _0x3efa6c[_0x21d494(0x1e9)](_0x6ab811,_0x11efc5);},'ySXyQ':function(_0x49d12f,_0x593fc1){return _0x3efa6c['kIxTR'](_0x49d12f,_0x593fc1);},'ejEBz':function(_0x2be52e,_0x1d941c){return _0x2be52e!==_0x1d941c;},'XuHGQ':_0x3efa6c[_0x27a5b3(0x228)],'vruaQ':function(_0x128a42,_0x3da4c5){const _0x28f700=_0x27a5b3;return _0x3efa6c[_0x28f700(0x269)](_0x128a42,_0x3da4c5);},'YxUnQ':_0x3efa6c['tLpvt']},{getTrainData:_0x361395,getWorstCaseProductType:_0x30b555,getProductTrainId:_0x4d30bf,calculateScores:_0x5ba85e}=_0x54cbbf,_0x186fca=_0x3efa6c['kUFIg'](_0x361395);if(0x0===_0x186fca[_0x27a5b3(0x1fa)])return hideLoader(),void _0x3efa6c[_0x27a5b3(0x2ea)](showCustomAlert,_0x3efa6c[_0x27a5b3(0x2ed)],_0x3efa6c[_0x27a5b3(0x141)]);const _0x2fd1c6=XLSX[_0x27a5b3(0x168)][_0x27a5b3(0x155)]();try{const _0x56f5f7=_0x186fca['reduce']((_0x1cd898,_0x7eb76d)=>_0x7eb76d['essa']>_0x1cd898['essa']?_0x7eb76d:_0x1cd898)[_0x27a5b3(0x316)],_0xca2e8=[];_0x186fca[_0x27a5b3(0x291)](_0x9bb283=>{const _0x5ad266=_0x27a5b3,_0x54bee3={'ocNok':function(_0xf3defb,_0x1ba779){const _0x327a07=a12_0x4a07;return _0xf4558f[_0x327a07(0x2bb)](_0xf3defb,_0x1ba779);},'bobXh':_0xf4558f[_0x5ad266(0x19a)]},_0x4380e6=_0xf4558f[_0x5ad266(0x23c)](_0x30b555,_0x9bb283[_0x5ad266(0x2b5)]['map'](_0x403b86=>_0x403b86[_0x5ad266(0x20e)])),_0x45f0c7=(a12_0x275932[_0x5ad266(0xe9)][_0x4380e6]||a12_0x275932[_0x5ad266(0xe9)]['Other'])[_0x5ad266(0x2d1)],_0x2573e3=_0xf4558f[_0x5ad266(0x11a)](_0xf4558f[_0x5ad266(0x14e)](_0x9bb283[_0x5ad266(0x158)],_0x9bb283[_0x5ad266(0x1ff)]),_0x45f0c7),_0x4fddfd=0xa*_0x9bb283['minMbsKg'];let _0x538b5f=_0xf4558f['kxMzQ'];_0xf4558f[_0x5ad266(0x2f3)](null,_0x9bb283['lowestPde'])&&(_0x538b5f=_0xf4558f[_0x5ad266(0x14e)](_0x9bb283[_0x5ad266(0x19d)],_0x9bb283[_0x5ad266(0x1ff)]));const _0x389cd3=_0xf4558f[_0x5ad266(0x1c3)](0.004,_0x56f5f7),_0x2287ec=[{'name':_0xf4558f[_0x5ad266(0x15b)],'value':_0x2573e3},{'name':'10\x20ppm\x20Criterion','value':_0x4fddfd},{'name':_0xf4558f['oUtVo'],'value':_0xf4558f['dlkYh'](_0xf4558f[_0x5ad266(0x1b0)],typeof _0x538b5f)?_0x538b5f:_0xf4558f[_0x5ad266(0x131)](0x1,0x0)},{'name':_0xf4558f[_0x5ad266(0x2b9)],'value':_0x389cd3}][_0x5ad266(0x1a0)]((_0x528d98,_0x290a74)=>_0x290a74[_0x5ad266(0x293)]<_0x528d98[_0x5ad266(0x293)]?_0x290a74:_0x528d98),_0x4fa5ce=_0x2287ec[_0x5ad266(0x293)],_0x14ca9f=_0xf4558f[_0x5ad266(0x140)](_0x56f5f7,0x0)?_0x4fa5ce/_0x56f5f7:0x0,_0x5dfecf=_0x14ca9f*_0x9bb283[_0x5ad266(0x18a)],_0x39b51c=_0x9bb283[_0x5ad266(0x1ce)]['map'](_0x39b622=>{const _0x5a4ea0=_0x5ad266,_0x3260dc=a12_0x275932[_0x5a4ea0(0x1aa)][_0x5a4ea0(0x292)](_0x4892f1=>_0x4892f1['id']===_0x39b622);return _0x54bee3['ocNok'](_0x3260dc,{'name':'Unknown\x20(ID:\x20'+_0x39b622+')','machineNumber':_0x54bee3['bobXh']});}),_0x3d5361=_0x54cbbf[_0x5ad266(0x275)](_0x9bb283['machineIds'])[_0x5ad266(0x2be)](_0x3b4b38=>_0x3b4b38[_0x5ad266(0x129)]?_0x3b4b38['group']+'\x20('+_0x3b4b38[_0x5ad266(0xd5)]+'x)':_0x3b4b38[_0x5ad266(0x2e8)])[_0x5ad266(0x26a)](_0xf4558f[_0x5ad266(0xd3)]),_0xf7254a=_0x9bb283['products'][_0x5ad266(0x2be)](_0x21725f=>_0x21725f[_0x5ad266(0x1a3)]+_0x5ad266(0x1d8)+_0x21725f[_0x5ad266(0x2e8)])['join'](';\x20'),_0x113014=_0x9bb283[_0x5ad266(0x1a7)]?_0x9bb283['worstProductRpn'][_0x5ad266(0x26e)]+'\x20('+_0x9bb283[_0x5ad266(0x1a7)][_0x5ad266(0x207)]+')\x20-\x20RPN:\x20'+_0x9bb283[_0x5ad266(0x1a7)]['rpn']:_0xf4558f[_0x5ad266(0x19a)];_0xca2e8[_0x5ad266(0x2a0)]({'Train':'T'+_0x9bb283['id'],'Total\x20Products':_0x9bb283[_0x5ad266(0x2b5)][_0x5ad266(0x1fa)],'Total\x20Machines':_0x39b51c[_0x5ad266(0x1fa)],'Total\x20Area\x20(ESSA)\x20cm²':_0x9bb283[_0x5ad266(0x316)]['toLocaleString'](),'Products':_0xf7254a,'Machines':_0x3d5361,'Worst-Case\x20Dosage\x20Form':_0x4380e6,'Safety\x20Factor':_0x45f0c7,'Lowest\x20LTD\x20(mg)':_0x9bb283[_0x5ad266(0x158)],'Min\x20Batch\x20Size\x20(kg)':_0x9bb283[_0x5ad266(0x103)],'Min\x20BS/MDD\x20Ratio':_0x9bb283[_0x5ad266(0x1ff)]['toFixed'](0x2),'Lowest\x20PDE\x20(mg)':_0xf4558f['VEVUA'](null,_0x9bb283[_0x5ad266(0x19d)])?_0x9bb283[_0x5ad266(0x19d)]:'N/A','Worst-Case\x20Product\x20(by\x20RPN)':_0x113014,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x2573e3[_0x5ad266(0x239)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x4fddfd[_0x5ad266(0x239)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0xf4558f['dlkYh'](_0xf4558f[_0x5ad266(0x1b0)],typeof _0x538b5f)?_0x538b5f['toFixed'](0x2):_0xf4558f[_0x5ad266(0x19a)],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x389cd3[_0x5ad266(0x239)](0x2),'Selected\x20MACO\x20Method':_0x2287ec[_0x5ad266(0x2e8)],'Final\x20MACO\x20(mg)':_0x4fa5ce[_0x5ad266(0x239)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x14ca9f[_0x5ad266(0x2ab)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x5dfecf['toFixed'](0x4)});});const _0x83362=XLSX[_0x27a5b3(0x168)][_0x27a5b3(0x2c9)](_0xca2e8);XLSX['utils']['book_append_sheet'](_0x2fd1c6,_0x83362,_0x3efa6c[_0x27a5b3(0x28e)]);}catch(_0x53f66a){console['error'](_0x3efa6c['HKVNc'],_0x53f66a);}try{if(_0x3efa6c[_0x27a5b3(0x283)](a12_0x275932['detergentIngredients']['length'],0x0)){const _0x42a5e0=_0x3efa6c[_0x27a5b3(0x113)](_0x186fca['length'],0x0)?Math['max'](..._0x186fca[_0x27a5b3(0x2be)](_0x5e987d=>_0x5e987d[_0x27a5b3(0x316)])):0x0,_0x1dc109=_0x3efa6c['AhuNI'](parseFloat,document[_0x27a5b3(0x2d7)](_0x3efa6c[_0x27a5b3(0x27c)])?.['value'])||0x46,_0x22403f=a12_0x275932[_0x27a5b3(0x297)][_0x27a5b3(0x2be)](_0x339981=>parseFloat(_0x339981[_0x27a5b3(0x14c)]))[_0x27a5b3(0x1b2)](_0x3201de=>!isNaN(_0x3201de)),_0x1a3dae=_0x3efa6c[_0x27a5b3(0x283)](_0x22403f['length'],0x0)?Math[_0x27a5b3(0x14d)](..._0x22403f):0x0,_0x53fd95=a12_0x275932[_0x27a5b3(0x297)][_0x27a5b3(0x2be)](_0x1c663c=>_0x1c663c[_0x27a5b3(0x2e8)])[_0x27a5b3(0x1b2)](_0x195d5a=>''!==_0x195d5a[_0x27a5b3(0x2c4)]())[_0x27a5b3(0x26a)](',\x20'),_0x18f5d9=[];_0x186fca['forEach'](_0x22bdbc=>{const _0x2ab915=_0x27a5b3,_0x3b087d=_0x3efa6c[_0x2ab915(0x28f)](_0x30b555,_0x22bdbc[_0x2ab915(0x2b5)]['map'](_0x32a191=>_0x32a191[_0x2ab915(0x20e)])),_0x572ea9=a12_0x275932['safetyFactorConfig'][_0x3b087d]||a12_0x275932[_0x2ab915(0xe9)][_0x2ab915(0x279)],_0x180856=document[_0x2ab915(0x2d7)](_0x2ab915(0x2ec)+_0x22bdbc['id']),_0x26bc4d=_0x180856&&_0x3efa6c[_0x2ab915(0x28f)](parseFloat,_0x180856['value'])||_0x572ea9[_0x2ab915(0x2d1)],_0x159d92=_0x3efa6c['nIlOt'](_0x3efa6c[_0x2ab915(0x249)](0.0005,_0x1a3dae),_0x1dc109)/_0x26bc4d,_0x3a1ba1=_0x3efa6c['TUMOx'](_0x159d92,_0x22bdbc[_0x2ab915(0x1ff)]),_0x160a6b=_0x3efa6c['yzBCb'](_0x42a5e0,0x0)?_0x3efa6c['QBASh'](_0x3a1ba1,_0x42a5e0):0x0,_0x478a13=_0x3efa6c['ASxjj'](_0x160a6b,_0x22bdbc[_0x2ab915(0x18a)]),_0x409c46=_0x22bdbc['machineIds'][_0x2ab915(0x2be)](_0x403d79=>{const _0x3a7cb4=_0x2ab915,_0x3c4f85=a12_0x275932['machines'][_0x3a7cb4(0x292)](_0xa8b5b4=>_0xa8b5b4['id']===_0x403d79);return _0xf4558f[_0x3a7cb4(0x2b7)](_0x3c4f85,{'name':_0x3a7cb4(0x29c)+_0x403d79+')','machineNumber':_0xf4558f[_0x3a7cb4(0x19a)]});}),_0x254a52=_0x54cbbf['consolidateMachinesByGroup'](_0x22bdbc[_0x2ab915(0x1ce)])[_0x2ab915(0x2be)](_0xd2421f=>_0xd2421f[_0x2ab915(0x129)]?_0xd2421f[_0x2ab915(0xfc)]+'\x20('+_0xd2421f[_0x2ab915(0xd5)]+'x)':_0xd2421f['name'])['join'](_0x3efa6c[_0x2ab915(0x211)]),_0x1a5997=_0x22bdbc[_0x2ab915(0x2b5)]['map'](_0x737cbf=>_0x737cbf[_0x2ab915(0x1a3)]+_0x2ab915(0x1d8)+_0x737cbf[_0x2ab915(0x2e8)])[_0x2ab915(0x26a)](';\x20'),_0x50bded=_0x22bdbc[_0x2ab915(0x1a7)]?_0x22bdbc[_0x2ab915(0x1a7)][_0x2ab915(0x26e)]+'\x20('+_0x22bdbc[_0x2ab915(0x1a7)][_0x2ab915(0x207)]+')\x20-\x20RPN:\x20'+_0x22bdbc['worstProductRpn'][_0x2ab915(0xd1)]:_0x3efa6c[_0x2ab915(0x262)];_0x18f5d9[_0x2ab915(0x2a0)]({'Train':'T'+_0x22bdbc['id'],'Total\x20Products':_0x22bdbc['products'][_0x2ab915(0x1fa)],'Total\x20Machines':_0x409c46[_0x2ab915(0x1fa)],'Total\x20Area\x20(ESSA)\x20cm²':_0x22bdbc[_0x2ab915(0x316)][_0x2ab915(0x2fe)](),'Products':_0x1a5997,'Machines':_0x254a52,'Worst-Case\x20Dosage\x20Form':_0x3b087d,'Safety\x20Factor\x20Range':_0x572ea9['min']+_0x2ab915(0x1d8)+_0x572ea9[_0x2ab915(0x2d1)],'Applied\x20Safety\x20Factor':_0x26bc4d,'Detergent\x20Ingredients':_0x53fd95,'Body\x20Weight\x20(kg)':_0x1dc109,'Minimum\x20LD50\x20(mg/kg)':_0x1a3dae,'Min\x20Batch\x20Size\x20(kg)':_0x22bdbc['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x22bdbc[_0x2ab915(0x1ff)][_0x2ab915(0x239)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x50bded,'ADI\x20(mg)':_0x159d92[_0x2ab915(0x239)](0x4),'MACO\x20(mg)':_0x3a1ba1['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x160a6b['toExponential'](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x478a13[_0x2ab915(0x239)](0x4)});});const _0x147f42=XLSX['utils'][_0x27a5b3(0x2c9)](_0x18f5d9);XLSX[_0x27a5b3(0x168)][_0x27a5b3(0x174)](_0x2fd1c6,_0x147f42,_0x27a5b3(0x236));}}catch(_0x23d0bb){console['error'](_0x3efa6c[_0x27a5b3(0x244)],_0x23d0bb);}try{const _0x4948c8=[];_0x186fca[_0x27a5b3(0x291)](_0xc77dda=>{const _0x535b5f=_0x27a5b3,_0x2b7449=_0xc77dda[_0x535b5f(0x1ce)][_0x535b5f(0x2be)](_0x1a5d9a=>{const _0x1bd50b=_0x535b5f,_0x644364=a12_0x275932['machines'][_0x1bd50b(0x292)](_0x3a74f0=>_0x3a74f0['id']===_0x1a5d9a);return _0xf4558f['umPwQ'](_0x644364,{'id':_0x1a5d9a,'name':_0x1bd50b(0x29c)+_0x1a5d9a+')','machineNumber':_0xf4558f['kxMzQ']});}),_0x49ebab=_0x54cbbf['consolidateMachinesByGroup'](_0xc77dda[_0x535b5f(0x1ce)])[_0x535b5f(0x2be)](_0x53baa7=>_0x53baa7[_0x535b5f(0x129)]?_0x53baa7[_0x535b5f(0xfc)]+'\x20('+_0x53baa7['machineCount']+'x)':_0x53baa7['name'])[_0x535b5f(0x26a)](_0x3efa6c[_0x535b5f(0x211)]),_0x51af81=_0xc77dda[_0x535b5f(0x2b5)][_0x535b5f(0x2be)](_0x2c686d=>_0x2c686d['productCode']+_0x535b5f(0x1d8)+_0x2c686d[_0x535b5f(0x2e8)])['join'](';\x20'),_0x244fb9=_0xc77dda[_0x535b5f(0x2b5)][_0x535b5f(0x2be)](_0x248cba=>_0x248cba[_0x535b5f(0x1a3)]+':\x20'+_0x248cba[_0x535b5f(0x2e8)])[_0x535b5f(0x26a)]('\x0a'),_0x5cb526=_0x2b7449[_0x535b5f(0x2be)](_0x136a45=>_0x136a45['machineNumber']+':\x20'+_0x136a45[_0x535b5f(0x2e8)])[_0x535b5f(0x26a)]('\x0a');_0x4948c8[_0x535b5f(0x2a0)]({'Train\x20ID':'T'+_0xc77dda['id'],'Products\x20Count':_0xc77dda['products'][_0x535b5f(0x1fa)],'Machines\x20Count':_0x2b7449['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0xc77dda[_0x535b5f(0x316)]['toLocaleString'](),'Products\x20(Code\x20-\x20Name)':_0x51af81,'Machines\x20(Number\x20-\x20Name)':_0x49ebab,'Products\x20Detailed':_0x244fb9,'Machines\x20Detailed':_0x5cb526,'Min\x20Batch\x20Size\x20(kg)':_0xc77dda[_0x535b5f(0x103)],'Min\x20BS/MDD\x20Ratio':_0xc77dda[_0x535b5f(0x1ff)][_0x535b5f(0x239)](0x2),'Assumed\x20SSA\x20(cm²)':_0xc77dda[_0x535b5f(0x18a)],'Lowest\x20LTD\x20(mg)':_0xc77dda['lowestLtd'],'Lowest\x20PDE\x20(mg)':_0x3efa6c[_0x535b5f(0x269)](null,_0xc77dda[_0x535b5f(0x19d)])?_0xc77dda['lowestPde']:_0x535b5f(0x1cc),'Worst\x20RPN\x20Product':_0xc77dda[_0x535b5f(0x1a7)]?_0xc77dda[_0x535b5f(0x1a7)]['productName']+'\x20('+_0xc77dda['worstProductRpn'][_0x535b5f(0x207)]+_0x535b5f(0x20b)+_0xc77dda[_0x535b5f(0x1a7)][_0x535b5f(0xd1)]:_0x3efa6c[_0x535b5f(0x262)]});});const _0x622b57=XLSX[_0x27a5b3(0x168)]['json_to_sheet'](_0x4948c8);XLSX['utils']['book_append_sheet'](_0x2fd1c6,_0x622b57,_0x3efa6c['btnGo']);}catch(_0x5033a6){console[_0x27a5b3(0xce)](_0x3efa6c[_0x27a5b3(0x1d7)],_0x5033a6);}try{const _0x4e6fb0=a12_0x275932[_0x27a5b3(0x2b5)]['flatMap'](_0x31d165=>{const _0x439460=_0x27a5b3,_0x796d15=_0xf4558f[_0x439460(0x310)](_0x4d30bf,_0x31d165);return _0x31d165[_0x439460(0x315)][_0x439460(0x2be)](_0x26de5f=>({'productName':_0x31d165[_0x439460(0x2e8)],'productCode':_0x31d165[_0x439460(0x1a3)],'ingredientName':_0x26de5f['name'],'rpn':_0x5ba85e(_0x26de5f)[_0x439460(0xd1)],'trainId':_0x439460(0x1cc)!==_0x796d15?'T'+_0x796d15:_0x439460(0x1cc)}));})['sort']((_0x131694,_0x3a8271)=>_0x3a8271['rpn']-_0x131694[_0x27a5b3(0xd1)])[_0x27a5b3(0xd4)](0x0,0xa);if(_0x3efa6c[_0x27a5b3(0x283)](_0x4e6fb0[_0x27a5b3(0x1fa)],0x0)){const _0x2d0223=_0x4e6fb0['map']((_0x1ec16f,_0x5e1711)=>({'Rank':_0x5e1711+0x1,'Product\x20Code':_0x1ec16f['productCode'],'Product\x20Name':_0x1ec16f[_0x27a5b3(0x26e)],'Train':_0x1ec16f[_0x27a5b3(0xee)],'Ingredient':_0x1ec16f[_0x27a5b3(0x207)],'RPN':_0x1ec16f['rpn']})),_0x1c2a08=XLSX[_0x27a5b3(0x168)][_0x27a5b3(0x2c9)](_0x2d0223);XLSX[_0x27a5b3(0x168)][_0x27a5b3(0x174)](_0x2fd1c6,_0x1c2a08,_0x3efa6c[_0x27a5b3(0x233)]);}}catch(_0x4b7237){console[_0x27a5b3(0xce)](_0x3efa6c[_0x27a5b3(0x169)],_0x4b7237);}try{const _0x48fed5=a12_0x275932['products'][_0x27a5b3(0x1b2)](_0x50285a=>_0x50285a[_0x27a5b3(0x27a)]);if(_0x3efa6c[_0x27a5b3(0x113)](_0x48fed5[_0x27a5b3(0x1fa)],0x0)){const _0x56efee=_0x48fed5['map'](_0x193d42=>({'Product\x20Code':_0x193d42[_0x27a5b3(0x1a3)],'Product\x20Name':_0x193d42[_0x27a5b3(0x2e8)],'Product\x20Type':_0x193d42[_0x27a5b3(0x20e)],'Batch\x20Size\x20(kg)':_0x193d42[_0x27a5b3(0x13f)],'MDD\x20(mg)':_0x193d42['mddMg'],'Critical\x20Reason':_0x193d42['criticalReason']||_0x27a5b3(0x27b),'Train':_0x27a5b3(0x1cc)!==_0x4d30bf(_0x193d42)?'T'+_0x4d30bf(_0x193d42):_0x27a5b3(0x1cc)})),_0x188309=XLSX[_0x27a5b3(0x168)][_0x27a5b3(0x2c9)](_0x56efee);XLSX[_0x27a5b3(0x168)]['book_append_sheet'](_0x2fd1c6,_0x188309,_0x3efa6c[_0x27a5b3(0x225)]);}}catch(_0x38191b){console[_0x27a5b3(0xce)](_0x3efa6c[_0x27a5b3(0x218)],_0x38191b);}try{const _0x562dfd=a12_0x275932[_0x27a5b3(0x2b5)]['map'](_0x5bc311=>{const _0x5883d3=_0x27a5b3,_0x31442d=_0xf4558f['ySXyQ'](_0x4d30bf,_0x5bc311),_0x17dfcf=_0x5bc311[_0x5883d3(0x315)]['reduce']((_0x1165bb,_0x1fcf6f)=>{const _0x2200c5=_0x5883d3,_0x903f76=_0xf4558f['ySXyQ'](_0x5ba85e,_0x1fcf6f)['rpn'];return _0xf4558f[_0x2200c5(0x140)](_0x903f76,_0x1165bb['rpn'])?{..._0x1fcf6f,'rpn':_0x903f76}:_0x1165bb;},{'rpn':0x0,'name':_0xf4558f[_0x5883d3(0x19a)]});return{'Product\x20Code':_0x5bc311[_0x5883d3(0x1a3)],'Product\x20Name':_0x5bc311[_0x5883d3(0x2e8)],'Product\x20Type':_0x5bc311['productType'],'Batch\x20Size\x20(kg)':_0x5bc311[_0x5883d3(0x13f)],'MDD\x20(mg)':_0x5bc311[_0x5883d3(0x290)],'Train':_0xf4558f['ejEBz'](_0xf4558f['kxMzQ'],_0x31442d)?'T'+_0x31442d:_0xf4558f[_0x5883d3(0x19a)],'Is\x20Critical':_0x5bc311[_0x5883d3(0x27a)]?_0xf4558f[_0x5883d3(0x16f)]:'No','Critical\x20Reason':_0x5bc311[_0x5883d3(0x13c)]||_0xf4558f['kxMzQ'],'Ingredients\x20Count':_0x5bc311['activeIngredients'][_0x5883d3(0x1fa)],'Highest\x20RPN\x20Ingredient':_0x17dfcf[_0x5883d3(0x2e8)],'Highest\x20RPN\x20Value':_0x17dfcf[_0x5883d3(0xd1)]||0x0};}),_0x10340a=XLSX['utils'][_0x27a5b3(0x2c9)](_0x562dfd);XLSX[_0x27a5b3(0x168)]['book_append_sheet'](_0x2fd1c6,_0x10340a,_0x3efa6c['dJOmB']);}catch(_0x56cf70){console['error'](_0x3efa6c[_0x27a5b3(0x241)],_0x56cf70);}try{const _0xf30253=[];a12_0x275932['products'][_0x27a5b3(0x291)](_0x43bfc6=>{const _0x1431a4=_0x27a5b3,_0x31696f=_0xf4558f[_0x1431a4(0x308)](_0x4d30bf,_0x43bfc6),_0x441480={'Product\x20Code':_0x43bfc6[_0x1431a4(0x1a3)],'Product\x20Name':_0x43bfc6['name'],'Product\x20Type':_0x43bfc6[_0x1431a4(0x20e)],'Batch\x20Size\x20(kg)':_0x43bfc6[_0x1431a4(0x13f)],'MDD\x20(mg)':_0x43bfc6['mddMg'],'Train':_0xf4558f[_0x1431a4(0x2ba)](_0xf4558f[_0x1431a4(0x19a)],_0x31696f)?'T'+_0x31696f:_0xf4558f['kxMzQ'],'Is\x20Critical':_0x43bfc6[_0x1431a4(0x27a)]?_0xf4558f[_0x1431a4(0x16f)]:'No','Critical\x20Reason':_0x43bfc6['criticalReason']||_0xf4558f[_0x1431a4(0x19a)],'Ingredient\x20Type':_0xf4558f['YxUnQ'],'Ingredient\x20Name':'','LTD\x20(mg)':'','PDE\x20(mg)':'','LD50\x20(mg/kg)':'','Severity':'','Occurrence':'','Detection':'','RPN':''};_0xf30253[_0x1431a4(0x2a0)](_0x441480),_0x43bfc6[_0x1431a4(0x315)][_0x1431a4(0x291)](_0x11076d=>{const _0x2c3132=_0x1431a4,_0x15fd5f=_0xf4558f[_0x2c3132(0x310)](_0x5ba85e,_0x11076d);_0xf30253[_0x2c3132(0x2a0)]({'Product\x20Code':'','Product\x20Name':'','Product\x20Type':'','Batch\x20Size\x20(kg)':'','MDD\x20(mg)':'','Train':'','Is\x20Critical':'','Critical\x20Reason':'','Ingredient\x20Type':_0x2c3132(0x265),'Ingredient\x20Name':_0x11076d[_0x2c3132(0x2e8)],'LTD\x20(mg)':_0x11076d['ltdMg']||_0xf4558f[_0x2c3132(0x19a)],'PDE\x20(mg)':_0x11076d[_0x2c3132(0x2de)]||_0x2c3132(0x1cc),'LD50\x20(mg/kg)':_0x11076d['ld50']||_0xf4558f[_0x2c3132(0x19a)],'Severity':_0x15fd5f[_0x2c3132(0x221)],'Occurrence':_0x15fd5f[_0x2c3132(0x127)],'Detection':_0x15fd5f[_0x2c3132(0x1bb)],'RPN':_0x15fd5f['rpn']});});});const _0x5f44fc=XLSX[_0x27a5b3(0x168)][_0x27a5b3(0x2c9)](_0xf30253);XLSX['utils'][_0x27a5b3(0x174)](_0x2fd1c6,_0x5f44fc,'Product\x20Register');}catch(_0x258b85){console[_0x27a5b3(0xce)](_0x3efa6c[_0x27a5b3(0x1f5)],_0x258b85);}const _0x10194d=new Date()['toISOString']()[_0x27a5b3(0x240)]('T')[0x0];XLSX[_0x27a5b3(0x2a6)](_0x2fd1c6,_0x27a5b3(0x276)+_0x10194d+_0x27a5b3(0xed)),_0x3efa6c[_0x27a5b3(0x166)](hideLoader),_0x3efa6c[_0x27a5b3(0xe0)](showCustomAlert,_0x27a5b3(0x232),'Complete\x20report\x20with\x20all\x20tabs\x20exported\x20to\x20Excel\x20successfully!');})['catch'](_0x41503f=>{const _0x496c43=_0xeb75fb;console['error'](_0x3efa6c[_0x496c43(0x1a1)],_0x41503f),_0x3efa6c['isMJa'](hideLoader),showCustomAlert(_0x3efa6c['nUlrN'],_0x496c43(0x2f8));});}export function toggleStageSection(_0x2df896){const _0x2d645e=a12_0x3bc3c7,_0x16b91a={'zocsq':'none','VYjfq':_0x2d645e(0x2b0),'fZxPx':_0x2d645e(0x2e1)},_0x4f98d5=document[_0x2d645e(0x2d7)](_0x2d645e(0xf0)+_0x2df896),_0x1c80c8=_0x16b91a[_0x2d645e(0xfb)]===_0x4f98d5['style'][_0x2d645e(0xde)];_0x4f98d5[_0x2d645e(0x136)][_0x2d645e(0xde)]=_0x1c80c8?'':_0x16b91a['zocsq'],localStorage[_0x2d645e(0x2e6)](_0x2d645e(0x306)+_0x2df896+'-hidden',!_0x1c80c8);const _0x225e4c=_0x4f98d5[_0x2d645e(0x270)][_0x2d645e(0x182)](_0x2d645e(0x124));_0x225e4c&&(_0x225e4c[_0x2d645e(0x18b)]=_0x1c80c8?_0x16b91a['VYjfq']:_0x16b91a['fZxPx']);}function a12_0x478f(){const _0x5b7d3b=['axEoC','NMxns','join','HKbCe','Error\x20creating\x20Product\x20Register\x20sheet:','juGqL','productName','historyIndex','parentElement','\x20.mainTable,\x20#','Error\x20loading\x20machine\x20stage\x20order','1033584kvzHiM','ifYsj','consolidateMachinesByGroup','Complete_MACO_Report_','FCWhd','macoScoringCriteria','Other','isCritical','No\x20reason\x20provided','fAJau','number','removeChild','tHGpO','pTduC','body','tHYqU','rkmjP','bUcpf','getItem','WSSMk','WViNb','syPUd','QVuLq','wzbVk','loader','Printing\x20view:','MACO\x20Report','TMsNW','JGkSI','mddMg','forEach','find','value','Hide\x20LD50','trainSummary','LYJzO','detergentIngredients','mJWRK','#detergentMaco\x20.train-content.collapsed','breakdown-toggle-btn-','log','Unknown\x20(ID:\x20','block','MlNaT','createElement','push','xWPnL','Qbdaz','sMZsj','button[onclick=\x22toggleColumnVisibilityDropdown()\x22]','readAsText','writeFile','RwOgf','Ntvpf','maco_data_export.json','#macoForTrains\x20.train-content.collapsed','toExponential','Could\x20not\x20save\x20data.\x20Storage\x20might\x20be\x20full.','./worstCaseView.js','HPtRc','rcbcB','Hide','setScoringCriteria','undo-btn','Vfqmv','RGwRZ','products','UvAtX','uAqAc','Train\x20Summary\x20Report','jNKfz','vruaQ','OaNHl','NiOne','hvYLD','map','OpNJD','lnuSt','productRegister','setScoringWasInEditModeForPrint','solubility','trim','Error','reMWG','Gvxpn','.toggle-pde','json_to_sheet','DAqKQ','solubilityScore','MzJKG','parse','Data\x20imported\x20successfully.','oVGhV','Error\x20loading\x20scoring\x20criteria','max','JjfcD','jhEwb','Wxgao','setHistory','none','getElementById','lgrLi','tsasy','Error\x20creating\x20All\x20Products\x20sheet:','RmZRx','jMbwP','khdpE','pdeMg','bxYld','Error\x20exporting\x20Detergent\x20MACO\x20to\x20Excel:','Show','hukyj','true','ZWkcY','UdOcY','setItem','then','name','jTqCL','OUAVV','sePYs','sf-input-train-','VhJSK','documentElement','renderDetergentMaco','hBucW','VWAMd','KdNSv','VEVUA','QKKLp','Worst\x20Case\x20Products','Error\x20loading\x20detergent\x20ingredients','printing-','Failed\x20to\x20export\x20complete\x20report\x20to\x20Excel.','tzDFn','PDPoM','ZBCvJ','TMuAK','toggle-pm-','toLocaleString','SfoBr','ZxEnl','RhWgx','Detergent\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','5483968qQWVdL','./macoProductView.js','GInmS','machineStage-','UJltt','ySXyQ','hide-ld50','LusIj','remove','ucRrF','Error\x20exporting\x20Train\x20Summary\x20to\x20Excel:','.toggle-ld50','rpnRatingText','tWVnj','SdqBW','There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','hide-pde','Critical\x20Products','activeIngredients','essa','pdeScore','538728NiXVpx','vnKyN','classList','Train\x20','stage','OWqNQ','target','gWdpD','error','history','Error\x20creating\x20Train\x20Summary\x20sheet:','rpn','zmwqt','BxhXe','slice','machineCount','bBOdp','dhBQq','toggle-','URlIQ','Product_MACO_Report','revokeObjectURL','kaljH','nAprh','display','includes','NnqtJ','2043864VNGSII','TIgSR','Save\x20Error','scoringCriteria','TVoBY','gNHmW','MACO_Summary_Report_','cUjmx','safetyFactorConfig','There\x20are\x20no\x20products\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','fGbnV','stringify','.xlsx','trainId','Hidden','stage-','Failed\x20to\x20save\x20data\x20to\x20localStorage','WfYDc','therapeuticDose','href','No\x20trains\x20match\x20the\x20selected\x20criteria.','Error\x20loading\x20detergent\x20view\x20for\x20print:','Product\x20MACO','No\x20train\x20data\x20to\x20print.\x20Please\x20ensure\x20you\x20have\x20created\x20trains\x20first.','ZlbfX','TIsNg','zocsq','group','PLDdL','_Train_','IFqlE','Hvbpj','VFVvB','tjlzs','minMbsKg','kjVQc','YQGDa','Machines','qnDcK','Visual\x20Clean\x20Limit','toISOString','sortValue','\x20.train-content-inner','nsoTo','cAfak','pNclY','zUxoE','setDetergentIngredients','warn','LGEmX','xHJEj','JXuiJ','AdMBZ','MiFEA','doiiL','KXCum','\x20.ingredients-sub-table','ZDJhS','rpnChartInstance','required','JaCXl','voEYG','MACO_Worst_Case_Products','ggZMz','GwiFU','UAJPF','result','button','RAnel','10\x20ppm\x20Criterion','occurrence','noTrainSummaryMessage','isGroup','Error\x20creating\x20Detergent\x20MACO\x20sheet:','scoringInEditMode','LnMUm','ioaVL','Train\x20Summary\x20data\x20exported\x20to\x20Excel\x20successfully!','anKmF','gAVJD','sqGHY','pnenA','finally','ENVKj','ggSsP','style','MFZfC','machineNumber','Show\x20PDE','viewProducts','RsrvT','criticalReason','dicfD','dvBZI','batchSizeKg','nmeCV','ggSZM','macoChartInstance','FXVJP','Error\x20creating\x20Critical\x20Products\x20sheet:','Product\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','Machines\x20data\x20exported\x20to\x20Excel\x20successfully!','mMYOU','Container\x20has\x20content:','createObjectURL','RrCoD','Error\x20exporting\x20to\x20Excel:','ld50','min','ZWZuU','xMvmy','RuJBt','mNgTU','keys','wnWrR','JKwTb','book_new','#columnVisibilityDropdown','255080DAvNzw','lowestLtd','DXaSk','tlSvz','Nkxjb','catch','YlfNp','renderTrainSummary','wHMQI','aUjdT','ZIcaC','qGqtp','Failed\x20to\x20export\x20data\x20to\x20Excel.','DFOVH','sort','isMJa','setMachines','utils','uMWiW','QNKbn','sDobr','setProducts','muwAE','trainSummaryContainer','XuHGQ','QLQtS','GLHNz','UqchU','oGRnn','book_append_sheet','PRODUCT','DxeRj','rJyFk','RNFJz','GAIPS','rQWgh','kaDQr','Hide\x20MACO\x20Calculation\x20Breakdown','addEventListener','application/json','flex','YbcsZ','TUcJd','querySelector','pde','There\x20are\x20no\x20detergent\x20ingredients\x20configured.\x20Add\x20detergent\x20ingredients\x20first.','Eqfeh','pfsvy','JNkbP','hidden','startsWith','assumedSsa','textContent','JZmkV','NxDQK','zshPz','jHAgN','Train_Summary_Report','BbPeo','cJcaH','No\x20trains\x20message\x20display:','renderRpnChart','contains','No\x20Data','mGfUZ','hide-','sHlLr','kxMzQ','disabled','setMachineStageDisplayOrder','lowestPde','pMoIn','-ld50Hidden','reduce','EtJsM','Train:','productCode','DWuWr','Train\x20summary\x20container\x20is\x20hidden\x20or\x20missing','WQQAi','worstProductRpn','\x20\x20└─\x20','pwDTt','machines','Yes','isArray','!cols','./utils.js','qsrOI','ofwSM','0.1%\x20Therapeutic\x20Dose','filter','15VqlwcG','add','EzUNP','cdlWd','Show\x20MACO\x20Calculation\x20Breakdown','toggle-dm-','customAlertModal','FKyUc','detection','CzwcC','collapsed','IEmcZ','NpRDK','LGjUR','Failed\x20to\x20parse\x20JSON\x20file.','content-','CHijX','redo-btn','_Trains_','fxVwX','HtytV','message','SckWn','HRQBa','jBolE','N/A','\x20→\x20','machineIds','Product\x20MACO\x20Report','-pdeHidden','productRegister-pdeHidden','PCWha','RQwuz','qyycn','ld50Score','content-dm-','MvQUP','\x20-\x20','zrMsC','jUWaO','omuHo','ASYyE','XcyBn','Error\x20exporting\x20worst\x20case\x20to\x20Excel:','Failed\x20to\x20export\x20data\x20to\x20JSON.','all','There\x20is\x20no\x20data\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','Ndtjx','FxgNy','cleanabilityScore','rOWtE','\x20not\x20found\x20or\x20has\x20no\x20products.','date','tybSU','AhuNI','yJSjA','macoMachines','customAlertMessage','GRGDi','There\x20are\x20no\x20machines\x20to\x20export.','print','querySelectorAll','rctFU','AHsMd','Detergent\x20MACO\x20Report','WSuNP','nYvIU','pWVCO','Hide\x20PDE','closest','LLSRU','length','product-sf-input','KwnMR','TEgkf','5326310VFjwKw','minBsMddRatio','renderWorstCaseByTrain','Invalid\x20JSON\x20file\x20structure.','pyFmv','appendChild','MHWCI','Show\x20LD50','files','ingredientName','wHyxB','Setting\x20printSelectedTrain\x20to:','msgbp',')\x20-\x20RPN:\x20','input','QBNaI','productType','zxDPm','wlWfE','ELFOd','LiHCl','fsggo','MACO_All_Products_Report.xlsx','dark','Container\x20display:','TjalA','BwRWJ','Error\x20loading\x20train\x20summary:\x20','bodyWeight','content-pm-','theme-toggle-dark-icon','rxpma','toggle','cqniC','nSuJW','severity','macoProducts','ypuCt','vzOKb','hOkUZ','pwJux','Failed\x20to\x20export\x20worst\x20case\x20data\x20to\x20Excel.','XsIEc','cPMTE','flatMap','GgAMa','\x20-\x20Worst\x20Case\x20Analysis','ieQVd','pZcro','rOVoM','QrSRQ','All\x20Products','Success','NYaap',',\x20#','machineStageDisplayOrder','Detergent\x20MACO','VsDxu','tXkAe','toFixed','tXdVJ','click','IUQHM','gpaGI','Error\x20loading\x20machines','fKTrE','split','SvLyG','BeJbw','NjQiG','ueGnd','rmpdz','Health-Based\x20Limit\x20(ADE)','fUlfN','pTvyS','nIlOt','uznNT','WGeMk','\x20.mainTable.hide-','Failed\x20to\x20export\x20Train\x20Summary\x20data\x20to\x20Excel.','#macoForTrains\x20[id^=\x22maco-breakdown-details-\x22].hidden','HFTRk','pnYrm','fETVo','There\x20is\x20no\x20data\x20in\x20the\x20current\x20view\x20to\x20export.','uKOLS','download','innerHTML','Error\x20loading\x20train\x20summary\x20view:','DooTR','rtCiR','WmMHl','therapeuticDoseScore','nBjKt','Top\x2010\x20RPN','nLUcu','1533154maXqji','worstCaseProducts','toLocaleDateString','printSelectedTrain','EnZWC','onload','OQpVW','INGREDIENT','shoyH','maco-breakdown-details-'];a12_0x478f=function(){return _0x5b7d3b;};return a12_0x478f();}