const a13_0x407115=a13_0x2b75;(function(_0xf0997b,_0x24b18a){const _0x301212=a13_0x2b75,_0x3b0f19=_0xf0997b();while(!![]){try{const _0x1365a1=parseInt(_0x301212(0x1b4))/0x1+parseInt(_0x301212(0x333))/0x2+-parseInt(_0x301212(0x1e1))/0x3+parseInt(_0x301212(0x18f))/0x4+-parseInt(_0x301212(0x264))/0x5+parseInt(_0x301212(0x1af))/0x6*(-parseInt(_0x301212(0xf4))/0x7)+-parseInt(_0x301212(0x26c))/0x8*(-parseInt(_0x301212(0x205))/0x9);if(_0x1365a1===_0x24b18a)break;else _0x3b0f19['push'](_0x3b0f19['shift']());}catch(_0x422a49){_0x3b0f19['push'](_0x3b0f19['shift']());}}}(a13_0x286d,0x5f8aa));import*as a13_0x4d29b2 from'./state.js';import{fullAppRender as a13_0x461adb}from'./app.js';import{generateTrainMap as a13_0x42d3ef}from'./utils.js';import{toggleScoringEditMode as a13_0x29cd97}from'./scoringView.js';import{renderRpnChart as a13_0x423af4}from'./worstCaseView.js';import{renderMacoChart as a13_0x4c1c10}from'./dashboardView.js';function a13_0x286d(){const _0x5f22f3=['tLrXl','isGroup','mcGoO','eRDnn','CMjHP','qjpBE','Failed\x20to\x20export\x20machines\x20data\x20to\x20Excel.','#detergentMaco\x20.train-content.collapsed','hnvpy','trainSummaryContainer','Train\x20','criticalReason','length','Complete_MACO_Report_','Visual\x20Clean\x20Limit','files','suTMo','.toggle-ld50','xyVtb','.toggle-pde','cvWdJ','fJTkh','Product_MACO_Report','Error\x20creating\x20All\x20Products\x20sheet:','uayan','getElementById','createObjectURL','\x20.ingredients-sub-table','group','.xlsx','zymZs','style','customAlertMessage','QLbhl','10\x20ppm\x20Criterion','JYsDB','idEDZ','KQjgS','./macoProductView.js','KGqiw','Error\x20creating\x20Product\x20MACO\x20sheet:','activeIngredients','WqUnZ','Summary\x20report\x20data\x20exported\x20to\x20Excel\x20successfully!','fUupX','error','Machines\x20data\x20exported\x20to\x20Excel\x20successfully!','OcHcB','batchSizeKg','Product\x20MACO','addEventListener','Error\x20creating\x20Detergent\x20MACO\x20sheet:','HvVpv','gPSMk','map','rRlIR','aDQRL','LmUEu','ZWxzm','XvcVR','filter','hiVZY','TYNnF','RDToc','Error\x20loading\x20train\x20summary:\x20','krkVC','OfZHa','EbbHC','getItem','BkZCS','VQCcx','MNJse','detection','ccNbV','reduce','scoring-system','QXJll','iJTct','ufsUq','gAsJR','DJqkm','macoForTrains','dcXlc','qVNMa','WSnZI','BBQoq','SGSBQ','SsKyf','Error\x20creating\x20Top\x2010\x20RPN\x20sheet:','ZrNCn','push','CJjyJ','YdhXt','vJlBW','detergentMaco','trainId','uAqox','Error\x20loading\x20products','scoringInEditMode','bsyWO','BYKOA','There\x20are\x20no\x20products\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','undo-btn','XBlSM','trainSummary','fPxkr','safetyFactorConfig','YPkpY','QDvBv','history','CDjFl','setDetergentIngredients','collapsed','toggle-dm-','renderWorstCaseByTrain','PMtmQ','#macoForTrains\x20[id^=\x22maco-breakdown-details-\x22].hidden','rgxAs','LejKG','TAhyt','Printing\x20view:','lowestPde','mOBDW','MACO_All_Products_Report.xlsx','setMachineStageDisplayOrder','setProducts','cfeeX','taOZZ','wZMOe','DDFXl','join','Hidden','AtpZt','KURuA','dVSuJ','Hide\x20PDE','Invalid\x20JSON\x20file\x20structure.','readAsText','CzNqE','./utils.js','Ugfah','Czcya','Unknown\x20(ID:\x20','PvETr','display','\x20.train-content-inner','Failed\x20to\x20export\x20data\x20to\x20Excel.','NVDHR','PigeR','GwBkt','epYHy','1194932FCFqSD','Top\x2010\x20RPN','-hidden','RwDCq','KvDqS','toggle-pm-','vvziT','lRboV','IZgMr','ingredientName','startsWith','Error\x20exporting\x20to\x20Excel:','columnVisibilityDropdown','lLzTT','Failed\x20to\x20parse\x20JSON\x20file.','mvlqP','macoScoringCriteria','value','EilRb','productRegister','true','closest','setMachines','lgkwO','machineCount','Bcwkj','name','dQUeJ','DhaqR','Error\x20creating\x20Product\x20Register\x20sheet:','toLocaleString','uuwWN','macoDetergentIngredients','ZKPNd','woVci','PNaiz','print','mddMg','nBmqG','trim','Hide\x20MACO\x20Calculation\x20Breakdown','MNtfX','dKWwI','1273867MUnqDy','content-dm-','Critical\x20Products','querySelector','stage','gRHyi','consolidateMachinesByGroup','cnwYa','detergentIngredients','N/A','machineIds','RChuN','Failed\x20to\x20export\x20Summary\x20report\x20data\x20to\x20Excel.','IfARG','EAqNa','productType','ltdMg',')\x20-\x20RPN:\x20','./macoDetergentView.js','YnpUZ','BKXUt','OwQCD','NQEfD','theme-toggle-dark-icon','PRODUCT','VmQbI','forEach','AvoIH','oojag','JVzQz','worstProductRpn','application/json','tMokh','\x20.mainTable.hide-','QHShl','pYrEh','EeinO','toISOString','CjWZQ','GWlPJ','target','Error\x20exporting\x20all\x20tabs\x20to\x20Excel:','Ivyah','disabled','HXses','monRn','Error\x20loading\x20machines','OYLWC','_Trains_','Zppxl','There\x20are\x20no\x20machines\x20to\x20export.','MACO_Machines_','pde','Show\x20MACO\x20Calculation\x20Breakdown','MBQyN','Data\x20imported\x20successfully.','fSNwg','not\x20found','Product\x20Register','aPVPN','CUBoH','setItem','cvoOo','wrocW','appendChild','redo-btn','includes','finally','renderMacoForTrains','No\x20Data','log','machineStageDisplayOrder','AigiX','TfJJE','LNTqM','hide-','Error\x20creating\x20Train\x20Summary\x20sheet:','lXegY','ShdYW','ndKuO','yqxoE','ePLNl','Health-Based\x20Limit\x20(ADE)','vILrR','Container\x20display:','fNwgK','#productRegister\x20.mainTable.hide-','XJxFk','\x20\x20└─\x20','printSelectedTrain','rdVuM','theme-toggle-light-icon','yDhhS','pdeScore','No\x20train\x20data\x20to\x20print.\x20Please\x20ensure\x20you\x20have\x20created\x20trains\x20first.','pVlGC','All\x20Products','qIUsx','Failed\x20to\x20export\x20Detergent\x20MACO\x20data\x20to\x20Excel.','onload','parse','hQhJr','HQukQ','severity','QiiQN','breakdown-toggle-btn-','RoMpv','XkuIy','YNRUR','add','flatMap','bxaxT','Train\x20Summary','HTeKX','sf-input-train','WUApk','BpaAh','assumedSsa','download','nEKTZ','wvIQX','Error\x20loading\x20detergent\x20view\x20for\x20print:','machines','aITlW','oDwEr','productName','GHiHW','TcgKH','YqnHX','split','Hide','plXFK','uyffc','sNLTB','renderRpnChart','MBunq','yprbL','Error\x20loading\x20machine\x20stage\x20order','hSaVB','loader','!cols','There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','nHjwL','sortValue','HzzmG','ORTEG','json_to_sheet','uxOSo','INGREDIENT','There\x20are\x20no\x20summary\x20data\x20to\x20export.\x20Add\x20products\x20and\x20ingredients\x20first.','qNZQl','XPcLn','MACO_Worst_Case_Products','woHOR','HwXNg','1193492mzgvnK','tJvRi','tYimx','SmlOX','kcbyR','AWJmA','EcCqm','KtoAw','ZSHTd','productRegister-ld50Hidden','fYRnm','Success','Train:','slice',',\x20#','viewProducts','DVgVd','bgpgt','body','GRoca','#columnVisibilityDropdown','catch','RQlLx','ZyIpl','Train\x20summary\x20container\x20is\x20hidden\x20or\x20missing','find','bXQAh','okXZr','0.1%\x20Therapeutic\x20Dose','KfGRA','toggle','bbYzS','12nfMxAv','setHistory','rXHfd','QFelO','Error\x20loading\x20detergent\x20ingredients','164488miexrt','keys','yOIMm','Show\x20LD50','rpn','remove','_Train_','waLLa','rDCSg','ftJgl','setScoringCriteria','LOwdQ','./worstCaseView.js','click','content-pm-','ZNDyD','hxMBl','No\x20trains\x20match\x20the\x20selected\x20criteria.','labcf','writeFile','bodyWeight','uTJGE','URSKo','hzqiU','Trains\x20','-pdeHidden','Qbkgx','lowestLtd','\x20.mainTable,\x20#','Error\x20exporting\x20Train\x20Summary\x20to\x20Excel:','BPCvN','SFZmS','classList','Failed\x20to\x20export\x20worst\x20case\x20data\x20to\x20Excel.','toFixed','LxqHF','YVFuN','kwOFx','MdfuH','yYxTM','rxKLA','toggle-','stringify','min','macoProducts','1809744Wlaaee','Detergent\x20MACO\x20Report','minBsMddRatio','tWTFP','maco-breakdown-details-','eryGJ','minMbsKg','ZRgcN','result','srogx','pYdJQ','bIbpb','renderDetergentMaco','aRnUa','Failed\x20to\x20export\x20Train\x20Summary\x20data\x20to\x20Excel.','textContent','#macoForTrains\x20.train-content.collapsed','occurrence','required','removeEventListener','Failed\x20to\x20export\x20data\x20to\x20JSON.','Train\x20Summary\x20Report','WDUsE','mHmxt','fpdRV','PmyXL','rwMjg','match','nUIjj','DoUyW','CAjoe','Error\x20exporting\x20Product\x20MACO\x20to\x20Excel:','worstCaseProducts','yqKTm','PDlNM','dark','4862799XMTokR','hidden','toExponential','suzXm','dslku','XyIae','DqHyN','Error','AYbus','nDylI','Detergent\x20MACO','SyODy','HOnZQ','solubilityScore','Save\x20Error','BxDDY','GpYBQ','Error\x20exporting\x20machines\x20to\x20Excel:','utils','Error\x20exporting\x20worst\x20case\x20to\x20Excel:','macoMachines','sGIaN','InrUg','hide-ld50','vzxbO','GbJeB','cleanabilityScore','puQJT','EYwDQ','vVdzk','Yes','agpYT','rpnChartInstance','WfGSo','Other','puOtK','IIBMT','max','number','iTsrZ','sf-input-train-','QqcCb','kWyKW','MyXWz','wEwCR','aBvPu','HOMFy','cphVC','yxQfJ','Show\x20PDE','Detergent\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','none','sYQez','sYPEc','Could\x20not\x20save\x20data.\x20Storage\x20might\x20be\x20full.','removeChild','JjUkj','book_append_sheet','EZHEc','ywkQV','zyAOn','jifWo','input','Failed\x20to\x20export\x20Product\x20MACO\x20data\x20to\x20Excel.','eHVHM','cphWn','jcGir','sort','scoringCriteria','products','FoGSF','Fcnrh','FtkQB','wipMy','\x20-\x20','gozPu','printing-','owVcy','NfVBU','renderTrainSummary','all','IJXtW','GMLCV','flex','button[onclick=\x22toggleColumnVisibilityDropdown()\x22]','querySelectorAll','rpnRatingText','oRVZM','Error\x20creating\x20Critical\x20Products\x20sheet:','maco_data_export.json','VsAvO','LquqI','LfKjJ','REsnM','JwbVy','1210450vNcoOw','hNZji','then','Setting\x20printSelectedTrain\x20to:','iNpkp','uULEq','cleanability','stage-','8mRpOnz','book_new','essa','aZHzH','block','Error\x20exporting\x20Summary\x20to\x20Excel:','MXyCw','IazvK','message','VwJqT','fmrUl','zdclD','macoChartInstance','Failed\x20to\x20export\x20complete\x20report\x20to\x20Excel.','hide-pde','ld50','MfzyT','hTHzK','iZKYM','bPKhr','jOaqv','gQYIi','innerHTML','pdeMg','productRegister-','mCuqC','-ld50Hidden','documentElement','znfAR','isCritical','erGJB','XfylU','isArray','GQwac','date','href','productCode','Detergent_MACO_Report_','lFrKP','\x20→\x20','historyIndex','JJZxl','anlCI','GFAqo','sKxSL','qofyO','JrIaK','BfSew'];a13_0x286d=function(){return _0x5f22f3;};return a13_0x286d();}const s=document['getElementById'](a13_0x407115(0x17f));export const showLoader=()=>s['style'][a13_0x407115(0x32c)]='flex';export const hideLoader=()=>s[a13_0x407115(0x2bb)]['display']='none';export function showCustomAlert(_0x1c0c58,_0x1f63a6){const _0x19cfa5=a13_0x407115,_0x34c412={'MBunq':'customAlertTitle','nHLzQ':_0x19cfa5(0x2bc),'PmyXL':'customAlertModal','CznJU':_0x19cfa5(0x258)};document['getElementById'](_0x34c412[_0x19cfa5(0x17b)])[_0x19cfa5(0x1f0)]=_0x1c0c58,document[_0x19cfa5(0x2b5)](_0x34c412['nHLzQ'])[_0x19cfa5(0x1f0)]=_0x1f63a6,document[_0x19cfa5(0x2b5)](_0x34c412[_0x19cfa5(0x1fa)])[_0x19cfa5(0x2bb)][_0x19cfa5(0x32c)]=_0x34c412['CznJU'];}export const hideModal=_0x205653=>document[a13_0x407115(0x2b5)](_0x205653)[a13_0x407115(0x2bb)][a13_0x407115(0x32c)]=a13_0x407115(0x238);export function saveAllDataToLocalStorage(){const _0xb2c34a=a13_0x407115,_0x34303f={'VTozC':_0xb2c34a(0x1e0),'KQsLj':_0xb2c34a(0x219),'cphWn':'macoScoringCriteria','cZToU':_0xb2c34a(0x13b),'SsKyf':function(_0x1a9c17,_0xe79dbb,_0x3e4d0e){return _0x1a9c17(_0xe79dbb,_0x3e4d0e);},'bgpgt':_0xb2c34a(0x23b)};try{localStorage[_0xb2c34a(0x131)](_0x34303f['VTozC'],JSON[_0xb2c34a(0x1de)](a13_0x4d29b2[_0xb2c34a(0x24a)])),localStorage[_0xb2c34a(0x131)](_0x34303f['KQsLj'],JSON['stringify'](a13_0x4d29b2[_0xb2c34a(0x16e)])),localStorage[_0xb2c34a(0x131)](_0x34303f[_0xb2c34a(0x246)],JSON[_0xb2c34a(0x1de)](a13_0x4d29b2[_0xb2c34a(0x249)])),localStorage[_0xb2c34a(0x131)]('macoDetergentIngredients',JSON[_0xb2c34a(0x1de)](a13_0x4d29b2[_0xb2c34a(0xfc)])),localStorage[_0xb2c34a(0x131)](_0x34303f['cZToU'],JSON[_0xb2c34a(0x1de)](a13_0x4d29b2['machineStageDisplayOrder']));}catch(_0x4df6f3){console[_0xb2c34a(0x2c9)]('Failed\x20to\x20save\x20data\x20to\x20localStorage',_0x4df6f3),_0x34303f[_0xb2c34a(0x2f3)](showCustomAlert,_0xb2c34a(0x213),_0x34303f[_0xb2c34a(0x1a0)]);}}export function loadAllDataFromLocalStorage(){const _0x48118d=a13_0x407115,_0x1ac908={'XfylU':'macoProducts','PhKJd':_0x48118d(0x219),'FRIBX':_0x48118d(0x343),'ccNbV':_0x48118d(0xe9),'VmQbI':'machineStageDisplayOrder','fNwgK':_0x48118d(0x2fd)},_0x214d7a=localStorage[_0x48118d(0x2e0)](_0x1ac908[_0x48118d(0x28b)]),_0x2f6ba2=localStorage[_0x48118d(0x2e0)](_0x1ac908['PhKJd']),_0x12d214=localStorage['getItem'](_0x1ac908['FRIBX']),_0x55232e=localStorage[_0x48118d(0x2e0)](_0x1ac908[_0x48118d(0x2e5)]),_0x359c41=localStorage[_0x48118d(0x2e0)](_0x1ac908[_0x48118d(0x10d)]);if(_0x214d7a)try{a13_0x4d29b2[_0x48118d(0x319)](JSON[_0x48118d(0x158)](_0x214d7a));}catch(_0x5e8764){console[_0x48118d(0x2c9)](_0x1ac908[_0x48118d(0x149)],_0x5e8764);}if(_0x2f6ba2)try{a13_0x4d29b2[_0x48118d(0xdf)](JSON[_0x48118d(0x158)](_0x2f6ba2));}catch(_0x441abb){console[_0x48118d(0x2c9)](_0x48118d(0x122),_0x441abb);}if(_0x12d214)try{a13_0x4d29b2[_0x48118d(0x1be)](JSON[_0x48118d(0x158)](_0x12d214));}catch(_0xd3c73){console[_0x48118d(0x2c9)]('Error\x20loading\x20scoring\x20criteria',_0xd3c73);}if(_0x55232e)try{a13_0x4d29b2[_0x48118d(0x30b)](JSON[_0x48118d(0x158)](_0x55232e));}catch(_0x4a4fcc){console['error'](_0x48118d(0x1b3),_0x4a4fcc);}if(_0x359c41)try{a13_0x4d29b2[_0x48118d(0x318)](JSON[_0x48118d(0x158)](_0x359c41));}catch(_0x5526a0){console[_0x48118d(0x2c9)](_0x48118d(0x17d),_0x5526a0);}}export function saveStateForUndo(){const _0x11c45d=a13_0x407115,_0x3f3059={'fPxkr':function(_0x2bd956){return _0x2bd956();},'QXJll':function(_0x48b9d5){return _0x48b9d5();}};_0x3f3059['fPxkr'](a13_0x42d3ef);const _0x275c1c=a13_0x4d29b2['history']['slice'](0x0,a13_0x4d29b2[_0x11c45d(0x294)]+0x1),_0x1b7df6={'products':JSON[_0x11c45d(0x158)](JSON[_0x11c45d(0x1de)](a13_0x4d29b2[_0x11c45d(0x24a)])),'machines':JSON[_0x11c45d(0x158)](JSON[_0x11c45d(0x1de)](a13_0x4d29b2[_0x11c45d(0x16e)])),'scoringCriteria':JSON['parse'](JSON[_0x11c45d(0x1de)](a13_0x4d29b2[_0x11c45d(0x249)])),'detergentIngredients':JSON[_0x11c45d(0x158)](JSON[_0x11c45d(0x1de)](a13_0x4d29b2[_0x11c45d(0xfc)]))};_0x275c1c[_0x11c45d(0x2f6)](_0x1b7df6),a13_0x4d29b2[_0x11c45d(0x1b0)](_0x275c1c,_0x275c1c[_0x11c45d(0x2a8)]-0x1),_0x3f3059[_0x11c45d(0x305)](updateUndoRedoButtons),_0x3f3059[_0x11c45d(0x2e8)](saveAllDataToLocalStorage);}export function updateUndoRedoButtons(){const _0x1100e7=a13_0x407115,_0x1ce8a0={'cvoOo':_0x1100e7(0x302),'UYeRp':function(_0x49e2e6,_0x251985){return _0x49e2e6<=_0x251985;},'nDylI':function(_0x520147,_0x3d6aaf){return _0x520147>=_0x3d6aaf;}},_0x18a1c6=document[_0x1100e7(0x2b5)](_0x1ce8a0[_0x1100e7(0x132)]),_0xe3943d=document['getElementById'](_0x1100e7(0x135));_0x18a1c6&&(_0x18a1c6[_0x1100e7(0x11f)]=_0x1ce8a0['UYeRp'](a13_0x4d29b2['historyIndex'],0x0)),_0xe3943d&&(_0xe3943d['disabled']=_0x1ce8a0[_0x1100e7(0x20e)](a13_0x4d29b2[_0x1100e7(0x294)],a13_0x4d29b2[_0x1100e7(0x309)][_0x1100e7(0x2a8)]-0x1));}export function undoChange(){const _0x19c951=a13_0x407115,_0x324599={'GWlPJ':function(_0x13cc3d,_0x25bc87){return _0x13cc3d>_0x25bc87;},'jUMgl':function(_0x4b34d5,_0x57e3e3){return _0x4b34d5-_0x57e3e3;},'CMjHP':function(_0x1a9978,_0x24298f){return _0x1a9978(_0x24298f);},'GpYBQ':function(_0x4a2698){return _0x4a2698();},'ZiGWY':function(_0x124248){return _0x124248();},'kwOFx':function(_0x32c34b){return _0x32c34b();}};if(_0x324599[_0x19c951(0x11b)](a13_0x4d29b2[_0x19c951(0x294)],0x0)){const _0x3483c1=_0x324599['jUMgl'](a13_0x4d29b2[_0x19c951(0x294)],0x1),_0x2d4c61=a13_0x4d29b2[_0x19c951(0x309)][_0x3483c1];a13_0x4d29b2[_0x19c951(0x319)](JSON[_0x19c951(0x158)](JSON[_0x19c951(0x1de)](_0x2d4c61[_0x19c951(0x24a)]))),a13_0x4d29b2[_0x19c951(0xdf)](JSON[_0x19c951(0x158)](JSON[_0x19c951(0x1de)](_0x2d4c61[_0x19c951(0x16e)]))),a13_0x4d29b2[_0x19c951(0x1be)](JSON['parse'](JSON[_0x19c951(0x1de)](_0x2d4c61[_0x19c951(0x249)]))),a13_0x4d29b2[_0x19c951(0x30b)](JSON[_0x19c951(0x158)](JSON['stringify'](_0x2d4c61['detergentIngredients']))),a13_0x4d29b2[_0x19c951(0x1b0)](a13_0x4d29b2[_0x19c951(0x309)],_0x3483c1),a13_0x4d29b2[_0x19c951(0x2fe)]&&_0x324599[_0x19c951(0x2a0)](a13_0x29cd97,!0x1),_0x324599[_0x19c951(0x215)](a13_0x461adb),_0x324599['ZiGWY'](updateUndoRedoButtons),_0x324599[_0x19c951(0x1d9)](saveAllDataToLocalStorage);}}export function redoChange(){const _0x52be26=a13_0x407115,_0x291712={'UHHcE':function(_0xeb142e,_0x3ef323){return _0xeb142e<_0x3ef323;},'sYQez':function(_0x37d91b,_0x2a441d){return _0x37d91b-_0x2a441d;},'WUApk':function(_0x53f5ee,_0x4eaa3d){return _0x53f5ee+_0x4eaa3d;},'DoUyW':function(_0x4d13b1){return _0x4d13b1();},'OzeWD':function(_0x4f3810){return _0x4f3810();}};if(_0x291712['UHHcE'](a13_0x4d29b2['historyIndex'],_0x291712[_0x52be26(0x239)](a13_0x4d29b2['history']['length'],0x1))){const _0x917ec6=_0x291712[_0x52be26(0x167)](a13_0x4d29b2[_0x52be26(0x294)],0x1),_0x221c27=a13_0x4d29b2[_0x52be26(0x309)][_0x917ec6];a13_0x4d29b2[_0x52be26(0x319)](JSON[_0x52be26(0x158)](JSON[_0x52be26(0x1de)](_0x221c27[_0x52be26(0x24a)]))),a13_0x4d29b2['setMachines'](JSON[_0x52be26(0x158)](JSON[_0x52be26(0x1de)](_0x221c27[_0x52be26(0x16e)]))),a13_0x4d29b2[_0x52be26(0x1be)](JSON[_0x52be26(0x158)](JSON['stringify'](_0x221c27[_0x52be26(0x249)]))),a13_0x4d29b2[_0x52be26(0x30b)](JSON['parse'](JSON[_0x52be26(0x1de)](_0x221c27[_0x52be26(0xfc)]))),a13_0x4d29b2[_0x52be26(0x1b0)](a13_0x4d29b2[_0x52be26(0x309)],_0x917ec6),a13_0x4d29b2['scoringInEditMode']&&a13_0x29cd97(!0x1),a13_0x461adb(),_0x291712[_0x52be26(0x1fe)](updateUndoRedoButtons),_0x291712['OzeWD'](saveAllDataToLocalStorage);}}export function toggleDarkMode(_0x2edd45){const _0x3a52f4=a13_0x407115,_0xc7a9cf={'kcbyR':_0x3a52f4(0x14f),'InrUg':_0x3a52f4(0x10b),'uAqox':_0x3a52f4(0x206),'UfCRM':_0x3a52f4(0x204),'cfeeX':function(_0xa173dc){return _0xa173dc();}},_0x131dc0=document['getElementById'](_0xc7a9cf[_0x3a52f4(0x193)]),_0x1aa238=document[_0x3a52f4(0x2b5)](_0xc7a9cf[_0x3a52f4(0x21b)]);_0x2edd45?(document[_0x3a52f4(0x287)][_0x3a52f4(0x1d4)][_0x3a52f4(0x161)](_0x3a52f4(0x204)),_0x131dc0&&_0x131dc0['classList'][_0x3a52f4(0x161)](_0xc7a9cf[_0x3a52f4(0x2fc)]),_0x1aa238&&_0x1aa238[_0x3a52f4(0x1d4)][_0x3a52f4(0x1b9)](_0xc7a9cf[_0x3a52f4(0x2fc)])):(document[_0x3a52f4(0x287)][_0x3a52f4(0x1d4)]['remove'](_0xc7a9cf['UfCRM']),_0x131dc0&&_0x131dc0[_0x3a52f4(0x1d4)][_0x3a52f4(0x1b9)](_0x3a52f4(0x206)),_0x1aa238&&_0x1aa238['classList'][_0x3a52f4(0x161)](_0x3a52f4(0x206))),a13_0x4d29b2[_0x3a52f4(0x225)]&&_0xc7a9cf[_0x3a52f4(0x31a)](a13_0x423af4),a13_0x4d29b2[_0x3a52f4(0x278)]&&_0xc7a9cf[_0x3a52f4(0x31a)](a13_0x4c1c10);}export function printCurrentView(_0x10869d,_0x594e73=a13_0x407115(0x255)){const _0x51c19e=a13_0x407115,_0x2d4dba={'uTJGE':function(_0x541004,_0x148924,_0x2831a1){return _0x541004(_0x148924,_0x2831a1);},'eRDnn':_0x51c19e(0x206),'TfJJE':_0x51c19e(0xf1),'MNtfX':_0x51c19e(0x129),'MNJse':_0x51c19e(0x310),'wrocW':_0x51c19e(0x2a3),'bPKhr':function(_0xc7ffaf,_0x2e5706,_0x35f649){return _0xc7ffaf(_0x2e5706,_0x35f649);},'AWJmA':_0x51c19e(0x16d),'iNpkp':_0x51c19e(0x106),'puQJT':function(_0x496616,_0x1ca826,_0x60d4d1){return _0x496616(_0x1ca826,_0x60d4d1);},'sYPEc':'noTrainSummaryMessage','mcGoO':_0x51c19e(0x148),'CzNqE':'Container\x20has\x20content:','EYwDQ':function(_0x182498,_0x369513){return _0x182498===_0x369513;},'uyffc':_0x51c19e(0x1a7),'MlHoR':function(_0x1623c7,_0x8d2312){return _0x1623c7(_0x8d2312);},'WfGSo':_0x51c19e(0x152),'gQYIi':function(_0x40303e,_0x5eb9ef,_0x4eaa25){return _0x40303e(_0x5eb9ef,_0x4eaa25);},'XBlSM':'Error\x20loading\x20train\x20summary\x20view:','JwbVy':function(_0x1403cd,_0x257cc7){return _0x1403cd(_0x257cc7);},'oojag':function(_0x4bac74,_0x82a272){return _0x4bac74+_0x82a272;},'vVdzk':_0x51c19e(0x2dc),'bsyWO':_0x51c19e(0x2e7),'labcf':_0x51c19e(0x314),'CJjyJ':_0x51c19e(0x19b),'ZNDyD':_0x51c19e(0x201),'ShdYW':_0x51c19e(0x1c0),'aDQRL':function(_0x47667e,_0x4ae157){return _0x47667e===_0x4ae157;},'JVzQz':_0x51c19e(0x2ed),'PKSIC':_0x51c19e(0x2c2),'sKxSL':function(_0xf92c85,_0x340d65){return _0xf92c85===_0x340d65;},'HvVpv':_0x51c19e(0x2fa),'rxKLA':_0x51c19e(0x304),'meOpM':'./trainSummaryView.js','tYimx':function(_0x4e51c9,_0x5991c2,_0x7bb6b4){return _0x4e51c9(_0x5991c2,_0x7bb6b4);}};_0x2d4dba[_0x51c19e(0x2ff)]===_0x10869d&&a13_0x4d29b2[_0x51c19e(0x2fe)]&&(a13_0x4d29b2['setScoringWasInEditModeForPrint'](!0x0),_0x2d4dba[_0x51c19e(0x263)](a13_0x29cd97,!0x1)),console[_0x51c19e(0x13a)](_0x2d4dba[_0x51c19e(0x1c6)],_0x10869d,_0x2d4dba[_0x51c19e(0x2f7)],_0x594e73),document[_0x51c19e(0x1a1)][_0x51c19e(0x1d4)][_0x51c19e(0x161)](_0x51c19e(0x251)+_0x10869d),_0x2d4dba['EYwDQ'](_0x2d4dba[_0x51c19e(0x1c3)],_0x10869d)?import(_0x2d4dba[_0x51c19e(0x142)])[_0x51c19e(0x266)](_0x4ce3cd=>{const _0x47fcc2=_0x51c19e;window['printSelectedTrain']=_0x594e73,_0x4ce3cd[_0x47fcc2(0x30e)](),_0x2d4dba[_0x47fcc2(0x1c9)](setTimeout,()=>{const _0x2197a0=_0x47fcc2;window[_0x2197a0(0xed)]();},0xc8);}):_0x2d4dba[_0x51c19e(0x2d4)](_0x2d4dba[_0x51c19e(0x111)],_0x10869d)?(window[_0x51c19e(0x14d)]=_0x594e73,import(_0x2d4dba['PKSIC'])['then'](_0x5bbf29=>{const _0x49c168=_0x51c19e;_0x5bbf29[_0x49c168(0x138)]();const _0x83164b=document[_0x49c168(0x25a)](_0x49c168(0x1f1)),_0x162bc7=[];_0x83164b[_0x49c168(0x10e)](_0x4960d2=>{const _0x58bb47=_0x49c168,_0x45cf14=_0x4960d2['id'][_0x58bb47(0x1fc)](/content-pm-(\d+)/);if(_0x45cf14){_0x162bc7[_0x58bb47(0x2f6)](_0x45cf14[0x1]),_0x4960d2[_0x58bb47(0x1d4)][_0x58bb47(0x1b9)](_0x58bb47(0x30c));const _0x4dc87e=document[_0x58bb47(0x2b5)](_0x58bb47(0x338)+_0x45cf14[0x1]);_0x4dc87e&&(_0x4dc87e[_0x58bb47(0x1f0)]='▼');}});const _0x3d17c8=document[_0x49c168(0x25a)](_0x2d4dba[_0x49c168(0x2e3)]),_0x4ae945=[];_0x3d17c8[_0x49c168(0x10e)](_0x5c02f4=>{const _0x5375fb=_0x49c168,_0x213f61=_0x5c02f4['id']['match'](/maco-breakdown-details-(\d+)/);if(_0x213f61){_0x4ae945[_0x5375fb(0x2f6)](_0x213f61[0x1]),_0x5c02f4['classList'][_0x5375fb(0x1b9)](_0x2d4dba[_0x5375fb(0x29f)]);const _0x73eb06=document['getElementById']('breakdown-toggle-btn-'+_0x213f61[0x1]);_0x73eb06&&(_0x73eb06[_0x5375fb(0x1f0)]=_0x2d4dba[_0x5375fb(0x13d)]);}}),_0x2d4dba[_0x49c168(0x1c9)](setTimeout,()=>{const _0x56240b=_0x49c168,_0x15dc61={'idEDZ':_0x2d4dba[_0x56240b(0x29f)],'aRnUa':_0x2d4dba[_0x56240b(0xf2)]};window['print'](),_0x2d4dba[_0x56240b(0x1c9)](setTimeout,()=>{const _0x54c3b2=_0x56240b,_0x46ea23={'MdfuH':_0x15dc61[_0x54c3b2(0x2c0)],'IIBMT':_0x15dc61[_0x54c3b2(0x1ee)]};_0x162bc7[_0x54c3b2(0x10e)](_0x275fba=>{const _0x4a05cd=_0x54c3b2,_0x53309a=document[_0x4a05cd(0x2b5)](_0x4a05cd(0x1c2)+_0x275fba),_0x1c460a=document['getElementById'](_0x4a05cd(0x338)+_0x275fba);_0x53309a&&_0x53309a['classList'][_0x4a05cd(0x161)](_0x4a05cd(0x30c)),_0x1c460a&&(_0x1c460a[_0x4a05cd(0x1f0)]='▶');}),_0x4ae945[_0x54c3b2(0x10e)](_0x593ea=>{const _0x2a391e=_0x54c3b2,_0x3f0676=document['getElementById'](_0x2a391e(0x1e5)+_0x593ea),_0x45a20b=document[_0x2a391e(0x2b5)]('breakdown-toggle-btn-'+_0x593ea);_0x3f0676&&_0x3f0676[_0x2a391e(0x1d4)]['add'](_0x46ea23[_0x2a391e(0x1da)]),_0x45a20b&&(_0x45a20b[_0x2a391e(0x1f0)]=_0x46ea23[_0x2a391e(0x229)]);});},0x3e8);},0xc8);})):_0x2d4dba[_0x51c19e(0x298)](_0x2d4dba[_0x51c19e(0x2d0)],_0x10869d)?(window[_0x51c19e(0x14d)]=_0x594e73,import(_0x2d4dba[_0x51c19e(0x268)])[_0x51c19e(0x266)](_0x303a25=>{const _0x2ee429=_0x51c19e;_0x303a25[_0x2ee429(0x1ed)]();const _0x1d8187=document[_0x2ee429(0x25a)](_0x2d4dba[_0x2ee429(0x133)]),_0x2f6b65=[];_0x1d8187[_0x2ee429(0x10e)](_0x11eee2=>{const _0x2bdb4c=_0x2ee429,_0x419c7a=_0x11eee2['id'][_0x2bdb4c(0x1fc)](/content-dm-(\d+)/);if(_0x419c7a){_0x2f6b65['push'](_0x419c7a[0x1]),_0x11eee2[_0x2bdb4c(0x1d4)][_0x2bdb4c(0x1b9)](_0x2bdb4c(0x30c));const _0x3e72d7=document[_0x2bdb4c(0x2b5)](_0x2bdb4c(0x30d)+_0x419c7a[0x1]);_0x3e72d7&&(_0x3e72d7['textContent']='▼');}}),_0x2d4dba[_0x2ee429(0x27f)](setTimeout,()=>{const _0x96c85e=_0x2ee429;window[_0x96c85e(0xed)](),setTimeout(()=>{const _0x4b5a00=_0x96c85e,_0x1157a6={'cnwYa':_0x4b5a00(0x30c)};_0x2f6b65['forEach'](_0x3ec8d8=>{const _0x22591e=_0x4b5a00,_0x4e9c9b=document[_0x22591e(0x2b5)](_0x22591e(0xf5)+_0x3ec8d8),_0xa092b1=document[_0x22591e(0x2b5)](_0x22591e(0x30d)+_0x3ec8d8);_0x4e9c9b&&_0x4e9c9b[_0x22591e(0x1d4)][_0x22591e(0x161)](_0x1157a6[_0x22591e(0xfb)]),_0xa092b1&&(_0xa092b1['textContent']='▶');});},0x3e8);},0xc8);})[_0x51c19e(0x1a4)](_0x1eded7=>{const _0x58e8e7=_0x51c19e;console['error'](_0x2d4dba[_0x58e8e7(0x194)],_0x1eded7),window[_0x58e8e7(0xed)]();})[_0x51c19e(0x137)](()=>{_0x2d4dba['puQJT'](setTimeout,()=>{const _0x2e2b2c=a13_0x2b75;window[_0x2e2b2c(0x14d)]=null,import(_0x2d4dba[_0x2e2b2c(0x268)])[_0x2e2b2c(0x266)](_0x204be4=>_0x204be4[_0x2e2b2c(0x1ed)]())['catch'](()=>{});},0x4b0);})):_0x2d4dba[_0x51c19e(0x1dc)]===_0x10869d?(window[_0x51c19e(0x14d)]=_0x594e73,console[_0x51c19e(0x13a)](_0x51c19e(0x267),_0x594e73),import(_0x2d4dba['meOpM'])[_0x51c19e(0x266)](_0x1fffb9=>{const _0x7f0cdd=_0x51c19e,_0x2c76c8={'tMokh':_0x2d4dba[_0x7f0cdd(0x23a)],'NVDHR':_0x2d4dba[_0x7f0cdd(0x29e)],'qofyO':_0x2d4dba[_0x7f0cdd(0x326)],'zymZs':function(_0x25a8e1,_0x18eba2){return _0x25a8e1>_0x18eba2;},'OfZHa':function(_0x546c01,_0x3898cc){const _0x1d36d7=_0x7f0cdd;return _0x2d4dba[_0x1d36d7(0x221)](_0x546c01,_0x3898cc);},'vJlBW':_0x2d4dba[_0x7f0cdd(0x178)],'monRn':function(_0x2ed0dd,_0x4d2f22){return _0x2d4dba['MlHoR'](_0x2ed0dd,_0x4d2f22);},'Czcya':_0x2d4dba[_0x7f0cdd(0x226)],'puOtK':function(_0x37bfd2,_0x1362f7,_0x41674d){const _0x5c7036=_0x7f0cdd;return _0x2d4dba[_0x5c7036(0x281)](_0x37bfd2,_0x1362f7,_0x41674d);}};_0x1fffb9[_0x7f0cdd(0x254)](),_0x2d4dba[_0x7f0cdd(0x220)](setTimeout,()=>{const _0x2024e4=_0x7f0cdd,_0xa0f2f4=document['getElementById'](_0x2024e4(0x2a5)),_0x1afdfe=document[_0x2024e4(0x2b5)](_0x2c76c8[_0x2024e4(0x114)]);if(console[_0x2024e4(0x13a)](_0x2c76c8[_0x2024e4(0x32f)],_0xa0f2f4?_0xa0f2f4[_0x2024e4(0x2bb)]['display']:_0x2024e4(0x12d)),console['log']('No\x20trains\x20message\x20display:',_0x1afdfe?_0x1afdfe[_0x2024e4(0x2bb)][_0x2024e4(0x32c)]:_0x2024e4(0x12d)),console[_0x2024e4(0x13a)](_0x2c76c8[_0x2024e4(0x299)],!!_0xa0f2f4&&_0x2c76c8[_0x2024e4(0x2ba)](_0xa0f2f4[_0x2024e4(0x282)][_0x2024e4(0x2a8)],0x0)),!_0xa0f2f4||_0x2c76c8[_0x2024e4(0x2de)]('none',_0xa0f2f4[_0x2024e4(0x2bb)][_0x2024e4(0x32c)]))return console['warn'](_0x2c76c8[_0x2024e4(0x2f9)]),void _0x2c76c8[_0x2024e4(0x121)](alert,_0x2c76c8[_0x2024e4(0x329)]);window['print'](),_0x2c76c8[_0x2024e4(0x228)](setTimeout,()=>{const _0x441920=_0x2024e4;window[_0x441920(0x14d)]=null,_0x1fffb9[_0x441920(0x254)]();},0x3e8);},0x1f4);})[_0x51c19e(0x1a4)](_0x36d5bd=>{const _0x35d418=_0x51c19e;console[_0x35d418(0x2c9)](_0x2d4dba[_0x35d418(0x303)],_0x36d5bd),_0x2d4dba[_0x35d418(0x263)](alert,_0x2d4dba[_0x35d418(0x110)](_0x2d4dba[_0x35d418(0x222)],_0x36d5bd[_0x35d418(0x274)]));})):_0x2d4dba[_0x51c19e(0x191)](setTimeout,()=>{const _0x235c8a=_0x51c19e;window[_0x235c8a(0xed)]();},0x64);}export function toggleColumn(_0x8c6101,_0x41723c){const _0x4177e3=a13_0x407115,_0x4a02ed={'AOGKO':function(_0x264666,_0x3c757a){return _0x264666===_0x3c757a;},'ufsUq':function(_0x178606,_0x5e0575){return _0x178606===_0x5e0575;},'JrIaK':_0x4177e3(0xdc),'gPSMk':_0x4177e3(0x201),'dcXlc':function(_0x1be20c,_0x371071){return _0x1be20c!==_0x371071;},'PvETr':function(_0x511560,_0x36a5f6){return _0x511560(_0x36a5f6);},'ORTEG':_0x4177e3(0x1c0),'fUupX':function(_0x23de66,_0x2f2c7d){return _0x23de66(_0x2f2c7d);}};if(_0x4a02ed['AOGKO']('pde',_0x8c6101)||_0x4a02ed[_0x4177e3(0x2ea)](_0x4177e3(0x27b),_0x8c6101)){[_0x4a02ed[_0x4177e3(0x29a)],_0x4a02ed['gPSMk']][_0x4177e3(0x10e)](_0x403ba1=>{const _0x3a68ee=_0x4177e3;document['querySelectorAll']('#'+_0x403ba1+'\x20.mainTable,\x20#'+_0x403ba1+_0x3a68ee(0x2b7))[_0x3a68ee(0x10e)](_0x18d01=>{const _0x212927=_0x3a68ee;_0x18d01[_0x212927(0x1d4)][_0x212927(0x1ad)](_0x212927(0x13f)+_0x8c6101);}),document[_0x3a68ee(0x25a)]('#'+_0x403ba1+',\x20#'+_0x403ba1+_0x3a68ee(0x32d))[_0x3a68ee(0x10e)](_0x40d183=>{const _0x17aa95=_0x3a68ee;_0x40d183&&_0x40d183['classList'][_0x17aa95(0x1ad)](_0x17aa95(0x13f)+_0x8c6101);});});const _0x265f55=_0x4a02ed[_0x4177e3(0x2ee)](null,document[_0x4177e3(0xf7)](_0x4177e3(0x14a)+_0x8c6101));localStorage[_0x4177e3(0x131)](_0x4177e3(0x284)+_0x8c6101+_0x4177e3(0x31f),_0x265f55),_0x4a02ed[_0x4177e3(0x32b)](updateToggleIcons,_0x4177e3(0xdc)),_0x4a02ed[_0x4177e3(0x32b)](updateToggleIcons,_0x4a02ed[_0x4177e3(0x2d1)]),import(_0x4177e3(0x1c0))['then'](_0x315436=>{_0x315436['renderWorstCaseByTrain']();}),import(_0x4a02ed[_0x4177e3(0x185)])[_0x4177e3(0x266)](_0xf8d4f7=>{const _0x4da17c=_0x4177e3;_0xf8d4f7['renderRpnChart']&&_0xf8d4f7[_0x4da17c(0x17a)]();});}else{document['querySelectorAll']('#'+_0x41723c+'\x20.mainTable,\x20#'+_0x41723c+_0x4177e3(0x2b7))['forEach'](_0x8063fe=>{const _0x4af267=_0x4177e3;_0x8063fe[_0x4af267(0x1d4)][_0x4af267(0x1ad)]('hide-'+_0x8c6101);});const _0x3a71ad=_0x4a02ed[_0x4177e3(0x2ee)](null,document[_0x4177e3(0xf7)]('#'+_0x41723c+_0x4177e3(0x115)+_0x8c6101));localStorage[_0x4177e3(0x131)](_0x41723c+'-'+_0x8c6101+_0x4177e3(0x31f),_0x3a71ad),_0x4a02ed[_0x4177e3(0x2c8)](updateToggleIcons,_0x41723c);}}export function toggleColumnVisibilityDropdown(){const _0x27bc16=a13_0x407115,_0x18619b={'vdmyC':_0x27bc16(0x1a3),'bXQAh':_0x27bc16(0x259),'fpdRV':'hidden','tLrXl':_0x27bc16(0x1c1),'MBQyN':_0x27bc16(0x33f)},_0x3626ed=document[_0x27bc16(0x2b5)](_0x18619b[_0x27bc16(0x12a)]);_0x3626ed['classList'][_0x27bc16(0x1ad)](_0x27bc16(0x206)),_0x3626ed['classList']['contains'](_0x18619b[_0x27bc16(0x1f9)])||document[_0x27bc16(0x2ce)](_0x27bc16(0x1c1),function _0x9fce52(_0x473592){const _0x9e67f9=_0x27bc16;_0x473592[_0x9e67f9(0x11c)][_0x9e67f9(0xde)](_0x18619b['vdmyC'])||_0x473592[_0x9e67f9(0x11c)]['closest'](_0x18619b[_0x9e67f9(0x1a9)])||(_0x3626ed[_0x9e67f9(0x1d4)][_0x9e67f9(0x161)](_0x18619b[_0x9e67f9(0x1f9)]),document[_0x9e67f9(0x1f4)](_0x18619b[_0x9e67f9(0x29c)],_0x9fce52));});}export function updateToggleIcons(_0x3ca240){const _0x55da21=a13_0x407115,_0x3986ec={'KQjgS':_0x55da21(0x21c),'IfARG':_0x55da21(0x27a),'rXHfd':function(_0x4ee837,_0x3b5ee1){return _0x4ee837===_0x3b5ee1;},'LVGJK':_0x55da21(0x201),'gRHyi':'productRegister-pdeHidden','oRVZM':_0x55da21(0x198),'jofdU':function(_0x5cd208,_0x1aeca7){return _0x5cd208===_0x1aeca7;},'GHiHW':function(_0x686e5d,_0x32ce92){return _0x686e5d===_0x32ce92;},'DDFXl':function(_0xff9b6b,_0x1a5c16){return _0xff9b6b===_0x1a5c16;},'vILrR':_0x55da21(0xdd),'aITlW':function(_0x41a27b,_0x1de475){return _0x41a27b&&_0x1de475;},'kWyKW':function(_0x5ce225,_0x3538b8){return _0x5ce225===_0x3538b8;},'lLzTT':function(_0x2bec9b,_0x12ecb5){return _0x2bec9b===_0x12ecb5;},'DVgVd':_0x55da21(0x2af),'KSpZb':_0x55da21(0x2ad),'CUBoH':_0x55da21(0x236),'KURuA':_0x55da21(0x1b7),'ICmlQ':'Hide\x20LD50'},_0x2d3efe=document[_0x55da21(0x2b5)](_0x3ca240);if(!_0x2d3efe)return;let _0x3056c2,_0x1ecfaf;if(_0x3986ec[_0x55da21(0x1b1)](_0x3986ec['LVGJK'],_0x3ca240)){const _0x2a8bda=localStorage[_0x55da21(0x2e0)](_0x3986ec[_0x55da21(0xf9)]),_0xd13c03=localStorage[_0x55da21(0x2e0)](_0x3986ec[_0x55da21(0x25c)]);if(_0x3986ec['jofdU'](null,_0x2a8bda)&&null===_0xd13c03)_0x3056c2=!0x1,_0x1ecfaf=!0x1;else{const _0x275e71=_0x3986ec[_0x55da21(0x172)](_0x55da21(0xdd),_0x2a8bda),_0x286a19=_0x3986ec[_0x55da21(0x31d)](_0x3986ec[_0x55da21(0x147)],_0xd13c03);_0x3986ec[_0x55da21(0x16f)](_0x275e71,_0x286a19)?(_0x3056c2=!0x1,_0x1ecfaf=!0x0):(_0x3056c2=_0x275e71,_0x1ecfaf=_0x286a19);}}else{const _0x298fbf=localStorage[_0x55da21(0x2e0)](_0x3ca240+_0x55da21(0x1cd)),_0x1199a0=localStorage[_0x55da21(0x2e0)](_0x3ca240+_0x55da21(0x286));_0x3056c2=_0x3986ec[_0x55da21(0x22f)](_0x3986ec[_0x55da21(0x147)],_0x298fbf),_0x1ecfaf=_0x3986ec[_0x55da21(0x340)](_0x3986ec['vILrR'],_0x1199a0);}const _0x5beffd=_0x2d3efe[_0x55da21(0xf7)](_0x3986ec[_0x55da21(0x19f)]),_0x48594e=_0x2d3efe[_0x55da21(0xf7)](_0x3986ec['KSpZb']);_0x5beffd&&(_0x5beffd[_0x55da21(0x282)]=_0x3056c2?_0x3986ec[_0x55da21(0x130)]:_0x55da21(0x323)),_0x48594e&&(_0x48594e[_0x55da21(0x282)]=_0x1ecfaf?_0x3986ec[_0x55da21(0x321)]:_0x3986ec['ICmlQ']),document[_0x55da21(0x25a)]('#'+_0x3ca240+_0x55da21(0x1d0)+_0x3ca240+_0x55da21(0x2b7))[_0x55da21(0x10e)](_0x421eb1=>{const _0x718ab0=_0x55da21;_0x421eb1&&(_0x421eb1[_0x718ab0(0x1d4)][_0x718ab0(0x1ad)](_0x718ab0(0x27a),_0x3056c2),_0x421eb1['classList'][_0x718ab0(0x1ad)](_0x3986ec[_0x718ab0(0x2c1)],_0x1ecfaf));}),document[_0x55da21(0x25a)]('#'+_0x3ca240+_0x55da21(0x19d)+_0x3ca240+_0x55da21(0x32d))[_0x55da21(0x10e)](_0x3f5422=>{const _0x32f0e6=_0x55da21;_0x3f5422&&(_0x3f5422['classList'][_0x32f0e6(0x1ad)](_0x3986ec[_0x32f0e6(0x101)],_0x3056c2),_0x3f5422['classList'][_0x32f0e6(0x1ad)](_0x32f0e6(0x21c),_0x1ecfaf));});}export function exportToExcel(){const _0x2923f4=a13_0x407115,_0x26e9d1={'Zppxl':function(_0x3c9c3f,_0x434071){return _0x3c9c3f(_0x434071);},'cvWdJ':function(_0x31c784,_0x1c1b37){return _0x31c784+_0x1c1b37;},'rRlIR':function(_0x4dba4d,_0x495f09,_0x26518a){return _0x4dba4d(_0x495f09,_0x26518a);},'gYcIz':_0x2923f4(0x139),'QDvBv':'There\x20is\x20no\x20data\x20in\x20the\x20current\x20view\x20to\x20export.','pYdJQ':'MACO\x20Report','qfZKf':_0x2923f4(0x180),'uYXTh':_0x2923f4(0x317),'PNaiz':_0x2923f4(0x33e),'cphVC':function(_0x3db7eb){return _0x3db7eb();},'hQhJr':function(_0x1d3835,_0x6af826,_0x37c2c8){return _0x1d3835(_0x6af826,_0x37c2c8);},'EZHEc':'Error','yprbL':_0x2923f4(0x32e),'MXyCw':function(_0x3537b9){return _0x3537b9();},'srogx':_0x2923f4(0x327)};_0x26e9d1[_0x2923f4(0x272)](showLoader),import(_0x26e9d1[_0x2923f4(0x1ea)])[_0x2923f4(0x266)](_0x1c3d63=>{const _0x1eb26d=_0x2923f4,_0x20ff4a={'qazaq':function(_0x5688bf,_0x8a075a){const _0x3a8c36=a13_0x2b75;return _0x26e9d1[_0x3a8c36(0x125)](_0x5688bf,_0x8a075a);},'YVFuN':function(_0x2fef26,_0x472a50){const _0x3b071f=a13_0x2b75;return _0x26e9d1[_0x3b071f(0x2b0)](_0x2fef26,_0x472a50);},'GQwac':'Yes'},{getProductTrainId:_0x39e6a8,calculateScores:_0x52bc04}=_0x1c3d63,_0x51c2fd=[];if(a13_0x4d29b2['products']['forEach'](_0x1d7cc=>{const _0x5c0d8a=a13_0x2b75;let _0xb0c10a='No';_0x1d7cc[_0x5c0d8a(0x289)]&&(_0xb0c10a=_0x20ff4a[_0x5c0d8a(0x1d8)](_0x20ff4a[_0x5c0d8a(0x28d)],_0x1d7cc[_0x5c0d8a(0x2a7)]?':\x20'+_0x1d7cc['criticalReason']:''));const _0x55e0a9=_0x39e6a8(_0x1d7cc),_0x51a66e=_0x1d7cc[_0x5c0d8a(0x28e)]?new Date(_0x1d7cc[_0x5c0d8a(0x28e)])['toLocaleDateString']():'';_0x51c2fd['push']({'Date':_0x51a66e,'Product\x20Code':_0x1d7cc['productCode'],'Product\x20Name':_0x1d7cc[_0x5c0d8a(0xe3)],'Train\x20No.':_0x55e0a9,'Dosage\x20Form':_0x1d7cc[_0x5c0d8a(0x103)]||'','Batch\x20Size\x20(Kg)':_0x1d7cc[_0x5c0d8a(0x2cc)],'Special\x20Case\x20Product':_0xb0c10a,'Active\x20Ingredient':'','Solubility':'','Therapeutic\x20Dose\x20(mg/day)':'','Cleanability':'','PDE\x20(µg/day)':'','LD50\x20(mg/kg)':'','Solubility\x20Score':'','Therapeutic\x20Dose\x20Score':'','Cleanability\x20Score':'','Toxicity\x20Score':'','RPN':'','RPN\x20Rating':''}),_0x1d7cc[_0x5c0d8a(0x2c5)][_0x5c0d8a(0x10e)](_0x30632a=>{const _0x29cf31=_0x5c0d8a,_0xb391c6=_0x20ff4a['qazaq'](_0x52bc04,_0x30632a);_0x51c2fd[_0x29cf31(0x2f6)]({'Date':'','Product\x20Code':'','Product\x20Name':_0x29cf31(0x14c)+_0x30632a[_0x29cf31(0xe3)],'Train\x20No.':'','Dosage\x20Form':'','Batch\x20Size\x20(Kg)':'','Special\x20Case\x20Product':'','Active\x20Ingredient':_0x30632a['name'],'Solubility':_0x30632a['solubility']||'','Therapeutic\x20Dose\x20(mg/day)':_0x30632a['therapeuticDose']||'','Cleanability':_0x30632a[_0x29cf31(0x26a)]||'','PDE\x20(µg/day)':_0x30632a[_0x29cf31(0x128)]||'','LD50\x20(mg/kg)':_0x30632a[_0x29cf31(0x27b)]||'','Solubility\x20Score':_0xb391c6[_0x29cf31(0x212)]||'','Therapeutic\x20Dose\x20Score':_0xb391c6['therapeuticDoseScore']||'','Cleanability\x20Score':_0xb391c6[_0x29cf31(0x21f)]||'','Toxicity\x20Score':_0xb391c6[_0x29cf31(0x151)]||_0xb391c6['ld50Score']||'','RPN':_0xb391c6['rpn'],'RPN\x20Rating':_0xb391c6[_0x29cf31(0x25b)]});});}),0x0===_0x51c2fd[_0x1eb26d(0x2a8)])return hideLoader(),void _0x26e9d1[_0x1eb26d(0x2d3)](showCustomAlert,_0x26e9d1['gYcIz'],_0x26e9d1[_0x1eb26d(0x308)]);const _0x98e8ce=XLSX[_0x1eb26d(0x217)][_0x1eb26d(0x186)](_0x51c2fd),_0x44f3b2=XLSX[_0x1eb26d(0x217)]['book_new']();XLSX[_0x1eb26d(0x217)][_0x1eb26d(0x23e)](_0x44f3b2,_0x98e8ce,_0x26e9d1[_0x1eb26d(0x1eb)]);const _0x4c2ac0=Object[_0x1eb26d(0x1b5)](_0x51c2fd[0x0])[_0x1eb26d(0x2d2)](_0x4a68ff=>({'wch':Math[_0x1eb26d(0x22a)](_0x4a68ff['length'],..._0x51c2fd[_0x1eb26d(0x2d2)](_0xd703fa=>String(_0xd703fa[_0x4a68ff]||'')['length']))+0x2}));_0x98e8ce[_0x26e9d1['qfZKf']]=_0x4c2ac0,XLSX[_0x1eb26d(0x1c7)](_0x44f3b2,_0x26e9d1['uYXTh']),hideLoader();})[_0x2923f4(0x1a4)](_0x5de55f=>{const _0x1bc345=_0x2923f4;console[_0x1bc345(0x2c9)](_0x26e9d1[_0x1bc345(0xec)],_0x5de55f),_0x26e9d1[_0x1bc345(0x234)](hideLoader),_0x26e9d1[_0x1bc345(0x159)](showCustomAlert,_0x26e9d1[_0x1bc345(0x23f)],_0x26e9d1[_0x1bc345(0x17c)]);});}export function exportAllToJson(){const _0x184c13=a13_0x407115,_0x2c0fb2={'TnzVg':function(_0x5cdc5d,_0x38b7ff,_0x27f693){return _0x5cdc5d(_0x38b7ff,_0x27f693);},'LmUEu':'Error','JjUkj':function(_0x4dc374,_0x4c9304){return _0x4dc374+_0x4c9304;},'PDlNM':_0x184c13(0x1f5),'qjpBE':function(_0x4f0649){return _0x4f0649();}};showLoader();try{const _0x218668={'exportDate':new Date()[_0x184c13(0x119)](),'scoringCriteria':a13_0x4d29b2['scoringCriteria'],'products':a13_0x4d29b2[_0x184c13(0x24a)],'machines':a13_0x4d29b2[_0x184c13(0x16e)],'detergentIngredients':a13_0x4d29b2[_0x184c13(0xfc)]},_0x57e3a3=JSON[_0x184c13(0x1de)](_0x218668,null,0x2),_0x43d780=new Blob([_0x57e3a3],{'type':_0x184c13(0x113)}),_0x2f01f1=URL[_0x184c13(0x2b6)](_0x43d780),_0x267f54=document['createElement']('a');_0x267f54[_0x184c13(0x28f)]=_0x2f01f1,_0x267f54[_0x184c13(0x16a)]=_0x184c13(0x25e),document[_0x184c13(0x1a1)][_0x184c13(0x134)](_0x267f54),_0x267f54[_0x184c13(0x1c1)](),document['body'][_0x184c13(0x23c)](_0x267f54),URL['revokeObjectURL'](_0x2f01f1);}catch(_0x125ee7){_0x2c0fb2['TnzVg'](showCustomAlert,_0x2c0fb2[_0x184c13(0x2d5)],_0x2c0fb2[_0x184c13(0x23d)](_0x2c0fb2[_0x184c13(0x203)],_0x125ee7[_0x184c13(0x274)]));}finally{_0x2c0fb2[_0x184c13(0x2a1)](hideLoader);}}export function importFromJson(_0x58a442){const _0x227455=a13_0x407115,_0x484d50={'LNTqM':function(_0x33a515){return _0x33a515();},'vtIOR':function(_0x42dc01,_0x56fa46,_0x30485e){return _0x42dc01(_0x56fa46,_0x30485e);},'yDhhS':_0x227455(0x19a),'anlCI':_0x227455(0x12b),'TYNnF':function(_0x36b270,_0x38a939,_0x547ff9){return _0x36b270(_0x38a939,_0x547ff9);},'AigiX':_0x227455(0x324),'TAhyt':_0x227455(0x341)},_0x1820f6=_0x58a442[_0x227455(0x11c)][_0x227455(0x2ab)][0x0];if(!_0x1820f6)return;const _0x2db409=new FileReader();_0x2db409[_0x227455(0x157)]=function(_0x321ede){const _0x2925d9=_0x227455;try{const _0x4c6edc=JSON[_0x2925d9(0x158)](_0x321ede[_0x2925d9(0x11c)][_0x2925d9(0x1e9)]);_0x4c6edc&&_0x4c6edc[_0x2925d9(0x24a)]&&_0x4c6edc['scoringCriteria']&&_0x4c6edc[_0x2925d9(0x16e)]?(a13_0x4d29b2[_0x2925d9(0x319)](_0x4c6edc[_0x2925d9(0x24a)]),a13_0x4d29b2['setMachines'](_0x4c6edc['machines']),a13_0x4d29b2[_0x2925d9(0x1be)](_0x4c6edc['scoringCriteria']),_0x4c6edc[_0x2925d9(0xfc)]&&a13_0x4d29b2['setDetergentIngredients'](_0x4c6edc[_0x2925d9(0xfc)]),_0x484d50[_0x2925d9(0x13e)](saveStateForUndo),_0x484d50[_0x2925d9(0x13e)](a13_0x461adb),_0x484d50['vtIOR'](showCustomAlert,_0x484d50[_0x2925d9(0x150)],_0x484d50[_0x2925d9(0x296)])):_0x484d50['TYNnF'](showCustomAlert,_0x2925d9(0x20c),_0x484d50[_0x2925d9(0x13c)]);}catch(_0x4adc2a){_0x484d50[_0x2925d9(0x2da)](showCustomAlert,_0x2925d9(0x20c),_0x484d50[_0x2925d9(0x313)]);}finally{_0x58a442[_0x2925d9(0x11c)]['value']='';}},_0x2db409[_0x227455(0x325)](_0x1820f6);}export function toggleOtherProductType(_0x3e2864,_0xc1c63b){const _0x2ffa14=a13_0x407115,_0x80765={'JYsDB':function(_0x3191cd,_0x51db8e){return _0x3191cd===_0x51db8e;},'wVHuk':'Other','pYrEh':_0x2ffa14(0x270),'Byuau':_0x2ffa14(0x238)},_0x1cd2ce=document[_0x2ffa14(0x2b5)](_0xc1c63b),_0x3c7ce9=_0x1cd2ce[_0x2ffa14(0xf7)](_0x2ffa14(0x243));_0x80765[_0x2ffa14(0x2bf)](_0x80765['wVHuk'],_0x3e2864['value'])?(_0x1cd2ce[_0x2ffa14(0x2bb)]['display']=_0x80765[_0x2ffa14(0x117)],_0x3c7ce9[_0x2ffa14(0x1f3)]=!0x0):(_0x1cd2ce[_0x2ffa14(0x2bb)]['display']=_0x80765['Byuau'],_0x3c7ce9[_0x2ffa14(0x1f3)]=!0x1,_0x3c7ce9[_0x2ffa14(0xda)]='');}export function toggleOtherMachineStage(_0x4f2c98,_0x555d7a){const _0x46e414=a13_0x407115,_0x23473b={'EbbHC':'input','wipMy':function(_0x57a8e1,_0x5b0a11){return _0x57a8e1===_0x5b0a11;},'uULEq':'Other','bxaxT':_0x46e414(0x270),'Ivyah':_0x46e414(0x238)},_0x58094d=document[_0x46e414(0x2b5)](_0x555d7a),_0xaa1712=_0x58094d[_0x46e414(0xf7)](_0x23473b[_0x46e414(0x2df)]);_0x23473b[_0x46e414(0x24e)](_0x23473b[_0x46e414(0x269)],_0x4f2c98[_0x46e414(0xda)])?(_0x58094d[_0x46e414(0x2bb)][_0x46e414(0x32c)]=_0x23473b[_0x46e414(0x163)],_0xaa1712[_0x46e414(0x1f3)]=!0x0):(_0x58094d[_0x46e414(0x2bb)][_0x46e414(0x32c)]=_0x23473b[_0x46e414(0x11e)],_0xaa1712[_0x46e414(0x1f3)]=!0x1,_0xaa1712[_0x46e414(0xda)]='');}export function toggleOtherMachineGroup(_0x1a2b68,_0x19c07e){const _0xc3d228=a13_0x407115,_0x1881c9={'LquqI':'input','Qbkgx':function(_0x15584c,_0x3e6bbe){return _0x15584c===_0x3e6bbe;},'agpYT':_0xc3d228(0x227),'iBbEA':'none'},_0x547248=document['getElementById'](_0x19c07e),_0x1fa31=_0x547248[_0xc3d228(0xf7)](_0x1881c9[_0xc3d228(0x260)]);_0x1881c9[_0xc3d228(0x1ce)](_0x1881c9[_0xc3d228(0x224)],_0x1a2b68[_0xc3d228(0xda)])?(_0x547248['style'][_0xc3d228(0x32c)]='block',_0x1fa31[_0xc3d228(0x1f3)]=!0x0):(_0x547248['style']['display']=_0x1881c9['iBbEA'],_0x1fa31[_0xc3d228(0x1f3)]=!0x1,_0x1fa31[_0xc3d228(0xda)]='');}export function clampSafetyFactor(_0x46ffce,_0x17613a){const _0xe12987=a13_0x407115,_0x23056e={'QFelO':function(_0x4d45c7,_0x2a9577){return _0x4d45c7(_0x2a9577);},'BkZCS':function(_0x870321,_0x4abc62){return _0x870321(_0x4abc62);},'KfGRA':function(_0xbf7d52,_0x29eb95){return _0xbf7d52>_0x29eb95;},'aBvPu':function(_0x3daf15,_0x57afcb){return _0x3daf15!==_0x57afcb;},'URSKo':function(_0x1bc52c,_0x9e4a82){return _0x1bc52c(_0x9e4a82);},'CCxAk':_0xe12987(0x166)},_0x5b8a80=_0x23056e['QFelO'](parseFloat,_0x46ffce[_0xe12987(0x1df)]),_0x4d7f0c=_0x23056e[_0xe12987(0x2e1)](parseFloat,_0x46ffce[_0xe12987(0x22a)]);let _0x4c74b9=parseFloat(_0x46ffce[_0xe12987(0xda)]);_0x23056e[_0xe12987(0x1b2)](isNaN,_0x4c74b9)&&(_0x4c74b9=_0x5b8a80),_0x4c74b9<_0x5b8a80?_0x4c74b9=_0x5b8a80:_0x23056e[_0xe12987(0x1ac)](_0x4c74b9,_0x4d7f0c)&&(_0x4c74b9=_0x4d7f0c),_0x23056e[_0xe12987(0x232)](parseFloat(_0x46ffce['value']),_0x4c74b9)&&(_0x46ffce[_0xe12987(0xda)]=_0x4c74b9),_0x46ffce['id'][_0xe12987(0x33d)]('product-sf-input')?_0x23056e[_0xe12987(0x1ca)](recalculateProductMacoForTrain,_0x17613a):_0x46ffce['id'][_0xe12987(0x33d)](_0x23056e['CCxAk'])&&_0x23056e[_0xe12987(0x1ca)](recalculateDetergentMacoForTrain,_0x17613a);}export function toggleTrain(_0x55de3c){const _0x3346d5=a13_0x407115,_0x461473={'fSNwg':function(_0x4b6402,_0x4a1dee){return _0x4b6402&&_0x4a1dee;},'LfKjJ':'collapsed'},_0x45c497=document[_0x3346d5(0x2b5)]('content-'+_0x55de3c),_0x5b919c=document[_0x3346d5(0x2b5)](_0x3346d5(0x1dd)+_0x55de3c);_0x461473[_0x3346d5(0x12c)](_0x45c497,_0x5b919c)&&(_0x45c497[_0x3346d5(0x1d4)]['contains'](_0x461473[_0x3346d5(0x261)])?(_0x45c497[_0x3346d5(0x1d4)]['remove'](_0x461473[_0x3346d5(0x261)]),_0x5b919c['textContent']='▼'):(_0x45c497[_0x3346d5(0x1d4)]['add'](_0x461473[_0x3346d5(0x261)]),_0x5b919c[_0x3346d5(0x1f0)]='▶'));}function a13_0x2b75(_0x55ce61,_0x318d22){const _0x286d41=a13_0x286d();return a13_0x2b75=function(_0x2b7512,_0x6cefb8){_0x2b7512=_0x2b7512-0xda;let _0x2092c4=_0x286d41[_0x2b7512];return _0x2092c4;},a13_0x2b75(_0x55ce61,_0x318d22);}export function toggleMacoBreakdown(_0x70a71a){const _0x29183c=a13_0x407115,_0x5ba007={'RoMpv':_0x29183c(0x206),'krkVC':_0x29183c(0xf1),'hiVZY':_0x29183c(0x129)},_0x352b71=document[_0x29183c(0x2b5)](_0x29183c(0x1e5)+_0x70a71a),_0x14b272=document[_0x29183c(0x2b5)](_0x29183c(0x15d)+_0x70a71a);_0x352b71['classList']['contains'](_0x5ba007[_0x29183c(0x15e)])?(_0x352b71[_0x29183c(0x1d4)][_0x29183c(0x1b9)](_0x5ba007[_0x29183c(0x15e)]),_0x14b272[_0x29183c(0x1f0)]=_0x5ba007[_0x29183c(0x2dd)]):(_0x352b71[_0x29183c(0x1d4)][_0x29183c(0x161)](_0x5ba007['RoMpv']),_0x14b272['textContent']=_0x5ba007[_0x29183c(0x2d9)]);}export function exportWorstCaseToExcel(_0x45c36b=a13_0x407115(0x255)){const _0x5ad908=a13_0x407115,_0x58ac3f={'okXZr':function(_0x3ab027,_0x487b1f){return _0x3ab027!==_0x487b1f;},'tJvRi':_0x5ad908(0x223),'xyVtb':function(_0x428a5c,_0x2fe8a6){return _0x428a5c===_0x2fe8a6;},'yOIMm':function(_0x19246b){return _0x19246b();},'epYHy':_0x5ad908(0x301),'fmrUl':function(_0x1961a9,_0x108d0e,_0xc9906d){return _0x1961a9(_0x108d0e,_0xc9906d);},'mHmxt':function(_0x4b38ac){return _0x4b38ac();},'GwBkt':_0x5ad908(0x139),'LOwdQ':'There\x20is\x20no\x20data\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','wZMOe':'Worst\x20Case\x20Products','VQCcx':'!cols','jFDzy':function(_0x2ff6e4,_0x568ec6){return _0x2ff6e4!==_0x568ec6;},'Fcnrh':_0x5ad908(0x255),'FtkQB':function(_0x530564){return _0x530564();},'rwMjg':_0x5ad908(0x218),'afnbq':function(_0x4aab65){return _0x4aab65();},'DrCwe':_0x5ad908(0x20c),'DqHyN':_0x5ad908(0x1d5),'AYbus':'./utils.js'};_0x58ac3f[_0x5ad908(0x24d)](showLoader),import(_0x58ac3f[_0x5ad908(0x20d)])[_0x5ad908(0x266)](_0x403a8d=>{const _0x1ee26a=_0x5ad908,_0x40c629={'suzXm':function(_0x3f8f46,_0x17a625){return _0x3f8f46>_0x17a625;},'vzxbO':_0x58ac3f[_0x1ee26a(0x190)]},{getProductTrainId:_0x235b6c,calculateScores:_0x3cd623,getToxicityPreference:_0x6ab018}=_0x403a8d,_0x5204fd=[];let _0x2ecb62=a13_0x4d29b2[_0x1ee26a(0x19e)]['worstCaseProducts']||a13_0x4d29b2['products'];if(_0x58ac3f[_0x1ee26a(0x2ae)](0x0,_0x2ecb62[_0x1ee26a(0x2a8)]))return _0x58ac3f[_0x1ee26a(0x1b6)](hideLoader),void showCustomAlert('No\x20Data',_0x58ac3f[_0x1ee26a(0x332)]);const _0x5a21b7={};_0x2ecb62['forEach'](_0x1913c4=>{const _0x50482f=_0x1ee26a,_0x5bc57a=_0x235b6c(_0x1913c4);_0x58ac3f[_0x50482f(0x1aa)](_0x50482f(0xfd),_0x5bc57a)&&(_0x5a21b7[_0x5bc57a]||(_0x5a21b7[_0x5bc57a]=[]),_0x5a21b7[_0x5bc57a][_0x50482f(0x2f6)](_0x1913c4));});let _0x1d24d7=_0x5a21b7;if(_0x1ee26a(0x255)!==_0x45c36b&&(_0x1d24d7={},Array['isArray'](_0x45c36b)?_0x45c36b[_0x1ee26a(0x10e)](_0x5f33a2=>{_0x5a21b7[_0x5f33a2]&&(_0x1d24d7[_0x5f33a2]=_0x5a21b7[_0x5f33a2]);}):_0x5a21b7[_0x45c36b]&&(_0x1d24d7={[_0x45c36b]:_0x5a21b7[_0x45c36b]}),0x0===Object[_0x1ee26a(0x1b5)](_0x1d24d7)[_0x1ee26a(0x2a8)]))return _0x58ac3f[_0x1ee26a(0x1b6)](hideLoader),void _0x58ac3f['fmrUl'](showCustomAlert,_0x1ee26a(0x139),(Array['isArray'](_0x45c36b)?_0x1ee26a(0x1cc)+_0x45c36b['join'](',\x20'):_0x1ee26a(0x2a6)+_0x45c36b)+'\x20not\x20found\x20or\x20has\x20no\x20products.');const _0x445858=_0x58ac3f[_0x1ee26a(0x1f8)](_0x6ab018);if(Object[_0x1ee26a(0x1b5)](_0x1d24d7)['sort']((_0xc75635,_0xd3a160)=>_0xc75635-_0xd3a160)[_0x1ee26a(0x10e)](_0x1c2a07=>{const _0x33ad47=_0x1ee26a,_0x3d530d={'Ugfah':'N/A','OwQCD':_0x40c629[_0x33ad47(0x21d)]},_0x6b7336=_0x1d24d7[_0x1c2a07];_0x5204fd['push']({'Train':_0x33ad47(0x2a6)+_0x1c2a07+'\x20-\x20Worst\x20Case\x20Analysis','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),_0x6b7336[_0x33ad47(0x10e)](_0x6396dd=>{const _0x2e2f47=_0x33ad47,_0x45d5f8=_0x6396dd['activeIngredients'][_0x2e2f47(0x2d2)](_0x33e8f4=>_0x3cd623(_0x33e8f4,_0x445858)[_0x2e2f47(0x1b8)]);_0x6396dd['sortValue']=_0x40c629[_0x2e2f47(0x208)](_0x45d5f8['length'],0x0)?Math[_0x2e2f47(0x22a)](..._0x45d5f8):0x0;}),_0x6b7336[_0x33ad47(0x248)]((_0x582052,_0x115175)=>_0x115175['sortValue']-_0x582052[_0x33ad47(0x183)]),_0x6b7336[_0x33ad47(0x10e)](_0x3947b7=>{const _0x247779=_0x33ad47,_0x3de6fa={'dKWwI':function(_0x29b6f0,_0x22a9ef,_0x4db2f5){return _0x29b6f0(_0x22a9ef,_0x4db2f5);},'HOnZQ':_0x3d530d[_0x247779(0x328)]},_0x437589=_0x3947b7[_0x247779(0x289)]?_0x3d530d[_0x247779(0x109)]:'No';_0x5204fd[_0x247779(0x2f6)]({'Train':'','Product\x20Code':_0x3947b7[_0x247779(0x290)],'Product\x20Name':_0x3947b7[_0x247779(0xe3)],'Highest\x20RPN':_0x3947b7[_0x247779(0x183)],'Special\x20Case\x20Product':_0x437589,'Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),(_0x3947b7[_0x247779(0x2c5)][_0x247779(0x248)]((_0xa1d0ac,_0x294346)=>_0x3cd623(_0x294346,_0x445858)[_0x247779(0x1b8)]-_0x3cd623(_0xa1d0ac,_0x445858)['rpn'])['forEach'](_0xa81ee3=>{const _0x1f2313=_0x247779,_0x2a536f=_0x3de6fa[_0x1f2313(0xf3)](_0x3cd623,_0xa81ee3,_0x445858);_0x5204fd[_0x1f2313(0x2f6)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':_0xa81ee3[_0x1f2313(0xe3)],'TD\x20Score':_0x2a536f['therapeuticDoseScore'],'Solubility\x20Score':_0x2a536f[_0x1f2313(0x212)],'Cleanability\x20Score':_0x2a536f[_0x1f2313(0x21f)],'PDE\x20Score':_0x2a536f[_0x1f2313(0x151)]??_0x3de6fa[_0x1f2313(0x211)],'LD50\x20Score':_0x2a536f['ld50Score']??_0x3de6fa[_0x1f2313(0x211)],'RPN':_0x2a536f[_0x1f2313(0x1b8)],'Rating':_0x2a536f[_0x1f2313(0x25b)]});}),_0x5204fd[_0x247779(0x2f6)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}));});}),0x0===_0x5204fd[_0x1ee26a(0x2a8)])return _0x58ac3f['yOIMm'](hideLoader),void _0x58ac3f['fmrUl'](showCustomAlert,_0x58ac3f[_0x1ee26a(0x331)],_0x58ac3f[_0x1ee26a(0x1bf)]);const _0x11bb9f=XLSX[_0x1ee26a(0x217)][_0x1ee26a(0x186)](_0x5204fd),_0x2dba17=XLSX[_0x1ee26a(0x217)][_0x1ee26a(0x26d)]();XLSX[_0x1ee26a(0x217)][_0x1ee26a(0x23e)](_0x2dba17,_0x11bb9f,_0x58ac3f[_0x1ee26a(0x31c)]);const _0xd6ffe4=Object[_0x1ee26a(0x1b5)](_0x5204fd[0x0])['map'](_0xb77566=>({'wch':Math[_0x1ee26a(0x22a)](_0xb77566[_0x1ee26a(0x2a8)],..._0x5204fd[_0x1ee26a(0x2d2)](_0x1d2219=>String(_0x1d2219[_0xb77566]||'')[_0x1ee26a(0x2a8)]))+0x2}));_0x11bb9f[_0x58ac3f[_0x1ee26a(0x2e2)]]=_0xd6ffe4;const _0x1cc06b=new Date()[_0x1ee26a(0x119)]()['split']('T')[0x0];let _0x3381fb='';_0x58ac3f['jFDzy'](_0x58ac3f[_0x1ee26a(0x24c)],_0x45c36b)&&(_0x3381fb=Array[_0x1ee26a(0x28c)](_0x45c36b)?'_Trains_'+_0x45c36b[_0x1ee26a(0x31e)]('_'):'_Train_'+_0x45c36b),XLSX[_0x1ee26a(0x1c7)](_0x2dba17,_0x1ee26a(0x18c)+_0x3381fb+'_'+_0x1cc06b+_0x1ee26a(0x2b9)),_0x58ac3f[_0x1ee26a(0x24d)](hideLoader);})['catch'](_0x1b1797=>{const _0x4774ee=_0x5ad908;console['error'](_0x58ac3f[_0x4774ee(0x1fb)],_0x1b1797),_0x58ac3f['afnbq'](hideLoader),_0x58ac3f[_0x4774ee(0x276)](showCustomAlert,_0x58ac3f['DrCwe'],_0x58ac3f[_0x4774ee(0x20b)]);});}export function exportMachinesToExcel(){const _0x56bdbd=a13_0x407115,_0x339d59={'wvIQX':function(_0x2c2e4d,_0xbb482b){return _0x2c2e4d===_0xbb482b;},'HzzmG':function(_0x573c6e){return _0x573c6e();},'gozPu':function(_0x4fec39,_0x3076f0,_0x4016c9){return _0x4fec39(_0x3076f0,_0x4016c9);},'EAqNa':_0x56bdbd(0x126),'qVNMa':'Machines','RDToc':_0x56bdbd(0x180),'MfzyT':function(_0x36792a,_0xbe9924,_0xfe1617){return _0x36792a(_0xbe9924,_0xfe1617);},'ftJgl':_0x56bdbd(0x19a),'bbYzS':_0x56bdbd(0x2ca),'SGSBQ':_0x56bdbd(0x216)};showLoader();try{if(_0x339d59[_0x56bdbd(0x16c)](0x0,a13_0x4d29b2[_0x56bdbd(0x16e)][_0x56bdbd(0x2a8)]))return _0x339d59[_0x56bdbd(0x184)](hideLoader),void _0x339d59[_0x56bdbd(0x250)](showCustomAlert,_0x56bdbd(0x139),_0x339d59[_0x56bdbd(0x102)]);const _0x94118e=[],_0x111a20={};a13_0x4d29b2[_0x56bdbd(0x16e)][_0x56bdbd(0x10e)](_0x12de6c=>{const _0x254ee0=_0x56bdbd;_0x111a20[_0x12de6c[_0x254ee0(0xf8)]]||(_0x111a20[_0x12de6c[_0x254ee0(0xf8)]]=[]),_0x111a20[_0x12de6c[_0x254ee0(0xf8)]][_0x254ee0(0x2f6)](_0x12de6c);}),a13_0x4d29b2[_0x56bdbd(0x13b)]['forEach'](_0x3ec8ac=>{_0x111a20[_0x3ec8ac]&&_0x111a20[_0x3ec8ac]['forEach'](_0x1efec3=>{const _0x2f58f3=a13_0x2b75,_0x62abbf=a13_0x4d29b2[_0x2f58f3(0x24a)][_0x2f58f3(0x2d8)](_0x554cf0=>_0x554cf0[_0x2f58f3(0xfe)]&&_0x554cf0['machineIds'][_0x2f58f3(0x136)](_0x1efec3['id'])),_0x390b53=_0x62abbf[_0x2f58f3(0x2d2)](_0x38422f=>_0x38422f[_0x2f58f3(0xe3)])[_0x2f58f3(0x31e)](',\x20')||'None',_0x3bcfc8=_0x62abbf[_0x2f58f3(0x2a8)];_0x94118e['push']({'Machine\x20Number':_0x1efec3['machineNumber'],'Machine\x20Name':_0x1efec3['name'],'Stage':_0x1efec3[_0x2f58f3(0xf8)],'Area\x20(sq\x20cm)':_0x1efec3['area'],'Assigned\x20Products\x20Count':_0x3bcfc8,'Assigned\x20Products':_0x390b53});});});const _0x510a0a=XLSX[_0x56bdbd(0x217)][_0x56bdbd(0x186)](_0x94118e),_0x3e2859=XLSX['utils']['book_new']();XLSX['utils'][_0x56bdbd(0x23e)](_0x3e2859,_0x510a0a,_0x339d59[_0x56bdbd(0x2ef)]);const _0x4e80c0=[{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0xf},{'wch':0x14},{'wch':0x32}];_0x510a0a[_0x339d59[_0x56bdbd(0x2db)]]=_0x4e80c0;const _0x5378c8=new Date()['toISOString']()['split']('T')[0x0];XLSX[_0x56bdbd(0x1c7)](_0x3e2859,_0x56bdbd(0x127)+_0x5378c8+_0x56bdbd(0x2b9)),hideLoader(),_0x339d59[_0x56bdbd(0x27c)](showCustomAlert,_0x339d59[_0x56bdbd(0x1bd)],_0x339d59[_0x56bdbd(0x1ae)]);}catch(_0x41cf2d){console['error'](_0x339d59[_0x56bdbd(0x2f2)],_0x41cf2d),hideLoader(),_0x339d59[_0x56bdbd(0x27c)](showCustomAlert,'Error',_0x56bdbd(0x2a2));}}export function exportProductMacoToExcel(_0xa6219e=a13_0x407115(0x255)){const _0xc40d05=a13_0x407115,_0xa5ff9b={'XkuIy':_0xc40d05(0xfd),'rDCSg':function(_0x327dde,_0x51b619){return _0x327dde(_0x51b619);},'nUIjj':function(_0x3c484d,_0x31f4df){return _0x3c484d*_0x31f4df;},'bIbpb':function(_0x48aaa0,_0x3a08b2){return _0x48aaa0*_0x3a08b2;},'woHOR':function(_0x55d2bf,_0x497416){return _0x55d2bf!==_0x497416;},'ndKuO':function(_0x52a19f,_0x8668e8){return _0x52a19f*_0x8668e8;},'dQUeJ':_0xc40d05(0x1ab),'Bcwkj':_0xc40d05(0x146),'vvziT':function(_0x29f72e,_0x704753){return _0x29f72e/_0x704753;},'QaySe':_0xc40d05(0x2aa),'YdhXt':function(_0x496d26,_0x870838){return _0x496d26>_0x870838;},'ePLNl':_0xc40d05(0x293),'aPVPN':function(_0x29d5de,_0x1cfa19){return _0x29d5de!==_0x1cfa19;},'PMtmQ':function(_0xd7b30b,_0x193c63){return _0xd7b30b==_0x193c63;},'TcgKH':_0xc40d05(0x22b),'fJTkh':function(_0xd16813){return _0xd16813();},'eHVHM':function(_0x786331,_0x589c37){return _0x786331===_0x589c37;},'OcHcB':function(_0x41d083){return _0x41d083();},'IZgMr':function(_0x4891a1,_0x2f2444,_0x3c0884){return _0x4891a1(_0x2f2444,_0x3c0884);},'YnpUZ':_0xc40d05(0x139),'HSIyu':_0xc40d05(0x181),'IIRgf':function(_0x1ea387,_0x1e82db){return _0x1ea387!==_0x1e82db;},'rgxAs':_0xc40d05(0x255),'wEwCR':function(_0x2b8383,_0x75b70c){return _0x2b8383===_0x75b70c;},'tlfjN':_0xc40d05(0x1c5),'EilRb':'Product\x20MACO\x20Report','sjMez':_0xc40d05(0x2b2),'ZSHTd':function(_0x3add0d,_0x5440fb){return _0x3add0d!==_0x5440fb;},'BPCvN':_0xc40d05(0x19a),'AtpZt':_0xc40d05(0x200),'nzgSZ':function(_0x4dc7b4){return _0x4dc7b4();},'znfAR':_0xc40d05(0x20c),'hxMBl':_0xc40d05(0x244),'hzqiU':function(_0x422ca7){return _0x422ca7();},'rZitm':_0xc40d05(0x327)};_0xa5ff9b[_0xc40d05(0x1cb)](showLoader),import(_0xa5ff9b['rZitm'])[_0xc40d05(0x266)](_0x5e4d33=>{const _0x5de06d=_0xc40d05,{getTrainData:_0xf41b1e,getWorstCaseProductType:_0x59db0d,getMacoPerSwabForTrain:_0x457492}=_0x5e4d33,_0x4bde24=_0xa5ff9b[_0x5de06d(0x2b1)](_0xf41b1e);if(_0xa5ff9b[_0x5de06d(0x245)](0x0,_0x4bde24['length']))return _0xa5ff9b[_0x5de06d(0x2cb)](hideLoader),void _0xa5ff9b[_0x5de06d(0x33b)](showCustomAlert,_0xa5ff9b[_0x5de06d(0x107)],_0xa5ff9b['HSIyu']);let _0x8eeeae=_0x4bde24;if(_0xa5ff9b['IIRgf'](_0xa5ff9b['rgxAs'],_0xa6219e)&&(_0x8eeeae=Array[_0x5de06d(0x28c)](_0xa6219e)?_0x4bde24[_0x5de06d(0x2d8)](_0x5d4164=>_0xa6219e[_0x5de06d(0x136)](String(_0x5d4164['id']))):_0x4bde24[_0x5de06d(0x2d8)](_0x2b1d79=>String(_0x2b1d79['id'])===String(_0xa6219e))),_0xa5ff9b[_0x5de06d(0x231)](0x0,_0x8eeeae[_0x5de06d(0x2a8)]))return _0xa5ff9b[_0x5de06d(0x2cb)](hideLoader),void _0xa5ff9b[_0x5de06d(0x33b)](showCustomAlert,_0xa5ff9b[_0x5de06d(0x107)],_0xa5ff9b['tlfjN']);const _0x32ad6a=[],_0x2e4b92=_0x4bde24[_0x5de06d(0x2e6)]((_0x5df2ea,_0x4164bf)=>_0x4164bf[_0x5de06d(0x26e)]>_0x5df2ea['essa']?_0x4164bf:_0x5df2ea)[_0x5de06d(0x26e)];_0x8eeeae['forEach'](_0x1998ef=>{const _0x29a673=_0x5de06d,_0x1e2613={'OhjqM':function(_0x2ea29c,_0x38eda4){return _0x2ea29c||_0x38eda4;},'BxDDY':_0xa5ff9b['XkuIy']},_0x3ccd93=_0xa5ff9b[_0x29a673(0x1bc)](_0x59db0d,_0x1998ef[_0x29a673(0x24a)][_0x29a673(0x2d2)](_0x157b4c=>_0x157b4c[_0x29a673(0x103)])),_0x3de762=(a13_0x4d29b2[_0x29a673(0x306)][_0x3ccd93]||a13_0x4d29b2[_0x29a673(0x306)][_0x29a673(0x227)])[_0x29a673(0x22a)],_0x2cc67e=_0xa5ff9b['nUIjj'](_0x1998ef[_0x29a673(0x1cf)],_0x1998ef[_0x29a673(0x1e3)])/_0x3de762,_0x3eb815=_0xa5ff9b['bIbpb'](0xa,_0x1998ef['minMbsKg']);let _0xdd146b=_0xa5ff9b[_0x29a673(0x15f)];_0xa5ff9b[_0x29a673(0x18d)](null,_0x1998ef[_0x29a673(0x315)])&&(_0xdd146b=_0xa5ff9b[_0x29a673(0x1fd)](_0x1998ef[_0x29a673(0x315)],_0x1998ef[_0x29a673(0x1e3)]));const _0x34989c=_0xa5ff9b[_0x29a673(0x143)](0.004,_0x2e4b92),_0x2f265c=[{'name':_0xa5ff9b[_0x29a673(0xe4)],'value':_0x2cc67e},{'name':_0x29a673(0x2be),'value':_0x3eb815},{'name':_0xa5ff9b[_0x29a673(0xe2)],'value':'number'==typeof _0xdd146b?_0xdd146b:_0xa5ff9b['vvziT'](0x1,0x0)},{'name':_0xa5ff9b['QaySe'],'value':_0x34989c}][_0x29a673(0x2e6)]((_0x181d28,_0x11483d)=>_0x11483d[_0x29a673(0xda)]<_0x181d28[_0x29a673(0xda)]?_0x11483d:_0x181d28),_0x39a53b=_0x2f265c[_0x29a673(0xda)],_0x229406=_0xa5ff9b[_0x29a673(0x2f8)](_0x2e4b92,0x0)?_0xa5ff9b[_0x29a673(0x339)](_0x39a53b,_0x2e4b92):0x0,_0x4b9dd8=_0xa5ff9b[_0x29a673(0x1ec)](_0x229406,_0x1998ef[_0x29a673(0x169)]),_0x4f7ead=_0x1998ef[_0x29a673(0xfe)][_0x29a673(0x2d2)](_0x29055a=>{const _0x21e2de=_0x29a673,_0x5dd694=a13_0x4d29b2[_0x21e2de(0x16e)][_0x21e2de(0x1a8)](_0x5a7169=>_0x5a7169['id']===_0x29055a);return _0x1e2613['OhjqM'](_0x5dd694,{'name':_0x21e2de(0x32a)+_0x29055a+')','machineNumber':_0x1e2613[_0x21e2de(0x214)]});}),_0x591f4a=_0x5e4d33[_0x29a673(0xfa)](_0x1998ef[_0x29a673(0xfe)])[_0x29a673(0x2d2)](_0x54530a=>_0x54530a[_0x29a673(0x29d)]?_0x54530a['group']+'\x20('+_0x54530a[_0x29a673(0xe1)]+'x)':_0x54530a[_0x29a673(0xe3)])[_0x29a673(0x31e)](_0xa5ff9b[_0x29a673(0x145)]),_0x400cf7=_0x1998ef[_0x29a673(0x24a)][_0x29a673(0x2d2)](_0x436521=>_0x436521[_0x29a673(0x290)]+_0x29a673(0x24f)+_0x436521[_0x29a673(0xe3)])[_0x29a673(0x31e)](';\x20'),_0x2d58c7=_0x1998ef[_0x29a673(0x112)]?_0x1998ef['worstProductRpn']['productName']+'\x20('+_0x1998ef[_0x29a673(0x112)][_0x29a673(0x33c)]+_0x29a673(0x105)+_0x1998ef[_0x29a673(0x112)][_0x29a673(0x1b8)]:_0xa5ff9b[_0x29a673(0x15f)];_0x32ad6a[_0x29a673(0x2f6)]({'Train':'T'+_0x1998ef['id'],'Total\x20Products':_0x1998ef[_0x29a673(0x24a)][_0x29a673(0x2a8)],'Total\x20Machines':_0x4f7ead[_0x29a673(0x2a8)],'Total\x20Area\x20(ESSA)\x20cm²':_0x1998ef[_0x29a673(0x26e)][_0x29a673(0xe7)](),'Products':_0x400cf7,'Machines':_0x591f4a,'Worst-Case\x20Dosage\x20Form':_0x3ccd93,'Safety\x20Factor':_0x3de762,'Lowest\x20LTD\x20(mg)':_0x1998ef[_0x29a673(0x1cf)],'Min\x20Batch\x20Size\x20(kg)':_0x1998ef[_0x29a673(0x1e7)],'Min\x20BS/MDD\x20Ratio':_0x1998ef[_0x29a673(0x1e3)][_0x29a673(0x1d6)](0x2),'Lowest\x20PDE\x20(mg)':_0xa5ff9b[_0x29a673(0x12f)](null,_0x1998ef[_0x29a673(0x315)])?_0x1998ef[_0x29a673(0x315)]:'N/A','Worst-Case\x20Product\x20(by\x20RPN)':_0x2d58c7,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x2cc67e[_0x29a673(0x1d6)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x3eb815['toFixed'](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0xa5ff9b[_0x29a673(0x30f)](_0xa5ff9b[_0x29a673(0x173)],typeof _0xdd146b)?_0xdd146b[_0x29a673(0x1d6)](0x2):_0xa5ff9b[_0x29a673(0x15f)],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x34989c['toFixed'](0x2),'Selected\x20MACO\x20Method':_0x2f265c['name'],'Final\x20MACO\x20(mg)':_0x39a53b[_0x29a673(0x1d6)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x229406[_0x29a673(0x207)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x4b9dd8[_0x29a673(0x1d6)](0x4)});});const _0x2bd72c=XLSX[_0x5de06d(0x217)]['json_to_sheet'](_0x32ad6a),_0x3ad630=XLSX[_0x5de06d(0x217)][_0x5de06d(0x26d)]();XLSX[_0x5de06d(0x217)][_0x5de06d(0x23e)](_0x3ad630,_0x2bd72c,_0xa5ff9b[_0x5de06d(0xdb)]),_0x2bd72c[_0x5de06d(0x180)]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0x12},{'wch':0xf},{'wch':0x12},{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0x12},{'wch':0x12}];const _0x310a76=new Date()[_0x5de06d(0x119)]()[_0x5de06d(0x175)]('T')[0x0];let _0x16f449=_0xa5ff9b['sjMez'];if(_0xa5ff9b[_0x5de06d(0x197)](_0xa5ff9b[_0x5de06d(0x311)],_0xa6219e)){if(Array['isArray'](_0xa6219e))_0x16f449+=_0x5de06d(0x124)+_0xa6219e['sort']((_0x325e53,_0x3faa74)=>_0x325e53-_0x3faa74)[_0x5de06d(0x31e)]('_');else _0x16f449+='_Train_'+_0xa6219e;}_0x16f449+='_'+_0x310a76+_0x5de06d(0x2b9),XLSX[_0x5de06d(0x1c7)](_0x3ad630,_0x16f449),_0xa5ff9b[_0x5de06d(0x2b1)](hideLoader),showCustomAlert(_0xa5ff9b[_0x5de06d(0x1d2)],'Product\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!');})[_0xc40d05(0x1a4)](_0x481541=>{const _0x19e591=_0xc40d05;console['error'](_0xa5ff9b[_0x19e591(0x320)],_0x481541),_0xa5ff9b['nzgSZ'](hideLoader),_0xa5ff9b[_0x19e591(0x33b)](showCustomAlert,_0xa5ff9b[_0x19e591(0x288)],_0xa5ff9b[_0x19e591(0x1c4)]);});}export function exportDetergentMacoToExcel(_0x5dd08d=a13_0x407115(0x255)){const _0x1bb4b8=a13_0x407115,_0x231dc5={'LxqHF':function(_0x52b9f1,_0x2c96bb){return _0x52b9f1(_0x2c96bb);},'ZyIpl':function(_0x329020,_0x417ba5){return _0x329020>_0x417ba5;},'NVNMv':function(_0x56543c,_0x34b2fa){return _0x56543c/_0x34b2fa;},'UQekx':function(_0x3f2896,_0x4435d9){return _0x3f2896*_0x4435d9;},'GMLCV':_0x1bb4b8(0x293),'YTFoO':function(_0xee2370,_0x3de790){return _0xee2370!==_0x3de790;},'lFrKP':_0x1bb4b8(0x255),'BfSew':function(_0x3b8cd6,_0x47af87){return _0x3b8cd6===_0x47af87;},'iDjPd':function(_0x8e89c9){return _0x8e89c9();},'uayan':function(_0x3f5ddc,_0x2466df,_0x4039d0){return _0x3f5ddc(_0x2466df,_0x4039d0);},'sNLTB':_0x1bb4b8(0x181),'LejKG':function(_0x13c3ea,_0x20b798){return _0x13c3ea===_0x20b798;},'KvDqS':function(_0x3b6b0b){return _0x3b6b0b();},'NfVBU':'There\x20are\x20no\x20detergent\x20ingredients\x20configured.\x20Add\x20detergent\x20ingredients\x20first.','CjWZQ':_0x1bb4b8(0x1c8),'sgwgs':function(_0x4ef1c7,_0x12d36e){return _0x4ef1c7>_0x12d36e;},'qPnIs':_0x1bb4b8(0x1e2),'PigeR':'!cols','lgkwO':function(_0x196918,_0x2957de,_0x434cfa){return _0x196918(_0x2957de,_0x434cfa);},'nHjwL':_0x1bb4b8(0x19a),'mOBDW':_0x1bb4b8(0x237),'YJrRX':_0x1bb4b8(0x20c),'uuwWN':_0x1bb4b8(0x156),'sGIaN':_0x1bb4b8(0x327)};showLoader(),import(_0x231dc5[_0x1bb4b8(0x21a)])[_0x1bb4b8(0x266)](_0x3309d9=>{const _0x14a05c=_0x1bb4b8,_0x829f3a={'gAsJR':function(_0x24c55f,_0x1304f5){const _0x2256c9=a13_0x2b75;return _0x231dc5[_0x2256c9(0x1d7)](_0x24c55f,_0x1304f5);},'hNZji':function(_0x53b48d,_0x1baeb5){return _0x53b48d*_0x1baeb5;},'RQlLx':function(_0x505968,_0x46d5b8){const _0x16205f=a13_0x2b75;return _0x231dc5[_0x16205f(0x1a6)](_0x505968,_0x46d5b8);},'RChuN':function(_0x135828,_0x22b4e8){return _0x231dc5['NVNMv'](_0x135828,_0x22b4e8);},'QLRYA':function(_0x2db7ea,_0x18306c){return _0x231dc5['UQekx'](_0x2db7ea,_0x18306c);},'zdclD':_0x231dc5[_0x14a05c(0x257)],'WDUsE':_0x14a05c(0xfd)},{getTrainData:_0x32e786,getWorstCaseProductType:_0x4c82d6}=_0x3309d9;let _0x221628=_0x32e786();if(_0x231dc5['YTFoO'](_0x231dc5[_0x14a05c(0x292)],_0x5dd08d)&&(_0x221628=Array[_0x14a05c(0x28c)](_0x5dd08d)?_0x221628['filter'](_0x5a2457=>_0x5dd08d['includes'](String(_0x5a2457['id']))):_0x221628[_0x14a05c(0x2d8)](_0x92ac85=>String(_0x92ac85['id'])===String(_0x5dd08d))),_0x231dc5[_0x14a05c(0x29b)](0x0,_0x221628[_0x14a05c(0x2a8)]))return _0x231dc5['iDjPd'](hideLoader),void _0x231dc5[_0x14a05c(0x2b4)](showCustomAlert,_0x14a05c(0x139),_0x231dc5[_0x14a05c(0x179)]);if(_0x231dc5[_0x14a05c(0x312)](0x0,a13_0x4d29b2[_0x14a05c(0xfc)]['length']))return _0x231dc5[_0x14a05c(0x337)](hideLoader),void showCustomAlert(_0x14a05c(0x139),_0x231dc5[_0x14a05c(0x253)]);const _0x5b3957=[],_0x1bebf9=_0x231dc5[_0x14a05c(0x1a6)](_0x221628[_0x14a05c(0x2a8)],0x0)?Math[_0x14a05c(0x22a)](..._0x221628['map'](_0xc0c05=>_0xc0c05[_0x14a05c(0x26e)])):0x0,_0x30de6e=_0x231dc5['LxqHF'](parseFloat,document[_0x14a05c(0x2b5)](_0x231dc5[_0x14a05c(0x11a)])?.[_0x14a05c(0xda)])||0x46,_0x2099b0=a13_0x4d29b2['detergentIngredients'][_0x14a05c(0x2d2)](_0x4ba3b4=>parseFloat(_0x4ba3b4[_0x14a05c(0x27b)]))['filter'](_0x553732=>!isNaN(_0x553732)),_0x13a7d3=_0x231dc5['sgwgs'](_0x2099b0[_0x14a05c(0x2a8)],0x0)?Math[_0x14a05c(0x1df)](..._0x2099b0):0x0,_0x517dfe=a13_0x4d29b2[_0x14a05c(0xfc)][_0x14a05c(0x2d2)](_0x1a2cae=>_0x1a2cae[_0x14a05c(0xe3)])[_0x14a05c(0x2d8)](_0x56eafd=>''!==_0x56eafd[_0x14a05c(0xf0)]())[_0x14a05c(0x31e)](',\x20');_0x221628[_0x14a05c(0x10e)](_0x3d0a94=>{const _0x576662=_0x14a05c,_0x57c307=_0x829f3a[_0x576662(0x2eb)](_0x4c82d6,_0x3d0a94['products']['map'](_0x5730bb=>_0x5730bb[_0x576662(0x103)])),_0x7298b1=a13_0x4d29b2['safetyFactorConfig'][_0x57c307]||a13_0x4d29b2['safetyFactorConfig'][_0x576662(0x227)],_0x3f2a90=document['getElementById'](_0x576662(0x22d)+_0x3d0a94['id']),_0x54cbbc=_0x3f2a90&&_0x829f3a['gAsJR'](parseFloat,_0x3f2a90[_0x576662(0xda)])||_0x7298b1[_0x576662(0x22a)],_0x1ff00e=_0x829f3a['hNZji'](0.0005,_0x13a7d3)*_0x30de6e/_0x54cbbc,_0x2954be=_0x829f3a[_0x576662(0x265)](_0x1ff00e,_0x3d0a94['minBsMddRatio']),_0x35de6f=_0x829f3a[_0x576662(0x1a5)](_0x1bebf9,0x0)?_0x829f3a[_0x576662(0xff)](_0x2954be,_0x1bebf9):0x0,_0x55fed0=_0x829f3a['QLRYA'](_0x35de6f,_0x3d0a94['assumedSsa']),_0x1b9c82=_0x3d0a94[_0x576662(0xfe)][_0x576662(0x2d2)](_0x2c9aaf=>{const _0x3be980=_0x576662,_0x3426bd=a13_0x4d29b2[_0x3be980(0x16e)][_0x3be980(0x1a8)](_0x39f682=>_0x39f682['id']===_0x2c9aaf);return _0x3426bd||{'name':'Unknown\x20(ID:\x20'+_0x2c9aaf+')','machineNumber':_0x3be980(0xfd)};}),_0xee0f51=_0x3309d9[_0x576662(0xfa)](_0x3d0a94['machineIds'])[_0x576662(0x2d2)](_0x39a021=>_0x39a021[_0x576662(0x29d)]?_0x39a021['group']+'\x20('+_0x39a021[_0x576662(0xe1)]+'x)':_0x39a021[_0x576662(0xe3)])[_0x576662(0x31e)](_0x829f3a[_0x576662(0x277)]),_0x336cbb=_0x3d0a94[_0x576662(0x24a)]['map'](_0x4326c9=>_0x4326c9[_0x576662(0x290)]+'\x20-\x20'+_0x4326c9[_0x576662(0xe3)])[_0x576662(0x31e)](';\x20'),_0x3c1ae3=_0x3d0a94[_0x576662(0x112)]?_0x3d0a94[_0x576662(0x112)][_0x576662(0x171)]+'\x20('+_0x3d0a94[_0x576662(0x112)][_0x576662(0x33c)]+_0x576662(0x105)+_0x3d0a94[_0x576662(0x112)][_0x576662(0x1b8)]:_0x829f3a[_0x576662(0x1f7)];_0x5b3957[_0x576662(0x2f6)]({'Train':'T'+_0x3d0a94['id'],'Total\x20Products':_0x3d0a94[_0x576662(0x24a)][_0x576662(0x2a8)],'Total\x20Machines':_0x1b9c82['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x3d0a94[_0x576662(0x26e)]['toLocaleString'](),'Products':_0x336cbb,'Machines':_0xee0f51,'Worst-Case\x20Dosage\x20Form':_0x57c307,'Safety\x20Factor\x20Range':_0x7298b1[_0x576662(0x1df)]+'\x20-\x20'+_0x7298b1[_0x576662(0x22a)],'Applied\x20Safety\x20Factor':_0x54cbbc,'Detergent\x20Ingredients':_0x517dfe,'Body\x20Weight\x20(kg)':_0x30de6e,'Minimum\x20LD50\x20(mg/kg)':_0x13a7d3,'Min\x20Batch\x20Size\x20(kg)':_0x3d0a94[_0x576662(0x1e7)],'Min\x20BS/MDD\x20Ratio':_0x3d0a94[_0x576662(0x1e3)][_0x576662(0x1d6)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x3c1ae3,'ADI\x20(mg)':_0x1ff00e[_0x576662(0x1d6)](0x4),'MACO\x20(mg)':_0x2954be[_0x576662(0x1d6)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x35de6f[_0x576662(0x207)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x55fed0[_0x576662(0x1d6)](0x4)});});const _0x52531d=XLSX[_0x14a05c(0x217)][_0x14a05c(0x186)](_0x5b3957),_0x3bac92=XLSX[_0x14a05c(0x217)][_0x14a05c(0x26d)]();XLSX[_0x14a05c(0x217)][_0x14a05c(0x23e)](_0x3bac92,_0x52531d,_0x231dc5['qPnIs']),_0x52531d[_0x231dc5[_0x14a05c(0x330)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0x1e},{'wch':0xc},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0xc},{'wch':0xc},{'wch':0x12},{'wch':0x12}];const _0x5ad4ba=new Date()[_0x14a05c(0x119)]()['split']('T')[0x0];XLSX[_0x14a05c(0x1c7)](_0x3bac92,_0x14a05c(0x291)+_0x5ad4ba+'.xlsx'),hideLoader(),_0x231dc5[_0x14a05c(0xe0)](showCustomAlert,_0x231dc5[_0x14a05c(0x182)],_0x231dc5[_0x14a05c(0x316)]);})[_0x1bb4b8(0x1a4)](_0x336115=>{const _0xbb8bc1=_0x1bb4b8;console[_0xbb8bc1(0x2c9)]('Error\x20exporting\x20Detergent\x20MACO\x20to\x20Excel:',_0x336115),hideLoader(),_0x231dc5[_0xbb8bc1(0x2b4)](showCustomAlert,_0x231dc5['YJrRX'],_0x231dc5[_0xbb8bc1(0xe8)]);});}export function exportTrainSummaryToExcel(_0x4808b5=a13_0x407115(0x255)){const _0x7e8bdd=a13_0x407115,_0x2372e3={'uPobv':_0x7e8bdd(0x293),'dslku':function(_0x5bd5de,_0x4d2f66){return _0x5bd5de!==_0x4d2f66;},'nBmqG':function(_0x5dc444){return _0x5dc444();},'XyIae':function(_0x51fbc3){return _0x51fbc3();},'HQukQ':function(_0x51c206,_0x3fd547,_0x4c5098){return _0x51c206(_0x3fd547,_0x4c5098);},'jifWo':'No\x20Data','YqnHX':_0x7e8bdd(0x181),'zyAOn':function(_0x150726,_0x2c7e30){return _0x150726!==_0x2c7e30;},'SFZmS':_0x7e8bdd(0x255),'MsBxI':function(_0x126e19,_0x212baf){return _0x126e19===_0x212baf;},'aZHzH':_0x7e8bdd(0x1c5),'FbSFB':_0x7e8bdd(0x1f6),'ZKPNd':'Train_Summary_Report','mvlqP':function(_0xc7f03a,_0xbb4927){return _0xc7f03a!==_0xbb4927;},'YNRUR':_0x7e8bdd(0x19a),'mVdCB':_0x7e8bdd(0x1d1),'BKXUt':_0x7e8bdd(0x20c),'AQBhW':_0x7e8bdd(0x1ef)};_0x2372e3[_0x7e8bdd(0x20a)](showLoader),import(_0x7e8bdd(0x327))['then'](_0x4f150a=>{const _0x1f9f3b=_0x7e8bdd,_0x6ce56b={'erGJB':'N/A','hTHzK':_0x2372e3['uPobv'],'mCuqC':function(_0x48173f,_0x45e164){const _0x155c77=a13_0x2b75;return _0x2372e3[_0x155c77(0x209)](_0x48173f,_0x45e164);}},{getTrainData:_0x244b50}=_0x4f150a,_0x4f36a8=_0x2372e3[_0x1f9f3b(0xef)](_0x244b50);if(0x0===_0x4f36a8[_0x1f9f3b(0x2a8)])return _0x2372e3[_0x1f9f3b(0x20a)](hideLoader),void _0x2372e3[_0x1f9f3b(0x15a)](showCustomAlert,_0x2372e3[_0x1f9f3b(0x242)],_0x2372e3[_0x1f9f3b(0x174)]);let _0x542b42=_0x4f36a8;if(_0x2372e3[_0x1f9f3b(0x241)](_0x2372e3[_0x1f9f3b(0x1d3)],_0x4808b5)&&(_0x542b42=Array[_0x1f9f3b(0x28c)](_0x4808b5)?_0x4f36a8[_0x1f9f3b(0x2d8)](_0x4378bc=>_0x4808b5[_0x1f9f3b(0x136)](String(_0x4378bc['id']))):_0x4f36a8['filter'](_0x14a514=>String(_0x14a514['id'])===String(_0x4808b5))),_0x2372e3['MsBxI'](0x0,_0x542b42[_0x1f9f3b(0x2a8)]))return _0x2372e3[_0x1f9f3b(0x20a)](hideLoader),void showCustomAlert(_0x1f9f3b(0x139),_0x2372e3[_0x1f9f3b(0x26f)]);const _0x390b63=[];_0x542b42[_0x1f9f3b(0x10e)](_0x3f33de=>{const _0x2a331b=_0x1f9f3b,_0x456ba4=_0x3f33de[_0x2a331b(0xfe)]['map'](_0x52149a=>{const _0x5e2391=_0x2a331b,_0x1a16c2=a13_0x4d29b2[_0x5e2391(0x16e)][_0x5e2391(0x1a8)](_0x143f41=>_0x143f41['id']===_0x52149a);return _0x1a16c2||{'id':_0x52149a,'name':_0x5e2391(0x32a)+_0x52149a+')','machineNumber':_0x6ce56b[_0x5e2391(0x28a)]};}),_0x5ea9ae=_0x4f150a[_0x2a331b(0xfa)](_0x3f33de[_0x2a331b(0xfe)])[_0x2a331b(0x2d2)](_0x5a7a99=>_0x5a7a99[_0x2a331b(0x29d)]?_0x5a7a99['group']+'\x20('+_0x5a7a99['machineCount']+'x)':_0x5a7a99[_0x2a331b(0xe3)])[_0x2a331b(0x31e)](_0x6ce56b[_0x2a331b(0x27d)]),_0x533a76=_0x3f33de[_0x2a331b(0x24a)]['map'](_0x3a192c=>_0x3a192c['productCode']+_0x2a331b(0x24f)+_0x3a192c[_0x2a331b(0xe3)])[_0x2a331b(0x31e)](';\x20'),_0x3af802=_0x3f33de['products'][_0x2a331b(0x2d2)](_0x5f2897=>_0x5f2897[_0x2a331b(0x290)]+':\x20'+_0x5f2897[_0x2a331b(0xe3)])['join']('\x0a'),_0x247cac=_0x456ba4[_0x2a331b(0x2d2)](_0x824da5=>_0x824da5['machineNumber']+':\x20'+_0x824da5[_0x2a331b(0xe3)])[_0x2a331b(0x31e)]('\x0a');_0x390b63[_0x2a331b(0x2f6)]({'Train\x20ID':'T'+_0x3f33de['id'],'Products\x20Count':_0x3f33de[_0x2a331b(0x24a)]['length'],'Machines\x20Count':_0x456ba4[_0x2a331b(0x2a8)],'Total\x20Area\x20(ESSA)\x20cm²':_0x3f33de[_0x2a331b(0x26e)][_0x2a331b(0xe7)](),'Products\x20(Code\x20-\x20Name)':_0x533a76,'Machines\x20(Number\x20-\x20Name)':_0x5ea9ae,'Products\x20Detailed':_0x3af802,'Machines\x20Detailed':_0x247cac,'Min\x20Batch\x20Size\x20(kg)':_0x3f33de[_0x2a331b(0x1e7)],'Min\x20BS/MDD\x20Ratio':_0x3f33de[_0x2a331b(0x1e3)][_0x2a331b(0x1d6)](0x2),'Assumed\x20SSA\x20(cm²)':_0x3f33de['assumedSsa'],'Lowest\x20LTD\x20(mg)':_0x3f33de[_0x2a331b(0x1cf)],'Lowest\x20PDE\x20(mg)':_0x6ce56b[_0x2a331b(0x285)](null,_0x3f33de['lowestPde'])?_0x3f33de[_0x2a331b(0x315)]:_0x6ce56b[_0x2a331b(0x28a)],'Worst\x20RPN\x20Product':_0x3f33de['worstProductRpn']?_0x3f33de[_0x2a331b(0x112)][_0x2a331b(0x171)]+'\x20('+_0x3f33de[_0x2a331b(0x112)][_0x2a331b(0x33c)]+_0x2a331b(0x105)+_0x3f33de[_0x2a331b(0x112)][_0x2a331b(0x1b8)]:_0x6ce56b['erGJB']});});const _0x5a763e=XLSX[_0x1f9f3b(0x217)]['json_to_sheet'](_0x390b63),_0x727ec8=XLSX[_0x1f9f3b(0x217)][_0x1f9f3b(0x26d)]();XLSX[_0x1f9f3b(0x217)]['book_append_sheet'](_0x727ec8,_0x5a763e,_0x2372e3['FbSFB']),_0x5a763e[_0x1f9f3b(0x180)]=[{'wch':0xa},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x3c},{'wch':0x3c},{'wch':0x28},{'wch':0x28},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32}];const _0x5c04ad=new Date()[_0x1f9f3b(0x119)]()[_0x1f9f3b(0x175)]('T')[0x0];let _0xe608d0=_0x2372e3[_0x1f9f3b(0xea)];if(_0x2372e3[_0x1f9f3b(0x342)](_0x2372e3[_0x1f9f3b(0x1d3)],_0x4808b5)){if(Array[_0x1f9f3b(0x28c)](_0x4808b5))_0xe608d0+='_Trains_'+_0x4808b5['sort']((_0x3fc253,_0x39eb2c)=>_0x3fc253-_0x39eb2c)[_0x1f9f3b(0x31e)]('_');else _0xe608d0+=_0x1f9f3b(0x1ba)+_0x4808b5;}_0xe608d0+='_'+_0x5c04ad+_0x1f9f3b(0x2b9),XLSX['writeFile'](_0x727ec8,_0xe608d0),_0x2372e3[_0x1f9f3b(0xef)](hideLoader),_0x2372e3[_0x1f9f3b(0x15a)](showCustomAlert,_0x2372e3[_0x1f9f3b(0x160)],'Train\x20Summary\x20data\x20exported\x20to\x20Excel\x20successfully!');})['catch'](_0x2f2f87=>{const _0x99ee0=_0x7e8bdd;console[_0x99ee0(0x2c9)](_0x2372e3['mVdCB'],_0x2f2f87),_0x2372e3['nBmqG'](hideLoader),showCustomAlert(_0x2372e3[_0x99ee0(0x108)],_0x2372e3['AQBhW']);});}export function exportSummaryToExcel(){const _0x5f2145=a13_0x407115,_0x15f446={'HTeKX':function(_0x820ce7,_0x259c94){return _0x820ce7(_0x259c94);},'HAbiQ':function(_0x11b83c,_0x1c092a){return _0x11b83c(_0x1c092a);},'ONMng':function(_0x437087,_0x204793){return _0x437087>_0x204793;},'XvcVR':_0x5f2145(0xfd),'IXVWv':_0x5f2145(0x223),'GRoca':function(_0x4f8cf8,_0x56860a){return _0x4f8cf8===_0x56860a;},'JJZxl':function(_0x11c7b7){return _0x11c7b7();},'MyXWz':_0x5f2145(0x139),'yqxoE':_0x5f2145(0x189),'PebRH':function(_0x29c294,_0x447471){return _0x29c294>_0x447471;},'WqUnZ':_0x5f2145(0x180),'AvoIH':function(_0x286d34,_0x30e2f5){return _0x286d34>_0x30e2f5;},'ZRgcN':_0x5f2145(0x154),'EoQxQ':function(_0x393f8d){return _0x393f8d();},'fhEWi':function(_0x355bc2,_0x262f1f,_0x1b6043){return _0x355bc2(_0x262f1f,_0x1b6043);},'CAjoe':_0x5f2145(0x19a),'ywkQV':_0x5f2145(0x2c7),'eryGJ':_0x5f2145(0x271),'jcGir':function(_0xdcdc33){return _0xdcdc33();},'XPcLn':function(_0x16a996,_0x45ab5e,_0x16da36){return _0x16a996(_0x45ab5e,_0x16da36);},'fYRnm':_0x5f2145(0x20c),'IDNiP':_0x5f2145(0x100),'REsnM':_0x5f2145(0x327)};_0x15f446['jcGir'](showLoader),import(_0x15f446[_0x5f2145(0x262)])[_0x5f2145(0x266)](_0x27f842=>{const _0x56bbe7=_0x5f2145,{getProductTrainId:_0x314fa6,calculateScores:_0x442f00}=_0x27f842,_0x1d38a8=a13_0x4d29b2[_0x56bbe7(0x24a)][_0x56bbe7(0x162)](_0x1bcbbf=>{const _0x2069f2=_0x56bbe7,_0x494558=_0x15f446[_0x2069f2(0x165)](_0x314fa6,_0x1bcbbf);return _0x1bcbbf[_0x2069f2(0x2c5)][_0x2069f2(0x2d2)](_0x1ed881=>({'productName':_0x1bcbbf[_0x2069f2(0xe3)],'productCode':_0x1bcbbf['productCode'],'ingredientName':_0x1ed881['name'],'rpn':_0x442f00(_0x1ed881)[_0x2069f2(0x1b8)],'trainId':_0x2069f2(0xfd)!==_0x494558?'T'+_0x494558:_0x2069f2(0xfd),'scores':_0x442f00(_0x1ed881)}));})['sort']((_0x3d3fb5,_0x1bdc5c)=>_0x1bdc5c[_0x56bbe7(0x1b8)]-_0x3d3fb5['rpn'])[_0x56bbe7(0x19c)](0x0,0xa),_0x5436d1=a13_0x4d29b2[_0x56bbe7(0x24a)][_0x56bbe7(0x2d8)](_0x17a824=>_0x17a824[_0x56bbe7(0x289)]);if(_0x15f446[_0x56bbe7(0x1a2)](0x0,_0x1d38a8[_0x56bbe7(0x2a8)])&&_0x15f446['GRoca'](0x0,_0x5436d1[_0x56bbe7(0x2a8)]))return _0x15f446[_0x56bbe7(0x295)](hideLoader),void showCustomAlert(_0x15f446[_0x56bbe7(0x230)],_0x15f446[_0x56bbe7(0x144)]);const _0x53c261=XLSX[_0x56bbe7(0x217)]['book_new']();if(_0x15f446['PebRH'](_0x1d38a8[_0x56bbe7(0x2a8)],0x0)){const _0x591d8a=_0x1d38a8[_0x56bbe7(0x2d2)]((_0x40d816,_0x2bef69)=>({'Rank':_0x2bef69+0x1,'Product\x20Code':_0x40d816[_0x56bbe7(0x290)],'Product\x20Name':_0x40d816[_0x56bbe7(0x171)],'Train':_0x40d816[_0x56bbe7(0x2fb)],'Ingredient':_0x40d816[_0x56bbe7(0x33c)],'RPN':_0x40d816[_0x56bbe7(0x1b8)]})),_0x36b98e=XLSX[_0x56bbe7(0x217)][_0x56bbe7(0x186)](_0x591d8a),_0x46a1d3=[{'wch':0x8},{'wch':0xf},{'wch':0x1e},{'wch':0xa},{'wch':0x19},{'wch':0x8}];_0x36b98e[_0x15f446[_0x56bbe7(0x2c6)]]=_0x46a1d3,XLSX[_0x56bbe7(0x217)]['book_append_sheet'](_0x53c261,_0x36b98e,_0x56bbe7(0x334));}if(_0x15f446[_0x56bbe7(0x10f)](_0x5436d1[_0x56bbe7(0x2a8)],0x0)){const _0x867da9=_0x5436d1[_0x56bbe7(0x2d2)](_0x2278d1=>({'Product\x20Code':_0x2278d1['productCode'],'Product\x20Name':_0x2278d1['name'],'Product\x20Type':_0x2278d1[_0x56bbe7(0x103)],'Batch\x20Size\x20(kg)':_0x2278d1['batchSizeKg'],'MDD\x20(mg)':_0x2278d1[_0x56bbe7(0xee)],'Critical\x20Reason':_0x2278d1[_0x56bbe7(0x2a7)]||'No\x20reason\x20provided','Train':_0x56bbe7(0xfd)!==_0x314fa6(_0x2278d1)?'T'+_0x314fa6(_0x2278d1):'N/A'})),_0x3acd56=XLSX[_0x56bbe7(0x217)][_0x56bbe7(0x186)](_0x867da9),_0x4e19da=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32},{'wch':0xa}];_0x3acd56[_0x15f446[_0x56bbe7(0x2c6)]]=_0x4e19da,XLSX[_0x56bbe7(0x217)][_0x56bbe7(0x23e)](_0x53c261,_0x3acd56,_0x56bbe7(0xf6));}const _0xfd3b93=a13_0x4d29b2[_0x56bbe7(0x24a)]['map'](_0x1093be=>{const _0x46c153=_0x56bbe7,_0x2b7f3d={'GFAqo':function(_0x39c041,_0x318143){return _0x15f446['HAbiQ'](_0x39c041,_0x318143);},'uxOSo':function(_0xa6c520,_0xf8000d){return _0x15f446['ONMng'](_0xa6c520,_0xf8000d);}},_0x16306b=_0x314fa6(_0x1093be),_0x3f12cb=_0x1093be[_0x46c153(0x2c5)][_0x46c153(0x2e6)]((_0x3adcee,_0xb1186b)=>{const _0x2a2f04=_0x46c153,_0x452a95=_0x2b7f3d[_0x2a2f04(0x297)](_0x442f00,_0xb1186b)[_0x2a2f04(0x1b8)];return _0x2b7f3d[_0x2a2f04(0x187)](_0x452a95,_0x3adcee[_0x2a2f04(0x1b8)])?{..._0xb1186b,'rpn':_0x452a95}:_0x3adcee;},{'rpn':0x0,'name':_0x46c153(0xfd)});return{'Product\x20Code':_0x1093be[_0x46c153(0x290)],'Product\x20Name':_0x1093be[_0x46c153(0xe3)],'Product\x20Type':_0x1093be[_0x46c153(0x103)],'Batch\x20Size\x20(kg)':_0x1093be['batchSizeKg'],'MDD\x20(mg)':_0x1093be['mddMg'],'Train':_0x15f446[_0x46c153(0x2d7)]!==_0x16306b?'T'+_0x16306b:_0x15f446['XvcVR'],'Is\x20Critical':_0x1093be[_0x46c153(0x289)]?_0x15f446['IXVWv']:'No','Critical\x20Reason':_0x1093be[_0x46c153(0x2a7)]||_0x15f446[_0x46c153(0x2d7)],'Ingredients\x20Count':_0x1093be[_0x46c153(0x2c5)][_0x46c153(0x2a8)],'Highest\x20RPN\x20Ingredient':_0x3f12cb[_0x46c153(0xe3)],'Highest\x20RPN\x20Value':_0x3f12cb[_0x46c153(0x1b8)]||0x0};}),_0x1a9e4f=XLSX['utils'][_0x56bbe7(0x186)](_0xfd3b93);_0x1a9e4f[_0x15f446[_0x56bbe7(0x2c6)]]=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xa},{'wch':0xa},{'wch':0x28},{'wch':0xc},{'wch':0x19},{'wch':0xc}],XLSX[_0x56bbe7(0x217)][_0x56bbe7(0x23e)](_0x53c261,_0x1a9e4f,_0x15f446[_0x56bbe7(0x1e8)]);const _0x216175=new Date()[_0x56bbe7(0x119)]()[_0x56bbe7(0x175)]('T')[0x0];XLSX[_0x56bbe7(0x1c7)](_0x53c261,'MACO_Summary_Report_'+_0x216175+_0x56bbe7(0x2b9)),_0x15f446['EoQxQ'](hideLoader),_0x15f446['fhEWi'](showCustomAlert,_0x15f446[_0x56bbe7(0x1ff)],_0x15f446[_0x56bbe7(0x240)]);})['catch'](_0x196daf=>{const _0x1f5024=_0x5f2145;console[_0x1f5024(0x2c9)](_0x15f446[_0x1f5024(0x1e6)],_0x196daf),_0x15f446[_0x1f5024(0x247)](hideLoader),_0x15f446[_0x1f5024(0x18b)](showCustomAlert,_0x15f446[_0x1f5024(0x199)],_0x15f446['IDNiP']);});}export function exportAllTabsToExcel(){const _0x3522a5=a13_0x407115,_0x36e598={'NQEfD':'\x20→\x20','nEKTZ':function(_0x469986,_0x29dee7){return _0x469986(_0x29dee7);},'jOaqv':function(_0x133167,_0x47c061){return _0x133167!==_0x47c061;},'IazvK':_0x3522a5(0xfd),'HXses':'Yes','rAEDx':_0x3522a5(0x10c),'pVlGC':function(_0x450139,_0x1477b7){return _0x450139||_0x1477b7;},'PetPD':function(_0x4b2c1a,_0x5ef39a){return _0x4b2c1a/_0x5ef39a;},'iZKYM':function(_0xe65e6c,_0x2d5202){return _0xe65e6c*_0x2d5202;},'LwgUN':function(_0x531198,_0x31fedb){return _0x531198*_0x31fedb;},'JjeAv':_0x3522a5(0x1ab),'qNZQl':_0x3522a5(0x2be),'QiiQN':'Health-Based\x20Limit\x20(ADE)','ZWxzm':function(_0x53f049,_0x48f790){return _0x53f049==_0x48f790;},'aNiyn':'Visual\x20Clean\x20Limit','EeinO':function(_0x29b977,_0x482f32){return _0x29b977>_0x482f32;},'hSaVB':function(_0x45bef4,_0x8c142d){return _0x45bef4(_0x8c142d);},'yYxTM':function(_0x469a23,_0xc22fed){return _0x469a23(_0xc22fed);},'dcpET':function(_0x489ba7,_0x2642d9){return _0x489ba7*_0x2642d9;},'SmlOX':function(_0x316e47,_0x6a8cd2){return _0x316e47(_0x6a8cd2);},'yxQfJ':function(_0x37ae35,_0x2eabc4){return _0x37ae35(_0x2eabc4);},'QLbhl':function(_0x22eee4){return _0x22eee4();},'DhaqR':function(_0x4df17f,_0x2d98c6){return _0x4df17f===_0x2d98c6;},'Ropec':'There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','EcCqm':_0x3522a5(0x2cd),'KtoAw':_0x3522a5(0x2c4),'jZogF':function(_0x223f06,_0x129d97){return _0x223f06(_0x129d97);},'SyODy':_0x3522a5(0x1c8),'CDjFl':function(_0x28161c,_0xf620b5){return _0x28161c>_0xf620b5;},'UXpbd':_0x3522a5(0x20f),'OYLWC':_0x3522a5(0x2cf),'QhPHk':_0x3522a5(0x164),'iJTct':function(_0x2ec655,_0x55a11b){return _0x2ec655>_0x55a11b;},'QqcCb':function(_0x267159,_0x19688b){return _0x267159>_0x19688b;},'dVSuJ':'Critical\x20Products','BpaAh':_0x3522a5(0x25d),'QHShl':_0x3522a5(0x154),'WSnZI':_0x3522a5(0x12e),'VwJqT':function(_0x4eed06,_0x36502d,_0x19d3e1){return _0x4eed06(_0x36502d,_0x19d3e1);},'waLLa':'Success','IJXtW':'Complete\x20report\x20with\x20all\x20tabs\x20exported\x20to\x20Excel\x20successfully!','ZrNCn':_0x3522a5(0x11d),'tWTFP':_0x3522a5(0x20c),'yqKTm':_0x3522a5(0x327)};_0x36e598[_0x3522a5(0x2bd)](showLoader),import(_0x36e598[_0x3522a5(0x202)])[_0x3522a5(0x266)](_0x5991ea=>{const _0x491523=_0x3522a5,_0x1b12ec={'VsAvO':function(_0x2cf686,_0x48c0e2){const _0x28da07=a13_0x2b75;return _0x36e598[_0x28da07(0x153)](_0x2cf686,_0x48c0e2);},'HwXNg':function(_0x2bbab0,_0x3f8bc3){return _0x36e598['PetPD'](_0x2bbab0,_0x3f8bc3);},'GbJeB':function(_0x5922c4,_0x481de9){return _0x36e598['iZKYM'](_0x5922c4,_0x481de9);},'owVcy':_0x491523(0xfd),'taOZZ':function(_0x4f6629,_0x22d03c){return _0x4f6629!==_0x22d03c;},'iTsrZ':function(_0xaca1e3,_0xe4e64d){const _0x5c314d=_0x491523;return _0x36e598[_0x5c314d(0x27e)](_0xaca1e3,_0xe4e64d);},'woVci':function(_0xcc565e,_0x270944){return _0x36e598['LwgUN'](_0xcc565e,_0x270944);},'FoGSF':_0x36e598['JjeAv'],'KGqiw':_0x36e598[_0x491523(0x18a)],'HOMFy':_0x36e598[_0x491523(0x15c)],'YPkpY':function(_0x515776,_0x585f6c){const _0x190b97=_0x491523;return _0x36e598[_0x190b97(0x2d6)](_0x515776,_0x585f6c);},'aXMTw':_0x36e598['aNiyn'],'RwDCq':function(_0x103791,_0x5cae3d){const _0x310693=_0x491523;return _0x36e598[_0x310693(0x118)](_0x103791,_0x5cae3d);},'Ecyyh':function(_0x34b1c5,_0x2a1f00){return _0x34b1c5/_0x2a1f00;},'lRboV':function(_0x4b2985,_0x80e375){const _0x1d2eef=_0x491523;return _0x36e598[_0x1d2eef(0x17e)](_0x4b2985,_0x80e375);},'BBQoq':function(_0x257707,_0x2c48af){const _0x312728=_0x491523;return _0x36e598[_0x312728(0x1db)](_0x257707,_0x2c48af);},'xmYHI':function(_0x2b3e20,_0xab1702){return _0x36e598['dcpET'](_0x2b3e20,_0xab1702);},'XJxFk':function(_0x37d37f,_0x1110de){return _0x36e598['LwgUN'](_0x37d37f,_0x1110de);},'DJqkm':_0x36e598[_0x491523(0x10a)],'hnvpy':function(_0x2540aa,_0x4b148e){const _0x3f30ed=_0x491523;return _0x36e598[_0x3f30ed(0x192)](_0x2540aa,_0x4b148e);},'plXFK':function(_0x2475da,_0x2f0223){const _0x4c2ed5=_0x491523;return _0x36e598[_0x4c2ed5(0x235)](_0x2475da,_0x2f0223);},'rdVuM':_0x36e598[_0x491523(0x120)],'suTMo':_0x491523(0x188)},{getTrainData:_0x177022,getWorstCaseProductType:_0x411d7a,getProductTrainId:_0x3731bc,calculateScores:_0x17cc43}=_0x5991ea,_0x420799=_0x36e598[_0x491523(0x2bd)](_0x177022);if(_0x36e598[_0x491523(0xe5)](0x0,_0x420799[_0x491523(0x2a8)]))return hideLoader(),void showCustomAlert(_0x491523(0x139),_0x36e598['Ropec']);const _0x5a0045=XLSX['utils'][_0x491523(0x26d)]();try{const _0x5b746b=_0x420799['reduce']((_0x3a44c9,_0x321f3b)=>_0x321f3b['essa']>_0x3a44c9[_0x491523(0x26e)]?_0x321f3b:_0x3a44c9)[_0x491523(0x26e)],_0x38cc65=[];_0x420799[_0x491523(0x10e)](_0x39ad29=>{const _0x100910=_0x491523,_0x222b22={'qIUsx':function(_0x5a705e,_0x2c44f8){const _0x2732d2=a13_0x2b75;return _0x1b12ec[_0x2732d2(0x25f)](_0x5a705e,_0x2c44f8);}},_0x81a6bc=_0x411d7a(_0x39ad29[_0x100910(0x24a)][_0x100910(0x2d2)](_0x2b7d8e=>_0x2b7d8e[_0x100910(0x103)])),_0x43939e=(a13_0x4d29b2[_0x100910(0x306)][_0x81a6bc]||a13_0x4d29b2[_0x100910(0x306)][_0x100910(0x227)])['max'],_0x1f74d6=_0x1b12ec[_0x100910(0x18e)](_0x1b12ec[_0x100910(0x21e)](_0x39ad29[_0x100910(0x1cf)],_0x39ad29[_0x100910(0x1e3)]),_0x43939e),_0x383f81=0xa*_0x39ad29[_0x100910(0x1e7)];let _0x374427=_0x1b12ec[_0x100910(0x252)];_0x1b12ec[_0x100910(0x31b)](null,_0x39ad29['lowestPde'])&&(_0x374427=_0x1b12ec[_0x100910(0x22c)](_0x39ad29[_0x100910(0x315)],_0x39ad29[_0x100910(0x1e3)]));const _0x495281=_0x1b12ec[_0x100910(0xeb)](0.004,_0x5b746b),_0x49ea29=[{'name':_0x1b12ec[_0x100910(0x24b)],'value':_0x1f74d6},{'name':_0x1b12ec[_0x100910(0x2c3)],'value':_0x383f81},{'name':_0x1b12ec[_0x100910(0x233)],'value':_0x1b12ec[_0x100910(0x307)](_0x100910(0x22b),typeof _0x374427)?_0x374427:_0x1b12ec[_0x100910(0x18e)](0x1,0x0)},{'name':_0x1b12ec['aXMTw'],'value':_0x495281}][_0x100910(0x2e6)]((_0x57937a,_0xcabf57)=>_0xcabf57[_0x100910(0xda)]<_0x57937a[_0x100910(0xda)]?_0xcabf57:_0x57937a),_0x284133=_0x49ea29['value'],_0x1e93da=_0x1b12ec[_0x100910(0x336)](_0x5b746b,0x0)?_0x1b12ec['Ecyyh'](_0x284133,_0x5b746b):0x0,_0x2ddfb7=_0x1b12ec[_0x100910(0x22c)](_0x1e93da,_0x39ad29[_0x100910(0x169)]),_0x3e0f09=_0x39ad29['machineIds'][_0x100910(0x2d2)](_0x582ade=>{const _0x2aea84=_0x100910,_0x5db344=a13_0x4d29b2['machines'][_0x2aea84(0x1a8)](_0x3aec60=>_0x3aec60['id']===_0x582ade);return _0x222b22[_0x2aea84(0x155)](_0x5db344,{'name':'Unknown\x20(ID:\x20'+_0x582ade+')','machineNumber':_0x2aea84(0xfd)});}),_0x4d4810=_0x5991ea[_0x100910(0xfa)](_0x39ad29[_0x100910(0xfe)])[_0x100910(0x2d2)](_0x45d6aa=>_0x45d6aa[_0x100910(0x29d)]?_0x45d6aa[_0x100910(0x2b8)]+'\x20('+_0x45d6aa[_0x100910(0xe1)]+'x)':_0x45d6aa['name'])[_0x100910(0x31e)](_0x100910(0x293)),_0x24e629=_0x39ad29[_0x100910(0x24a)][_0x100910(0x2d2)](_0xb69508=>_0xb69508['productCode']+_0x100910(0x24f)+_0xb69508['name'])['join'](';\x20'),_0x2c7f74=_0x39ad29[_0x100910(0x112)]?_0x39ad29[_0x100910(0x112)][_0x100910(0x171)]+'\x20('+_0x39ad29[_0x100910(0x112)][_0x100910(0x33c)]+')\x20-\x20RPN:\x20'+_0x39ad29[_0x100910(0x112)]['rpn']:_0x1b12ec['owVcy'];_0x38cc65[_0x100910(0x2f6)]({'Train':'T'+_0x39ad29['id'],'Total\x20Products':_0x39ad29[_0x100910(0x24a)][_0x100910(0x2a8)],'Total\x20Machines':_0x3e0f09[_0x100910(0x2a8)],'Total\x20Area\x20(ESSA)\x20cm²':_0x39ad29['essa'][_0x100910(0xe7)](),'Products':_0x24e629,'Machines':_0x4d4810,'Worst-Case\x20Dosage\x20Form':_0x81a6bc,'Safety\x20Factor':_0x43939e,'Lowest\x20LTD\x20(mg)':_0x39ad29[_0x100910(0x1cf)],'Min\x20Batch\x20Size\x20(kg)':_0x39ad29[_0x100910(0x1e7)],'Min\x20BS/MDD\x20Ratio':_0x39ad29['minBsMddRatio'][_0x100910(0x1d6)](0x2),'Lowest\x20PDE\x20(mg)':_0x1b12ec[_0x100910(0x31b)](null,_0x39ad29[_0x100910(0x315)])?_0x39ad29[_0x100910(0x315)]:_0x1b12ec[_0x100910(0x252)],'Worst-Case\x20Product\x20(by\x20RPN)':_0x2c7f74,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x1f74d6['toFixed'](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x383f81[_0x100910(0x1d6)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':'number'==typeof _0x374427?_0x374427[_0x100910(0x1d6)](0x2):_0x100910(0xfd),'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x495281[_0x100910(0x1d6)](0x2),'Selected\x20MACO\x20Method':_0x49ea29[_0x100910(0xe3)],'Final\x20MACO\x20(mg)':_0x284133[_0x100910(0x1d6)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x1e93da[_0x100910(0x207)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x2ddfb7[_0x100910(0x1d6)](0x4)});});const _0x4e601f=XLSX[_0x491523(0x217)][_0x491523(0x186)](_0x38cc65);XLSX[_0x491523(0x217)][_0x491523(0x23e)](_0x5a0045,_0x4e601f,_0x36e598[_0x491523(0x195)]);}catch(_0x1b5a3c){console[_0x491523(0x2c9)](_0x36e598[_0x491523(0x196)],_0x1b5a3c);}try{if(a13_0x4d29b2[_0x491523(0xfc)][_0x491523(0x2a8)]>0x0){const _0x10b7d6=_0x36e598[_0x491523(0x118)](_0x420799[_0x491523(0x2a8)],0x0)?Math[_0x491523(0x22a)](..._0x420799[_0x491523(0x2d2)](_0x11ac39=>_0x11ac39[_0x491523(0x26e)])):0x0,_0x5a420c=_0x36e598['jZogF'](parseFloat,document['getElementById'](_0x36e598[_0x491523(0x210)])?.['value'])||0x46,_0x40449b=a13_0x4d29b2[_0x491523(0xfc)][_0x491523(0x2d2)](_0x2a7e81=>parseFloat(_0x2a7e81['ld50']))[_0x491523(0x2d8)](_0x4283e3=>!isNaN(_0x4283e3)),_0x19fde2=_0x36e598[_0x491523(0x30a)](_0x40449b[_0x491523(0x2a8)],0x0)?Math[_0x491523(0x1df)](..._0x40449b):0x0,_0x2c3ece=a13_0x4d29b2[_0x491523(0xfc)][_0x491523(0x2d2)](_0x43ad7d=>_0x43ad7d[_0x491523(0xe3)])[_0x491523(0x2d8)](_0x5b8378=>''!==_0x5b8378[_0x491523(0xf0)]())['join'](',\x20'),_0x8b2209=[];_0x420799[_0x491523(0x10e)](_0x8e0bd1=>{const _0x1eafbd=_0x491523,_0x59e700=_0x1b12ec['lRboV'](_0x411d7a,_0x8e0bd1['products'][_0x1eafbd(0x2d2)](_0x385837=>_0x385837[_0x1eafbd(0x103)])),_0xfd1f42=a13_0x4d29b2[_0x1eafbd(0x306)][_0x59e700]||a13_0x4d29b2[_0x1eafbd(0x306)][_0x1eafbd(0x227)],_0x2d767c=document[_0x1eafbd(0x2b5)](_0x1eafbd(0x22d)+_0x8e0bd1['id']),_0x4e2d4c=_0x2d767c&&_0x1b12ec[_0x1eafbd(0x2f1)](parseFloat,_0x2d767c[_0x1eafbd(0xda)])||_0xfd1f42[_0x1eafbd(0x22a)],_0xaea270=_0x1b12ec['GbJeB'](_0x1b12ec['iTsrZ'](0.0005,_0x19fde2),_0x5a420c)/_0x4e2d4c,_0x389824=_0x1b12ec['xmYHI'](_0xaea270,_0x8e0bd1['minBsMddRatio']),_0x152f4c=_0x10b7d6>0x0?_0x389824/_0x10b7d6:0x0,_0x50a0be=_0x1b12ec[_0x1eafbd(0x14b)](_0x152f4c,_0x8e0bd1[_0x1eafbd(0x169)]),_0x3e789b=_0x8e0bd1[_0x1eafbd(0xfe)][_0x1eafbd(0x2d2)](_0x344933=>{const _0x3a4aa8=_0x1eafbd,_0x4886d9=a13_0x4d29b2[_0x3a4aa8(0x16e)]['find'](_0x59072b=>_0x59072b['id']===_0x344933);return _0x4886d9||{'name':_0x3a4aa8(0x32a)+_0x344933+')','machineNumber':_0x1b12ec[_0x3a4aa8(0x252)]};}),_0x209cd1=_0x5991ea[_0x1eafbd(0xfa)](_0x8e0bd1[_0x1eafbd(0xfe)])[_0x1eafbd(0x2d2)](_0x5d30cf=>_0x5d30cf[_0x1eafbd(0x29d)]?_0x5d30cf[_0x1eafbd(0x2b8)]+'\x20('+_0x5d30cf['machineCount']+'x)':_0x5d30cf['name'])[_0x1eafbd(0x31e)](_0x1b12ec[_0x1eafbd(0x2ec)]),_0x5ab3d5=_0x8e0bd1[_0x1eafbd(0x24a)][_0x1eafbd(0x2d2)](_0x1484b3=>_0x1484b3[_0x1eafbd(0x290)]+_0x1eafbd(0x24f)+_0x1484b3['name'])[_0x1eafbd(0x31e)](';\x20'),_0x17ebfe=_0x8e0bd1[_0x1eafbd(0x112)]?_0x8e0bd1['worstProductRpn'][_0x1eafbd(0x171)]+'\x20('+_0x8e0bd1['worstProductRpn']['ingredientName']+_0x1eafbd(0x105)+_0x8e0bd1['worstProductRpn'][_0x1eafbd(0x1b8)]:_0x1b12ec['owVcy'];_0x8b2209[_0x1eafbd(0x2f6)]({'Train':'T'+_0x8e0bd1['id'],'Total\x20Products':_0x8e0bd1[_0x1eafbd(0x24a)]['length'],'Total\x20Machines':_0x3e789b[_0x1eafbd(0x2a8)],'Total\x20Area\x20(ESSA)\x20cm²':_0x8e0bd1[_0x1eafbd(0x26e)]['toLocaleString'](),'Products':_0x5ab3d5,'Machines':_0x209cd1,'Worst-Case\x20Dosage\x20Form':_0x59e700,'Safety\x20Factor\x20Range':_0xfd1f42[_0x1eafbd(0x1df)]+_0x1eafbd(0x24f)+_0xfd1f42[_0x1eafbd(0x22a)],'Applied\x20Safety\x20Factor':_0x4e2d4c,'Detergent\x20Ingredients':_0x2c3ece,'Body\x20Weight\x20(kg)':_0x5a420c,'Minimum\x20LD50\x20(mg/kg)':_0x19fde2,'Min\x20Batch\x20Size\x20(kg)':_0x8e0bd1[_0x1eafbd(0x1e7)],'Min\x20BS/MDD\x20Ratio':_0x8e0bd1[_0x1eafbd(0x1e3)][_0x1eafbd(0x1d6)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x17ebfe,'ADI\x20(mg)':_0xaea270['toFixed'](0x4),'MACO\x20(mg)':_0x389824[_0x1eafbd(0x1d6)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x152f4c[_0x1eafbd(0x207)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x50a0be['toFixed'](0x4)});});const _0x183ebb=XLSX[_0x491523(0x217)]['json_to_sheet'](_0x8b2209);XLSX['utils'][_0x491523(0x23e)](_0x5a0045,_0x183ebb,_0x36e598['UXpbd']);}}catch(_0x571afb){console[_0x491523(0x2c9)](_0x36e598[_0x491523(0x123)],_0x571afb);}try{const _0xc315db=[];_0x420799['forEach'](_0x3d1eaa=>{const _0x14d1fd=_0x491523,_0x11d31d=_0x3d1eaa[_0x14d1fd(0xfe)][_0x14d1fd(0x2d2)](_0xe025db=>{const _0x47149f=_0x14d1fd,_0x90d1d7=a13_0x4d29b2['machines'][_0x47149f(0x1a8)](_0x46c199=>_0x46c199['id']===_0xe025db);return _0x90d1d7||{'id':_0xe025db,'name':_0x47149f(0x32a)+_0xe025db+')','machineNumber':_0x1b12ec['owVcy']};}),_0x199b34=_0x5991ea['consolidateMachinesByGroup'](_0x3d1eaa[_0x14d1fd(0xfe)])[_0x14d1fd(0x2d2)](_0x21dbd9=>_0x21dbd9['isGroup']?_0x21dbd9['group']+'\x20('+_0x21dbd9['machineCount']+'x)':_0x21dbd9[_0x14d1fd(0xe3)])[_0x14d1fd(0x31e)](_0x36e598[_0x14d1fd(0x10a)]),_0x52f0db=_0x3d1eaa[_0x14d1fd(0x24a)]['map'](_0x3f8bc6=>_0x3f8bc6[_0x14d1fd(0x290)]+_0x14d1fd(0x24f)+_0x3f8bc6[_0x14d1fd(0xe3)])['join'](';\x20'),_0x5a9ef5=_0x3d1eaa[_0x14d1fd(0x24a)][_0x14d1fd(0x2d2)](_0x2c29f4=>_0x2c29f4[_0x14d1fd(0x290)]+':\x20'+_0x2c29f4[_0x14d1fd(0xe3)])[_0x14d1fd(0x31e)]('\x0a'),_0xf0cd63=_0x11d31d[_0x14d1fd(0x2d2)](_0x27aaff=>_0x27aaff['machineNumber']+':\x20'+_0x27aaff['name'])[_0x14d1fd(0x31e)]('\x0a');_0xc315db[_0x14d1fd(0x2f6)]({'Train\x20ID':'T'+_0x3d1eaa['id'],'Products\x20Count':_0x3d1eaa[_0x14d1fd(0x24a)][_0x14d1fd(0x2a8)],'Machines\x20Count':_0x11d31d[_0x14d1fd(0x2a8)],'Total\x20Area\x20(ESSA)\x20cm²':_0x3d1eaa[_0x14d1fd(0x26e)][_0x14d1fd(0xe7)](),'Products\x20(Code\x20-\x20Name)':_0x52f0db,'Machines\x20(Number\x20-\x20Name)':_0x199b34,'Products\x20Detailed':_0x5a9ef5,'Machines\x20Detailed':_0xf0cd63,'Min\x20Batch\x20Size\x20(kg)':_0x3d1eaa[_0x14d1fd(0x1e7)],'Min\x20BS/MDD\x20Ratio':_0x3d1eaa['minBsMddRatio'][_0x14d1fd(0x1d6)](0x2),'Assumed\x20SSA\x20(cm²)':_0x3d1eaa[_0x14d1fd(0x169)],'Lowest\x20LTD\x20(mg)':_0x3d1eaa[_0x14d1fd(0x1cf)],'Lowest\x20PDE\x20(mg)':null!==_0x3d1eaa[_0x14d1fd(0x315)]?_0x3d1eaa[_0x14d1fd(0x315)]:'N/A','Worst\x20RPN\x20Product':_0x3d1eaa[_0x14d1fd(0x112)]?_0x3d1eaa[_0x14d1fd(0x112)][_0x14d1fd(0x171)]+'\x20('+_0x3d1eaa['worstProductRpn']['ingredientName']+_0x14d1fd(0x105)+_0x3d1eaa['worstProductRpn'][_0x14d1fd(0x1b8)]:'N/A'});});const _0x50309e=XLSX['utils'][_0x491523(0x186)](_0xc315db);XLSX[_0x491523(0x217)][_0x491523(0x23e)](_0x5a0045,_0x50309e,_0x36e598['QhPHk']);}catch(_0x2b6abe){console[_0x491523(0x2c9)](_0x491523(0x140),_0x2b6abe);}try{const _0x49815a=a13_0x4d29b2[_0x491523(0x24a)][_0x491523(0x162)](_0x2cd2ee=>{const _0x22a230=_0x491523,_0x45ee28=_0x1b12ec[_0x22a230(0x33a)](_0x3731bc,_0x2cd2ee);return _0x2cd2ee[_0x22a230(0x2c5)][_0x22a230(0x2d2)](_0x3b4cfe=>({'productName':_0x2cd2ee[_0x22a230(0xe3)],'productCode':_0x2cd2ee[_0x22a230(0x290)],'ingredientName':_0x3b4cfe[_0x22a230(0xe3)],'rpn':_0x17cc43(_0x3b4cfe)[_0x22a230(0x1b8)],'trainId':'N/A'!==_0x45ee28?'T'+_0x45ee28:_0x22a230(0xfd)}));})[_0x491523(0x248)]((_0x4c0e3b,_0x25626a)=>_0x25626a['rpn']-_0x4c0e3b['rpn'])[_0x491523(0x19c)](0x0,0xa);if(_0x36e598[_0x491523(0x2e9)](_0x49815a[_0x491523(0x2a8)],0x0)){const _0x5758dc=_0x49815a[_0x491523(0x2d2)]((_0x1def6a,_0x25bc8c)=>({'Rank':_0x25bc8c+0x1,'Product\x20Code':_0x1def6a['productCode'],'Product\x20Name':_0x1def6a['productName'],'Train':_0x1def6a['trainId'],'Ingredient':_0x1def6a[_0x491523(0x33c)],'RPN':_0x1def6a['rpn']})),_0x2cd6bc=XLSX['utils'][_0x491523(0x186)](_0x5758dc);XLSX[_0x491523(0x217)][_0x491523(0x23e)](_0x5a0045,_0x2cd6bc,_0x491523(0x334));}}catch(_0x3be8fc){console[_0x491523(0x2c9)](_0x491523(0x2f4),_0x3be8fc);}try{const _0x225381=a13_0x4d29b2[_0x491523(0x24a)]['filter'](_0x2efdc2=>_0x2efdc2[_0x491523(0x289)]);if(_0x36e598[_0x491523(0x22e)](_0x225381[_0x491523(0x2a8)],0x0)){const _0x3edf8e=_0x225381['map'](_0x36962a=>({'Product\x20Code':_0x36962a[_0x491523(0x290)],'Product\x20Name':_0x36962a[_0x491523(0xe3)],'Product\x20Type':_0x36962a['productType'],'Batch\x20Size\x20(kg)':_0x36962a['batchSizeKg'],'MDD\x20(mg)':_0x36962a[_0x491523(0xee)],'Critical\x20Reason':_0x36962a[_0x491523(0x2a7)]||'No\x20reason\x20provided','Train':_0x491523(0xfd)!==_0x3731bc(_0x36962a)?'T'+_0x3731bc(_0x36962a):_0x491523(0xfd)})),_0x146c8e=XLSX[_0x491523(0x217)]['json_to_sheet'](_0x3edf8e);XLSX[_0x491523(0x217)]['book_append_sheet'](_0x5a0045,_0x146c8e,_0x36e598[_0x491523(0x322)]);}}catch(_0x55c36b){console[_0x491523(0x2c9)](_0x36e598[_0x491523(0x168)],_0x55c36b);}try{const _0x414c74=a13_0x4d29b2[_0x491523(0x24a)]['map'](_0x1da680=>{const _0x230815=_0x491523,_0x310e3b={'BYKOA':function(_0x12e726,_0x3f0573){const _0x2d0355=a13_0x2b75;return _0x1b12ec[_0x2d0355(0x2a4)](_0x12e726,_0x3f0573);}},_0x590e40=_0x1b12ec[_0x230815(0x177)](_0x3731bc,_0x1da680),_0x3e1971=_0x1da680[_0x230815(0x2c5)][_0x230815(0x2e6)]((_0x3a9706,_0x4c582b)=>{const _0x53bdaf=_0x230815,_0x59e464=_0x310e3b[_0x53bdaf(0x300)](_0x17cc43,_0x4c582b)[_0x53bdaf(0x1b8)];return _0x59e464>_0x3a9706[_0x53bdaf(0x1b8)]?{..._0x4c582b,'rpn':_0x59e464}:_0x3a9706;},{'rpn':0x0,'name':_0x1b12ec[_0x230815(0x252)]});return{'Product\x20Code':_0x1da680[_0x230815(0x290)],'Product\x20Name':_0x1da680['name'],'Product\x20Type':_0x1da680[_0x230815(0x103)],'Batch\x20Size\x20(kg)':_0x1da680[_0x230815(0x2cc)],'MDD\x20(mg)':_0x1da680[_0x230815(0xee)],'Train':'N/A'!==_0x590e40?'T'+_0x590e40:_0x1b12ec[_0x230815(0x252)],'Is\x20Critical':_0x1da680[_0x230815(0x289)]?_0x1b12ec[_0x230815(0x14e)]:'No','Critical\x20Reason':_0x1da680['criticalReason']||_0x1b12ec[_0x230815(0x252)],'Ingredients\x20Count':_0x1da680['activeIngredients'][_0x230815(0x2a8)],'Highest\x20RPN\x20Ingredient':_0x3e1971['name'],'Highest\x20RPN\x20Value':_0x3e1971['rpn']||0x0};}),_0x3f280e=XLSX[_0x491523(0x217)][_0x491523(0x186)](_0x414c74);XLSX[_0x491523(0x217)]['book_append_sheet'](_0x5a0045,_0x3f280e,_0x36e598[_0x491523(0x116)]);}catch(_0x34cc9c){console['error'](_0x491523(0x2b3),_0x34cc9c);}try{const _0x15a6d8=[];a13_0x4d29b2[_0x491523(0x24a)]['forEach'](_0x2bf908=>{const _0x390cbe=_0x491523,_0x38af2c=_0x36e598[_0x390cbe(0x16b)](_0x3731bc,_0x2bf908),_0x1e44d2={'Product\x20Code':_0x2bf908['productCode'],'Product\x20Name':_0x2bf908['name'],'Product\x20Type':_0x2bf908['productType'],'Batch\x20Size\x20(kg)':_0x2bf908[_0x390cbe(0x2cc)],'MDD\x20(mg)':_0x2bf908[_0x390cbe(0xee)],'Train':_0x36e598[_0x390cbe(0x280)](_0x36e598[_0x390cbe(0x273)],_0x38af2c)?'T'+_0x38af2c:_0x36e598[_0x390cbe(0x273)],'Is\x20Critical':_0x2bf908[_0x390cbe(0x289)]?_0x36e598[_0x390cbe(0x120)]:'No','Critical\x20Reason':_0x2bf908[_0x390cbe(0x2a7)]||_0x36e598[_0x390cbe(0x273)],'Ingredient\x20Type':_0x36e598['rAEDx'],'Ingredient\x20Name':'','LTD\x20(mg)':'','PDE\x20(mg)':'','LD50\x20(mg/kg)':'','Severity':'','Occurrence':'','Detection':'','RPN':''};_0x15a6d8[_0x390cbe(0x2f6)](_0x1e44d2),_0x2bf908[_0x390cbe(0x2c5)]['forEach'](_0x27bf84=>{const _0x4f83f5=_0x390cbe,_0x4f9211=_0x17cc43(_0x27bf84);_0x15a6d8[_0x4f83f5(0x2f6)]({'Product\x20Code':'','Product\x20Name':'','Product\x20Type':'','Batch\x20Size\x20(kg)':'','MDD\x20(mg)':'','Train':'','Is\x20Critical':'','Critical\x20Reason':'','Ingredient\x20Type':_0x1b12ec[_0x4f83f5(0x2ac)],'Ingredient\x20Name':_0x27bf84[_0x4f83f5(0xe3)],'LTD\x20(mg)':_0x27bf84[_0x4f83f5(0x104)]||_0x1b12ec[_0x4f83f5(0x252)],'PDE\x20(mg)':_0x27bf84[_0x4f83f5(0x283)]||_0x1b12ec[_0x4f83f5(0x252)],'LD50\x20(mg/kg)':_0x27bf84[_0x4f83f5(0x27b)]||_0x4f83f5(0xfd),'Severity':_0x4f9211[_0x4f83f5(0x15b)],'Occurrence':_0x4f9211[_0x4f83f5(0x1f2)],'Detection':_0x4f9211[_0x4f83f5(0x2e4)],'RPN':_0x4f9211[_0x4f83f5(0x1b8)]});});});const _0x3d4d41=XLSX['utils'][_0x491523(0x186)](_0x15a6d8);XLSX[_0x491523(0x217)][_0x491523(0x23e)](_0x5a0045,_0x3d4d41,_0x36e598[_0x491523(0x2f0)]);}catch(_0x191a54){console[_0x491523(0x2c9)](_0x491523(0xe6),_0x191a54);}const _0x166d47=new Date()['toISOString']()[_0x491523(0x175)]('T')[0x0];XLSX[_0x491523(0x1c7)](_0x5a0045,_0x491523(0x2a9)+_0x166d47+_0x491523(0x2b9)),_0x36e598[_0x491523(0x2bd)](hideLoader),_0x36e598[_0x491523(0x275)](showCustomAlert,_0x36e598[_0x491523(0x1bb)],_0x36e598[_0x491523(0x256)]);})['catch'](_0x17e116=>{const _0x3533a4=_0x3522a5;console[_0x3533a4(0x2c9)](_0x36e598[_0x3533a4(0x2f5)],_0x17e116),_0x36e598[_0x3533a4(0x2bd)](hideLoader),showCustomAlert(_0x36e598[_0x3533a4(0x1e4)],_0x3533a4(0x279));});}export function toggleStageSection(_0x570142){const _0x1c3378=a13_0x407115,_0x693a82={'bBuCo':function(_0x582b94,_0x9e79af){return _0x582b94===_0x9e79af;},'oDwEr':_0x1c3378(0x238),'lXegY':'button','nbigZ':_0x1c3378(0x176),'izuTE':'Show'},_0x4007dd=document['getElementById'](_0x1c3378(0x26b)+_0x570142),_0x59fe88=_0x693a82['bBuCo'](_0x693a82[_0x1c3378(0x170)],_0x4007dd[_0x1c3378(0x2bb)][_0x1c3378(0x32c)]);_0x4007dd['style'][_0x1c3378(0x32c)]=_0x59fe88?'':_0x693a82[_0x1c3378(0x170)],localStorage[_0x1c3378(0x131)]('machineStage-'+_0x570142+_0x1c3378(0x335),!_0x59fe88);const _0x8e07a=_0x4007dd['parentElement'][_0x1c3378(0xf7)](_0x693a82[_0x1c3378(0x141)]);_0x8e07a&&(_0x8e07a['textContent']=_0x59fe88?_0x693a82['nbigZ']:_0x693a82['izuTE']);}