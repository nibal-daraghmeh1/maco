const a13_0x16a2fa=a13_0x434f;(function(_0x2964bc,_0x30ca56){const _0x5230d3=a13_0x434f,_0x269aef=_0x2964bc();while(!![]){try{const _0x58d062=parseInt(_0x5230d3(0x1c7))/0x1*(-parseInt(_0x5230d3(0x25b))/0x2)+parseInt(_0x5230d3(0x2c0))/0x3+-parseInt(_0x5230d3(0x1e9))/0x4*(-parseInt(_0x5230d3(0x20a))/0x5)+parseInt(_0x5230d3(0xd3))/0x6+parseInt(_0x5230d3(0x16b))/0x7+parseInt(_0x5230d3(0x1bc))/0x8+-parseInt(_0x5230d3(0x2f8))/0x9*(parseInt(_0x5230d3(0x225))/0xa);if(_0x58d062===_0x30ca56)break;else _0x269aef['push'](_0x269aef['shift']());}catch(_0x242db8){_0x269aef['push'](_0x269aef['shift']());}}}(a13_0x4d53,0xc4615));import*as a13_0x210961 from'./state.js';import{fullAppRender as a13_0x178ab6}from'./app.js';import{generateTrainMap as a13_0x102e79}from'./utils.js';import{toggleScoringEditMode as a13_0x30184f}from'./scoringView.js';import{renderRpnChart as a13_0x1687fc}from'./worstCaseView.js';import{renderMacoChart as a13_0x41db8d}from'./dashboardView.js';const s=document[a13_0x16a2fa(0x2e0)](a13_0x16a2fa(0x113));export const showLoader=()=>s['style'][a13_0x16a2fa(0x200)]=a13_0x16a2fa(0x19b);export const hideLoader=()=>s['style'][a13_0x16a2fa(0x200)]=a13_0x16a2fa(0x236);export function showCustomAlert(_0x5f1287,_0x3ba24a){const _0x2c8aa9=a13_0x16a2fa,_0x3c2b38={'UHBdO':_0x2c8aa9(0x1d2),'HgYRJ':'customAlertMessage','UvkWt':_0x2c8aa9(0x19b)};document[_0x2c8aa9(0x2e0)](_0x3c2b38[_0x2c8aa9(0x11a)])[_0x2c8aa9(0x162)]=_0x5f1287,document[_0x2c8aa9(0x2e0)](_0x3c2b38[_0x2c8aa9(0x265)])['textContent']=_0x3ba24a,document[_0x2c8aa9(0x2e0)](_0x2c8aa9(0x179))[_0x2c8aa9(0x294)][_0x2c8aa9(0x200)]=_0x3c2b38[_0x2c8aa9(0x19a)];}export const hideModal=_0x139106=>document[a13_0x16a2fa(0x2e0)](_0x139106)[a13_0x16a2fa(0x294)][a13_0x16a2fa(0x200)]='none';export const showModal=_0x1e8d0a=>document[a13_0x16a2fa(0x2e0)](_0x1e8d0a)[a13_0x16a2fa(0x294)]['display']=a13_0x16a2fa(0x19b);export function saveAllDataToLocalStorage(){const _0xa30975=a13_0x16a2fa,_0x375104={'PrTLS':_0xa30975(0x1fc),'LAvIJ':_0xa30975(0x253),'IItqu':_0xa30975(0xf5),'qgyhR':_0xa30975(0x2c3),'gIfHL':function(_0x2930b6,_0x6ba1cc,_0x119d73){return _0x2930b6(_0x6ba1cc,_0x119d73);},'OqeTC':_0xa30975(0x1b9)};try{localStorage['setItem'](_0x375104[_0xa30975(0x193)],JSON[_0xa30975(0x1d5)](a13_0x210961[_0xa30975(0x1aa)])),localStorage['setItem'](_0x375104[_0xa30975(0x1e6)],JSON[_0xa30975(0x1d5)](a13_0x210961[_0xa30975(0x12c)])),localStorage[_0xa30975(0x1b8)](_0xa30975(0x19c),JSON[_0xa30975(0x1d5)](a13_0x210961['scoringCriteria'])),localStorage[_0xa30975(0x1b8)]('macoDetergentIngredients',JSON['stringify'](a13_0x210961[_0xa30975(0x2b9)])),localStorage['setItem'](_0x375104['IItqu'],JSON[_0xa30975(0x1d5)](a13_0x210961[_0xa30975(0xf5)]));}catch(_0x26bf4c){console[_0xa30975(0x10b)](_0x375104[_0xa30975(0x1d7)],_0x26bf4c),_0x375104[_0xa30975(0xf2)](showCustomAlert,_0x375104[_0xa30975(0x27e)],_0xa30975(0x110));}}export function loadAllDataFromLocalStorage(){const _0x101f28=a13_0x16a2fa,_0xb6ca1f={'cTGAC':'macoProducts','zwrwJ':_0x101f28(0x253),'GUGQX':_0x101f28(0x19c),'KkvJe':_0x101f28(0x26b),'ZrUVa':_0x101f28(0x1fd),'QQSit':_0x101f28(0x17e),'ZVwvV':_0x101f28(0x2dc),'lWxBI':_0x101f28(0xc7),'NZyTb':_0x101f28(0x22f)},_0x165467=localStorage[_0x101f28(0xed)](_0xb6ca1f[_0x101f28(0x305)]),_0x4a9496=localStorage[_0x101f28(0xed)](_0xb6ca1f[_0x101f28(0x1c8)]),_0x2d52ec=localStorage[_0x101f28(0xed)](_0xb6ca1f[_0x101f28(0x106)]),_0x5f1139=localStorage[_0x101f28(0xed)](_0xb6ca1f[_0x101f28(0xd1)]),_0x1b2850=localStorage[_0x101f28(0xed)](_0x101f28(0xf5));if(_0x165467)try{a13_0x210961[_0x101f28(0x165)](JSON[_0x101f28(0x1d4)](_0x165467));}catch(_0xea131a){console['error'](_0xb6ca1f[_0x101f28(0x12d)],_0xea131a);}if(_0x4a9496)try{a13_0x210961[_0x101f28(0xe6)](JSON['parse'](_0x4a9496));}catch(_0x9348bb){console[_0x101f28(0x10b)](_0xb6ca1f['QQSit'],_0x9348bb);}if(_0x2d52ec)try{a13_0x210961[_0x101f28(0x219)](JSON['parse'](_0x2d52ec));}catch(_0xb94130){console[_0x101f28(0x10b)](_0xb6ca1f[_0x101f28(0xfc)],_0xb94130);}if(_0x5f1139)try{a13_0x210961[_0x101f28(0x151)](JSON[_0x101f28(0x1d4)](_0x5f1139));}catch(_0x18bf1b){console[_0x101f28(0x10b)](_0xb6ca1f['lWxBI'],_0x18bf1b);}if(_0x1b2850)try{a13_0x210961[_0x101f28(0x1a8)](JSON[_0x101f28(0x1d4)](_0x1b2850));}catch(_0x56e51e){console['error'](_0xb6ca1f['NZyTb'],_0x56e51e);}}export function saveStateForUndo(){const _0xba8565=a13_0x16a2fa,_0x12552c={'Vovbl':function(_0x4fe34e){return _0x4fe34e();},'FWmRO':function(_0x36b394,_0x4dd83c){return _0x36b394+_0x4dd83c;},'mDSza':function(_0x1916f7,_0x2a88f5){return _0x1916f7-_0x2a88f5;},'RGNaq':function(_0x398f3f){return _0x398f3f();}};_0x12552c['Vovbl'](a13_0x102e79);const _0x1f1ad1=a13_0x210961['history'][_0xba8565(0x29d)](0x0,_0x12552c[_0xba8565(0x247)](a13_0x210961[_0xba8565(0x2d3)],0x1)),_0x8f0c44={'products':JSON[_0xba8565(0x1d4)](JSON[_0xba8565(0x1d5)](a13_0x210961['products'])),'machines':JSON['parse'](JSON[_0xba8565(0x1d5)](a13_0x210961['machines'])),'scoringCriteria':JSON[_0xba8565(0x1d4)](JSON['stringify'](a13_0x210961[_0xba8565(0x28f)])),'detergentIngredients':JSON[_0xba8565(0x1d4)](JSON[_0xba8565(0x1d5)](a13_0x210961['detergentIngredients']))};_0x1f1ad1[_0xba8565(0x182)](_0x8f0c44),a13_0x210961[_0xba8565(0x2eb)](_0x1f1ad1,_0x12552c[_0xba8565(0x1f3)](_0x1f1ad1['length'],0x1)),updateUndoRedoButtons(),_0x12552c[_0xba8565(0x2a0)](saveAllDataToLocalStorage);}export function updateUndoRedoButtons(){const _0x146c7c=a13_0x16a2fa,_0x2047ef={'LRqeP':_0x146c7c(0x204),'FvqfY':_0x146c7c(0x119),'dBMzT':function(_0xf48c5b,_0x1de58e){return _0xf48c5b<=_0x1de58e;},'KCuIo':function(_0x3edac4,_0x41847a){return _0x3edac4>=_0x41847a;},'RlXoJ':function(_0x37f474,_0x3dacbc){return _0x37f474-_0x3dacbc;}},_0xeb1aaa=document['getElementById'](_0x2047ef[_0x146c7c(0x13f)]),_0x36d36a=document['getElementById'](_0x2047ef[_0x146c7c(0x130)]);_0xeb1aaa&&(_0xeb1aaa[_0x146c7c(0x2d9)]=_0x2047ef[_0x146c7c(0x23b)](a13_0x210961[_0x146c7c(0x2d3)],0x0)),_0x36d36a&&(_0x36d36a['disabled']=_0x2047ef[_0x146c7c(0x307)](a13_0x210961['historyIndex'],_0x2047ef[_0x146c7c(0x15c)](a13_0x210961[_0x146c7c(0x1a0)]['length'],0x1)));}export function undoChange(){const _0x376c51=a13_0x16a2fa,_0x507084={'LWHoF':function(_0x493025,_0x2a076f){return _0x493025>_0x2a076f;},'bIjXe':function(_0x236e81,_0x321b1f){return _0x236e81(_0x321b1f);},'uhKiG':function(_0x40eb11){return _0x40eb11();},'kthCQ':function(_0x57dbf9){return _0x57dbf9();},'HcTbw':function(_0x3098f9){return _0x3098f9();}};if(_0x507084['LWHoF'](a13_0x210961[_0x376c51(0x2d3)],0x0)){const _0x4849ca=a13_0x210961['historyIndex']-0x1,_0x5b441a=a13_0x210961[_0x376c51(0x1a0)][_0x4849ca];a13_0x210961[_0x376c51(0x165)](JSON[_0x376c51(0x1d4)](JSON[_0x376c51(0x1d5)](_0x5b441a[_0x376c51(0x1aa)]))),a13_0x210961[_0x376c51(0xe6)](JSON['parse'](JSON['stringify'](_0x5b441a[_0x376c51(0x12c)]))),a13_0x210961['setScoringCriteria'](JSON[_0x376c51(0x1d4)](JSON[_0x376c51(0x1d5)](_0x5b441a['scoringCriteria']))),a13_0x210961['setDetergentIngredients'](JSON[_0x376c51(0x1d4)](JSON['stringify'](_0x5b441a[_0x376c51(0x2b9)]))),a13_0x210961[_0x376c51(0x2eb)](a13_0x210961[_0x376c51(0x1a0)],_0x4849ca),a13_0x210961[_0x376c51(0x27d)]&&_0x507084['bIjXe'](a13_0x30184f,!0x1),_0x507084['uhKiG'](a13_0x178ab6),_0x507084['kthCQ'](updateUndoRedoButtons),_0x507084[_0x376c51(0x26f)](saveAllDataToLocalStorage);}}export function redoChange(){const _0x1ad740=a13_0x16a2fa,_0x2d5468={'nFHZw':function(_0x3181c6,_0x28c9a7){return _0x3181c6<_0x28c9a7;},'NuzzB':function(_0x516a56,_0x4fcc71){return _0x516a56-_0x4fcc71;},'GqEhF':function(_0x46b197){return _0x46b197();},'EuGVv':function(_0x481c50){return _0x481c50();}};if(_0x2d5468[_0x1ad740(0x1c0)](a13_0x210961['historyIndex'],_0x2d5468[_0x1ad740(0x2db)](a13_0x210961['history'][_0x1ad740(0x20c)],0x1))){const _0x9fba57=a13_0x210961['historyIndex']+0x1,_0x3ad10a=a13_0x210961[_0x1ad740(0x1a0)][_0x9fba57];a13_0x210961['setProducts'](JSON[_0x1ad740(0x1d4)](JSON[_0x1ad740(0x1d5)](_0x3ad10a[_0x1ad740(0x1aa)]))),a13_0x210961[_0x1ad740(0xe6)](JSON[_0x1ad740(0x1d4)](JSON[_0x1ad740(0x1d5)](_0x3ad10a[_0x1ad740(0x12c)]))),a13_0x210961[_0x1ad740(0x219)](JSON[_0x1ad740(0x1d4)](JSON[_0x1ad740(0x1d5)](_0x3ad10a['scoringCriteria']))),a13_0x210961[_0x1ad740(0x151)](JSON[_0x1ad740(0x1d4)](JSON[_0x1ad740(0x1d5)](_0x3ad10a['detergentIngredients']))),a13_0x210961[_0x1ad740(0x2eb)](a13_0x210961['history'],_0x9fba57),a13_0x210961[_0x1ad740(0x27d)]&&a13_0x30184f(!0x1),_0x2d5468[_0x1ad740(0x14b)](a13_0x178ab6),_0x2d5468['EuGVv'](updateUndoRedoButtons),saveAllDataToLocalStorage();}}function a13_0x434f(_0x195759,_0x50b7a0){const _0x4d5349=a13_0x4d53();return a13_0x434f=function(_0x434f97,_0x4ad6da){_0x434f97=_0x434f97-0xc5;let _0x23d601=_0x4d5349[_0x434f97];return _0x23d601;},a13_0x434f(_0x195759,_0x50b7a0);}export function toggleDarkMode(_0x5f2b5c){const _0x362838=a13_0x16a2fa,_0x422801={'wAgkH':_0x362838(0x222),'awABH':_0x362838(0x23d),'fNOiA':_0x362838(0xe4),'cGQtr':'hidden','LQrnE':function(_0x2ff0a0){return _0x2ff0a0();}},_0x4b0498=document['getElementById'](_0x422801[_0x362838(0x2f9)]),_0x1b2bdf=document[_0x362838(0x2e0)](_0x422801[_0x362838(0xfa)]);_0x5f2b5c?(document[_0x362838(0x1e4)][_0x362838(0x2e7)][_0x362838(0x274)](_0x422801[_0x362838(0x24e)]),_0x4b0498&&_0x4b0498[_0x362838(0x2e7)][_0x362838(0x274)](_0x422801['cGQtr']),_0x1b2bdf&&_0x1b2bdf[_0x362838(0x2e7)][_0x362838(0x291)](_0x422801[_0x362838(0x24d)])):(document[_0x362838(0x1e4)][_0x362838(0x2e7)][_0x362838(0x291)](_0x422801[_0x362838(0x24e)]),_0x4b0498&&_0x4b0498[_0x362838(0x2e7)][_0x362838(0x291)](_0x422801['cGQtr']),_0x1b2bdf&&_0x1b2bdf[_0x362838(0x2e7)][_0x362838(0x274)](_0x422801[_0x362838(0x24d)])),a13_0x210961[_0x362838(0x11e)]&&_0x422801['LQrnE'](a13_0x1687fc),a13_0x210961[_0x362838(0x28a)]&&_0x422801[_0x362838(0x314)](a13_0x41db8d);}export function printCurrentView(_0x2b65b3,_0x8ec996='all'){const _0x10d9ae=a13_0x16a2fa,_0x1ad7f2={'oTzYH':_0x10d9ae(0x135),'rJTRR':_0x10d9ae(0x2da),'gAKlv':_0x10d9ae(0x312),'PXPXY':_0x10d9ae(0x12b),'EjqXF':function(_0xbd3cdd,_0x5bda93,_0x56da1a){return _0xbd3cdd(_0x5bda93,_0x56da1a);},'spOCA':function(_0x3cac08,_0x366f24,_0x1580bc){return _0x3cac08(_0x366f24,_0x1580bc);},'CaiNT':_0x10d9ae(0x2e3),'cdIqc':_0x10d9ae(0x1b5),'SVeaK':_0x10d9ae(0x212),'ydEVV':'Container\x20has\x20content:','DnJfB':function(_0x11012a,_0x42ff46){return _0x11012a>_0x42ff46;},'svblp':function(_0x2848e2,_0x24d83a){return _0x2848e2===_0x24d83a;},'THXqj':_0x10d9ae(0x236),'rtqsC':function(_0x2b268e,_0x3ebe80){return _0x2b268e(_0x3ebe80);},'PDoYf':'No\x20train\x20data\x20to\x20print.\x20Please\x20ensure\x20you\x20have\x20created\x20trains\x20first.','rvBoN':'Error\x20loading\x20train\x20summary\x20view:','ehFih':function(_0x46b64a,_0x1adb1b){return _0x46b64a+_0x1adb1b;},'XSAIp':'scoring-system','PTlDO':_0x10d9ae(0x22b),'laXwz':_0x10d9ae(0x108),'ozaib':function(_0x517d7,_0x53846d){return _0x517d7===_0x53846d;},'vIYpU':function(_0x41439d,_0x48221c){return _0x41439d===_0x48221c;},'lpgNd':'macoForTrains','ZyTMC':_0x10d9ae(0x114),'uhlus':'detergentMaco','dYycZ':_0x10d9ae(0x1e7),'ppTGI':_0x10d9ae(0xd7)};_0x1ad7f2[_0x10d9ae(0x217)](_0x1ad7f2[_0x10d9ae(0x156)],_0x2b65b3)&&a13_0x210961[_0x10d9ae(0x27d)]&&(a13_0x210961[_0x10d9ae(0x297)](!0x0),a13_0x30184f(!0x1)),console['log'](_0x1ad7f2[_0x10d9ae(0x159)],_0x2b65b3,_0x1ad7f2[_0x10d9ae(0x2be)],_0x8ec996),document[_0x10d9ae(0x299)]['classList'][_0x10d9ae(0x274)](_0x10d9ae(0x2a9)+_0x2b65b3),_0x1ad7f2['ozaib'](_0x10d9ae(0x215),_0x2b65b3)?import(_0x10d9ae(0x105))['then'](_0x58b1e8=>{const _0x667d03=_0x10d9ae;window[_0x667d03(0x10d)]=_0x8ec996,_0x58b1e8[_0x667d03(0x306)](),setTimeout(()=>{const _0x10a150=_0x667d03;window[_0x10a150(0x147)]();},0xc8);}):_0x1ad7f2[_0x10d9ae(0x12e)](_0x1ad7f2[_0x10d9ae(0x2b8)],_0x2b65b3)?(window['printSelectedTrain']=_0x8ec996,import(_0x1ad7f2[_0x10d9ae(0x2ff)])[_0x10d9ae(0x283)](_0x412490=>{const _0x4ac929=_0x10d9ae,_0x5eecd9={'sgvYd':_0x1ad7f2[_0x4ac929(0x160)],'QvYcl':function(_0x57c951,_0x2c32d5,_0x2cffb6){return _0x57c951(_0x2c32d5,_0x2cffb6);}};_0x412490['renderMacoForTrains']();const _0x3796f6=document[_0x4ac929(0xf6)](_0x1ad7f2['gAKlv']),_0x47549e=[];_0x3796f6[_0x4ac929(0x177)](_0x3b1c5b=>{const _0x5ddac0=_0x4ac929,_0x2706aa=_0x3b1c5b['id'][_0x5ddac0(0x201)](/content-pm-(\d+)/);if(_0x2706aa){_0x47549e[_0x5ddac0(0x182)](_0x2706aa[0x1]),_0x3b1c5b[_0x5ddac0(0x2e7)]['remove'](_0x1ad7f2[_0x5ddac0(0x160)]);const _0x53cece=document['getElementById'](_0x5ddac0(0xf3)+_0x2706aa[0x1]);_0x53cece&&(_0x53cece[_0x5ddac0(0x162)]='▼');}});const _0x1994fa=document[_0x4ac929(0xf6)](_0x1ad7f2['PXPXY']),_0x1c739d=[];_0x1994fa[_0x4ac929(0x177)](_0x2a174f=>{const _0x13f2c8=_0x4ac929,_0x173c2f=_0x2a174f['id'][_0x13f2c8(0x201)](/maco-breakdown-details-(\d+)/);if(_0x173c2f){_0x1c739d[_0x13f2c8(0x182)](_0x173c2f[0x1]),_0x2a174f[_0x13f2c8(0x2e7)]['remove'](_0x1ad7f2[_0x13f2c8(0x190)]);const _0x594752=document['getElementById'](_0x13f2c8(0x104)+_0x173c2f[0x1]);_0x594752&&(_0x594752[_0x13f2c8(0x162)]=_0x13f2c8(0x264));}}),_0x1ad7f2[_0x4ac929(0x1da)](setTimeout,()=>{const _0x15d5a9=_0x4ac929,_0x4b70c3={'mpGHV':_0x5eecd9[_0x15d5a9(0x1a3)],'gBrHZ':'hidden'};window[_0x15d5a9(0x147)](),_0x5eecd9[_0x15d5a9(0x21c)](setTimeout,()=>{const _0x2b7560=_0x15d5a9;_0x47549e[_0x2b7560(0x177)](_0x4592f5=>{const _0x5887aa=_0x2b7560,_0x31bca2=document['getElementById'](_0x5887aa(0x1cf)+_0x4592f5),_0xd9fafd=document[_0x5887aa(0x2e0)](_0x5887aa(0xf3)+_0x4592f5);_0x31bca2&&_0x31bca2[_0x5887aa(0x2e7)]['add'](_0x4b70c3[_0x5887aa(0x276)]),_0xd9fafd&&(_0xd9fafd[_0x5887aa(0x162)]='▶');}),_0x1c739d['forEach'](_0x5a91ed=>{const _0x39c59c=_0x2b7560,_0x180214=document[_0x39c59c(0x2e0)]('maco-breakdown-details-'+_0x5a91ed),_0x5aaa23=document['getElementById']('breakdown-toggle-btn-'+_0x5a91ed);_0x180214&&_0x180214[_0x39c59c(0x2e7)]['add'](_0x4b70c3[_0x39c59c(0x29a)]),_0x5aaa23&&(_0x5aaa23[_0x39c59c(0x162)]=_0x39c59c(0x117));});},0x3e8);},0xc8);})):_0x1ad7f2[_0x10d9ae(0x112)]===_0x2b65b3?(window['printSelectedTrain']=_0x8ec996,import(_0x10d9ae(0x23a))[_0x10d9ae(0x283)](_0x507a72=>{const _0x271c63=_0x10d9ae,_0x1cf67c={'mVMRA':_0x1ad7f2[_0x271c63(0x160)],'yRyCQ':function(_0x57f8b5,_0x4fabb2,_0x557fff){const _0x304d1b=_0x271c63;return _0x1ad7f2[_0x304d1b(0xd4)](_0x57f8b5,_0x4fabb2,_0x557fff);}};_0x507a72[_0x271c63(0xd6)]();const _0x420fbc=document['querySelectorAll'](_0x1ad7f2[_0x271c63(0x254)]),_0x13e074=[];_0x420fbc[_0x271c63(0x177)](_0x298175=>{const _0x5ecb27=_0x271c63,_0x5eda8d=_0x298175['id'][_0x5ecb27(0x201)](/content-dm-(\d+)/);if(_0x5eda8d){_0x13e074[_0x5ecb27(0x182)](_0x5eda8d[0x1]),_0x298175['classList'][_0x5ecb27(0x291)](_0x1cf67c[_0x5ecb27(0x2c2)]);const _0x30f320=document[_0x5ecb27(0x2e0)](_0x5ecb27(0xe0)+_0x5eda8d[0x1]);_0x30f320&&(_0x30f320['textContent']='▼');}}),_0x1ad7f2[_0x271c63(0x1da)](setTimeout,()=>{const _0x3b426a=_0x271c63;window[_0x3b426a(0x147)](),_0x1cf67c[_0x3b426a(0x229)](setTimeout,()=>{const _0x26c8db=_0x3b426a,_0x442d1c={'DbEJh':_0x1cf67c['mVMRA']};_0x13e074[_0x26c8db(0x177)](_0x2cc64a=>{const _0x692d4c=_0x26c8db,_0xfaff40=document['getElementById'](_0x692d4c(0x1ec)+_0x2cc64a),_0x1a7a00=document[_0x692d4c(0x2e0)](_0x692d4c(0xe0)+_0x2cc64a);_0xfaff40&&_0xfaff40[_0x692d4c(0x2e7)]['add'](_0x442d1c[_0x692d4c(0x248)]),_0x1a7a00&&(_0x1a7a00['textContent']='▶');});},0x3e8);},0xc8);})[_0x10d9ae(0x278)](_0x111bc7=>{const _0x492c68=_0x10d9ae;console['error'](_0x1ad7f2[_0x492c68(0x272)],_0x111bc7),window['print']();})[_0x10d9ae(0x171)](()=>{const _0x1f97d5=_0x10d9ae;_0x1ad7f2[_0x1f97d5(0xd4)](setTimeout,()=>{const _0x5bf8e0=_0x1f97d5;window[_0x5bf8e0(0x10d)]=null,import(_0x5bf8e0(0x23a))[_0x5bf8e0(0x283)](_0x49fa0e=>_0x49fa0e[_0x5bf8e0(0xd6)]())[_0x5bf8e0(0x278)](()=>{});},0x4b0);})):_0x1ad7f2['vIYpU'](_0x1ad7f2[_0x10d9ae(0x1d6)],_0x2b65b3)?(window[_0x10d9ae(0x10d)]=_0x8ec996,console['log']('Setting\x20printSelectedTrain\x20to:',_0x8ec996),import(_0x1ad7f2['ppTGI'])[_0x10d9ae(0x283)](_0x589794=>{const _0x235c3d=_0x10d9ae,_0x28a9da={'mRGYn':_0x1ad7f2[_0x235c3d(0x1cb)],'OnyXx':'not\x20found','aHqzm':_0x1ad7f2[_0x235c3d(0x2bb)],'GtelR':function(_0x4a6894,_0x540d66){const _0x3c2511=_0x235c3d;return _0x1ad7f2[_0x3c2511(0x26c)](_0x4a6894,_0x540d66);},'LlXEX':function(_0x2ee472,_0x1d6fcc){return _0x1ad7f2['svblp'](_0x2ee472,_0x1d6fcc);},'sRDwM':_0x1ad7f2[_0x235c3d(0x2f3)],'XFVDb':function(_0x22163e,_0x4e2ccd){return _0x1ad7f2['rtqsC'](_0x22163e,_0x4e2ccd);},'QYDjQ':_0x1ad7f2[_0x235c3d(0x1b6)],'HGdpV':function(_0x1e34c0,_0x357937,_0x243996){return _0x1ad7f2['spOCA'](_0x1e34c0,_0x357937,_0x243996);}};_0x589794['renderTrainSummary'](),_0x1ad7f2[_0x235c3d(0xd4)](setTimeout,()=>{const _0x21a730=_0x235c3d,_0x1a54f4=document[_0x21a730(0x2e0)]('trainSummaryContainer'),_0x4e1ea6=document['getElementById'](_0x21a730(0x198));if(console[_0x21a730(0x316)](_0x21a730(0x218),_0x1a54f4?_0x1a54f4[_0x21a730(0x294)]['display']:_0x21a730(0x30d)),console[_0x21a730(0x316)](_0x28a9da[_0x21a730(0x210)],_0x4e1ea6?_0x4e1ea6['style'][_0x21a730(0x200)]:_0x28a9da[_0x21a730(0x163)]),console[_0x21a730(0x316)](_0x28a9da[_0x21a730(0x1f6)],!!_0x1a54f4&&_0x28a9da[_0x21a730(0x1b7)](_0x1a54f4[_0x21a730(0x1f5)][_0x21a730(0x20c)],0x0)),!_0x1a54f4||_0x28a9da['LlXEX'](_0x28a9da[_0x21a730(0x1f7)],_0x1a54f4[_0x21a730(0x294)][_0x21a730(0x200)]))return console[_0x21a730(0x161)](_0x21a730(0x1eb)),void _0x28a9da[_0x21a730(0x2d7)](alert,_0x28a9da[_0x21a730(0x242)]);window[_0x21a730(0x147)](),_0x28a9da[_0x21a730(0x230)](setTimeout,()=>{const _0x1ac9e5=_0x21a730;window[_0x1ac9e5(0x10d)]=null,_0x589794[_0x1ac9e5(0x281)]();},0x3e8);},0x1f4);})[_0x10d9ae(0x278)](_0x1b32bf=>{const _0x50d503=_0x10d9ae;console[_0x50d503(0x10b)](_0x1ad7f2[_0x50d503(0x26d)],_0x1b32bf),alert(_0x1ad7f2[_0x50d503(0x2df)](_0x50d503(0x22e),_0x1b32bf[_0x50d503(0x220)]));})):setTimeout(()=>{const _0x13cfe7=_0x10d9ae;window[_0x13cfe7(0x147)]();},0x64);}export function toggleColumn(_0x3875e5,_0x287d68){const _0x5102b2=a13_0x16a2fa,_0x41e8e7={'DdOai':function(_0x44e82b,_0x296e75){return _0x44e82b===_0x296e75;},'Yhpui':_0x5102b2(0x2fb),'dYPIU':_0x5102b2(0x129),'pJuVk':_0x5102b2(0x215),'tYIcc':function(_0x183b9a,_0x385818){return _0x183b9a(_0x385818);},'JRVgL':_0x5102b2(0x21e),'wZwzb':function(_0x566137,_0x3c9da6){return _0x566137(_0x3c9da6);},'PqnsV':function(_0x7f9812,_0x1e90e7){return _0x7f9812!==_0x1e90e7;},'HOceO':function(_0x2121cf,_0x12112b){return _0x2121cf(_0x12112b);}};if(_0x41e8e7['DdOai'](_0x41e8e7[_0x5102b2(0xe5)],_0x3875e5)||_0x41e8e7[_0x5102b2(0xfb)]===_0x3875e5){['productRegister',_0x41e8e7[_0x5102b2(0x2e6)]]['forEach'](_0x577768=>{const _0x4dcddb=_0x5102b2;document['querySelectorAll']('#'+_0x577768+_0x4dcddb(0x27b)+_0x577768+_0x4dcddb(0x2d8))[_0x4dcddb(0x177)](_0x56ceb1=>{const _0xfe6ad5=_0x4dcddb;_0x56ceb1[_0xfe6ad5(0x2e7)]['toggle']('hide-'+_0x3875e5);}),document['querySelectorAll']('#'+_0x577768+_0x4dcddb(0x216)+_0x577768+_0x4dcddb(0x196))[_0x4dcddb(0x177)](_0x586d79=>{const _0x57b542=_0x4dcddb;_0x586d79&&_0x586d79[_0x57b542(0x2e7)]['toggle'](_0x57b542(0x168)+_0x3875e5);});});const _0xf9c316=null!==document['querySelector'](_0x5102b2(0x26e)+_0x3875e5);localStorage[_0x5102b2(0x1b8)]('productRegister-'+_0x3875e5+_0x5102b2(0x150),_0xf9c316),_0x41e8e7[_0x5102b2(0x2ec)](updateToggleIcons,_0x41e8e7[_0x5102b2(0x1ce)]),_0x41e8e7[_0x5102b2(0x1db)](updateToggleIcons,_0x41e8e7[_0x5102b2(0x2e6)]),import(_0x5102b2(0x105))[_0x5102b2(0x283)](_0x30d1dd=>{const _0x203c6f=_0x5102b2;_0x30d1dd[_0x203c6f(0x306)]();}),import(_0x5102b2(0x105))[_0x5102b2(0x283)](_0x1354bb=>{const _0x191993=_0x5102b2;_0x1354bb[_0x191993(0xcf)]&&_0x1354bb[_0x191993(0xcf)]();});}else{document[_0x5102b2(0xf6)]('#'+_0x287d68+_0x5102b2(0x27b)+_0x287d68+_0x5102b2(0x2d8))[_0x5102b2(0x177)](_0x2a1928=>{const _0x5a0a01=_0x5102b2;_0x2a1928[_0x5a0a01(0x2e7)][_0x5a0a01(0x136)]('hide-'+_0x3875e5);});const _0x5798a1=_0x41e8e7['PqnsV'](null,document[_0x5102b2(0x127)]('#'+_0x287d68+_0x5102b2(0x121)+_0x3875e5));localStorage['setItem'](_0x287d68+'-'+_0x3875e5+'Hidden',_0x5798a1),_0x41e8e7[_0x5102b2(0x30c)](updateToggleIcons,_0x287d68);}}export function toggleColumnVisibilityDropdown(){const _0x48781b=a13_0x16a2fa,_0x1e96fe={'QjAJv':_0x48781b(0xee),'WUKUP':_0x48781b(0x1d0),'crdPg':_0x48781b(0x2da),'kCcda':_0x48781b(0x15d),'YTpjR':'columnVisibilityDropdown'},_0x5d77a9=document[_0x48781b(0x2e0)](_0x1e96fe[_0x48781b(0x20d)]);_0x5d77a9[_0x48781b(0x2e7)][_0x48781b(0x136)](_0x1e96fe[_0x48781b(0x11c)]),_0x5d77a9[_0x48781b(0x2e7)][_0x48781b(0x29e)](_0x1e96fe[_0x48781b(0x11c)])||document['addEventListener'](_0x1e96fe[_0x48781b(0x2cb)],function _0x292042(_0x2c34b1){const _0x54ae8e=_0x48781b;_0x2c34b1['target']['closest'](_0x1e96fe[_0x54ae8e(0x21f)])||_0x2c34b1[_0x54ae8e(0xca)][_0x54ae8e(0xde)](_0x1e96fe[_0x54ae8e(0x2b2)])||(_0x5d77a9[_0x54ae8e(0x2e7)]['add'](_0x1e96fe[_0x54ae8e(0x11c)]),document[_0x54ae8e(0x1fb)](_0x1e96fe[_0x54ae8e(0x2cb)],_0x292042));});}export function updateToggleIcons(_0x2d88f8){const _0x34488d=a13_0x16a2fa,_0x5d8da5={'kjAXh':_0x34488d(0x21d),'gZIXO':'hide-ld50','NvzeD':_0x34488d(0x215),'IOqgz':_0x34488d(0x2d0),'DwSAg':function(_0x233245,_0x1212fd){return _0x233245===_0x1212fd;},'LBqfU':_0x34488d(0x197),'kGdvo':function(_0x3d2a94,_0x56aac0){return _0x3d2a94&&_0x56aac0;},'kowZM':_0x34488d(0xec),'ikkgG':'.toggle-ld50','OOVKz':_0x34488d(0x27a),'YnCLo':_0x34488d(0x256),'fyoAm':_0x34488d(0x17d),'UzEJs':'Hide\x20LD50'},_0x3e4463=document[_0x34488d(0x2e0)](_0x2d88f8);if(!_0x3e4463)return;let _0x234faa,_0x148bd5;if(_0x5d8da5[_0x34488d(0x298)]===_0x2d88f8){const _0x467f59=localStorage[_0x34488d(0xed)](_0x34488d(0x14c)),_0x45d51d=localStorage[_0x34488d(0xed)](_0x5d8da5[_0x34488d(0x103)]);if(_0x5d8da5['DwSAg'](null,_0x467f59)&&null===_0x45d51d)_0x234faa=!0x1,_0x148bd5=!0x1;else{const _0x418835=_0x5d8da5[_0x34488d(0xf8)](_0x5d8da5['LBqfU'],_0x467f59),_0x4e9f4c=_0x5d8da5['LBqfU']===_0x45d51d;_0x5d8da5[_0x34488d(0x2c6)](_0x418835,_0x4e9f4c)?(_0x234faa=!0x1,_0x148bd5=!0x0):(_0x234faa=_0x418835,_0x148bd5=_0x4e9f4c);}}else{const _0x12bb07=localStorage[_0x34488d(0xed)](_0x2d88f8+_0x34488d(0x2a3)),_0x5d60e5=localStorage[_0x34488d(0xed)](_0x2d88f8+_0x34488d(0x100));_0x234faa=_0x5d8da5['LBqfU']===_0x12bb07,_0x148bd5=_0x5d8da5[_0x34488d(0xf8)](_0x5d8da5['LBqfU'],_0x5d60e5);}const _0x482645=_0x3e4463[_0x34488d(0x127)](_0x5d8da5['kowZM']),_0x265925=_0x3e4463[_0x34488d(0x127)](_0x5d8da5['ikkgG']);_0x482645&&(_0x482645['innerHTML']=_0x234faa?_0x5d8da5[_0x34488d(0x2f4)]:_0x5d8da5[_0x34488d(0x195)]),_0x265925&&(_0x265925[_0x34488d(0x1f5)]=_0x148bd5?_0x5d8da5[_0x34488d(0xcc)]:_0x5d8da5[_0x34488d(0x126)]),document[_0x34488d(0xf6)]('#'+_0x2d88f8+_0x34488d(0x27b)+_0x2d88f8+_0x34488d(0x2d8))['forEach'](_0x367d9d=>{const _0x1dbf6c=_0x34488d;_0x367d9d&&(_0x367d9d[_0x1dbf6c(0x2e7)][_0x1dbf6c(0x136)](_0x5d8da5[_0x1dbf6c(0x2aa)],_0x234faa),_0x367d9d['classList'][_0x1dbf6c(0x136)](_0x5d8da5[_0x1dbf6c(0x143)],_0x148bd5));}),document['querySelectorAll']('#'+_0x2d88f8+_0x34488d(0x216)+_0x2d88f8+_0x34488d(0x196))['forEach'](_0x386a20=>{const _0x483a4f=_0x34488d;_0x386a20&&(_0x386a20[_0x483a4f(0x2e7)][_0x483a4f(0x136)](_0x5d8da5['kjAXh'],_0x234faa),_0x386a20[_0x483a4f(0x2e7)][_0x483a4f(0x136)](_0x5d8da5[_0x483a4f(0x143)],_0x148bd5));});}export function exportToExcel(){const _0xdc249=a13_0x16a2fa,_0x20824c={'QDafr':function(_0x5c7931,_0x18cd7d){return _0x5c7931+_0x18cd7d;},'ylJYR':function(_0x2e91d4,_0x105954){return _0x2e91d4(_0x105954);},'CUgDu':function(_0x5ae0f7,_0x3655dd){return _0x5ae0f7===_0x3655dd;},'sGnZP':_0xdc249(0x25d),'QVJbb':'MACO\x20Report','pOtPk':function(_0x15e575){return _0x15e575();},'EwFGw':'Error\x20exporting\x20to\x20Excel:','tZHuk':_0xdc249(0x2de),'NbyiX':'./utils.js'};showLoader(),import(_0x20824c[_0xdc249(0x16a)])[_0xdc249(0x283)](_0x1f887e=>{const _0x39c789=_0xdc249,{getProductTrainId:_0x2e0861,calculateScores:_0x58d522}=_0x1f887e,_0x2af9b5=[];if(a13_0x210961[_0x39c789(0x1aa)][_0x39c789(0x177)](_0x15d0f8=>{const _0x440a68=_0x39c789,_0x3cd674={'qIKMA':function(_0x5c331e,_0x136b21){return _0x5c331e(_0x136b21);}};let _0x11b6ea='No';_0x15d0f8[_0x440a68(0x13d)]&&(_0x11b6ea=_0x20824c['QDafr']('Yes',_0x15d0f8[_0x440a68(0x26a)]?':\x20'+_0x15d0f8[_0x440a68(0x26a)]:''));const _0xb74411=_0x20824c[_0x440a68(0x313)](_0x2e0861,_0x15d0f8),_0x5b85c7=_0x15d0f8[_0x440a68(0x241)]?new Date(_0x15d0f8[_0x440a68(0x241)])[_0x440a68(0x169)]():'';_0x2af9b5[_0x440a68(0x182)]({'Date':_0x5b85c7,'Product\x20Code':_0x15d0f8[_0x440a68(0x2bd)],'Product\x20Name':_0x15d0f8[_0x440a68(0x2f0)],'Train\x20No.':_0xb74411,'Dosage\x20Form':_0x15d0f8[_0x440a68(0x16f)]||'','Batch\x20Size\x20(Kg)':_0x15d0f8[_0x440a68(0x205)],'Special\x20Case\x20Product':_0x11b6ea,'Active\x20Ingredient':'','Solubility':'','Therapeutic\x20Dose\x20(mg/day)':'','Cleanability':'','PDE\x20(µg/day)':'','LD50\x20(mg/kg)':'','Solubility\x20Score':'','Therapeutic\x20Dose\x20Score':'','Cleanability\x20Score':'','Toxicity\x20Score':'','RPN':'','RPN\x20Rating':''}),_0x15d0f8['activeIngredients'][_0x440a68(0x177)](_0x101326=>{const _0xf151d3=_0x440a68,_0xdf956e=_0x3cd674[_0xf151d3(0xd2)](_0x58d522,_0x101326);_0x2af9b5[_0xf151d3(0x182)]({'Date':'','Product\x20Code':'','Product\x20Name':'\x20\x20└─\x20'+_0x101326[_0xf151d3(0x2f0)],'Train\x20No.':'','Dosage\x20Form':'','Batch\x20Size\x20(Kg)':'','Special\x20Case\x20Product':'','Active\x20Ingredient':_0x101326[_0xf151d3(0x2f0)],'Solubility':_0x101326['solubility']||'','Therapeutic\x20Dose\x20(mg/day)':_0x101326[_0xf151d3(0xf0)]||'','Cleanability':_0x101326['cleanability']||'','PDE\x20(µg/day)':_0x101326['pde']||'','LD50\x20(mg/kg)':_0x101326[_0xf151d3(0x129)]||'','Solubility\x20Score':_0xdf956e[_0xf151d3(0x295)]||'','Therapeutic\x20Dose\x20Score':_0xdf956e['therapeuticDoseScore']||'','Cleanability\x20Score':_0xdf956e[_0xf151d3(0x251)]||'','Toxicity\x20Score':_0xdf956e[_0xf151d3(0xe3)]||_0xdf956e[_0xf151d3(0x304)]||'','RPN':_0xdf956e[_0xf151d3(0x15a)],'RPN\x20Rating':_0xdf956e[_0xf151d3(0x12a)]});});}),_0x20824c[_0x39c789(0xd9)](0x0,_0x2af9b5[_0x39c789(0x20c)]))return hideLoader(),void showCustomAlert(_0x20824c[_0x39c789(0x1df)],_0x39c789(0xdb));const _0x1f9c26=XLSX[_0x39c789(0x2e9)][_0x39c789(0x2fd)](_0x2af9b5),_0x3182de=XLSX[_0x39c789(0x2e9)][_0x39c789(0x2a5)]();XLSX[_0x39c789(0x2e9)]['book_append_sheet'](_0x3182de,_0x1f9c26,_0x20824c['QVJbb']);const _0x3b4a33=Object[_0x39c789(0x234)](_0x2af9b5[0x0])[_0x39c789(0x1a2)](_0x2b7f85=>({'wch':Math[_0x39c789(0x14f)](_0x2b7f85[_0x39c789(0x20c)],..._0x2af9b5[_0x39c789(0x1a2)](_0x5e8e6e=>String(_0x5e8e6e[_0x2b7f85]||'')[_0x39c789(0x20c)]))+0x2}));_0x1f9c26[_0x39c789(0x146)]=_0x3b4a33,XLSX[_0x39c789(0x18b)](_0x3182de,'MACO_All_Products_Report.xlsx'),_0x20824c[_0x39c789(0x29b)](hideLoader);})[_0xdc249(0x278)](_0x2560b9=>{const _0x5f355e=_0xdc249;console[_0x5f355e(0x10b)](_0x20824c['EwFGw'],_0x2560b9),hideLoader(),showCustomAlert(_0x5f355e(0x228),_0x20824c[_0x5f355e(0x132)]);});}export function exportAllToJson(){const _0x212739=a13_0x16a2fa,_0x3d39bc={'pvZvu':_0x212739(0x167),'rgIyo':function(_0x4ca2b1,_0x4165eb,_0x3efe7c){return _0x4ca2b1(_0x4165eb,_0x3efe7c);},'zAVca':function(_0x5f0b26,_0x1f8bbd){return _0x5f0b26+_0x1f8bbd;},'wVRjF':'Failed\x20to\x20export\x20data\x20to\x20JSON.','RTEko':function(_0x5045b6){return _0x5045b6();}};showLoader();try{const _0x3218f7={'exportDate':new Date()[_0x212739(0x1be)](),'scoringCriteria':a13_0x210961['scoringCriteria'],'products':a13_0x210961['products'],'machines':a13_0x210961['machines'],'detergentIngredients':a13_0x210961[_0x212739(0x2b9)]},_0x452a55=JSON['stringify'](_0x3218f7,null,0x2),_0x5768a4=new Blob([_0x452a55],{'type':_0x3d39bc[_0x212739(0x102)]}),_0x2c4a6d=URL[_0x212739(0x249)](_0x5768a4),_0x456f74=document[_0x212739(0x2a1)]('a');_0x456f74[_0x212739(0x166)]=_0x2c4a6d,_0x456f74['download']='maco_data_export.json',document['body'][_0x212739(0x2ee)](_0x456f74),_0x456f74[_0x212739(0x15d)](),document[_0x212739(0x299)][_0x212739(0xff)](_0x456f74),URL[_0x212739(0x185)](_0x2c4a6d);}catch(_0x309c79){_0x3d39bc[_0x212739(0x207)](showCustomAlert,_0x212739(0x228),_0x3d39bc[_0x212739(0x268)](_0x3d39bc['wVRjF'],_0x309c79[_0x212739(0x220)]));}finally{_0x3d39bc[_0x212739(0xcd)](hideLoader);}}export function importFromJson(_0x49cccc){const _0x3abd09=a13_0x16a2fa,_0x24bc4a={'zyxTf':function(_0x4dd8fd){return _0x4dd8fd();},'qWsxP':function(_0x348381){return _0x348381();},'YTrgI':_0x3abd09(0x228),'kTsdf':_0x3abd09(0xe2),'hRtHW':_0x3abd09(0x223)},_0x4fd82b=_0x49cccc[_0x3abd09(0xca)][_0x3abd09(0x170)][0x0];if(!_0x4fd82b)return;const _0x52c9e9=new FileReader();_0x52c9e9[_0x3abd09(0x1c6)]=function(_0xd1e2d){const _0x3068f1=_0x3abd09;try{const _0x4f7ee3=JSON[_0x3068f1(0x1d4)](_0xd1e2d['target'][_0x3068f1(0x157)]);_0x4f7ee3&&_0x4f7ee3[_0x3068f1(0x1aa)]&&_0x4f7ee3[_0x3068f1(0x28f)]&&_0x4f7ee3[_0x3068f1(0x12c)]?(a13_0x210961[_0x3068f1(0x165)](_0x4f7ee3[_0x3068f1(0x1aa)]),a13_0x210961[_0x3068f1(0xe6)](_0x4f7ee3['machines']),a13_0x210961[_0x3068f1(0x219)](_0x4f7ee3[_0x3068f1(0x28f)]),_0x4f7ee3[_0x3068f1(0x2b9)]&&a13_0x210961[_0x3068f1(0x151)](_0x4f7ee3[_0x3068f1(0x2b9)]),_0x24bc4a[_0x3068f1(0x2bc)](saveStateForUndo),_0x24bc4a['qWsxP'](a13_0x178ab6),showCustomAlert(_0x3068f1(0x303),'Data\x20imported\x20successfully.')):showCustomAlert(_0x24bc4a[_0x3068f1(0x318)],_0x24bc4a[_0x3068f1(0x214)]);}catch(_0x2adc4d){showCustomAlert(_0x24bc4a[_0x3068f1(0x318)],_0x24bc4a['hRtHW']);}finally{_0x49cccc['target']['value']='';}},_0x52c9e9[_0x3abd09(0x288)](_0x4fd82b);}export function toggleOtherProductType(_0x467aa3,_0x227886){const _0x1eea80=a13_0x16a2fa,_0x264563={'yWoMM':function(_0x1b3401,_0x5e5bd6){return _0x1b3401===_0x5e5bd6;},'DEnGV':_0x1eea80(0x1bb),'gLlPz':_0x1eea80(0x236)},_0x308991=document[_0x1eea80(0x2e0)](_0x227886),_0x37b10b=_0x308991[_0x1eea80(0x127)]('input');_0x264563[_0x1eea80(0x257)](_0x264563['DEnGV'],_0x467aa3[_0x1eea80(0x13e)])?(_0x308991['style']['display']=_0x1eea80(0x2ab),_0x37b10b[_0x1eea80(0xf9)]=!0x0):(_0x308991['style'][_0x1eea80(0x200)]=_0x264563[_0x1eea80(0x2a4)],_0x37b10b['required']=!0x1,_0x37b10b[_0x1eea80(0x13e)]='');}export function toggleOtherMachineStage(_0x21af72,_0x43b719){const _0xd6f82c=a13_0x16a2fa,_0x472df2={'jupCj':_0xd6f82c(0x1bb),'RrpRb':_0xd6f82c(0x2ab),'nZqHI':'none'},_0x490f6b=document[_0xd6f82c(0x2e0)](_0x43b719),_0x13224b=_0x490f6b['querySelector'](_0xd6f82c(0x282));_0x472df2[_0xd6f82c(0x140)]===_0x21af72['value']?(_0x490f6b[_0xd6f82c(0x294)][_0xd6f82c(0x200)]=_0x472df2[_0xd6f82c(0x221)],_0x13224b[_0xd6f82c(0xf9)]=!0x0):(_0x490f6b[_0xd6f82c(0x294)][_0xd6f82c(0x200)]=_0x472df2[_0xd6f82c(0x2c5)],_0x13224b[_0xd6f82c(0xf9)]=!0x1,_0x13224b['value']='');}export function toggleOtherMachineGroup(_0x90d8b7,_0x3381e4){const _0x561d27=a13_0x16a2fa,_0x23f8a7={'RjPuj':function(_0x5573b8,_0x5e4f92){return _0x5573b8===_0x5e4f92;},'LSZpn':_0x561d27(0x1bb),'BcUnY':_0x561d27(0x2ab)},_0x187832=document[_0x561d27(0x2e0)](_0x3381e4),_0x47a7d9=_0x187832[_0x561d27(0x127)](_0x561d27(0x282));_0x23f8a7[_0x561d27(0x1ab)](_0x23f8a7[_0x561d27(0x18c)],_0x90d8b7['value'])?(_0x187832[_0x561d27(0x294)][_0x561d27(0x200)]=_0x23f8a7[_0x561d27(0x10c)],_0x47a7d9[_0x561d27(0xf9)]=!0x0):(_0x187832[_0x561d27(0x294)][_0x561d27(0x200)]=_0x561d27(0x236),_0x47a7d9[_0x561d27(0xf9)]=!0x1,_0x47a7d9[_0x561d27(0x13e)]='');}export function clampSafetyFactor(_0x7eb73c,_0x3e4471){const _0x32f1a8=a13_0x16a2fa,_0x79beec={'YDhTb':function(_0x346f16,_0x4efea3){return _0x346f16(_0x4efea3);},'LjmjN':function(_0xdd0c43,_0x1c9962){return _0xdd0c43(_0x1c9962);},'Pcbbh':function(_0x4e38c9,_0x5a2a5a){return _0x4e38c9(_0x5a2a5a);},'jIxIu':function(_0x530555,_0x92ed90){return _0x530555<_0x92ed90;},'mldMN':function(_0x55828c,_0x4441c9){return _0x55828c>_0x4441c9;},'xDqbA':function(_0x4ba568,_0x464c53){return _0x4ba568(_0x464c53);},'AUvuL':_0x32f1a8(0x2cd),'MMDSM':function(_0x137238,_0x55eb32){return _0x137238(_0x55eb32);},'ymVyq':_0x32f1a8(0x285),'uZgUC':function(_0x4ecd5d,_0x338971){return _0x4ecd5d(_0x338971);}},_0x51d5a8=_0x79beec[_0x32f1a8(0x17b)](parseFloat,_0x7eb73c[_0x32f1a8(0x18a)]),_0x2f26ba=_0x79beec[_0x32f1a8(0x1b4)](parseFloat,_0x7eb73c['max']);let _0x3ade96=_0x79beec[_0x32f1a8(0x17b)](parseFloat,_0x7eb73c['value']);_0x79beec[_0x32f1a8(0x1ff)](isNaN,_0x3ade96)&&(_0x3ade96=_0x51d5a8),_0x79beec[_0x32f1a8(0x27f)](_0x3ade96,_0x51d5a8)?_0x3ade96=_0x51d5a8:_0x79beec['mldMN'](_0x3ade96,_0x2f26ba)&&(_0x3ade96=_0x2f26ba),_0x79beec[_0x32f1a8(0x277)](parseFloat,_0x7eb73c['value'])!==_0x3ade96&&(_0x7eb73c['value']=_0x3ade96),_0x7eb73c['id'][_0x32f1a8(0x206)](_0x79beec['AUvuL'])?_0x79beec['MMDSM'](recalculateProductMacoForTrain,_0x3e4471):_0x7eb73c['id'][_0x32f1a8(0x206)](_0x79beec['ymVyq'])&&_0x79beec[_0x32f1a8(0x152)](recalculateDetergentMacoForTrain,_0x3e4471);}export function toggleTrain(_0x44f720){const _0x16cda8=a13_0x16a2fa,_0x59d6c1={'bCdIj':_0x16cda8(0x135)},_0x28ca6b=document[_0x16cda8(0x2e0)](_0x16cda8(0x15f)+_0x44f720),_0x17357b=document[_0x16cda8(0x2e0)](_0x16cda8(0x1f9)+_0x44f720);_0x28ca6b&&_0x17357b&&(_0x28ca6b[_0x16cda8(0x2e7)]['contains'](_0x59d6c1[_0x16cda8(0x192)])?(_0x28ca6b['classList']['remove'](_0x59d6c1[_0x16cda8(0x192)]),_0x17357b['textContent']='▼'):(_0x28ca6b[_0x16cda8(0x2e7)][_0x16cda8(0x274)](_0x16cda8(0x135)),_0x17357b[_0x16cda8(0x162)]='▶'));}export function toggleMacoBreakdown(_0x4c9d27){const _0x1e0309=a13_0x16a2fa,_0x36e6c4={'RQQBI':_0x1e0309(0x2da),'hqItO':_0x1e0309(0x264)},_0x13b3dd=document[_0x1e0309(0x2e0)](_0x1e0309(0x20b)+_0x4c9d27),_0x5e1e31=document['getElementById'](_0x1e0309(0x104)+_0x4c9d27);_0x13b3dd[_0x1e0309(0x2e7)]['contains'](_0x36e6c4[_0x1e0309(0x180)])?(_0x13b3dd[_0x1e0309(0x2e7)][_0x1e0309(0x291)](_0x36e6c4['RQQBI']),_0x5e1e31['textContent']=_0x36e6c4['hqItO']):(_0x13b3dd['classList'][_0x1e0309(0x274)](_0x36e6c4[_0x1e0309(0x180)]),_0x5e1e31['textContent']=_0x1e0309(0x117));}export function exportWorstCaseToExcel(_0x5c3db2='all'){const _0x6b434=a13_0x16a2fa,_0x57e7fa={'StPaV':function(_0x38484d,_0x444412,_0x2ddedd){return _0x38484d(_0x444412,_0x2ddedd);},'zQfpw':_0x6b434(0x16e),'ILlvf':_0x6b434(0x2f6),'vfKry':function(_0x3c48c0,_0x437927){return _0x3c48c0(_0x437927);},'CZbWu':function(_0x2342e0,_0x1f26fc){return _0x2342e0===_0x1f26fc;},'IgkPf':_0x6b434(0x25d),'kCxNU':function(_0xfcebe4,_0x5797e3){return _0xfcebe4!==_0x5797e3;},'VuQxz':_0x6b434(0x2d4),'PgDLE':function(_0x2ecd4e){return _0x2ecd4e();},'jNwJH':function(_0x2aaacd,_0x44442a){return _0x2aaacd===_0x44442a;},'YegaY':function(_0x29e996){return _0x29e996();},'oPGVI':'Worst\x20Case\x20Products','JuMZs':_0x6b434(0x146),'DnDjg':function(_0x58c424){return _0x58c424();},'rLQCt':'Error\x20exporting\x20worst\x20case\x20to\x20Excel:','SYEbC':function(_0xf814a9,_0x2ef9e1,_0xeab4aa){return _0xf814a9(_0x2ef9e1,_0xeab4aa);},'ACPer':'./utils.js'};_0x57e7fa[_0x6b434(0x244)](showLoader),import(_0x57e7fa[_0x6b434(0x1e5)])['then'](_0x4f7850=>{const _0x3b4264=_0x6b434,_0x3d8c9b={'MLNpB':function(_0x887048,_0x2b2484){const _0x2889a9=a13_0x434f;return _0x57e7fa[_0x2889a9(0x1e0)](_0x887048,_0x2b2484);}},{getProductTrainId:_0x5f5077,calculateScores:_0xbb5356,getToxicityPreference:_0x583c71}=_0x4f7850,_0x1e5c12=[];let _0x4dd92c=a13_0x210961['viewProducts'][_0x3b4264(0x215)]||a13_0x210961[_0x3b4264(0x1aa)];if(_0x57e7fa[_0x3b4264(0x175)](0x0,_0x4dd92c['length']))return hideLoader(),void showCustomAlert(_0x57e7fa[_0x3b4264(0x2e5)],'There\x20are\x20no\x20products\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.');const _0x5e971c={};_0x4dd92c[_0x3b4264(0x177)](_0x873d9b=>{const _0x3f8115=_0x3b4264,_0x388743=_0x3d8c9b[_0x3f8115(0x149)](_0x5f5077,_0x873d9b);_0x3f8115(0x16e)!==_0x388743&&(_0x5e971c[_0x388743]||(_0x5e971c[_0x388743]=[]),_0x5e971c[_0x388743][_0x3f8115(0x182)](_0x873d9b));});let _0x42ebd5=_0x5e971c;if(_0x57e7fa['kCxNU'](_0x57e7fa[_0x3b4264(0x2f5)],_0x5c3db2)&&(_0x42ebd5={},Array[_0x3b4264(0x271)](_0x5c3db2)?_0x5c3db2[_0x3b4264(0x177)](_0x4ad042=>{_0x5e971c[_0x4ad042]&&(_0x42ebd5[_0x4ad042]=_0x5e971c[_0x4ad042]);}):_0x5e971c[_0x5c3db2]&&(_0x42ebd5={[_0x5c3db2]:_0x5e971c[_0x5c3db2]}),_0x57e7fa[_0x3b4264(0x175)](0x0,Object['keys'](_0x42ebd5)['length'])))return hideLoader(),void showCustomAlert(_0x57e7fa[_0x3b4264(0x2e5)],(Array['isArray'](_0x5c3db2)?_0x3b4264(0x237)+_0x5c3db2[_0x3b4264(0x2fe)](',\x20'):'Train\x20'+_0x5c3db2)+_0x3b4264(0x1e1));const _0x4940df=_0x57e7fa[_0x3b4264(0x138)](_0x583c71);if(Object[_0x3b4264(0x234)](_0x42ebd5)[_0x3b4264(0x1f2)]((_0x48091b,_0x41ed19)=>_0x48091b-_0x41ed19)[_0x3b4264(0x177)](_0x18fa9c=>{const _0x4f645c=_0x3b4264,_0x449a57={'LVXio':function(_0x462347,_0x222e56){return _0x462347>_0x222e56;},'CDkLB':function(_0x1a1da1,_0xf8fe6e,_0x59223d){return _0x57e7fa['StPaV'](_0x1a1da1,_0xf8fe6e,_0x59223d);},'eMeGn':_0x57e7fa[_0x4f645c(0x2f7)],'jWTcz':_0x57e7fa[_0x4f645c(0x2ef)]},_0x26f2f2=_0x42ebd5[_0x18fa9c];_0x1e5c12['push']({'Train':_0x4f645c(0x240)+_0x18fa9c+'\x20-\x20Worst\x20Case\x20Analysis','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),_0x26f2f2[_0x4f645c(0x177)](_0x52761d=>{const _0x31ebe6=_0x4f645c,_0x49572a=_0x52761d[_0x31ebe6(0x275)][_0x31ebe6(0x1a2)](_0x1ef90a=>_0xbb5356(_0x1ef90a,_0x4940df)[_0x31ebe6(0x15a)]);_0x52761d[_0x31ebe6(0xfd)]=_0x449a57[_0x31ebe6(0xdc)](_0x49572a[_0x31ebe6(0x20c)],0x0)?Math[_0x31ebe6(0x14f)](..._0x49572a):0x0;}),_0x26f2f2['sort']((_0x2b6e79,_0x20ab29)=>_0x20ab29['sortValue']-_0x2b6e79[_0x4f645c(0xfd)]),_0x26f2f2[_0x4f645c(0x177)](_0x121d06=>{const _0x2f6973=_0x4f645c,_0x466390=_0x121d06[_0x2f6973(0x13d)]?_0x449a57['jWTcz']:'No';_0x1e5c12[_0x2f6973(0x182)]({'Train':'','Product\x20Code':_0x121d06[_0x2f6973(0x2bd)],'Product\x20Name':_0x121d06[_0x2f6973(0x2f0)],'Highest\x20RPN':_0x121d06[_0x2f6973(0xfd)],'Special\x20Case\x20Product':_0x466390,'Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),(_0x121d06['activeIngredients'][_0x2f6973(0x1f2)]((_0x26490d,_0x1327ac)=>_0xbb5356(_0x1327ac,_0x4940df)[_0x2f6973(0x15a)]-_0xbb5356(_0x26490d,_0x4940df)[_0x2f6973(0x15a)])['forEach'](_0xc73f75=>{const _0x17ee73=_0x2f6973,_0x104579=_0x449a57[_0x17ee73(0x208)](_0xbb5356,_0xc73f75,_0x4940df);_0x1e5c12[_0x17ee73(0x182)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':_0xc73f75[_0x17ee73(0x2f0)],'TD\x20Score':_0x104579[_0x17ee73(0x308)],'Solubility\x20Score':_0x104579['solubilityScore'],'Cleanability\x20Score':_0x104579[_0x17ee73(0x251)],'PDE\x20Score':_0x104579['pdeScore']??'N/A','LD50\x20Score':_0x104579[_0x17ee73(0x304)]??_0x449a57[_0x17ee73(0xe1)],'RPN':_0x104579[_0x17ee73(0x15a)],'Rating':_0x104579[_0x17ee73(0x12a)]});}),_0x1e5c12[_0x2f6973(0x182)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}));});}),_0x57e7fa['jNwJH'](0x0,_0x1e5c12[_0x3b4264(0x20c)]))return _0x57e7fa['YegaY'](hideLoader),void _0x57e7fa[_0x3b4264(0x302)](showCustomAlert,_0x57e7fa[_0x3b4264(0x2e5)],_0x3b4264(0x252));const _0x1c7df7=XLSX[_0x3b4264(0x2e9)][_0x3b4264(0x2fd)](_0x1e5c12),_0x24e994=XLSX[_0x3b4264(0x2e9)][_0x3b4264(0x2a5)]();XLSX[_0x3b4264(0x2e9)][_0x3b4264(0x2b7)](_0x24e994,_0x1c7df7,_0x57e7fa[_0x3b4264(0x181)]);const _0x58a812=Object[_0x3b4264(0x234)](_0x1e5c12[0x0])[_0x3b4264(0x1a2)](_0x2484cb=>({'wch':Math[_0x3b4264(0x14f)](_0x2484cb[_0x3b4264(0x20c)],..._0x1e5c12[_0x3b4264(0x1a2)](_0x435ea5=>String(_0x435ea5[_0x2484cb]||'')[_0x3b4264(0x20c)]))+0x2}));_0x1c7df7[_0x57e7fa[_0x3b4264(0xf1)]]=_0x58a812;const _0x3d808c=new Date()[_0x3b4264(0x1be)]()[_0x3b4264(0x1ba)]('T')[0x0];let _0x13a16d='';_0x3b4264(0x2d4)!==_0x5c3db2&&(_0x13a16d=Array['isArray'](_0x5c3db2)?'_Trains_'+_0x5c3db2[_0x3b4264(0x2fe)]('_'):'_Train_'+_0x5c3db2),XLSX['writeFile'](_0x24e994,_0x3b4264(0x2a7)+_0x13a16d+'_'+_0x3d808c+_0x3b4264(0x131)),_0x57e7fa[_0x3b4264(0x244)](hideLoader);})[_0x6b434(0x278)](_0x17620b=>{const _0x43a795=_0x6b434;console['error'](_0x57e7fa[_0x43a795(0xc6)],_0x17620b),_0x57e7fa[_0x43a795(0x138)](hideLoader),_0x57e7fa[_0x43a795(0xd0)](showCustomAlert,_0x43a795(0x228),'Failed\x20to\x20export\x20worst\x20case\x20data\x20to\x20Excel.');});}export function exportMachinesToExcel(){const _0x10e2b7=a13_0x16a2fa,_0x370c2a={'vSyyf':_0x10e2b7(0x1cc),'sKMyj':function(_0x3694c4){return _0x3694c4();},'zcmHF':_0x10e2b7(0x25d),'TxgOO':_0x10e2b7(0x2ed),'Bafvs':_0x10e2b7(0x101),'JwyOX':function(_0x51ca47,_0xd887ef,_0x9f7f47){return _0x51ca47(_0xd887ef,_0x9f7f47);},'VAIrz':_0x10e2b7(0x228),'iedJl':_0x10e2b7(0x1b0)};_0x370c2a[_0x10e2b7(0x2d2)](showLoader);try{if(0x0===a13_0x210961[_0x10e2b7(0x12c)]['length'])return hideLoader(),void showCustomAlert(_0x370c2a[_0x10e2b7(0xef)],_0x370c2a['TxgOO']);const _0x2b1158=[],_0x4ff4f1={};a13_0x210961[_0x10e2b7(0x12c)][_0x10e2b7(0x177)](_0x238eb0=>{const _0x3107d3=_0x10e2b7;_0x4ff4f1[_0x238eb0[_0x3107d3(0x263)]]||(_0x4ff4f1[_0x238eb0[_0x3107d3(0x263)]]=[]),_0x4ff4f1[_0x238eb0[_0x3107d3(0x263)]][_0x3107d3(0x182)](_0x238eb0);}),a13_0x210961[_0x10e2b7(0xf5)][_0x10e2b7(0x177)](_0x26011d=>{const _0x8c89c7=_0x10e2b7,_0x93e654={'wrtwz':_0x370c2a['vSyyf']};_0x4ff4f1[_0x26011d]&&_0x4ff4f1[_0x26011d][_0x8c89c7(0x177)](_0x34f21f=>{const _0xd9272=_0x8c89c7,_0x426936=a13_0x210961[_0xd9272(0x1aa)][_0xd9272(0x245)](_0x3f8431=>_0x3f8431[_0xd9272(0x2b6)]&&_0x3f8431[_0xd9272(0x2b6)]['includes'](_0x34f21f['id'])),_0x5aba36=_0x426936['map'](_0x37ce66=>_0x37ce66[_0xd9272(0x2f0)])[_0xd9272(0x2fe)](',\x20')||_0x93e654[_0xd9272(0x123)],_0x1006d5=_0x426936[_0xd9272(0x20c)];_0x2b1158[_0xd9272(0x182)]({'Machine\x20Number':_0x34f21f[_0xd9272(0x233)],'Machine\x20Name':_0x34f21f['name'],'Stage':_0x34f21f['stage'],'Area\x20(sq\x20cm)':_0x34f21f[_0xd9272(0x232)],'Assigned\x20Products\x20Count':_0x1006d5,'Assigned\x20Products':_0x5aba36});});});const _0x5dece9=XLSX['utils'][_0x10e2b7(0x2fd)](_0x2b1158),_0x297d81=XLSX[_0x10e2b7(0x2e9)][_0x10e2b7(0x2a5)]();XLSX[_0x10e2b7(0x2e9)][_0x10e2b7(0x2b7)](_0x297d81,_0x5dece9,_0x10e2b7(0x155));const _0x2c6873=[{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0xf},{'wch':0x14},{'wch':0x32}];_0x5dece9['!cols']=_0x2c6873;const _0x37fe37=new Date()[_0x10e2b7(0x1be)]()[_0x10e2b7(0x1ba)]('T')[0x0];XLSX['writeFile'](_0x297d81,_0x10e2b7(0x15e)+_0x37fe37+_0x10e2b7(0x131)),hideLoader(),showCustomAlert('Success',_0x10e2b7(0x250));}catch(_0x27d2ce){console[_0x10e2b7(0x10b)](_0x370c2a[_0x10e2b7(0x226)],_0x27d2ce),hideLoader(),_0x370c2a['JwyOX'](showCustomAlert,_0x370c2a[_0x10e2b7(0x30a)],_0x370c2a[_0x10e2b7(0x24f)]);}}function a13_0x4d53(){const _0x197c0b=['onload','125198dUlmaQ','zwrwJ','jmZru','All\x20Products','SVeaK','None','uVJZp','JRVgL','content-pm-','button[onclick=\x22toggleColumnVisibilityDropdown()\x22]','Train\x20Summary','customAlertTitle','IMwaN','parse','stringify','dYycZ','qgyhR','Gvdes','YUwfo','EjqXF','wZwzb','uuDNt','fqQxr','NjNbE','sGnZP','vfKry','\x20not\x20found\x20or\x20has\x20no\x20products.','Failed\x20to\x20export\x20Summary\x20report\x20data\x20to\x20Excel.','zWjKL','documentElement','ACPer','LAvIJ','trainSummary','Detergent_MACO_Report_','1248852AtmrcB','ovBBr','Train\x20summary\x20container\x20is\x20hidden\x20or\x20missing','content-dm-','lhPxw','Lvtbg','eafDk','npSdy','WKEDD','sort','mDSza','No\x20reason\x20provided','innerHTML','aHqzm','sRDwM','Health-Based\x20Limit\x20(PDE)','toggle-','Train\x20Summary\x20Report','removeEventListener','macoProducts','Error\x20loading\x20products','ChNIS','Pcbbh','display','match','xrhjP','exQJU','undo-btn','batchSizeKg','startsWith','rgIyo','CDkLB','mnmat','5vOhGth','maco-breakdown-details-','length','YTpjR','ctWLR','flatMap','mRGYn','lowestLd50','No\x20trains\x20message\x20display:','CjEBe','kTsdf','worstCaseProducts',',\x20#','svblp','Container\x20display:','setScoringCriteria','kODcd','JUUzv','QvYcl','hide-pde','productRegister','QjAJv','message','RrpRb','theme-toggle-light-icon','Failed\x20to\x20parse\x20JSON\x20file.','igupt','1630aUtBdY','Bafvs','oyJmd','Error','yRyCQ','Error\x20creating\x20Product\x20MACO\x20sheet:','Printing\x20view:','GbJio','saHYf','Error\x20loading\x20train\x20summary:\x20','Error\x20loading\x20machine\x20stage\x20order','HGdpV','jKZga','area','machineNumber','keys','YVQtI','none','Trains\x20','-hidden','RBAny','./macoDetergentView.js','dBMzT','RbPSX','theme-toggle-dark-icon','xJytO','yvdrQ','Train\x20','date','QYDjQ','XJtDs','DnDjg','filter','Detergent\x20MACO\x20Report','FWmRO','DbEJh','createObjectURL','Complete_MACO_Report_','mamag','EiEks','cGQtr','fNOiA','iedJl','Machines\x20data\x20exported\x20to\x20Excel\x20successfully!','cleanabilityScore','There\x20is\x20no\x20data\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','macoMachines','CaiNT','FEiPI','Hide\x20PDE','yWoMM','reduce','DOtHy','lowestLtd','22lrYQRk','pdeMg','No\x20Data','Yvibs','toExponential','iqsmY','zcbjp','minMbsKg','stage','Hide\x20MACO\x20Calculation\x20Breakdown','HgYRJ','ldwRm','safetyFactorConfig','zAVca','jmUNF','criticalReason','macoDetergentIngredients','DnJfB','rvBoN','#productRegister\x20.mainTable.hide-','HcTbw','gxAlv','isArray','cdIqc','button','add','activeIngredients','mpGHV','xDqbA','catch','REhlu','Show\x20PDE','\x20.mainTable,\x20#','YSwPX','scoringInEditMode','OqeTC','jIxIu','HhCcA','renderTrainSummary','input','then','number','sf-input-train','VLfnj','sEmpu','readAsText','Health-Based\x20Limit\x20(NOEL)','macoChartInstance','Hide','JzaJl','Complete\x20report\x20with\x20all\x20tabs\x20exported\x20to\x20Excel\x20successfully!','kJmQg','scoringCriteria','NXHNb','remove','Critical\x20Products','Error\x20creating\x20Product\x20Register\x20sheet:','style','solubilityScore','toFixed','setScoringWasInEditModeForPrint','NvzeD','body','gBrHZ','pOtPk','OITth','slice','contains','trim','RGNaq','createElement','zyEWf','-pdeHidden','gLlPz','book_new','Unknown\x20(ID:\x20','MACO_Worst_Case_Products','There\x20are\x20no\x20detergent\x20ingredients\x20configured.\x20Add\x20detergent\x20ingredients\x20first.','printing-','kjAXh','block','gRdeV','esqIE','Error\x20creating\x20Detergent\x20MACO\x20sheet:','Product\x20MACO\x20Report','fnxgM','lowestPde','WUKUP','ryIRQ','detection','cLMJR','machineIds','book_append_sheet','lpgNd','detergentIngredients','OaCiO','ydEVV','zyxTf','productCode','laXwz','sf-input-train-','1689429IKUynG','mddMg','mVMRA','Failed\x20to\x20save\x20data\x20to\x20localStorage','ZUWrY','nZqHI','kGdvo','CfaeK','BHIlo','Error\x20exporting\x20Product\x20MACO\x20to\x20Excel:','WgXzN','kCcda','SHhLI','product-sf-input','liavh','MACO_Summary_Report_','productRegister-ld50Hidden','hoXIx','sKMyj','historyIndex','all','hExkr','TKsiG','XFVDb','\x20.ingredients-sub-table','disabled','hidden','NuzzB','Error\x20loading\x20scoring\x20criteria','bodyWeight','Failed\x20to\x20export\x20data\x20to\x20Excel.','ehFih','getElementById','Fgxsh','There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','#detergentMaco\x20.train-content.collapsed','Top\x2010\x20RPN','IgkPf','pJuVk','classList','Visual\x20Clean\x20Limit','utils','pnhGt','setHistory','tYIcc','There\x20are\x20no\x20machines\x20to\x20export.','appendChild','ILlvf','name','trainId','severity','THXqj','OOVKz','VuQxz','Yes','zQfpw','15822JbjmsC','wAgkH','No\x20trains\x20match\x20the\x20selected\x20criteria.','pde','zTCNz','json_to_sheet','join','ZyTMC','pKvxp','oSMlk','StPaV','Success','ld50Score','cTGAC','renderWorstCaseByTrain','KCuIo','therapeuticDoseScore','YYMKl','VAIrz','LPHUB','HOceO','not\x20found','ARHwc','yPKHz','QARJy','lEnwg','#macoForTrains\x20.train-content.collapsed','ylJYR','LQrnE','XpdKk','log','cTHcE','YTrgI','kRojV','rLQCt','Error\x20loading\x20detergent\x20ingredients','zbdhb','JGLVs','target','EzPto','fyoAm','RTEko','BsijR','renderRpnChart','SYEbC','KkvJe','qIKMA','2982198FKKEac','spOCA','TCOxG','renderDetergentMaco','./trainSummaryView.js','fMxCT','CUgDu','\x20-\x20','There\x20is\x20no\x20data\x20in\x20the\x20current\x20view\x20to\x20export.','LVXio','vEIOX','closest','Error\x20creating\x20All\x20Products\x20sheet:','toggle-dm-','eMeGn','Invalid\x20JSON\x20file\x20structure.','pdeScore','dark','Yhpui','setMachines','Nhdqi','assumedSsa','getLargestEssaForLineAndDosageForm','_Trains_','KMogd','.toggle-pde','getItem','#columnVisibilityDropdown','zcmHF','therapeuticDose','JuMZs','gIfHL','toggle-pm-','SqpGC','machineStageDisplayOrder','querySelectorAll','stage-','DwSAg','required','awABH','dYPIU','ZVwvV','sortValue','find','removeChild','-ld50Hidden','Error\x20exporting\x20machines\x20to\x20Excel:','pvZvu','IOqgz','breakdown-toggle-btn-','./worstCaseView.js','GUGQX','bQOKW','Train:','maGry','NXYFT','error','BcUnY','printSelectedTrain','ZXvwW','productName','Could\x20not\x20save\x20data.\x20Storage\x20might\x20be\x20full.','jdtvV','uhlus','loader','./macoProductView.js','wXRhV','XSoec','Show\x20MACO\x20Calculation\x20Breakdown','QcuvL','redo-btn','UHBdO','zaOxt','crdPg','RXuOi','rpnChartInstance','XZBUi','XnBnM','\x20.mainTable.hide-','Product\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','wrtwz','_Train_','oKdfX','UzEJs','querySelector','Summary\x20report\x20data\x20exported\x20to\x20Excel\x20successfully!','ld50','rpnRatingText','#macoForTrains\x20[id^=\x22maco-breakdown-details-\x22].hidden','machines','ZrUVa','vIYpU','Train\x20Summary\x20data\x20exported\x20to\x20Excel\x20successfully!','FvqfY','.xlsx','tZHuk','PRODUCT','INGREDIENT','collapsed','toggle','hPXYP','PgDLE','auvIU','toLocaleString','mdd','eKkjK','isCritical','value','LRqeP','jupCj','Sohvx','qZSCS','gZIXO','nUuqZ','minBsMddRatio','!cols','print','GibaN','MLNpB','PvsmM','GqEhF','productRegister-pdeHidden','Train_Summary_Report','MIBRQ','max','Hidden','setDetergentIngredients','uZgUC','essa','Error\x20exporting\x20Train\x20Summary\x20to\x20Excel:','Machines','XSAIp','result','hUITg','PTlDO','rpn','Product\x20Register','RlXoJ','click','MACO_Machines_','content-','oTzYH','warn','textContent','OnyXx','EbTKR','setProducts','href','application/json','hide-','toLocaleDateString','NbyiX','385231HDjMSL','yrDEm','0.1%\x20Therapeutic\x20Dose','N/A','productType','files','finally','nwftT','IJCPX','Failed\x20to\x20export\x20Product\x20MACO\x20data\x20to\x20Excel.','CZbWu','JYHPL','forEach','JXgLD','customAlertModal',')\x20-\x20RPN:\x20','YDhTb','Failed\x20to\x20export\x20Train\x20Summary\x20data\x20to\x20Excel.','Show\x20LD50','Error\x20loading\x20machines','JfYio','RQQBI','oPGVI','push','GBczK','uqqVC','revokeObjectURL','Yeyyy','UYAYs','./utils.js','ysaGZ','min','writeFile','LSZpn','QQjNx','hGbAz','amycM','rJTRR','REmXo','bCdIj','PrTLS','LGKDD','YnCLo','\x20.train-content-inner','true','noTrainSummaryMessage','Fcjdq','UvkWt','flex','macoScoringCriteria','MUYWD','vLava','rYNqV','history','uaRDH','map','sgvYd','DWYkK','ingredientName','IciCC','NijRH','setMachineStageDisplayOrder','Error\x20creating\x20Top\x2010\x20RPN\x20sheet:','products','RjPuj','TUhFb','vcmeH','vRPrV','10\x20ppm\x20Criterion','Failed\x20to\x20export\x20machines\x20data\x20to\x20Excel.','shBkV','includes','HUXbf','LjmjN','Error\x20loading\x20detergent\x20view\x20for\x20print:','PDoYf','GtelR','setItem','Save\x20Error','split','Other','8325464MWvnqY','worstProductRpn','toISOString','kYDSW','nFHZw','gbgDd','fmEOk','qOBhG','VViuO','parentElement'];a13_0x4d53=function(){return _0x197c0b;};return a13_0x4d53();}export function exportProductMacoToExcel(_0x43901a=a13_0x16a2fa(0x2d4)){const _0x198a28=a13_0x16a2fa,_0x6a8935={'dEyMe':function(_0x4bba0a,_0x872ba4){return _0x4bba0a(_0x872ba4);},'jKZga':function(_0x33a760,_0x1f1f9f){return _0x33a760/_0x1f1f9f;},'lhPxw':function(_0x38e78b,_0x112b27){return _0x38e78b*_0x112b27;},'QVOLy':function(_0x86179e,_0x105b7d){return _0x86179e/_0x105b7d;},'ZECac':_0x198a28(0x197),'jboNE':'productRegister-pdeHidden','NjNbE':function(_0x5dfe7d,_0x59ff9c){return _0x5dfe7d===_0x59ff9c;},'JXgLD':function(_0x4bc8a1,_0x3df820){return _0x4bc8a1*_0x3df820;},'DOtHy':function(_0x535f03,_0x34e6a5){return _0x535f03!==_0x34e6a5;},'BfeHK':function(_0x5c31fa,_0xa2fbf9){return _0x5c31fa/_0xa2fbf9;},'JfYio':function(_0x2c0943,_0x21297d){return _0x2c0943/_0x21297d;},'JUUzv':function(_0x317575,_0x41ac81){return _0x317575*_0x41ac81;},'EbTKR':'0.1%\x20Therapeutic\x20Dose','GibaN':'10\x20ppm\x20Criterion','ARHwc':function(_0x141761,_0x14cf46){return _0x141761===_0x14cf46;},'MIBRQ':_0x198a28(0x1f8),'nwftT':_0x198a28(0x2e8),'zWjKL':function(_0x596c22,_0x5c8de3){return _0x596c22>_0x5c8de3;},'Yvibs':function(_0x1ca614,_0x12832f){return _0x1ca614/_0x12832f;},'fmEOk':function(_0x270831,_0x46350c){return _0x270831*_0x46350c;},'sEmpu':'N/A','QQjNx':_0x198a28(0x284),'amycM':function(_0x4727e6){return _0x4727e6();},'xidaW':function(_0x4248f3,_0x574d92,_0x1ca959){return _0x4248f3(_0x574d92,_0x1ca959);},'kYDSW':_0x198a28(0x25d),'GBczK':_0x198a28(0x2e2),'wXRhV':_0x198a28(0x2d4),'lEnwg':function(_0x32066d,_0x26ce7c){return _0x32066d===_0x26ce7c;},'TCOxG':_0x198a28(0x2fa),'yvdrQ':_0x198a28(0x2af),'yPKHz':_0x198a28(0x146),'OITth':function(_0x556250,_0x308239,_0x450cb7){return _0x556250(_0x308239,_0x450cb7);},'mnmat':_0x198a28(0x2c9),'Fcjdq':function(_0x5bd256,_0x38002e,_0x35ca5a){return _0x5bd256(_0x38002e,_0x35ca5a);},'Yeyyy':_0x198a28(0x228),'NijRH':_0x198a28(0x174),'CjEBe':function(_0x462760){return _0x462760();},'Sohvx':'./utils.js'};_0x6a8935[_0x198a28(0x213)](showLoader),import(_0x6a8935[_0x198a28(0x141)])[_0x198a28(0x283)](_0x5ed552=>{const _0x48cb7e=_0x198a28,{getTrainData:_0x3ee556,getWorstCaseProductType:_0x545473,getMacoPerSwabForTrain:_0x1995c0,getLargestEssaForLineAndDosageForm:_0x2fffa0}=_0x5ed552,_0xa3220=_0x6a8935[_0x48cb7e(0x18f)](_0x3ee556);if(_0x6a8935[_0x48cb7e(0x1de)](0x0,_0xa3220[_0x48cb7e(0x20c)]))return _0x6a8935[_0x48cb7e(0x18f)](hideLoader),void _0x6a8935['xidaW'](showCustomAlert,_0x6a8935[_0x48cb7e(0x1bf)],_0x6a8935[_0x48cb7e(0x183)]);let _0xd89582=_0xa3220;if(_0x6a8935[_0x48cb7e(0x115)]!==_0x43901a&&(_0xd89582=Array['isArray'](_0x43901a)?_0xa3220[_0x48cb7e(0x245)](_0x363058=>_0x43901a[_0x48cb7e(0x1b2)](String(_0x363058['id']))):_0xa3220[_0x48cb7e(0x245)](_0x2e363a=>String(_0x2e363a['id'])===String(_0x43901a))),_0x6a8935[_0x48cb7e(0x311)](0x0,_0xd89582[_0x48cb7e(0x20c)]))return _0x6a8935[_0x48cb7e(0x18f)](hideLoader),void showCustomAlert('No\x20Data',_0x6a8935[_0x48cb7e(0xd5)]);const _0x1cd7b2=[];_0xd89582[_0x48cb7e(0x177)](_0x2089db=>{const _0x5d13cb=_0x48cb7e,_0x29fbde=_0x6a8935['dEyMe'](_0x545473,_0x2089db[_0x5d13cb(0x1aa)][_0x5d13cb(0x1a2)](_0x28b48c=>_0x28b48c[_0x5d13cb(0x16f)])),_0x31852d=(a13_0x210961['safetyFactorConfig'][_0x29fbde]||a13_0x210961[_0x5d13cb(0x267)][_0x5d13cb(0x1bb)])['max'],_0x5aa4a2=_0x6a8935[_0x5d13cb(0x231)](_0x6a8935['lhPxw'](_0x2089db[_0x5d13cb(0x25a)],_0x2089db[_0x5d13cb(0x145)]),_0x31852d),_0x911319=_0x6a8935[_0x5d13cb(0x1ed)](0xa,_0x2089db[_0x5d13cb(0x262)]);let _0x3a3349=_0x6a8935['QVOLy'](0x1,0x0),_0x234bd2=_0x6a8935['jKZga'](0x1,0x0);const _0x444663=_0x6a8935['ZECac']===localStorage[_0x5d13cb(0xed)](_0x6a8935['jboNE']),_0x221932='true'===localStorage[_0x5d13cb(0xed)](_0x5d13cb(0x2d0));if(_0x6a8935['NjNbE'](null,_0x2089db[_0x5d13cb(0x2b1)])||_0x444663||(_0x3a3349=_0x6a8935['JXgLD'](_0x2089db[_0x5d13cb(0x2b1)],_0x2089db['minBsMddRatio'])),_0x6a8935[_0x5d13cb(0x259)](null,_0x2089db[_0x5d13cb(0x211)])&&!_0x221932){const _0x5dbd61=_0x6a8935['BfeHK'](_0x6a8935[_0x5d13cb(0x178)](0x46,_0x2089db[_0x5d13cb(0x211)]),0x7d0),_0x4d8eed=_0x2089db['products'][_0x5d13cb(0x20f)](_0x22a40d=>_0x22a40d['activeIngredients']['map'](_0x33c9ae=>_0x33c9ae[_0x5d13cb(0x13b)]/0x3e8)),_0x13dca1=Math[_0x5d13cb(0x18a)](..._0x4d8eed);_0x234bd2=_0x6a8935[_0x5d13cb(0x17f)](_0x6a8935[_0x5d13cb(0x178)](_0x5dbd61,_0x2089db[_0x5d13cb(0x262)])*0x3e8,_0x6a8935[_0x5d13cb(0x21b)](_0x31852d,_0x13dca1));}const _0x4e00a9=_0x2fffa0(_0x2089db,_0xa3220),_0x52fc9c=0.004*_0x4e00a9,_0x5d94f1=[{'name':_0x6a8935[_0x5d13cb(0x164)],'value':_0x5aa4a2},{'name':_0x6a8935[_0x5d13cb(0x148)],'value':_0x911319}];_0x6a8935[_0x5d13cb(0x30e)](null,_0x2089db[_0x5d13cb(0x2b1)])||_0x444663||_0x5d94f1[_0x5d13cb(0x182)]({'name':_0x6a8935[_0x5d13cb(0x14e)],'value':_0x3a3349}),null===_0x2089db[_0x5d13cb(0x211)]||_0x221932||_0x5d94f1[_0x5d13cb(0x182)]({'name':_0x5d13cb(0x289),'value':_0x234bd2}),_0x5d94f1['push']({'name':_0x6a8935[_0x5d13cb(0x172)],'value':_0x52fc9c});const _0x3d6797=_0x5d94f1[_0x5d13cb(0x258)]((_0x8de5e5,_0x6af007)=>_0x6af007['value']<_0x8de5e5[_0x5d13cb(0x13e)]?_0x6af007:_0x8de5e5),_0x43c926=_0x3d6797['value'],_0x5abb5b=_0x6a8935[_0x5d13cb(0x1e3)](_0x4e00a9,0x0)?_0x6a8935[_0x5d13cb(0x25e)](_0x43c926,_0x4e00a9):0x0,_0x3eb21b=_0x6a8935[_0x5d13cb(0x1c2)](_0x5abb5b,_0x2089db['assumedSsa']),_0x4d1fec=_0x2089db[_0x5d13cb(0x2b6)][_0x5d13cb(0x1a2)](_0x40c835=>{const _0x653dec=_0x5d13cb,_0x5b4ac2=a13_0x210961['machines']['find'](_0x5d568b=>_0x5d568b['id']===_0x40c835);return _0x5b4ac2||{'name':_0x653dec(0x2a6)+_0x40c835+')','machineNumber':'N/A'};}),_0x31c096=_0x2089db[_0x5d13cb(0x2b6)]['map'](_0x3fdca9=>{const _0x3d568b=_0x5d13cb,_0x416520=a13_0x210961[_0x3d568b(0x12c)][_0x3d568b(0xfe)](_0x92ef2=>_0x92ef2['id']===_0x3fdca9);return _0x416520?_0x416520[_0x3d568b(0x2f0)]:_0x3d568b(0x2a6)+_0x3fdca9+')';})[_0x5d13cb(0x2fe)](',\x20'),_0x20e20b=_0x2089db[_0x5d13cb(0x1aa)][_0x5d13cb(0x1a2)](_0x1ee30f=>_0x1ee30f[_0x5d13cb(0x2bd)]+_0x5d13cb(0xda)+_0x1ee30f[_0x5d13cb(0x2f0)])[_0x5d13cb(0x2fe)](';\x20'),_0x14bbf4=_0x2089db[_0x5d13cb(0x1bd)]?_0x2089db[_0x5d13cb(0x1bd)][_0x5d13cb(0x10f)]+'\x20('+_0x2089db[_0x5d13cb(0x1bd)][_0x5d13cb(0x1a5)]+_0x5d13cb(0x17a)+_0x2089db['worstProductRpn'][_0x5d13cb(0x15a)]:_0x6a8935[_0x5d13cb(0x287)];_0x1cd7b2[_0x5d13cb(0x182)]({'Train':'T'+_0x2089db['id'],'Total\x20Products':_0x2089db[_0x5d13cb(0x1aa)][_0x5d13cb(0x20c)],'Total\x20Machines':_0x4d1fec['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x2089db[_0x5d13cb(0x153)][_0x5d13cb(0x13a)](),'Products':_0x20e20b,'Machines':_0x31c096,'Worst-Case\x20Dosage\x20Form':_0x29fbde,'Safety\x20Factor':_0x31852d,'Lowest\x20LTD\x20(mg)':_0x2089db[_0x5d13cb(0x25a)],'Min\x20Batch\x20Size\x20(kg)':_0x2089db[_0x5d13cb(0x262)],'Min\x20BS/MDD\x20Ratio':_0x2089db['minBsMddRatio']['toFixed'](0x2),'Lowest\x20PDE\x20(mg)':_0x6a8935[_0x5d13cb(0x259)](null,_0x2089db[_0x5d13cb(0x2b1)])?_0x2089db[_0x5d13cb(0x2b1)]:_0x6a8935[_0x5d13cb(0x287)],'Worst-Case\x20Product\x20(by\x20RPN)':_0x14bbf4,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x5aa4a2[_0x5d13cb(0x296)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x911319[_0x5d13cb(0x296)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x6a8935[_0x5d13cb(0x18d)]==typeof _0x3a3349?_0x3a3349[_0x5d13cb(0x296)](0x2):_0x6a8935[_0x5d13cb(0x287)],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x52fc9c[_0x5d13cb(0x296)](0x2),'Selected\x20MACO\x20Method':_0x3d6797[_0x5d13cb(0x2f0)],'Final\x20MACO\x20(mg)':_0x43c926['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x5abb5b[_0x5d13cb(0x25f)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x3eb21b[_0x5d13cb(0x296)](0x4)});});const _0x212c77=XLSX[_0x48cb7e(0x2e9)]['json_to_sheet'](_0x1cd7b2),_0x1d7ab9=XLSX[_0x48cb7e(0x2e9)][_0x48cb7e(0x2a5)]();XLSX[_0x48cb7e(0x2e9)]['book_append_sheet'](_0x1d7ab9,_0x212c77,_0x6a8935[_0x48cb7e(0x23f)]),_0x212c77[_0x6a8935[_0x48cb7e(0x30f)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0x12},{'wch':0xf},{'wch':0x12},{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0x12},{'wch':0x12}];const _0x4df8d0=new Date()['toISOString']()[_0x48cb7e(0x1ba)]('T')[0x0];let _0x380281='Product_MACO_Report';if(_0x6a8935[_0x48cb7e(0x115)]!==_0x43901a){if(Array['isArray'](_0x43901a))_0x380281+=_0x48cb7e(0xea)+_0x43901a[_0x48cb7e(0x1f2)]((_0x54f64f,_0x375bfd)=>_0x54f64f-_0x375bfd)['join']('_');else _0x380281+=_0x48cb7e(0x124)+_0x43901a;}_0x380281+='_'+_0x4df8d0+_0x48cb7e(0x131),XLSX[_0x48cb7e(0x18b)](_0x1d7ab9,_0x380281),_0x6a8935['amycM'](hideLoader),_0x6a8935[_0x48cb7e(0x29c)](showCustomAlert,_0x48cb7e(0x303),_0x48cb7e(0x122));})[_0x198a28(0x278)](_0x3fdc59=>{const _0x3713a5=_0x198a28;console[_0x3713a5(0x10b)](_0x6a8935[_0x3713a5(0x209)],_0x3fdc59),_0x6a8935[_0x3713a5(0x18f)](hideLoader),_0x6a8935[_0x3713a5(0x199)](showCustomAlert,_0x6a8935[_0x3713a5(0x186)],_0x6a8935[_0x3713a5(0x1a7)]);});}export function exportDetergentMacoToExcel(_0x5ab3f5=a13_0x16a2fa(0x2d4)){const _0x2d9f17=a13_0x16a2fa,_0x43828a={'oSMlk':function(_0x2bb6c2,_0x21c61d){return _0x2bb6c2||_0x21c61d;},'GCWXo':function(_0x4e37be,_0x4cc973){return _0x4e37be(_0x4cc973);},'QARJy':function(_0x4d520f,_0x2dc965){return _0x4d520f*_0x2dc965;},'uUkbV':function(_0x1cc26e,_0x467d4f){return _0x1cc26e>_0x467d4f;},'zbdhb':function(_0x272c43){return _0x272c43();},'vEIOX':function(_0x148f95,_0x49391f){return _0x148f95!==_0x49391f;},'XLFPv':_0x2d9f17(0x2d4),'hPXYP':function(_0x22ed4c,_0x4e7d8c,_0x1b8dfc){return _0x22ed4c(_0x4e7d8c,_0x1b8dfc);},'pAncx':_0x2d9f17(0x25d),'VgxOA':function(_0x1eb532,_0x323da1){return _0x1eb532===_0x323da1;},'Nhdqi':function(_0x1433ee){return _0x1433ee();},'zaOxt':_0x2d9f17(0x2a8),'oKdfX':'bodyWeight','REmXo':_0x2d9f17(0x246),'xrhjP':_0x2d9f17(0x146),'YYMKl':_0x2d9f17(0x303),'FEiPI':'Detergent\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','JQNEr':function(_0x51be15){return _0x51be15();},'TKXBz':function(_0x43a9be,_0x1bf7ed,_0x50a395){return _0x43a9be(_0x1bf7ed,_0x50a395);},'QcuvL':_0x2d9f17(0x228),'lBYiK':function(_0x1665c4){return _0x1665c4();}};_0x43828a['lBYiK'](showLoader),import('./utils.js')[_0x2d9f17(0x283)](_0x5790b7=>{const _0x5f234d=_0x2d9f17,_0x499b17={'IKUXr':function(_0x1fbd97,_0x12fc42){const _0x4110ac=a13_0x434f;return _0x43828a[_0x4110ac(0x301)](_0x1fbd97,_0x12fc42);},'NXHNb':function(_0x7f5d51,_0x38116e){return _0x43828a['GCWXo'](_0x7f5d51,_0x38116e);},'fqQxr':function(_0x23fee4,_0x319591){return _0x23fee4/_0x319591;},'VLfnj':function(_0x385b61,_0x5a49a7){const _0x16e567=a13_0x434f;return _0x43828a[_0x16e567(0x310)](_0x385b61,_0x5a49a7);},'TKsiG':function(_0x5e91be,_0x1400f9){return _0x43828a['uUkbV'](_0x5e91be,_0x1400f9);},'Fgxsh':function(_0x3f025c,_0x4ed297){return _0x43828a['QARJy'](_0x3f025c,_0x4ed297);}},{getTrainData:_0x156545,getWorstCaseProductType:_0x90ce44}=_0x5790b7;let _0x429176=_0x43828a['zbdhb'](_0x156545);if(_0x43828a[_0x5f234d(0xdd)](_0x43828a['XLFPv'],_0x5ab3f5)&&(_0x429176=Array['isArray'](_0x5ab3f5)?_0x429176[_0x5f234d(0x245)](_0x18f222=>_0x5ab3f5[_0x5f234d(0x1b2)](String(_0x18f222['id']))):_0x429176[_0x5f234d(0x245)](_0x40a3b4=>String(_0x40a3b4['id'])===String(_0x5ab3f5))),0x0===_0x429176[_0x5f234d(0x20c)])return _0x43828a['zbdhb'](hideLoader),void _0x43828a['hPXYP'](showCustomAlert,_0x43828a['pAncx'],_0x5f234d(0x2e2));if(_0x43828a['VgxOA'](0x0,a13_0x210961[_0x5f234d(0x2b9)][_0x5f234d(0x20c)]))return _0x43828a[_0x5f234d(0xe7)](hideLoader),void _0x43828a[_0x5f234d(0x137)](showCustomAlert,_0x5f234d(0x25d),_0x43828a[_0x5f234d(0x11b)]);const _0x51df5f=[],_0x519e15=parseFloat(document[_0x5f234d(0x2e0)](_0x43828a[_0x5f234d(0x125)])?.[_0x5f234d(0x13e)])||0x46,_0x6aeae3=a13_0x210961[_0x5f234d(0x2b9)][_0x5f234d(0x1a2)](_0x217df6=>parseFloat(_0x217df6['ld50']))[_0x5f234d(0x245)](_0x2e38d6=>!isNaN(_0x2e38d6)),_0x12aa14=_0x6aeae3[_0x5f234d(0x20c)]>0x0?Math[_0x5f234d(0x18a)](..._0x6aeae3):0x0,_0x9b7546=a13_0x210961['detergentIngredients']['map'](_0x31884a=>_0x31884a[_0x5f234d(0x2f0)])[_0x5f234d(0x245)](_0x4018ef=>''!==_0x4018ef[_0x5f234d(0x29f)]())['join'](',\x20');_0x429176[_0x5f234d(0x177)](_0x52b399=>{const _0xc7b58c=_0x5f234d,_0x2409d3={'ZkKuJ':function(_0x800a93,_0x2b05cf){return _0x499b17['IKUXr'](_0x800a93,_0x2b05cf);},'jdtvV':_0xc7b58c(0x16e)},_0x4c55c1=_0x499b17[_0xc7b58c(0x290)](_0x90ce44,_0x52b399[_0xc7b58c(0x1aa)][_0xc7b58c(0x1a2)](_0x12fa74=>_0x12fa74[_0xc7b58c(0x16f)])),_0x6867eb=a13_0x210961[_0xc7b58c(0x267)][_0x4c55c1]||a13_0x210961[_0xc7b58c(0x267)][_0xc7b58c(0x1bb)],_0x1bf84d=document['getElementById']('sf-input-train-'+_0x52b399['id']),_0xe28c0d=_0x1bf84d&&_0x499b17['NXHNb'](parseFloat,_0x1bf84d[_0xc7b58c(0x13e)])||_0x6867eb[_0xc7b58c(0x14f)],_0x434ef2=_0x499b17[_0xc7b58c(0x1dd)](_0x499b17[_0xc7b58c(0x286)](0.0005,_0x12aa14)*_0x519e15,_0xe28c0d),_0x210592=_0x499b17[_0xc7b58c(0x286)](_0x434ef2,_0x52b399[_0xc7b58c(0x145)]),_0x1b1bc0=_0x5790b7[_0xc7b58c(0xe9)](_0x52b399,_0x429176),_0x4e574d=_0x499b17[_0xc7b58c(0x2d6)](_0x1b1bc0,0x0)?_0x210592/_0x1b1bc0:0x0,_0x3f2c73=_0x499b17[_0xc7b58c(0x2e1)](_0x4e574d,_0x52b399[_0xc7b58c(0xe8)]),_0x84210a=_0x52b399[_0xc7b58c(0x2b6)][_0xc7b58c(0x1a2)](_0x15f074=>{const _0x3596b4=_0xc7b58c,_0x426452=a13_0x210961['machines']['find'](_0x4e7a19=>_0x4e7a19['id']===_0x15f074);return _0x2409d3['ZkKuJ'](_0x426452,{'name':_0x3596b4(0x2a6)+_0x15f074+')','machineNumber':_0x2409d3[_0x3596b4(0x111)]});}),_0xc378bd=_0x52b399['machineIds'][_0xc7b58c(0x1a2)](_0x2badbd=>{const _0x4e0441=_0xc7b58c,_0x1ec696=a13_0x210961['machines'][_0x4e0441(0xfe)](_0x5ec0f4=>_0x5ec0f4['id']===_0x2badbd);return _0x1ec696?_0x1ec696[_0x4e0441(0x2f0)]:'Unknown\x20(ID:\x20'+_0x2badbd+')';})[_0xc7b58c(0x2fe)](',\x20'),_0x4d85df=_0x52b399[_0xc7b58c(0x1aa)][_0xc7b58c(0x1a2)](_0x55f562=>_0x55f562['productCode']+_0xc7b58c(0xda)+_0x55f562['name'])[_0xc7b58c(0x2fe)](';\x20'),_0x3594a0=_0x52b399[_0xc7b58c(0x1bd)]?_0x52b399[_0xc7b58c(0x1bd)][_0xc7b58c(0x10f)]+'\x20('+_0x52b399[_0xc7b58c(0x1bd)][_0xc7b58c(0x1a5)]+_0xc7b58c(0x17a)+_0x52b399['worstProductRpn']['rpn']:_0xc7b58c(0x16e);_0x51df5f['push']({'Train':'T'+_0x52b399['id'],'Total\x20Products':_0x52b399[_0xc7b58c(0x1aa)][_0xc7b58c(0x20c)],'Total\x20Machines':_0x84210a[_0xc7b58c(0x20c)],'Total\x20Area\x20(ESSA)\x20cm²':_0x52b399[_0xc7b58c(0x153)][_0xc7b58c(0x13a)](),'Products':_0x4d85df,'Machines':_0xc378bd,'Worst-Case\x20Dosage\x20Form':_0x4c55c1,'Safety\x20Factor\x20Range':_0x6867eb['min']+_0xc7b58c(0xda)+_0x6867eb[_0xc7b58c(0x14f)],'Applied\x20Safety\x20Factor':_0xe28c0d,'Detergent\x20Ingredients':_0x9b7546,'Body\x20Weight\x20(kg)':_0x519e15,'Minimum\x20LD50\x20(mg/kg)':_0x12aa14,'Min\x20Batch\x20Size\x20(kg)':_0x52b399['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x52b399[_0xc7b58c(0x145)][_0xc7b58c(0x296)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x3594a0,'ADI\x20(mg)':_0x434ef2['toFixed'](0x4),'MACO\x20(mg)':_0x210592['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x4e574d[_0xc7b58c(0x25f)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x3f2c73[_0xc7b58c(0x296)](0x4)});});const _0x445b02=XLSX[_0x5f234d(0x2e9)]['json_to_sheet'](_0x51df5f),_0x32d3c9=XLSX[_0x5f234d(0x2e9)]['book_new']();XLSX[_0x5f234d(0x2e9)][_0x5f234d(0x2b7)](_0x32d3c9,_0x445b02,_0x43828a[_0x5f234d(0x191)]),_0x445b02[_0x43828a[_0x5f234d(0x202)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0x1e},{'wch':0xc},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0xc},{'wch':0xc},{'wch':0x12},{'wch':0x12}];const _0x398b1e=new Date()['toISOString']()[_0x5f234d(0x1ba)]('T')[0x0];XLSX['writeFile'](_0x32d3c9,_0x5f234d(0x1e8)+_0x398b1e+_0x5f234d(0x131)),_0x43828a[_0x5f234d(0xc8)](hideLoader),showCustomAlert(_0x43828a[_0x5f234d(0x309)],_0x43828a[_0x5f234d(0x255)]);})[_0x2d9f17(0x278)](_0x398f8e=>{const _0x562d2b=_0x2d9f17;console['error']('Error\x20exporting\x20Detergent\x20MACO\x20to\x20Excel:',_0x398f8e),_0x43828a['JQNEr'](hideLoader),_0x43828a['TKXBz'](showCustomAlert,_0x43828a[_0x562d2b(0x118)],'Failed\x20to\x20export\x20Detergent\x20MACO\x20data\x20to\x20Excel.');});}export function exportTrainSummaryToExcel(_0xf79db5='all'){const _0x2272c0=a13_0x16a2fa,_0x4bb2c0={'SqpGC':function(_0xeb9f1e,_0x2cfb11){return _0xeb9f1e||_0x2cfb11;},'uaRDH':function(_0x2158b4,_0x24a649){return _0x2158b4!==_0x24a649;},'XnBnM':'N/A','thwVM':function(_0x128e92){return _0x128e92();},'zcbjp':function(_0x31c765,_0x388383){return _0x31c765===_0x388383;},'zTCNz':function(_0x30bad7){return _0x30bad7();},'shBkV':function(_0x33121f,_0x2b2fb0,_0x42560c){return _0x33121f(_0x2b2fb0,_0x42560c);},'uuDNt':_0x2272c0(0x25d),'ysaGZ':_0x2272c0(0x2e2),'saHYf':'all','IJCPX':function(_0x42ffc0,_0x2c5bb8){return _0x42ffc0===_0x2c5bb8;},'IciCC':function(_0x5adb03,_0x4f81b9,_0xc35ada){return _0x5adb03(_0x4f81b9,_0xc35ada);},'ZUWrY':'No\x20trains\x20match\x20the\x20selected\x20criteria.','pKvxp':_0x2272c0(0x146),'NqyuL':_0x2272c0(0x14d),'mamag':function(_0x3e1370,_0xc87383){return _0x3e1370!==_0xc87383;},'WKEDD':function(_0x13f96a,_0x4b24cb,_0x26acb5){return _0x13f96a(_0x4b24cb,_0x26acb5);},'EiEks':_0x2272c0(0x303),'fMxCT':_0x2272c0(0x12f),'RbPSX':_0x2272c0(0x154),'wZTmL':_0x2272c0(0x228),'XJtDs':_0x2272c0(0x17c),'GbJio':'./utils.js'};_0x4bb2c0['thwVM'](showLoader),import(_0x4bb2c0[_0x2272c0(0x22c)])['then'](_0x1749e9=>{const _0x5a021f=_0x2272c0,{getTrainData:_0x3c4230}=_0x1749e9,_0x35a54b=_0x4bb2c0['thwVM'](_0x3c4230);if(_0x4bb2c0[_0x5a021f(0x261)](0x0,_0x35a54b[_0x5a021f(0x20c)]))return _0x4bb2c0[_0x5a021f(0x2fc)](hideLoader),void _0x4bb2c0[_0x5a021f(0x1b1)](showCustomAlert,_0x4bb2c0[_0x5a021f(0x1dc)],_0x4bb2c0[_0x5a021f(0x189)]);let _0x3a2da9=_0x35a54b;if(_0x4bb2c0[_0x5a021f(0x22d)]!==_0xf79db5&&(_0x3a2da9=Array[_0x5a021f(0x271)](_0xf79db5)?_0x35a54b[_0x5a021f(0x245)](_0x2b6e5f=>_0xf79db5['includes'](String(_0x2b6e5f['id']))):_0x35a54b[_0x5a021f(0x245)](_0x2b0315=>String(_0x2b0315['id'])===String(_0xf79db5))),_0x4bb2c0[_0x5a021f(0x173)](0x0,_0x3a2da9[_0x5a021f(0x20c)]))return hideLoader(),void _0x4bb2c0[_0x5a021f(0x1a6)](showCustomAlert,_0x4bb2c0['uuDNt'],_0x4bb2c0[_0x5a021f(0x2c4)]);const _0x16e3b4=[];_0x3a2da9[_0x5a021f(0x177)](_0xde4f71=>{const _0x2233de=_0x5a021f,_0x28b856={'XSoec':function(_0x4a67a9,_0x38d22d){const _0x42b25e=a13_0x434f;return _0x4bb2c0[_0x42b25e(0xf4)](_0x4a67a9,_0x38d22d);},'gFZcj':_0x2233de(0x16e)},_0x49a003=_0xde4f71['machineIds'][_0x2233de(0x1a2)](_0x65e6d4=>{const _0x5bd458=_0x2233de,_0x515941=a13_0x210961['machines'][_0x5bd458(0xfe)](_0x4a49c5=>_0x4a49c5['id']===_0x65e6d4);return _0x28b856[_0x5bd458(0x116)](_0x515941,{'id':_0x65e6d4,'name':'Unknown\x20(ID:\x20'+_0x65e6d4+')','machineNumber':_0x28b856['gFZcj']});}),_0x2b47b7=_0xde4f71['machineIds']['map'](_0x438d50=>{const _0x3043c4=_0x2233de,_0x4c3bd7=a13_0x210961['machines'][_0x3043c4(0xfe)](_0x2a989d=>_0x2a989d['id']===_0x438d50);return _0x4c3bd7?_0x4c3bd7['name']:_0x3043c4(0x2a6)+_0x438d50+')';})[_0x2233de(0x2fe)](',\x20'),_0x59d168=_0xde4f71[_0x2233de(0x1aa)][_0x2233de(0x1a2)](_0x4b9418=>_0x4b9418[_0x2233de(0x2bd)]+_0x2233de(0xda)+_0x4b9418[_0x2233de(0x2f0)])[_0x2233de(0x2fe)](';\x20'),_0x149c34=_0xde4f71['products'][_0x2233de(0x1a2)](_0x92fb5d=>_0x92fb5d['productCode']+':\x20'+_0x92fb5d[_0x2233de(0x2f0)])[_0x2233de(0x2fe)]('\x0a'),_0x52c2ca=_0x49a003[_0x2233de(0x1a2)](_0x60fa96=>_0x60fa96[_0x2233de(0x233)]+':\x20'+_0x60fa96[_0x2233de(0x2f0)])[_0x2233de(0x2fe)]('\x0a');_0x16e3b4[_0x2233de(0x182)]({'Train\x20ID':'T'+_0xde4f71['id'],'Products\x20Count':_0xde4f71[_0x2233de(0x1aa)][_0x2233de(0x20c)],'Machines\x20Count':_0x49a003['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0xde4f71['essa'][_0x2233de(0x13a)](),'Products\x20(Code\x20-\x20Name)':_0x59d168,'Machines\x20(Number\x20-\x20Name)':_0x2b47b7,'Products\x20Detailed':_0x149c34,'Machines\x20Detailed':_0x52c2ca,'Min\x20Batch\x20Size\x20(kg)':_0xde4f71['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0xde4f71[_0x2233de(0x145)][_0x2233de(0x296)](0x2),'Assumed\x20SSA\x20(cm²)':_0xde4f71['assumedSsa'],'Lowest\x20LTD\x20(mg)':_0xde4f71[_0x2233de(0x25a)],'Lowest\x20PDE\x20(mg)':_0x4bb2c0[_0x2233de(0x1a1)](null,_0xde4f71[_0x2233de(0x2b1)])?_0xde4f71[_0x2233de(0x2b1)]:_0x4bb2c0[_0x2233de(0x120)],'Worst\x20RPN\x20Product':_0xde4f71[_0x2233de(0x1bd)]?_0xde4f71['worstProductRpn'][_0x2233de(0x10f)]+'\x20('+_0xde4f71[_0x2233de(0x1bd)][_0x2233de(0x1a5)]+_0x2233de(0x17a)+_0xde4f71[_0x2233de(0x1bd)][_0x2233de(0x15a)]:_0x4bb2c0[_0x2233de(0x120)]});});const _0x15fbc6=XLSX[_0x5a021f(0x2e9)][_0x5a021f(0x2fd)](_0x16e3b4),_0x2d6981=XLSX[_0x5a021f(0x2e9)][_0x5a021f(0x2a5)]();XLSX['utils'][_0x5a021f(0x2b7)](_0x2d6981,_0x15fbc6,_0x5a021f(0x1fa)),_0x15fbc6[_0x4bb2c0[_0x5a021f(0x300)]]=[{'wch':0xa},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x3c},{'wch':0x3c},{'wch':0x28},{'wch':0x28},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32}];const _0x47add2=new Date()['toISOString']()[_0x5a021f(0x1ba)]('T')[0x0];let _0x2dacc0=_0x4bb2c0['NqyuL'];if(_0x4bb2c0[_0x5a021f(0x24b)](_0x4bb2c0[_0x5a021f(0x22d)],_0xf79db5)){if(Array[_0x5a021f(0x271)](_0xf79db5))_0x2dacc0+=_0x5a021f(0xea)+_0xf79db5['sort']((_0x50b263,_0x53d7ce)=>_0x50b263-_0x53d7ce)[_0x5a021f(0x2fe)]('_');else _0x2dacc0+=_0x5a021f(0x124)+_0xf79db5;}_0x2dacc0+='_'+_0x47add2+_0x5a021f(0x131),XLSX[_0x5a021f(0x18b)](_0x2d6981,_0x2dacc0),hideLoader(),_0x4bb2c0[_0x5a021f(0x1f1)](showCustomAlert,_0x4bb2c0[_0x5a021f(0x24c)],_0x4bb2c0[_0x5a021f(0xd8)]);})[_0x2272c0(0x278)](_0x139c89=>{const _0x55f8e5=_0x2272c0;console[_0x55f8e5(0x10b)](_0x4bb2c0[_0x55f8e5(0x23c)],_0x139c89),hideLoader(),_0x4bb2c0[_0x55f8e5(0x1f1)](showCustomAlert,_0x4bb2c0['wZTmL'],_0x4bb2c0[_0x55f8e5(0x243)]);});}export function exportSummaryToExcel(){const _0x1e93b3=a13_0x16a2fa,_0x12475b={'TLMGr':function(_0x578a31,_0x4673e9){return _0x578a31(_0x4673e9);},'cTHcE':'N/A','jmZru':function(_0x438901,_0x22bcc0){return _0x438901!==_0x22bcc0;},'VViuO':_0x1e93b3(0x2f6),'yrDEm':function(_0x1ac067,_0x3d6388){return _0x1ac067(_0x3d6388);},'QjzEk':function(_0x1fae3a,_0x39ddac){return _0x1fae3a>_0x39ddac;},'QvaSR':function(_0x227eba,_0x5e0888){return _0x227eba===_0x5e0888;},'maGry':function(_0x1ca2f2){return _0x1ca2f2();},'oyJmd':function(_0x39ad60,_0x55b809){return _0x39ad60>_0x55b809;},'ctWLR':_0x1e93b3(0x146),'esqIE':_0x1e93b3(0x292),'npSdy':_0x1e93b3(0x1ca),'ryIRQ':function(_0x269fb4,_0x5ada46,_0x36a742){return _0x269fb4(_0x5ada46,_0x36a742);},'qZSCS':'Success','PtvEx':'Error\x20exporting\x20Summary\x20to\x20Excel:','TUhFb':_0x1e93b3(0x228),'auvIU':_0x1e93b3(0x1e2),'gRdeV':_0x1e93b3(0x188)};_0x12475b[_0x1e93b3(0x109)](showLoader),import(_0x12475b[_0x1e93b3(0x2ac)])[_0x1e93b3(0x283)](_0x5a0d37=>{const _0x4a234c=_0x1e93b3,_0x5a5724={'NXYFT':function(_0x3932a3,_0x58b011){const _0x3b00d6=a13_0x434f;return _0x12475b[_0x3b00d6(0x16c)](_0x3932a3,_0x58b011);},'WgXzN':function(_0x29430c,_0x5e522c){return _0x12475b['QjzEk'](_0x29430c,_0x5e522c);}},{getProductTrainId:_0x16fc3a,calculateScores:_0x3cd6da}=_0x5a0d37,_0xba1d65=a13_0x210961['products'][_0x4a234c(0x20f)](_0x5d733a=>{const _0x3a0d98=_0x4a234c,_0x1a0e37=_0x5a5724[_0x3a0d98(0x10a)](_0x16fc3a,_0x5d733a);return _0x5d733a[_0x3a0d98(0x275)]['map'](_0x488893=>({'productName':_0x5d733a['name'],'productCode':_0x5d733a[_0x3a0d98(0x2bd)],'ingredientName':_0x488893[_0x3a0d98(0x2f0)],'rpn':_0x3cd6da(_0x488893)[_0x3a0d98(0x15a)],'trainId':_0x3a0d98(0x16e)!==_0x1a0e37?'T'+_0x1a0e37:_0x3a0d98(0x16e),'scores':_0x3cd6da(_0x488893)}));})[_0x4a234c(0x1f2)]((_0x229f80,_0x183a76)=>_0x183a76['rpn']-_0x229f80[_0x4a234c(0x15a)])[_0x4a234c(0x29d)](0x0,0xa),_0x323298=a13_0x210961['products'][_0x4a234c(0x245)](_0x3c5b5f=>_0x3c5b5f[_0x4a234c(0x13d)]);if(_0x12475b['QvaSR'](0x0,_0xba1d65['length'])&&0x0===_0x323298[_0x4a234c(0x20c)])return _0x12475b[_0x4a234c(0x109)](hideLoader),void showCustomAlert(_0x4a234c(0x25d),'There\x20are\x20no\x20summary\x20data\x20to\x20export.\x20Add\x20products\x20and\x20ingredients\x20first.');const _0x3ce203=XLSX['utils'][_0x4a234c(0x2a5)]();if(_0x12475b[_0x4a234c(0x227)](_0xba1d65[_0x4a234c(0x20c)],0x0)){const _0x2acaac=_0xba1d65['map']((_0x8e1dfc,_0x48490e)=>({'Rank':_0x48490e+0x1,'Product\x20Code':_0x8e1dfc[_0x4a234c(0x2bd)],'Product\x20Name':_0x8e1dfc['productName'],'Train':_0x8e1dfc[_0x4a234c(0x2f1)],'Ingredient':_0x8e1dfc[_0x4a234c(0x1a5)],'RPN':_0x8e1dfc[_0x4a234c(0x15a)]})),_0x1c61c0=XLSX[_0x4a234c(0x2e9)][_0x4a234c(0x2fd)](_0x2acaac),_0x4c1ca4=[{'wch':0x8},{'wch':0xf},{'wch':0x1e},{'wch':0xa},{'wch':0x19},{'wch':0x8}];_0x1c61c0[_0x4a234c(0x146)]=_0x4c1ca4,XLSX[_0x4a234c(0x2e9)][_0x4a234c(0x2b7)](_0x3ce203,_0x1c61c0,_0x4a234c(0x2e4));}if(_0x323298[_0x4a234c(0x20c)]>0x0){const _0x2ffa61=_0x323298[_0x4a234c(0x1a2)](_0x5de24a=>({'Product\x20Code':_0x5de24a[_0x4a234c(0x2bd)],'Product\x20Name':_0x5de24a['name'],'Product\x20Type':_0x5de24a[_0x4a234c(0x16f)],'Batch\x20Size\x20(kg)':_0x5de24a[_0x4a234c(0x205)],'MDD\x20(mg)':_0x5de24a[_0x4a234c(0x2c1)],'Critical\x20Reason':_0x5de24a[_0x4a234c(0x26a)]||_0x4a234c(0x1f4),'Train':'N/A'!==_0x16fc3a(_0x5de24a)?'T'+_0x16fc3a(_0x5de24a):_0x4a234c(0x16e)})),_0xd6ea51=XLSX[_0x4a234c(0x2e9)][_0x4a234c(0x2fd)](_0x2ffa61),_0x21f531=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32},{'wch':0xa}];_0xd6ea51[_0x12475b[_0x4a234c(0x20e)]]=_0x21f531,XLSX[_0x4a234c(0x2e9)][_0x4a234c(0x2b7)](_0x3ce203,_0xd6ea51,_0x12475b[_0x4a234c(0x2ad)]);}const _0x5bacfc=a13_0x210961[_0x4a234c(0x1aa)]['map'](_0xe07e8f=>{const _0x1c797d=_0x4a234c,_0x19a408=_0x12475b['TLMGr'](_0x16fc3a,_0xe07e8f),_0x50aa0a=_0xe07e8f[_0x1c797d(0x275)][_0x1c797d(0x258)]((_0x5ba989,_0x938901)=>{const _0x1466f3=_0x1c797d,_0x5ef3bb=_0x3cd6da(_0x938901)[_0x1466f3(0x15a)];return _0x5a5724[_0x1466f3(0x2ca)](_0x5ef3bb,_0x5ba989[_0x1466f3(0x15a)])?{..._0x938901,'rpn':_0x5ef3bb}:_0x5ba989;},{'rpn':0x0,'name':_0x12475b[_0x1c797d(0x317)]});return{'Product\x20Code':_0xe07e8f[_0x1c797d(0x2bd)],'Product\x20Name':_0xe07e8f[_0x1c797d(0x2f0)],'Product\x20Type':_0xe07e8f['productType'],'Batch\x20Size\x20(kg)':_0xe07e8f['batchSizeKg'],'MDD\x20(mg)':_0xe07e8f[_0x1c797d(0x2c1)],'Train':_0x12475b[_0x1c797d(0x1c9)](_0x1c797d(0x16e),_0x19a408)?'T'+_0x19a408:_0x12475b[_0x1c797d(0x317)],'Is\x20Critical':_0xe07e8f[_0x1c797d(0x13d)]?_0x12475b[_0x1c797d(0x1c4)]:'No','Critical\x20Reason':_0xe07e8f[_0x1c797d(0x26a)]||_0x12475b[_0x1c797d(0x317)],'Ingredients\x20Count':_0xe07e8f[_0x1c797d(0x275)][_0x1c797d(0x20c)],'Highest\x20RPN\x20Ingredient':_0x50aa0a[_0x1c797d(0x2f0)],'Highest\x20RPN\x20Value':_0x50aa0a[_0x1c797d(0x15a)]||0x0};}),_0x3cb36f=XLSX[_0x4a234c(0x2e9)]['json_to_sheet'](_0x5bacfc);_0x3cb36f[_0x12475b[_0x4a234c(0x20e)]]=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xa},{'wch':0xa},{'wch':0x28},{'wch':0xc},{'wch':0x19},{'wch':0xc}],XLSX[_0x4a234c(0x2e9)]['book_append_sheet'](_0x3ce203,_0x3cb36f,_0x12475b[_0x4a234c(0x1f0)]);const _0x560317=new Date()[_0x4a234c(0x1be)]()['split']('T')[0x0];XLSX[_0x4a234c(0x18b)](_0x3ce203,_0x4a234c(0x2cf)+_0x560317+_0x4a234c(0x131)),_0x12475b['maGry'](hideLoader),_0x12475b[_0x4a234c(0x2b3)](showCustomAlert,_0x12475b[_0x4a234c(0x142)],_0x4a234c(0x128));})[_0x1e93b3(0x278)](_0x4738ab=>{const _0x8a43b4=_0x1e93b3;console[_0x8a43b4(0x10b)](_0x12475b['PtvEx'],_0x4738ab),_0x12475b['maGry'](hideLoader),_0x12475b[_0x8a43b4(0x2b3)](showCustomAlert,_0x12475b[_0x8a43b4(0x1ac)],_0x12475b[_0x8a43b4(0x139)]);});}export function exportAllTabsToExcel(){const _0xac9670=a13_0x16a2fa,_0x40b650={'uVJZp':function(_0x483d7c,_0x5efaca){return _0x483d7c||_0x5efaca;},'kJmQg':'N/A','vRPrV':function(_0xaddbfd,_0x3ad864){return _0xaddbfd(_0x3ad864);},'UYAYs':function(_0x54f3ca,_0x2136c5){return _0x54f3ca/_0x2136c5;},'MUYWD':function(_0x2ffbf2,_0x3ff47e){return _0x2ffbf2*_0x3ff47e;},'HUXbf':function(_0x39856b,_0x16ba91,_0x588dd4){return _0x39856b(_0x16ba91,_0x588dd4);},'gbgDd':function(_0x462670,_0x7c95d9){return _0x462670>_0x7c95d9;},'vcmeH':function(_0x36b1a7,_0x19444b){return _0x36b1a7(_0x19444b);},'YVQtI':function(_0x170b9c,_0x14508b){return _0x170b9c!==_0x14508b;},'gxAlv':function(_0x5216cd,_0x306b1d){return _0x5216cd===_0x306b1d;},'exQJU':_0xac9670(0x14c),'hUITg':function(_0x4e7304,_0x418b03){return _0x4e7304===_0x418b03;},'ztphl':function(_0x52bfdf,_0x121756){return _0x52bfdf*_0x121756;},'PvsmM':function(_0x52383c,_0x32a833){return _0x52383c/_0x32a833;},'eafDk':_0xac9670(0x16d),'lQoOE':_0xac9670(0x1af),'jmUNF':_0xac9670(0x1f8),'KMogd':'Health-Based\x20Limit\x20(NOEL)','eKkjK':function(_0x12d005,_0x18de56){return _0x12d005>_0x18de56;},'pnhGt':function(_0x10acda,_0x54411b){return _0x10acda==_0x54411b;},'xJytO':_0xac9670(0x134),'EzPto':_0xac9670(0x2f6),'BHIlo':function(_0x1bd4f9){return _0x1bd4f9();},'orkpQ':function(_0xc755c8,_0x20a6da){return _0xc755c8===_0x20a6da;},'kODcd':_0xac9670(0x25d),'hoXIx':'Product\x20MACO','nUuqZ':_0xac9670(0x22a),'pELeQ':_0xac9670(0x2dd),'VqIko':'Detergent\x20MACO','msSRX':_0xac9670(0x2ae),'RBAny':_0xac9670(0x1d1),'XpdKk':_0xac9670(0x1a9),'liavh':'Error\x20creating\x20Critical\x20Products\x20sheet:','zyEWf':'All\x20Products','hGbAz':_0xac9670(0xdf),'HhCcA':_0xac9670(0x15b),'uqkrZ':function(_0x40a059,_0x2c4c3a,_0x92d04f){return _0x40a059(_0x2c4c3a,_0x92d04f);},'ldwRm':_0xac9670(0x28d),'ovBBr':'Error\x20exporting\x20all\x20tabs\x20to\x20Excel:','tWtKo':function(_0xa7b6fe){return _0xa7b6fe();},'REhlu':_0xac9670(0x228),'JGLVs':'Failed\x20to\x20export\x20complete\x20report\x20to\x20Excel.','Gvdes':'./utils.js'};showLoader(),import(_0x40b650[_0xac9670(0x1d8)])[_0xac9670(0x283)](_0x2b7a6d=>{const _0xd8a935=_0xac9670,_0x320a5c={'SHhLI':function(_0x269ace,_0xd564e2){return _0x269ace||_0xd564e2;},'BsijR':function(_0x2f10e0,_0x2b5b03){return _0x2f10e0(_0x2b5b03);},'FYUlo':function(_0x58452c,_0x544dea){return _0x40b650['UYAYs'](_0x58452c,_0x544dea);},'hExkr':function(_0x2bca6e,_0x1ec9ad){return _0x40b650['UYAYs'](_0x2bca6e,_0x1ec9ad);},'IMwaN':function(_0x258819,_0x2e3b31){const _0x2067b8=a13_0x434f;return _0x40b650[_0x2067b8(0x270)](_0x258819,_0x2e3b31);},'ChNIS':'true','rYNqV':_0x40b650[_0xd8a935(0x203)],'LPHUB':function(_0x48478b,_0x3f17f7){const _0x39d14c=_0xd8a935;return _0x40b650[_0x39d14c(0x158)](_0x48478b,_0x3f17f7);},'kRojV':_0xd8a935(0x2d0),'ZXvwW':function(_0x34f432,_0x7f1bf){return _0x40b650['ztphl'](_0x34f432,_0x7f1bf);},'XPima':function(_0x454aae,_0xbb4530){return _0x454aae*_0xbb4530;},'igupt':function(_0x321c95,_0x480a8d){const _0x548519=_0xd8a935;return _0x40b650[_0x548519(0x14a)](_0x321c95,_0x480a8d);},'fnxgM':function(_0x651756,_0x4eaf69,_0xba2f3f){const _0x119a85=_0xd8a935;return _0x40b650[_0x119a85(0x1b3)](_0x651756,_0x4eaf69,_0xba2f3f);},'OaCiO':_0x40b650[_0xd8a935(0x1ef)],'LGKDD':_0x40b650['lQoOE'],'bQOKW':_0x40b650[_0xd8a935(0x269)],'JzaJl':function(_0x1179f4,_0x262fdb){return _0x40b650['gxAlv'](_0x1179f4,_0x262fdb);},'XZBUi':_0x40b650[_0xd8a935(0xeb)],'cxMFv':function(_0x1d71bc,_0x1f9cd3){const _0x174fec=_0xd8a935;return _0x40b650[_0x174fec(0x13c)](_0x1d71bc,_0x1f9cd3);},'JYHPL':function(_0x705117,_0x5f9fe9){const _0x3c7d74=_0xd8a935;return _0x40b650[_0x3c7d74(0x187)](_0x705117,_0x5f9fe9);},'Lvtbg':_0x40b650[_0xd8a935(0x28e)],'acbCP':function(_0x4a64b9,_0x488a62){return _0x4a64b9!==_0x488a62;},'ZnpXR':function(_0x52e7a1,_0x3f1c9c){const _0x21da42=_0xd8a935;return _0x40b650[_0x21da42(0x2ea)](_0x52e7a1,_0x3f1c9c);},'uqqVC':_0x40b650[_0xd8a935(0x23e)],'qOBhG':_0x40b650[_0xd8a935(0xcb)]},{getTrainData:_0x39e44e,getWorstCaseProductType:_0x3b71f7,getProductTrainId:_0x586a4d,calculateScores:_0x56b300}=_0x2b7a6d,_0x525e6f=_0x40b650[_0xd8a935(0x2c8)](_0x39e44e);if(_0x40b650['orkpQ'](0x0,_0x525e6f['length']))return hideLoader(),void showCustomAlert(_0x40b650[_0xd8a935(0x21a)],_0xd8a935(0x2e2));const _0x98ef5d=XLSX[_0xd8a935(0x2e9)][_0xd8a935(0x2a5)]();try{const _0x38aeeb=[];_0x525e6f['forEach'](_0x10af0e=>{const _0x5dc8c1=_0xd8a935,_0x1eedf9={'YUwfo':function(_0x443a23,_0x2d8b59){const _0x45eb2b=a13_0x434f;return _0x320a5c[_0x45eb2b(0x2cc)](_0x443a23,_0x2d8b59);},'CfaeK':_0x5dc8c1(0x16e)},_0x2c0599=_0x320a5c[_0x5dc8c1(0xce)](_0x3b71f7,_0x10af0e[_0x5dc8c1(0x1aa)]['map'](_0x4250b4=>_0x4250b4[_0x5dc8c1(0x16f)])),_0x28db42=(a13_0x210961[_0x5dc8c1(0x267)][_0x2c0599]||a13_0x210961[_0x5dc8c1(0x267)]['Other'])['max'],_0x1a2f8d=_0x320a5c['FYUlo'](_0x10af0e[_0x5dc8c1(0x25a)]*_0x10af0e[_0x5dc8c1(0x145)],_0x28db42),_0x2c8817=0xa*_0x10af0e[_0x5dc8c1(0x262)];let _0xfa88ae=_0x320a5c[_0x5dc8c1(0x2d5)](0x1,0x0),_0x14d830=0x1/0x0;const _0x3b593d=_0x320a5c[_0x5dc8c1(0x1d3)](_0x320a5c[_0x5dc8c1(0x1fe)],localStorage['getItem'](_0x320a5c[_0x5dc8c1(0x19f)])),_0x254e01=_0x320a5c[_0x5dc8c1(0x30b)](_0x320a5c[_0x5dc8c1(0x1fe)],localStorage[_0x5dc8c1(0xed)](_0x320a5c[_0x5dc8c1(0xc5)]));if(null===_0x10af0e[_0x5dc8c1(0x2b1)]||_0x3b593d||(_0xfa88ae=_0x320a5c[_0x5dc8c1(0x10e)](_0x10af0e[_0x5dc8c1(0x2b1)],_0x10af0e[_0x5dc8c1(0x145)])),null!==_0x10af0e[_0x5dc8c1(0x211)]&&!_0x254e01){const _0x47b2d3=_0x320a5c[_0x5dc8c1(0x2d5)](_0x320a5c['XPima'](0x46,_0x10af0e[_0x5dc8c1(0x211)]),0x7d0),_0x2af6ef=_0x10af0e[_0x5dc8c1(0x1aa)][_0x5dc8c1(0x20f)](_0x4531c0=>_0x4531c0[_0x5dc8c1(0x275)][_0x5dc8c1(0x1a2)](_0x134ea0=>_0x134ea0[_0x5dc8c1(0x13b)]/0x3e8)),_0x1213d1=Math[_0x5dc8c1(0x18a)](..._0x2af6ef);_0x14d830=_0x320a5c[_0x5dc8c1(0x224)](_0x320a5c['ZXvwW'](_0x47b2d3,_0x10af0e[_0x5dc8c1(0x262)])*0x3e8,_0x320a5c[_0x5dc8c1(0x10e)](_0x28db42,_0x1213d1));}const _0x458d70=_0x320a5c[_0x5dc8c1(0x2b0)](getLargestEssaForLineAndDosageForm,_0x10af0e,_0x525e6f),_0x468f7f=0.004*_0x458d70,_0x1de1b9=[{'name':_0x320a5c[_0x5dc8c1(0x2ba)],'value':_0x1a2f8d},{'name':_0x320a5c[_0x5dc8c1(0x194)],'value':_0x2c8817}];_0x320a5c[_0x5dc8c1(0x30b)](null,_0x10af0e['lowestPde'])||_0x3b593d||_0x1de1b9[_0x5dc8c1(0x182)]({'name':_0x320a5c[_0x5dc8c1(0x107)],'value':_0xfa88ae}),_0x320a5c[_0x5dc8c1(0x28c)](null,_0x10af0e[_0x5dc8c1(0x211)])||_0x254e01||_0x1de1b9[_0x5dc8c1(0x182)]({'name':_0x320a5c[_0x5dc8c1(0x11f)],'value':_0x14d830}),_0x1de1b9[_0x5dc8c1(0x182)]({'name':_0x5dc8c1(0x2e8),'value':_0x468f7f});const _0x3547e4=_0x1de1b9[_0x5dc8c1(0x258)]((_0x478819,_0x5173c3)=>_0x5173c3['value']<_0x478819[_0x5dc8c1(0x13e)]?_0x5173c3:_0x478819),_0x4d21a4=_0x3547e4[_0x5dc8c1(0x13e)],_0x3d5ea2=_0x320a5c['cxMFv'](_0x458d70,0x0)?_0x320a5c[_0x5dc8c1(0x176)](_0x4d21a4,_0x458d70):0x0,_0xe7f0b9=_0x3d5ea2*_0x10af0e[_0x5dc8c1(0xe8)],_0x497226=_0x10af0e['machineIds'][_0x5dc8c1(0x1a2)](_0x519ea5=>{const _0x53bca4=_0x5dc8c1,_0x5c8b4b=a13_0x210961['machines'][_0x53bca4(0xfe)](_0x3092a4=>_0x3092a4['id']===_0x519ea5);return _0x1eedf9[_0x53bca4(0x1d9)](_0x5c8b4b,{'name':_0x53bca4(0x2a6)+_0x519ea5+')','machineNumber':_0x1eedf9[_0x53bca4(0x2c7)]});}),_0x49ee8a=_0x10af0e[_0x5dc8c1(0x2b6)][_0x5dc8c1(0x1a2)](_0x23a527=>{const _0x405866=_0x5dc8c1,_0x4c00ae=a13_0x210961[_0x405866(0x12c)][_0x405866(0xfe)](_0x2f20fb=>_0x2f20fb['id']===_0x23a527);return _0x4c00ae?_0x4c00ae[_0x405866(0x2f0)]:_0x405866(0x2a6)+_0x23a527+')';})[_0x5dc8c1(0x2fe)](',\x20'),_0x5c0e29=_0x10af0e['products'][_0x5dc8c1(0x1a2)](_0x3421ee=>_0x3421ee['productCode']+_0x5dc8c1(0xda)+_0x3421ee[_0x5dc8c1(0x2f0)])[_0x5dc8c1(0x2fe)](';\x20'),_0x2181ea=_0x10af0e[_0x5dc8c1(0x1bd)]?_0x10af0e['worstProductRpn'][_0x5dc8c1(0x10f)]+'\x20('+_0x10af0e['worstProductRpn']['ingredientName']+_0x5dc8c1(0x17a)+_0x10af0e['worstProductRpn'][_0x5dc8c1(0x15a)]:_0x320a5c[_0x5dc8c1(0x1ee)];_0x38aeeb[_0x5dc8c1(0x182)]({'Train':'T'+_0x10af0e['id'],'Total\x20Products':_0x10af0e['products'][_0x5dc8c1(0x20c)],'Total\x20Machines':_0x497226['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x10af0e[_0x5dc8c1(0x153)][_0x5dc8c1(0x13a)](),'Products':_0x5c0e29,'Machines':_0x49ee8a,'Worst-Case\x20Dosage\x20Form':_0x2c0599,'Safety\x20Factor':_0x28db42,'Lowest\x20LTD\x20(mg)':_0x10af0e[_0x5dc8c1(0x25a)],'Min\x20Batch\x20Size\x20(kg)':_0x10af0e[_0x5dc8c1(0x262)],'Min\x20BS/MDD\x20Ratio':_0x10af0e[_0x5dc8c1(0x145)][_0x5dc8c1(0x296)](0x2),'Lowest\x20PDE\x20(mg)':_0x320a5c['acbCP'](null,_0x10af0e[_0x5dc8c1(0x2b1)])?_0x10af0e[_0x5dc8c1(0x2b1)]:'N/A','Worst-Case\x20Product\x20(by\x20RPN)':_0x2181ea,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x1a2f8d[_0x5dc8c1(0x296)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x2c8817[_0x5dc8c1(0x296)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x320a5c['ZnpXR'](_0x5dc8c1(0x284),typeof _0xfa88ae)?_0xfa88ae[_0x5dc8c1(0x296)](0x2):_0x320a5c[_0x5dc8c1(0x1ee)],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x468f7f[_0x5dc8c1(0x296)](0x2),'Selected\x20MACO\x20Method':_0x3547e4[_0x5dc8c1(0x2f0)],'Final\x20MACO\x20(mg)':_0x4d21a4['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x3d5ea2[_0x5dc8c1(0x25f)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0xe7f0b9['toFixed'](0x4)});});const _0x46b2ec=XLSX[_0xd8a935(0x2e9)][_0xd8a935(0x2fd)](_0x38aeeb);XLSX[_0xd8a935(0x2e9)][_0xd8a935(0x2b7)](_0x98ef5d,_0x46b2ec,_0x40b650[_0xd8a935(0x2d1)]);}catch(_0x134520){console[_0xd8a935(0x10b)](_0x40b650[_0xd8a935(0x144)],_0x134520);}try{if(_0x40b650[_0xd8a935(0x1c1)](a13_0x210961[_0xd8a935(0x2b9)][_0xd8a935(0x20c)],0x0)){const _0x42d8b9=_0x40b650['vRPrV'](parseFloat,document[_0xd8a935(0x2e0)](_0x40b650['pELeQ'])?.[_0xd8a935(0x13e)])||0x46,_0x5563de=a13_0x210961[_0xd8a935(0x2b9)]['map'](_0x2a7f4c=>parseFloat(_0x2a7f4c[_0xd8a935(0x129)]))['filter'](_0x241447=>!isNaN(_0x241447)),_0x302133=_0x40b650[_0xd8a935(0x13c)](_0x5563de[_0xd8a935(0x20c)],0x0)?Math[_0xd8a935(0x18a)](..._0x5563de):0x0,_0x149984=a13_0x210961[_0xd8a935(0x2b9)][_0xd8a935(0x1a2)](_0x5991c0=>_0x5991c0[_0xd8a935(0x2f0)])[_0xd8a935(0x245)](_0x547739=>''!==_0x547739[_0xd8a935(0x29f)]())['join'](',\x20'),_0x3153fb=[];_0x525e6f[_0xd8a935(0x177)](_0x280cbe=>{const _0x41d061=_0xd8a935,_0x37cec8={'RXuOi':function(_0x9ec5fe,_0x362002){const _0x879e64=a13_0x434f;return _0x40b650[_0x879e64(0x1cd)](_0x9ec5fe,_0x362002);},'vLava':_0x40b650[_0x41d061(0x28e)]},_0x4bc88b=_0x3b71f7(_0x280cbe[_0x41d061(0x1aa)][_0x41d061(0x1a2)](_0x2f74ec=>_0x2f74ec[_0x41d061(0x16f)])),_0xc4277a=a13_0x210961[_0x41d061(0x267)][_0x4bc88b]||a13_0x210961[_0x41d061(0x267)]['Other'],_0xf5e21d=document[_0x41d061(0x2e0)](_0x41d061(0x2bf)+_0x280cbe['id']),_0x567be1=_0xf5e21d&&_0x40b650[_0x41d061(0x1ae)](parseFloat,_0xf5e21d[_0x41d061(0x13e)])||_0xc4277a[_0x41d061(0x14f)],_0x4d8d96=_0x40b650['UYAYs'](_0x40b650[_0x41d061(0x19d)](_0x40b650[_0x41d061(0x19d)](0.0005,_0x302133),_0x42d8b9),_0x567be1),_0x3e7372=_0x40b650[_0x41d061(0x19d)](_0x4d8d96,_0x280cbe[_0x41d061(0x145)]),_0x210499=_0x40b650['HUXbf'](getLargestEssaForLineAndDosageForm,_0x280cbe,_0x525e6f),_0xcf3c21=_0x40b650[_0x41d061(0x1c1)](_0x210499,0x0)?_0x3e7372/_0x210499:0x0,_0x526795=_0x40b650[_0x41d061(0x19d)](_0xcf3c21,_0x280cbe[_0x41d061(0xe8)]),_0x1c358a=_0x280cbe[_0x41d061(0x2b6)][_0x41d061(0x1a2)](_0x441757=>{const _0x125eb9=_0x41d061,_0x18a7ce=a13_0x210961['machines'][_0x125eb9(0xfe)](_0x466298=>_0x466298['id']===_0x441757);return _0x37cec8[_0x125eb9(0x11d)](_0x18a7ce,{'name':'Unknown\x20(ID:\x20'+_0x441757+')','machineNumber':_0x37cec8[_0x125eb9(0x19e)]});}),_0x191412=_0x280cbe[_0x41d061(0x2b6)]['map'](_0x145672=>{const _0x3fbcd2=_0x41d061,_0x1363f1=a13_0x210961['machines']['find'](_0x58dfd2=>_0x58dfd2['id']===_0x145672);return _0x1363f1?_0x1363f1[_0x3fbcd2(0x2f0)]:'Unknown\x20(ID:\x20'+_0x145672+')';})['join'](',\x20'),_0x3fd03a=_0x280cbe['products'][_0x41d061(0x1a2)](_0x9977a4=>_0x9977a4['productCode']+'\x20-\x20'+_0x9977a4['name'])[_0x41d061(0x2fe)](';\x20'),_0x54b87d=_0x280cbe[_0x41d061(0x1bd)]?_0x280cbe['worstProductRpn']['productName']+'\x20('+_0x280cbe[_0x41d061(0x1bd)]['ingredientName']+_0x41d061(0x17a)+_0x280cbe[_0x41d061(0x1bd)][_0x41d061(0x15a)]:_0x40b650['kJmQg'];_0x3153fb['push']({'Train':'T'+_0x280cbe['id'],'Total\x20Products':_0x280cbe['products'][_0x41d061(0x20c)],'Total\x20Machines':_0x1c358a[_0x41d061(0x20c)],'Total\x20Area\x20(ESSA)\x20cm²':_0x280cbe[_0x41d061(0x153)][_0x41d061(0x13a)](),'Products':_0x3fd03a,'Machines':_0x191412,'Worst-Case\x20Dosage\x20Form':_0x4bc88b,'Safety\x20Factor\x20Range':_0xc4277a[_0x41d061(0x18a)]+_0x41d061(0xda)+_0xc4277a[_0x41d061(0x14f)],'Applied\x20Safety\x20Factor':_0x567be1,'Detergent\x20Ingredients':_0x149984,'Body\x20Weight\x20(kg)':_0x42d8b9,'Minimum\x20LD50\x20(mg/kg)':_0x302133,'Min\x20Batch\x20Size\x20(kg)':_0x280cbe[_0x41d061(0x262)],'Min\x20BS/MDD\x20Ratio':_0x280cbe[_0x41d061(0x145)][_0x41d061(0x296)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x54b87d,'ADI\x20(mg)':_0x4d8d96['toFixed'](0x4),'MACO\x20(mg)':_0x3e7372['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0xcf3c21['toExponential'](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x526795['toFixed'](0x4)});});const _0x1c28ee=XLSX[_0xd8a935(0x2e9)][_0xd8a935(0x2fd)](_0x3153fb);XLSX['utils'][_0xd8a935(0x2b7)](_0x98ef5d,_0x1c28ee,_0x40b650['VqIko']);}}catch(_0x5500d2){console[_0xd8a935(0x10b)](_0x40b650['msSRX'],_0x5500d2);}try{const _0x5d23cc=[];_0x525e6f['forEach'](_0x443776=>{const _0x10131f=_0xd8a935,_0x2ca390={'YSwPX':function(_0x5d0d15,_0x3b28cd){const _0x182d27=a13_0x434f;return _0x40b650[_0x182d27(0x1cd)](_0x5d0d15,_0x3b28cd);}},_0x3e26cb=_0x443776[_0x10131f(0x2b6)][_0x10131f(0x1a2)](_0x56f2af=>{const _0x15b23d=_0x10131f,_0x33bb24=a13_0x210961[_0x15b23d(0x12c)][_0x15b23d(0xfe)](_0x15ec10=>_0x15ec10['id']===_0x56f2af);return _0x2ca390[_0x15b23d(0x27c)](_0x33bb24,{'id':_0x56f2af,'name':_0x15b23d(0x2a6)+_0x56f2af+')','machineNumber':_0x15b23d(0x16e)});}),_0x2781b9=_0x443776['machineIds']['map'](_0x5de43e=>{const _0x29a49c=_0x10131f,_0x5e1dbb=a13_0x210961[_0x29a49c(0x12c)][_0x29a49c(0xfe)](_0x5baa73=>_0x5baa73['id']===_0x5de43e);return _0x5e1dbb?_0x5e1dbb['name']:_0x29a49c(0x2a6)+_0x5de43e+')';})[_0x10131f(0x2fe)](',\x20'),_0x2d4898=_0x443776[_0x10131f(0x1aa)][_0x10131f(0x1a2)](_0x155997=>_0x155997[_0x10131f(0x2bd)]+_0x10131f(0xda)+_0x155997['name'])[_0x10131f(0x2fe)](';\x20'),_0x4faf18=_0x443776[_0x10131f(0x1aa)][_0x10131f(0x1a2)](_0x12ce04=>_0x12ce04[_0x10131f(0x2bd)]+':\x20'+_0x12ce04['name'])[_0x10131f(0x2fe)]('\x0a'),_0xb466ad=_0x3e26cb[_0x10131f(0x1a2)](_0x5596b0=>_0x5596b0[_0x10131f(0x233)]+':\x20'+_0x5596b0['name'])[_0x10131f(0x2fe)]('\x0a');_0x5d23cc[_0x10131f(0x182)]({'Train\x20ID':'T'+_0x443776['id'],'Products\x20Count':_0x443776[_0x10131f(0x1aa)]['length'],'Machines\x20Count':_0x3e26cb[_0x10131f(0x20c)],'Total\x20Area\x20(ESSA)\x20cm²':_0x443776[_0x10131f(0x153)][_0x10131f(0x13a)](),'Products\x20(Code\x20-\x20Name)':_0x2d4898,'Machines\x20(Number\x20-\x20Name)':_0x2781b9,'Products\x20Detailed':_0x4faf18,'Machines\x20Detailed':_0xb466ad,'Min\x20Batch\x20Size\x20(kg)':_0x443776[_0x10131f(0x262)],'Min\x20BS/MDD\x20Ratio':_0x443776[_0x10131f(0x145)][_0x10131f(0x296)](0x2),'Assumed\x20SSA\x20(cm²)':_0x443776['assumedSsa'],'Lowest\x20LTD\x20(mg)':_0x443776[_0x10131f(0x25a)],'Lowest\x20PDE\x20(mg)':null!==_0x443776[_0x10131f(0x2b1)]?_0x443776[_0x10131f(0x2b1)]:_0x40b650[_0x10131f(0x28e)],'Worst\x20RPN\x20Product':_0x443776[_0x10131f(0x1bd)]?_0x443776[_0x10131f(0x1bd)]['productName']+'\x20('+_0x443776[_0x10131f(0x1bd)][_0x10131f(0x1a5)]+_0x10131f(0x17a)+_0x443776['worstProductRpn'][_0x10131f(0x15a)]:_0x10131f(0x16e)});});const _0x1869b7=XLSX['utils']['json_to_sheet'](_0x5d23cc);XLSX['utils'][_0xd8a935(0x2b7)](_0x98ef5d,_0x1869b7,_0x40b650[_0xd8a935(0x239)]);}catch(_0x7b834e){console[_0xd8a935(0x10b)]('Error\x20creating\x20Train\x20Summary\x20sheet:',_0x7b834e);}try{const _0x519c87=a13_0x210961[_0xd8a935(0x1aa)][_0xd8a935(0x20f)](_0x475151=>{const _0x4b7fb5=_0xd8a935,_0x1f9ca8=_0x40b650['vRPrV'](_0x586a4d,_0x475151);return _0x475151[_0x4b7fb5(0x275)]['map'](_0x3a4625=>({'productName':_0x475151[_0x4b7fb5(0x2f0)],'productCode':_0x475151[_0x4b7fb5(0x2bd)],'ingredientName':_0x3a4625[_0x4b7fb5(0x2f0)],'rpn':_0x56b300(_0x3a4625)['rpn'],'trainId':_0x4b7fb5(0x16e)!==_0x1f9ca8?'T'+_0x1f9ca8:_0x4b7fb5(0x16e)}));})[_0xd8a935(0x1f2)]((_0x45067e,_0x478cd9)=>_0x478cd9[_0xd8a935(0x15a)]-_0x45067e['rpn'])['slice'](0x0,0xa);if(_0x40b650[_0xd8a935(0x1c1)](_0x519c87['length'],0x0)){const _0x4c05da=_0x519c87[_0xd8a935(0x1a2)]((_0x3ad892,_0x2c4d0d)=>({'Rank':_0x2c4d0d+0x1,'Product\x20Code':_0x3ad892[_0xd8a935(0x2bd)],'Product\x20Name':_0x3ad892[_0xd8a935(0x10f)],'Train':_0x3ad892[_0xd8a935(0x2f1)],'Ingredient':_0x3ad892[_0xd8a935(0x1a5)],'RPN':_0x3ad892[_0xd8a935(0x15a)]})),_0x3a9ba0=XLSX['utils']['json_to_sheet'](_0x4c05da);XLSX['utils'][_0xd8a935(0x2b7)](_0x98ef5d,_0x3a9ba0,_0xd8a935(0x2e4));}}catch(_0x3c8776){console['error'](_0x40b650[_0xd8a935(0x315)],_0x3c8776);}try{const _0xc823a9=a13_0x210961[_0xd8a935(0x1aa)][_0xd8a935(0x245)](_0x274845=>_0x274845[_0xd8a935(0x13d)]);if(_0xc823a9[_0xd8a935(0x20c)]>0x0){const _0x3abe14=_0xc823a9[_0xd8a935(0x1a2)](_0x23a382=>({'Product\x20Code':_0x23a382['productCode'],'Product\x20Name':_0x23a382[_0xd8a935(0x2f0)],'Product\x20Type':_0x23a382['productType'],'Batch\x20Size\x20(kg)':_0x23a382[_0xd8a935(0x205)],'MDD\x20(mg)':_0x23a382[_0xd8a935(0x2c1)],'Critical\x20Reason':_0x23a382[_0xd8a935(0x26a)]||'No\x20reason\x20provided','Train':_0xd8a935(0x16e)!==_0x586a4d(_0x23a382)?'T'+_0x586a4d(_0x23a382):_0xd8a935(0x16e)})),_0xcf6af=XLSX[_0xd8a935(0x2e9)]['json_to_sheet'](_0x3abe14);XLSX[_0xd8a935(0x2e9)][_0xd8a935(0x2b7)](_0x98ef5d,_0xcf6af,_0xd8a935(0x292));}}catch(_0x2e2fc8){console[_0xd8a935(0x10b)](_0x40b650[_0xd8a935(0x2ce)],_0x2e2fc8);}try{const _0x17b57d=a13_0x210961[_0xd8a935(0x1aa)][_0xd8a935(0x1a2)](_0x1fcdeb=>{const _0x1f3333=_0xd8a935,_0x42569e={'cLMJR':function(_0x278e9a,_0x3d91f7){return _0x278e9a(_0x3d91f7);}},_0x47b77f=_0x40b650[_0x1f3333(0x1ad)](_0x586a4d,_0x1fcdeb),_0x58d4c4=_0x1fcdeb['activeIngredients'][_0x1f3333(0x258)]((_0x379cc2,_0x4b60a4)=>{const _0x8b0ccd=_0x1f3333,_0x5eb6fa=_0x42569e[_0x8b0ccd(0x2b5)](_0x56b300,_0x4b60a4)[_0x8b0ccd(0x15a)];return _0x5eb6fa>_0x379cc2['rpn']?{..._0x4b60a4,'rpn':_0x5eb6fa}:_0x379cc2;},{'rpn':0x0,'name':_0x1f3333(0x16e)});return{'Product\x20Code':_0x1fcdeb['productCode'],'Product\x20Name':_0x1fcdeb['name'],'Product\x20Type':_0x1fcdeb['productType'],'Batch\x20Size\x20(kg)':_0x1fcdeb[_0x1f3333(0x205)],'MDD\x20(mg)':_0x1fcdeb['mddMg'],'Train':_0x40b650[_0x1f3333(0x235)](_0x40b650['kJmQg'],_0x47b77f)?'T'+_0x47b77f:_0x40b650[_0x1f3333(0x28e)],'Is\x20Critical':_0x1fcdeb[_0x1f3333(0x13d)]?_0x1f3333(0x2f6):'No','Critical\x20Reason':_0x1fcdeb['criticalReason']||_0x1f3333(0x16e),'Ingredients\x20Count':_0x1fcdeb[_0x1f3333(0x275)][_0x1f3333(0x20c)],'Highest\x20RPN\x20Ingredient':_0x58d4c4[_0x1f3333(0x2f0)],'Highest\x20RPN\x20Value':_0x58d4c4['rpn']||0x0};}),_0x254ce8=XLSX[_0xd8a935(0x2e9)][_0xd8a935(0x2fd)](_0x17b57d);XLSX[_0xd8a935(0x2e9)]['book_append_sheet'](_0x98ef5d,_0x254ce8,_0x40b650[_0xd8a935(0x2a2)]);}catch(_0x18d901){console[_0xd8a935(0x10b)](_0x40b650[_0xd8a935(0x18e)],_0x18d901);}try{const _0x10c2ee=[];a13_0x210961[_0xd8a935(0x1aa)][_0xd8a935(0x177)](_0x43aa17=>{const _0x3ac552=_0xd8a935,_0x58d356=_0x320a5c['BsijR'](_0x586a4d,_0x43aa17),_0x2024c0={'Product\x20Code':_0x43aa17[_0x3ac552(0x2bd)],'Product\x20Name':_0x43aa17[_0x3ac552(0x2f0)],'Product\x20Type':_0x43aa17[_0x3ac552(0x16f)],'Batch\x20Size\x20(kg)':_0x43aa17['batchSizeKg'],'MDD\x20(mg)':_0x43aa17[_0x3ac552(0x2c1)],'Train':_0x320a5c[_0x3ac552(0x1ee)]!==_0x58d356?'T'+_0x58d356:_0x320a5c['Lvtbg'],'Is\x20Critical':_0x43aa17['isCritical']?_0x320a5c[_0x3ac552(0x1c3)]:'No','Critical\x20Reason':_0x43aa17[_0x3ac552(0x26a)]||_0x3ac552(0x16e),'Ingredient\x20Type':_0x3ac552(0x133),'Ingredient\x20Name':'','LTD\x20(mg)':'','PDE\x20(mg)':'','LD50\x20(mg/kg)':'','Severity':'','Occurrence':'','Detection':'','RPN':''};_0x10c2ee[_0x3ac552(0x182)](_0x2024c0),_0x43aa17[_0x3ac552(0x275)][_0x3ac552(0x177)](_0x3de30b=>{const _0x4813c7=_0x3ac552,_0x3581c1=_0x56b300(_0x3de30b);_0x10c2ee[_0x4813c7(0x182)]({'Product\x20Code':'','Product\x20Name':'','Product\x20Type':'','Batch\x20Size\x20(kg)':'','MDD\x20(mg)':'','Train':'','Is\x20Critical':'','Critical\x20Reason':'','Ingredient\x20Type':_0x320a5c[_0x4813c7(0x184)],'Ingredient\x20Name':_0x3de30b['name'],'LTD\x20(mg)':_0x3de30b['ltdMg']||_0x320a5c[_0x4813c7(0x1ee)],'PDE\x20(mg)':_0x3de30b[_0x4813c7(0x25c)]||_0x320a5c[_0x4813c7(0x1ee)],'LD50\x20(mg/kg)':_0x3de30b[_0x4813c7(0x129)]||_0x320a5c[_0x4813c7(0x1ee)],'Severity':_0x3581c1[_0x4813c7(0x2f2)],'Occurrence':_0x3581c1['occurrence'],'Detection':_0x3581c1[_0x4813c7(0x2b4)],'RPN':_0x3581c1[_0x4813c7(0x15a)]});});});const _0x5bf2dd=XLSX['utils']['json_to_sheet'](_0x10c2ee);XLSX[_0xd8a935(0x2e9)]['book_append_sheet'](_0x98ef5d,_0x5bf2dd,_0x40b650[_0xd8a935(0x280)]);}catch(_0x5fb94e){console['error'](_0xd8a935(0x293),_0x5fb94e);}const _0x1fca09=new Date()['toISOString']()[_0xd8a935(0x1ba)]('T')[0x0];XLSX[_0xd8a935(0x18b)](_0x98ef5d,_0xd8a935(0x24a)+_0x1fca09+_0xd8a935(0x131)),hideLoader(),_0x40b650['uqkrZ'](showCustomAlert,_0xd8a935(0x303),_0x40b650[_0xd8a935(0x266)]);})[_0xac9670(0x278)](_0x3d3ef1=>{const _0x248686=_0xac9670;console[_0x248686(0x10b)](_0x40b650[_0x248686(0x1ea)],_0x3d3ef1),_0x40b650['tWtKo'](hideLoader),_0x40b650['uqkrZ'](showCustomAlert,_0x40b650[_0x248686(0x279)],_0x40b650[_0x248686(0xc9)]);});}export function toggleStageSection(_0x414b34){const _0x7bc480=a13_0x16a2fa,_0x21fbf1={'DWYkK':function(_0x4be8aa,_0x45f56e){return _0x4be8aa===_0x45f56e;},'iqsmY':_0x7bc480(0x236),'nMOEg':_0x7bc480(0x273),'dqigp':'Show'},_0x4f5fc3=document[_0x7bc480(0x2e0)](_0x7bc480(0xf7)+_0x414b34),_0x41f312=_0x21fbf1[_0x7bc480(0x1a4)](_0x21fbf1[_0x7bc480(0x260)],_0x4f5fc3[_0x7bc480(0x294)][_0x7bc480(0x200)]);_0x4f5fc3[_0x7bc480(0x294)]['display']=_0x41f312?'':_0x21fbf1[_0x7bc480(0x260)],localStorage['setItem']('machineStage-'+_0x414b34+_0x7bc480(0x238),!_0x41f312);const _0x297670=_0x4f5fc3[_0x7bc480(0x1c5)][_0x7bc480(0x127)](_0x21fbf1['nMOEg']);_0x297670&&(_0x297670[_0x7bc480(0x162)]=_0x41f312?_0x7bc480(0x28b):_0x21fbf1['dqigp']);}