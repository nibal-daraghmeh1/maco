const a16_0x2b6eac=a16_0x4e51;(function(_0xb7c87b,_0x3fe0e9){const _0x385a4c=a16_0x4e51,_0x56ab04=_0xb7c87b();while(!![]){try{const _0x3eedf6=-parseInt(_0x385a4c(0x2e7))/0x1*(-parseInt(_0x385a4c(0x318))/0x2)+-parseInt(_0x385a4c(0x29d))/0x3+-parseInt(_0x385a4c(0x35d))/0x4+parseInt(_0x385a4c(0x106))/0x5*(-parseInt(_0x385a4c(0x13a))/0x6)+-parseInt(_0x385a4c(0x19f))/0x7+parseInt(_0x385a4c(0x103))/0x8+parseInt(_0x385a4c(0x2e9))/0x9*(parseInt(_0x385a4c(0x255))/0xa);if(_0x3eedf6===_0x3fe0e9)break;else _0x56ab04['push'](_0x56ab04['shift']());}catch(_0x4466e4){_0x56ab04['push'](_0x56ab04['shift']());}}}(a16_0x176a,0x601d4));import*as a16_0x4cd0f5 from'./state.js';import{fullAppRender as a16_0xb7686f}from'./app.js';import{generateTrainMap as a16_0x38d944,getTrainIdToLineNumberMap as a16_0x185e9e,getProductTrainNumber as a16_0x3b78dc}from'./utils.js';import{toggleScoringEditMode as a16_0x3b1957}from'./scoringView.js';import{renderRpnChart as a16_0x2a6587}from'./worstCaseView.js';function i(_0x445285,_0x35cc77=''){const _0x9e341e=a16_0x4e51,_0x2b65b0={'ZyWeN':function(_0x4a8d2b,_0x4bc35b){return _0x4a8d2b===_0x4bc35b;},'xImUZ':function(_0x535532,_0x7d1995){return _0x535532==_0x7d1995;},'VpIxC':function(_0xa5e2b7,_0xfaac3a){return _0xa5e2b7+_0xfaac3a;},'sKHmj':function(_0x20f585,_0x47c409){return _0x20f585+_0x47c409;},'qzEsx':function(_0x917e18,_0x403b75){return _0x917e18<_0x403b75;},'yAKSE':function(_0xad6f99,_0xb1f821){return _0xad6f99+_0xb1f821;}};if(_0x2b65b0['ZyWeN'](0x0,_0x445285)||_0x2b65b0[_0x9e341e(0x274)](null,_0x445285)||isNaN(_0x445285))return _0x2b65b0[_0x9e341e(0x34c)]('0',_0x35cc77?_0x2b65b0['sKHmj']('\x20',_0x35cc77):'');const _0x59098f=Math[_0x9e341e(0x292)](_0x445285);return _0x59098f<0.0001?''+_0x445285[_0x9e341e(0x241)](0x3)+(_0x35cc77?_0x2b65b0[_0x9e341e(0x2f2)]('\x20',_0x35cc77):''):_0x2b65b0[_0x9e341e(0x1ce)](_0x59098f,0.01)?''+_0x445285[_0x9e341e(0x29b)](0x6)+(_0x35cc77?_0x2b65b0[_0x9e341e(0x19a)]('\x20',_0x35cc77):''):''+_0x445285[_0x9e341e(0x29b)](0x4)+(_0x35cc77?'\x20'+_0x35cc77:'');}import{renderMacoChart as a16_0x598f3d}from'./dashboardView.js';const d=document['getElementById'](a16_0x2b6eac(0x1e6));export const showLoader=()=>d[a16_0x2b6eac(0x16b)][a16_0x2b6eac(0x2fc)]=a16_0x2b6eac(0x2fa);export const hideLoader=()=>d[a16_0x2b6eac(0x16b)][a16_0x2b6eac(0x2fc)]=a16_0x2b6eac(0x32b);export function showCustomAlert(_0x220299,_0x54d778){const _0x5c1508=a16_0x2b6eac,_0x197779={'HLJqk':_0x5c1508(0x305),'sOtOM':_0x5c1508(0x2b2),'OHiMN':_0x5c1508(0x245),'TBTac':_0x5c1508(0x2fa)};document['getElementById'](_0x197779[_0x5c1508(0x1e4)])[_0x5c1508(0x1f1)]=_0x220299,document['getElementById'](_0x197779[_0x5c1508(0x2a9)])['textContent']=_0x54d778,document[_0x5c1508(0x19d)](_0x197779[_0x5c1508(0x137)])[_0x5c1508(0x16b)]['display']=_0x197779[_0x5c1508(0x2ce)];}export const hideModal=_0x4c9f0e=>document[a16_0x2b6eac(0x19d)](_0x4c9f0e)['style']['display']='none';export const showModal=_0x36bd45=>document[a16_0x2b6eac(0x19d)](_0x36bd45)[a16_0x2b6eac(0x16b)][a16_0x2b6eac(0x2fc)]=a16_0x2b6eac(0x2fa);export function saveAllDataToLocalStorage(){const _0x57c697=a16_0x2b6eac,_0x527aa3={'AwcEw':_0x57c697(0x331),'odFyF':_0x57c697(0x179),'CIOvs':_0x57c697(0x129),'aqaSy':_0x57c697(0x30c),'otJGD':_0x57c697(0x112),'cIsgg':'Failed\x20to\x20save\x20data\x20to\x20localStorage','huUxz':function(_0x5bb51f,_0x3cd3bf,_0x8751c4){return _0x5bb51f(_0x3cd3bf,_0x8751c4);}};try{localStorage[_0x57c697(0x30d)](_0x527aa3[_0x57c697(0x155)],JSON['stringify'](a16_0x4cd0f5[_0x57c697(0x22c)])),localStorage['setItem'](_0x527aa3[_0x57c697(0x19b)],JSON[_0x57c697(0x14a)](a16_0x4cd0f5[_0x57c697(0x34a)])),localStorage['setItem'](_0x527aa3['CIOvs'],JSON[_0x57c697(0x14a)](a16_0x4cd0f5[_0x57c697(0x32e)])),localStorage['setItem'](_0x527aa3[_0x57c697(0x109)],JSON[_0x57c697(0x14a)](a16_0x4cd0f5[_0x57c697(0x30f)])),localStorage[_0x57c697(0x30d)](_0x527aa3[_0x57c697(0x323)],JSON[_0x57c697(0x14a)](a16_0x4cd0f5[_0x57c697(0x112)]));}catch(_0x47d8e9){console[_0x57c697(0x2a0)](_0x527aa3['cIsgg'],_0x47d8e9),_0x527aa3[_0x57c697(0x18e)](showCustomAlert,_0x57c697(0x1d3),_0x57c697(0x2b1));}}export function loadAllDataFromLocalStorage(){const _0x31b0f5=a16_0x2b6eac,_0x4a771d={'woiyT':_0x31b0f5(0x179),'CZDpZ':_0x31b0f5(0x129),'gtFzq':_0x31b0f5(0x30c),'JrGDN':_0x31b0f5(0x112),'VySeP':_0x31b0f5(0x1f8),'oBvxA':'Error\x20loading\x20scoring\x20criteria','IcoeR':_0x31b0f5(0x312),'JMnfZ':_0x31b0f5(0x12f)},_0xf9560a=localStorage[_0x31b0f5(0x1af)](_0x31b0f5(0x331)),_0x2a7d6b=localStorage['getItem'](_0x4a771d[_0x31b0f5(0x361)]),_0x18dcec=localStorage[_0x31b0f5(0x1af)](_0x4a771d[_0x31b0f5(0x2b3)]),_0x542730=localStorage['getItem'](_0x4a771d[_0x31b0f5(0x1f3)]),_0x579da3=localStorage[_0x31b0f5(0x1af)](_0x4a771d['JrGDN']);if(_0xf9560a)try{a16_0x4cd0f5['setProducts'](JSON[_0x31b0f5(0x242)](_0xf9560a));}catch(_0x260b2b){console[_0x31b0f5(0x2a0)](_0x31b0f5(0x224),_0x260b2b);}if(_0x2a7d6b)try{a16_0x4cd0f5[_0x31b0f5(0x16d)](JSON[_0x31b0f5(0x242)](_0x2a7d6b));}catch(_0x18b6b7){console[_0x31b0f5(0x2a0)](_0x4a771d[_0x31b0f5(0x200)],_0x18b6b7);}if(_0x18dcec)try{a16_0x4cd0f5[_0x31b0f5(0x2db)](JSON[_0x31b0f5(0x242)](_0x18dcec));}catch(_0x3f2a3c){console[_0x31b0f5(0x2a0)](_0x4a771d[_0x31b0f5(0x1d7)],_0x3f2a3c);}if(_0x542730)try{a16_0x4cd0f5[_0x31b0f5(0x2f8)](JSON[_0x31b0f5(0x242)](_0x542730));}catch(_0x24a2eb){console['error'](_0x4a771d['IcoeR'],_0x24a2eb);}if(_0x579da3)try{a16_0x4cd0f5[_0x31b0f5(0x317)](JSON[_0x31b0f5(0x242)](_0x579da3));}catch(_0xb3a300){console[_0x31b0f5(0x2a0)](_0x4a771d[_0x31b0f5(0x359)],_0xb3a300);}}export function saveStateForUndo(){const _0x72d942=a16_0x2b6eac,_0x8f49a4={'rHEwD':function(_0x21ffad){return _0x21ffad();},'JEbeW':function(_0x3fb761,_0x2a686a){return _0x3fb761+_0x2a686a;}};_0x8f49a4['rHEwD'](a16_0x38d944);const _0x49abb5=a16_0x4cd0f5[_0x72d942(0x1a9)]['slice'](0x0,_0x8f49a4[_0x72d942(0x23e)](a16_0x4cd0f5[_0x72d942(0x130)],0x1)),_0x2f1ab7={'products':JSON['parse'](JSON[_0x72d942(0x14a)](a16_0x4cd0f5[_0x72d942(0x22c)])),'machines':JSON[_0x72d942(0x242)](JSON[_0x72d942(0x14a)](a16_0x4cd0f5['machines'])),'scoringCriteria':JSON['parse'](JSON[_0x72d942(0x14a)](a16_0x4cd0f5[_0x72d942(0x32e)])),'detergentIngredients':JSON[_0x72d942(0x242)](JSON[_0x72d942(0x14a)](a16_0x4cd0f5[_0x72d942(0x30f)]))};_0x49abb5[_0x72d942(0x32a)](_0x2f1ab7),a16_0x4cd0f5[_0x72d942(0x1a7)](_0x49abb5,_0x49abb5[_0x72d942(0x35b)]-0x1),updateUndoRedoButtons(),_0x8f49a4[_0x72d942(0x2f9)](saveAllDataToLocalStorage);}export function updateUndoRedoButtons(){const _0x405842=a16_0x2b6eac,_0x569538={'CTyay':'redo-btn','hFduw':function(_0x287624,_0x39c5db){return _0x287624<=_0x39c5db;},'stKDt':function(_0x2e908f,_0x5be551){return _0x2e908f>=_0x5be551;},'fntEB':function(_0x5c3621,_0x2a8314){return _0x5c3621-_0x2a8314;}},_0x3d5897=document[_0x405842(0x19d)](_0x405842(0x302)),_0x298d7d=document[_0x405842(0x19d)](_0x569538['CTyay']);_0x3d5897&&(_0x3d5897['disabled']=_0x569538[_0x405842(0x22f)](a16_0x4cd0f5[_0x405842(0x130)],0x0)),_0x298d7d&&(_0x298d7d['disabled']=_0x569538[_0x405842(0x31e)](a16_0x4cd0f5['historyIndex'],_0x569538['fntEB'](a16_0x4cd0f5['history'][_0x405842(0x35b)],0x1)));}function a16_0x4e51(_0x457efd,_0x27bc05){const _0x176a4f=a16_0x176a();return a16_0x4e51=function(_0x4e5181,_0x22cdfa){_0x4e5181=_0x4e5181-0xfd;let _0x2a2539=_0x176a4f[_0x4e5181];return _0x2a2539;},a16_0x4e51(_0x457efd,_0x27bc05);}export function undoChange(){const _0x3894f2=a16_0x2b6eac,_0x3fb88f={'aYECy':function(_0x183b6f,_0x4558ee){return _0x183b6f-_0x4558ee;},'xjita':function(_0x48b54b,_0x148e35){return _0x48b54b(_0x148e35);},'OufgH':function(_0x5c794c){return _0x5c794c();},'gLvVH':function(_0x1a409a){return _0x1a409a();},'DGbrv':function(_0x50eaf9){return _0x50eaf9();}};if(a16_0x4cd0f5[_0x3894f2(0x130)]>0x0){const _0x1667cc=_0x3fb88f[_0x3894f2(0x293)](a16_0x4cd0f5['historyIndex'],0x1),_0x96e642=a16_0x4cd0f5[_0x3894f2(0x1a9)][_0x1667cc];a16_0x4cd0f5[_0x3894f2(0x35f)](JSON[_0x3894f2(0x242)](JSON[_0x3894f2(0x14a)](_0x96e642['products']))),a16_0x4cd0f5['setMachines'](JSON[_0x3894f2(0x242)](JSON[_0x3894f2(0x14a)](_0x96e642['machines']))),a16_0x4cd0f5[_0x3894f2(0x2db)](JSON[_0x3894f2(0x242)](JSON[_0x3894f2(0x14a)](_0x96e642[_0x3894f2(0x32e)]))),a16_0x4cd0f5[_0x3894f2(0x2f8)](JSON['parse'](JSON[_0x3894f2(0x14a)](_0x96e642[_0x3894f2(0x30f)]))),a16_0x4cd0f5['setHistory'](a16_0x4cd0f5[_0x3894f2(0x1a9)],_0x1667cc),a16_0x4cd0f5['scoringInEditMode']&&_0x3fb88f[_0x3894f2(0x347)](a16_0x3b1957,!0x1),_0x3fb88f[_0x3894f2(0x31c)](a16_0xb7686f),_0x3fb88f[_0x3894f2(0x217)](updateUndoRedoButtons),_0x3fb88f['DGbrv'](saveAllDataToLocalStorage);}}function a16_0x176a(){const _0x3dbc9d=['\x20-\x20Worst\x20Case\x20Analysis','BkUdC','wUwqE','renderRpnChart','writeFile','FQRGA','Hwaep','vaStR','kawnX','textContent','appendChild','gtFzq','add','bWCpX','Failed\x20to\x20export\x20Summary\x20report\x20data\x20to\x20Excel.','VmKIS','Error\x20loading\x20machines','worstProductRpn','uukAy','./utils.js','scoringInEditMode','FiRkb','-pdeHidden','stage-','VySeP','gzUxG','date','bIxMs','IKTgA','_Train_','kgxup','JtOOE','Critical\x20Products','./macoProductView.js','cleanabilityScore','isCritical','zElZD','oDqvj','setScoringWasInEditModeForPrint','noTrainSummaryMessage','rEFJP','mhjpa','wWqBJ','xluYP','button','fZwyW','isArray','gLvVH','Data\x20imported\x20successfully.','warn','HTqIR','trainId','OveRd','TBJmx','AgxON','documentElement','Error','Other','BcBrS','VOUOk','Error\x20loading\x20products','Train\x20','licJF','QHCMT','oThvy','wnWnP','uNjZZ','Soppj','products','TYJlM','IeSsJ','hFduw','toggle','KdLXi','closest','Container\x20display:','BXhnu','eNafW','hcHuT','juRuQ','jNRhM','YbHCK','Show\x20LD50','Error\x20exporting\x20Summary\x20to\x20Excel:','WYMim','FqeCX','JEbeW','vbiGp','odDGT','toExponential','parse','startsWith','LRioC','customAlertModal','ANQAa','minMbsKg','YcjNq','GrfnP','#productRegister\x20.mainTable.hide-','parentElement','PwmMY','CNCkp','cciks','yQbTc','qtfbg','activeIngredients','BNndu','rGHBc','RxXvv','2086520OohCTA','Detergent\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','href','Error\x20exporting\x20worst\x20case\x20to\x20Excel:','INGREDIENT','includes','yCFjb','productRegister-','viBIz','sort','zoRvu','zxTVW','PsIic','#columnVisibilityDropdown','Error\x20creating\x20Detergent\x20MACO\x20sheet:','ANjfg','kwlAg','Mqine','msddJ','Unknown\x20(ID:\x20','hidGJ','GeiIt','Machines\x20data\x20exported\x20to\x20Excel\x20successfully!','kaMDK','message','Detergent\x20MACO\x20Report','sf-input-train-','querySelector','yOxHh','PWlXS','MACO_All_Products_Report.xlsx','xImUZ','There\x20are\x20no\x20machines\x20to\x20export.','RBqfl','Error\x20exporting\x20all\x20tabs\x20to\x20Excel:','HUTwn','cjwKB','sQVEQ','tTZYG','wrFdI','!cols','dkwpQ','getLargestEssaForLineAndDosageForm','ODKpn','No\x20Data','GZKzC','AwPFR','VeIPc','DIjjJ','rnEIH','lowestLd50','NyVqX','OgSog','All\x20Products','name','iEmpE','IzeEz','FuRil','hide-','oFxKn','trainSummaryContainer','abs','aYECy','Error\x20exporting\x20Detergent\x20MACO\x20to\x20Excel:','uXbbY','nwxpV','sYWqn','match','bDIwq','MACO_Worst_Case_Products','toFixed','hide-ld50','721776josgrb','productRegister-ld50Hidden','stage','error','\x20.ingredients-sub-table','qLsEZ','WJvOL','worstCaseProducts','Xhkxj','Train\x20Summary\x20Report','There\x20is\x20no\x20data\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','TmuRV','sOtOM','0.1%\x20Therapeutic\x20Dose','vsZWM','maco_data_export.json','Complete_MACO_Report_','gZaNw','Hide','Train\x20Summary','Could\x20not\x20save\x20data.\x20Storage\x20might\x20be\x20full.','customAlertMessage','CZDpZ','BHaqV','Printing\x20view:','OzZHY','vMyIa','true','WLnJG','area','rFtCF','CRIcO','Invalid\x20JSON\x20file\x20structure.','CFbIv','#macoForTrains\x20[id^=\x22maco-breakdown-details-\x22].hidden','CIqMt','FVVVl','Hide\x20LD50','rQHag','IFoFj','hhdyk','hidden','GKYUf','NBwUM','GaUMM','mddMg','AAwWF','rlics','pdeMg','TBTac','vCVXt','OGxec','mcKPJ','vRvLq','No\x20reason\x20provided','ssSpf','TnoFt','mdd','elwrV','required','Emtdb','Top\x2010\x20RPN','setScoringCriteria','SLLpb','N/A','log','sscWN','createElement','There\x20is\x20no\x20data\x20in\x20the\x20current\x20view\x20to\x20export.','Hide\x20MACO\x20Calculation\x20Breakdown','macoForTrains','LoFPB','IPVun','ltdMg','2zkqGPP','bSwky','27eJNwqh','productType','hweek','oIKDN','YyrLU','IsUtR','.toggle-ld50','Failed\x20to\x20export\x20machines\x20data\x20to\x20Excel.','button[onclick=\x22toggleColumnVisibilityDropdown()\x22]','sKHmj','join','Failed\x20to\x20export\x20complete\x20report\x20to\x20Excel.','Show','UBqoG','jNLJN','setDetergentIngredients','rHEwD','flex','BiCsX','display','application/json','productRegister','sortValue','#macoForTrains\x20.train-content.collapsed','uGudb','undo-btn','auDac','forEach','customAlertTitle','CDGMh','classList','IvMXO','\x20.mainTable,\x20#','ocxxU','toggle-dm-','macoDetergentIngredients','setItem','target','detergentIngredients','flatMap','ncvJh','Error\x20loading\x20detergent\x20ingredients','assumedSsa','HEKJo','productRegister-pdeHidden','zMWyR','setMachineStageDisplayOrder','347414oTyblX','\x20-\x20','batchSizeKg','therapeuticDoseScore','OufgH','productCode','stKDt','minBsMddRatio','Detergent\x20MACO','mjMwG','bvdHi','otJGD','product-sf-input','content-pm-','book_new','#detergentMaco\x20.train-content.collapsed','min','xwPHK','push','none','ytZAH','KKrXW','scoringCriteria','readAsText','content-dm-','macoProducts','AAwzQ','ShGcB','KozRx','toISOString','download','not\x20found','uiAaV','CcOWS','MACO\x20Report','gpsuO','\x20.mainTable.hide-','pdeScore','lPYhh','Failed\x20to\x20export\x20Train\x20Summary\x20data\x20to\x20Excel.','value','nMarr','KHBQd','LjNfO','Failed\x20to\x20export\x20worst\x20case\x20data\x20to\x20Excel.','Success','Error\x20exporting\x20machines\x20to\x20Excel:','xjita','.toggle-pde','cPPCz','machines','productName','VpIxC','fpQdt','TLGBr','vLtSD','find','solubility','uhqLE','ingredientName','mKPkg','jIPLg','OOnmW','ewbeK','hUuXl','JMnfZ','yGgNY','length','fQrQY','1556596ZDTvWU','lowestLtd','setProducts','Ycqok','woiyT','EJDOh','SswxL','Failed\x20to\x20export\x20data\x20to\x20Excel.','yilOH','map','There\x20are\x20no\x20summary\x20data\x20to\x20export.\x20Add\x20products\x20and\x20ingredients\x20first.','body','QKmXs','6179928Eoaxgt','\x20.train-content-inner','There\x20are\x20no\x20products\x20in\x20the\x20worst\x20case\x20view\x20to\x20export.','50015OXsvRU','peahE','trainSummary','aqaSy','VbyJH','Product_MACO_Report','PLLpV','HTALr','hTUMN','columnVisibilityDropdown','ubhLU','removeChild','machineStageDisplayOrder','WarOE','NroNx','Error\x20creating\x20All\x20Products\x20sheet:','MACO_Machines_','renderMacoForTrains','solubilityScore','rpnRatingText','FBzsC','LNjNQ','DZfdf','LlHFW','Train\x20Summary\x20data\x20exported\x20to\x20Excel\x20successfully!','WwqNk','hide-pde','WNqRl','XUVST','DlRfH','\x20not\x20found\x20or\x20has\x20no\x20products.','renderTrainSummary','OnKwM','viewProducts','No\x20train\x20data\x20to\x20print.\x20Please\x20ensure\x20you\x20have\x20created\x20trains\x20first.','macoScoringCriteria','None','toggle-pm-','PcrfP','tjECN','FOoLN','Error\x20loading\x20machine\x20stage\x20order','historyIndex','Visual\x20Clean\x20Limit','uKyZW','UtpJP','djpxx','There\x20are\x20no\x20detergent\x20ingredients\x20configured.\x20Add\x20detergent\x20ingredients\x20first.','zRyXC','OHiMN','VPgnd','get','6HpRPto','innerHTML','revokeObjectURL','CnKOI','mTIUb','split','onload','bwJKG','PzefG','ruvej','LsBBH','aBara','lowestPde','Setting\x20printSelectedTrain\x20to:','ilQcw','severity','stringify','TGyMs','luyCn','LvDFD','Summary\x20report\x20data\x20exported\x20to\x20Excel\x20successfully!','.xlsx','collapsed','hCvHS','Ggpoe','Show\x20PDE','MeDGI','AwcEw','UbjDn','QeUdE','rczFa','sf-input-train','machineNumber','toLocaleString','Sjhnd','jGxEK','Error\x20loading\x20train\x20summary:\x20','pde','toLocaleDateString','theme-toggle-dark-icon','YkReD','hiTch','drlaB','printing-','xqJxi','Hidden','Hide\x20PDE','renderDetergentMaco','SganV','style','Failed\x20to\x20export\x20data\x20to\x20JSON.','setMachines','TYYpQ','No\x20trains\x20match\x20the\x20selected\x20criteria.','BUXGB','QLzWT','10\x20ppm\x20Criterion','catch','CsTzu','TUkVC','filter','input','maco-breakdown-details-','macoMachines','keys','xtard','renderWorstCaseByTrain','eeCmh','macoChartInstance','essa','cleanability',',\x20#','NEqGR','zdzZb','ChibM','WHxFr','ld50Score','_Trains_','content-','then','aJBKa','breakdown-toggle-btn-','Failed\x20to\x20export\x20Detergent\x20MACO\x20data\x20to\x20Excel.','all','huUxz','./trainSummaryView.js','ToYmH','utils','detergentMaco','kzHSL','block','FCLmL','UoaBk','JAgQo','max','book_append_sheet','yAKSE','odFyF','klomo','getElementById','PRODUCT','4987031ZTgqRV','oenFu','Health-Based\x20Limit\x20(PDE)','bodyWeight','machineIds','./worstCaseView.js','cLAdq','Error\x20creating\x20Critical\x20Products\x20sheet:','setHistory','MACO_Summary_Report_','history','airmg','./macoDetergentView.js','queVU','hvyxN','AHTsF','getItem','There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.','atakz','Worst\x20Case\x20Products','reduce','ERMSa','mXOOa','IoRjB','safetyFactorConfig','json_to_sheet','MClrn','NCkYB','Detergent_MACO_Report_','CDdiy','JqVsX','Show\x20MACO\x20Calculation\x20Breakdown','theme-toggle-light-icon','RJJFd','mNrZX','hKfkt','jfsjd','result','HYYAC','tcXBc','printSelectedTrain','RUmKJ','criticalReason','xzFhU','slice','number','ouIlF','qzEsx','print','dark','lnaPC','Health-Based\x20Limit\x20(NOEL)','Save\x20Error','removeEventListener','Product\x20Register','KFdgZ','oBvxA','UoWOE','mGgVU','ARjJX','QJSch','ywMbc',')\x20-\x20RPN:\x20','querySelectorAll','ld50','WLabU','remove','FkVST','jhXBz','HLJqk','rpn','loader','contains'];a16_0x176a=function(){return _0x3dbc9d;};return a16_0x176a();}export function redoChange(){const _0x504a6a=a16_0x2b6eac,_0x213a86={'cciks':function(_0x3dbe68,_0x52b248){return _0x3dbe68-_0x52b248;},'FqeCX':function(_0x31f40a,_0x48f8d7){return _0x31f40a(_0x48f8d7);},'zxTVW':function(_0xa58911){return _0xa58911();},'LNjNQ':function(_0xc9a196){return _0xc9a196();},'AHTsF':function(_0x1686af){return _0x1686af();}};if(a16_0x4cd0f5['historyIndex']<_0x213a86[_0x504a6a(0x24e)](a16_0x4cd0f5[_0x504a6a(0x1a9)][_0x504a6a(0x35b)],0x1)){const _0x4cf121=a16_0x4cd0f5[_0x504a6a(0x130)]+0x1,_0x586db9=a16_0x4cd0f5[_0x504a6a(0x1a9)][_0x4cf121];a16_0x4cd0f5[_0x504a6a(0x35f)](JSON['parse'](JSON['stringify'](_0x586db9['products']))),a16_0x4cd0f5[_0x504a6a(0x16d)](JSON['parse'](JSON[_0x504a6a(0x14a)](_0x586db9[_0x504a6a(0x34a)]))),a16_0x4cd0f5[_0x504a6a(0x2db)](JSON[_0x504a6a(0x242)](JSON[_0x504a6a(0x14a)](_0x586db9[_0x504a6a(0x32e)]))),a16_0x4cd0f5['setDetergentIngredients'](JSON[_0x504a6a(0x242)](JSON['stringify'](_0x586db9[_0x504a6a(0x30f)]))),a16_0x4cd0f5[_0x504a6a(0x1a7)](a16_0x4cd0f5[_0x504a6a(0x1a9)],_0x4cf121),a16_0x4cd0f5[_0x504a6a(0x1fc)]&&_0x213a86[_0x504a6a(0x23d)](a16_0x3b1957,!0x1),_0x213a86[_0x504a6a(0x260)](a16_0xb7686f),_0x213a86[_0x504a6a(0x11b)](updateUndoRedoButtons),_0x213a86[_0x504a6a(0x1ae)](saveAllDataToLocalStorage);}}export function toggleDarkMode(_0x42734f){const _0x543ead=a16_0x2b6eac,_0x17af4e={'qLsEZ':_0x543ead(0x1bf),'TLGBr':_0x543ead(0x161),'KHBQd':'hidden','fAEbZ':'dark','jIPLg':function(_0x38ab14){return _0x38ab14();},'kwlAg':function(_0x43e9eb){return _0x43e9eb();}},_0x3046e4=document[_0x543ead(0x19d)](_0x17af4e[_0x543ead(0x2a2)]),_0x1de934=document[_0x543ead(0x19d)](_0x17af4e[_0x543ead(0x34e)]);_0x42734f?(document[_0x543ead(0x21f)][_0x543ead(0x307)][_0x543ead(0x1f4)](_0x543ead(0x1d0)),_0x3046e4&&_0x3046e4[_0x543ead(0x307)][_0x543ead(0x1f4)](_0x17af4e[_0x543ead(0x342)]),_0x1de934&&_0x1de934['classList']['remove'](_0x17af4e[_0x543ead(0x342)])):(document[_0x543ead(0x21f)][_0x543ead(0x307)][_0x543ead(0x1e1)](_0x17af4e['fAEbZ']),_0x3046e4&&_0x3046e4['classList']['remove'](_0x17af4e[_0x543ead(0x342)]),_0x1de934&&_0x1de934[_0x543ead(0x307)][_0x543ead(0x1f4)](_0x17af4e[_0x543ead(0x342)])),a16_0x4cd0f5['rpnChartInstance']&&_0x17af4e[_0x543ead(0x355)](a16_0x2a6587),a16_0x4cd0f5[_0x543ead(0x17e)]&&_0x17af4e[_0x543ead(0x265)](a16_0x598f3d);}export function printCurrentView(_0xe7241d,_0x3bb93a=a16_0x2b6eac(0x18d)){const _0x1b906e=a16_0x2b6eac,_0x30e432={'oDqvj':_0x1b906e(0x2c6),'DIjjJ':function(_0x58d803,_0xbadeb5,_0x4e9b82){return _0x58d803(_0xbadeb5,_0x4e9b82);},'TpfXY':_0x1b906e(0x150),'NCkYB':_0x1b906e(0x327),'FksnL':'Error\x20loading\x20detergent\x20view\x20for\x20print:','KYMeM':_0x1b906e(0x291),'TYJlM':_0x1b906e(0x20f),'NoQcK':_0x1b906e(0x233),'RJJFd':_0x1b906e(0x337),'PcrfP':'No\x20trains\x20message\x20display:','Emtdb':function(_0x49df9c,_0x30db93){return _0x49df9c>_0x30db93;},'hiTch':function(_0x56c413,_0x4e2805){return _0x56c413===_0x4e2805;},'iEmpE':function(_0x3c2213,_0x4dd71c){return _0x3c2213(_0x4dd71c);},'CDdiy':function(_0x1b7249,_0x3aeead,_0xcdc303){return _0x1b7249(_0x3aeead,_0xcdc303);},'hKfkt':'Error\x20loading\x20train\x20summary\x20view:','KozRx':function(_0x3aa86b,_0x1d90b6){return _0x3aa86b+_0x1d90b6;},'WLabU':_0x1b906e(0x15e),'aJssh':'scoring-system','xBkBL':'Train:','tTZYG':function(_0x7ca07,_0x39300d){return _0x7ca07===_0x39300d;},'BNndu':_0x1b906e(0x2a4),'fLQfq':_0x1b906e(0x1a4),'zRyXC':_0x1b906e(0x2e3),'AAwzQ':_0x1b906e(0x209),'fAwkF':function(_0x318fc0,_0x2ecf5c){return _0x318fc0===_0x2ecf5c;},'IKTgA':_0x1b906e(0x192),'FQRGA':_0x1b906e(0x1ab),'viBIz':_0x1b906e(0x108),'WqWjM':_0x1b906e(0x147),'WNqRl':_0x1b906e(0x18f)};_0x30e432['aJssh']===_0xe7241d&&a16_0x4cd0f5[_0x1b906e(0x1fc)]&&(a16_0x4cd0f5[_0x1b906e(0x20e)](!0x0),a16_0x3b1957(!0x1)),console[_0x1b906e(0x2de)](_0x1b906e(0x2b5),_0xe7241d,_0x30e432['xBkBL'],_0x3bb93a),document['body'][_0x1b906e(0x307)][_0x1b906e(0x1f4)](_0x1b906e(0x165)+_0xe7241d),_0x30e432[_0x1b906e(0x27b)](_0x30e432[_0x1b906e(0x252)],_0xe7241d)?import(_0x30e432['fLQfq'])[_0x1b906e(0x189)](_0xe835d5=>{const _0x15fe8a=_0x1b906e;window['printSelectedTrain']=_0x3bb93a,_0xe835d5[_0x15fe8a(0x17c)](),setTimeout(()=>{const _0x63dca8=_0x15fe8a;window[_0x63dca8(0x1cf)]();},0xc8);}):_0x30e432[_0x1b906e(0x163)](_0x30e432[_0x1b906e(0x136)],_0xe7241d)?(window['printSelectedTrain']=_0x3bb93a,import(_0x30e432[_0x1b906e(0x332)])['then'](_0x49a20d=>{const _0x26ca93=_0x1b906e,_0x384d44={'TBJmx':_0x30e432[_0x26ca93(0x20d)],'jfsjd':function(_0x57b97e,_0x5483d1,_0x3ccaa3){return _0x30e432['DIjjJ'](_0x57b97e,_0x5483d1,_0x3ccaa3);}};_0x49a20d[_0x26ca93(0x117)]();const _0x4c71a1=document['querySelectorAll'](_0x26ca93(0x300)),_0x22ca29=[];_0x4c71a1[_0x26ca93(0x304)](_0x58112d=>{const _0x4f4894=_0x26ca93,_0x3b2b11=_0x58112d['id'][_0x4f4894(0x298)](/content-pm-(\d+)/);if(_0x3b2b11){_0x22ca29[_0x4f4894(0x32a)](_0x3b2b11[0x1]),_0x58112d[_0x4f4894(0x307)][_0x4f4894(0x1e1)](_0x4f4894(0x150));const _0x43a8f0=document[_0x4f4894(0x19d)](_0x4f4894(0x12b)+_0x3b2b11[0x1]);_0x43a8f0&&(_0x43a8f0[_0x4f4894(0x1f1)]='▼');}});const _0x1ec52f=document['querySelectorAll'](_0x26ca93(0x2bf)),_0x3f43c8=[];_0x1ec52f[_0x26ca93(0x304)](_0xcea88d=>{const _0x14a258=_0x26ca93,_0xf1b51b=_0xcea88d['id'][_0x14a258(0x298)](/maco-breakdown-details-(\d+)/);if(_0xf1b51b){_0x3f43c8['push'](_0xf1b51b[0x1]),_0xcea88d['classList'][_0x14a258(0x1e1)](_0x384d44[_0x14a258(0x21d)]);const _0x3dad81=document['getElementById'](_0x14a258(0x18b)+_0xf1b51b[0x1]);_0x3dad81&&(_0x3dad81['textContent']=_0x14a258(0x2e2));}}),_0x30e432[_0x26ca93(0x285)](setTimeout,()=>{const _0x595279=_0x26ca93,_0x1455d2={'kgxup':_0x595279(0x150),'cHtzh':_0x384d44['TBJmx']};window[_0x595279(0x1cf)](),_0x384d44[_0x595279(0x1c3)](setTimeout,()=>{const _0x1cfa68=_0x595279,_0x48a276={'airmg':_0x1455d2[_0x1cfa68(0x206)],'zbffF':_0x1455d2['cHtzh']};_0x22ca29['forEach'](_0x21a5c7=>{const _0xb001a1=_0x1cfa68,_0x578130=document[_0xb001a1(0x19d)](_0xb001a1(0x325)+_0x21a5c7),_0x291a79=document[_0xb001a1(0x19d)](_0xb001a1(0x12b)+_0x21a5c7);_0x578130&&_0x578130[_0xb001a1(0x307)][_0xb001a1(0x1f4)](_0x48a276[_0xb001a1(0x1aa)]),_0x291a79&&(_0x291a79[_0xb001a1(0x1f1)]='▶');}),_0x3f43c8['forEach'](_0x15e849=>{const _0xaccb4e=_0x1cfa68,_0x208e03=document['getElementById'](_0xaccb4e(0x178)+_0x15e849),_0x4cfc03=document['getElementById'](_0xaccb4e(0x18b)+_0x15e849);_0x208e03&&_0x208e03[_0xaccb4e(0x307)][_0xaccb4e(0x1f4)](_0x48a276['zbffF']),_0x4cfc03&&(_0x4cfc03[_0xaccb4e(0x1f1)]=_0xaccb4e(0x1be));});},0x3e8);},0xc8);})):_0x30e432['fAwkF'](_0x30e432[_0x1b906e(0x204)],_0xe7241d)?(window[_0x1b906e(0x1c7)]=_0x3bb93a,import(_0x30e432[_0x1b906e(0x1ed)])[_0x1b906e(0x189)](_0x304592=>{const _0x35b897=_0x1b906e;_0x304592[_0x35b897(0x169)]();const _0x5c5775=document[_0x35b897(0x1de)](_0x30e432[_0x35b897(0x1ba)]),_0x2b6dc3=[];_0x5c5775['forEach'](_0x4e7f9e=>{const _0x125278=_0x35b897,_0x667911=_0x4e7f9e['id'][_0x125278(0x298)](/content-dm-(\d+)/);if(_0x667911){_0x2b6dc3[_0x125278(0x32a)](_0x667911[0x1]),_0x4e7f9e[_0x125278(0x307)][_0x125278(0x1e1)](_0x30e432['TpfXY']);const _0x36a492=document[_0x125278(0x19d)](_0x125278(0x30b)+_0x667911[0x1]);_0x36a492&&(_0x36a492[_0x125278(0x1f1)]='▼');}}),_0x30e432[_0x35b897(0x285)](setTimeout,()=>{const _0x4a029c=_0x35b897;window[_0x4a029c(0x1cf)](),setTimeout(()=>{_0x2b6dc3['forEach'](_0x1677f7=>{const _0x299cc6=a16_0x4e51,_0x320ee3=document['getElementById'](_0x299cc6(0x330)+_0x1677f7),_0x407fb0=document[_0x299cc6(0x19d)](_0x299cc6(0x30b)+_0x1677f7);_0x320ee3&&_0x320ee3[_0x299cc6(0x307)][_0x299cc6(0x1f4)](_0x299cc6(0x150)),_0x407fb0&&(_0x407fb0[_0x299cc6(0x1f1)]='▶');});},0x3e8);},0xc8);})[_0x1b906e(0x173)](_0x242c6a=>{const _0x4f64eb=_0x1b906e;console[_0x4f64eb(0x2a0)](_0x30e432['FksnL'],_0x242c6a),window[_0x4f64eb(0x1cf)]();})['finally'](()=>{setTimeout(()=>{const _0x127539=a16_0x4e51;window[_0x127539(0x1c7)]=null,import(_0x127539(0x1ab))[_0x127539(0x189)](_0x4b2882=>_0x4b2882[_0x127539(0x169)]())[_0x127539(0x173)](()=>{});},0x4b0);})):_0x30e432[_0x1b906e(0x163)](_0x30e432[_0x1b906e(0x25d)],_0xe7241d)?(window[_0x1b906e(0x1c7)]=_0x3bb93a,console[_0x1b906e(0x2de)](_0x30e432['WqWjM'],_0x3bb93a),import(_0x30e432[_0x1b906e(0x121)])[_0x1b906e(0x189)](_0x53def9=>{const _0x488bc4=_0x1b906e;_0x53def9[_0x488bc4(0x125)](),_0x30e432[_0x488bc4(0x1bc)](setTimeout,()=>{const _0x43ba1c=_0x488bc4,_0x59da78=document[_0x43ba1c(0x19d)](_0x30e432['KYMeM']),_0x1810dd=document[_0x43ba1c(0x19d)](_0x30e432[_0x43ba1c(0x22d)]);if(console[_0x43ba1c(0x2de)](_0x30e432['NoQcK'],_0x59da78?_0x59da78[_0x43ba1c(0x16b)][_0x43ba1c(0x2fc)]:_0x30e432[_0x43ba1c(0x1c0)]),console[_0x43ba1c(0x2de)](_0x30e432[_0x43ba1c(0x12c)],_0x1810dd?_0x1810dd[_0x43ba1c(0x16b)][_0x43ba1c(0x2fc)]:_0x30e432[_0x43ba1c(0x1c0)]),console[_0x43ba1c(0x2de)]('Container\x20has\x20content:',!!_0x59da78&&_0x30e432[_0x43ba1c(0x2d9)](_0x59da78[_0x43ba1c(0x13b)][_0x43ba1c(0x35b)],0x0)),!_0x59da78||_0x30e432[_0x43ba1c(0x163)]('none',_0x59da78[_0x43ba1c(0x16b)][_0x43ba1c(0x2fc)]))return console[_0x43ba1c(0x219)]('Train\x20summary\x20container\x20is\x20hidden\x20or\x20missing'),void _0x30e432[_0x43ba1c(0x28c)](alert,_0x43ba1c(0x128));window[_0x43ba1c(0x1cf)](),_0x30e432[_0x43ba1c(0x1bc)](setTimeout,()=>{const _0x4fea53=_0x43ba1c;window['printSelectedTrain']=null,_0x53def9[_0x4fea53(0x125)]();},0x3e8);},0x1f4);})[_0x1b906e(0x173)](_0x2dcfd8=>{const _0x13ca26=_0x1b906e;console[_0x13ca26(0x2a0)](_0x30e432[_0x13ca26(0x1c2)],_0x2dcfd8),alert(_0x30e432[_0x13ca26(0x334)](_0x30e432[_0x13ca26(0x1e0)],_0x2dcfd8[_0x13ca26(0x26d)]));})):setTimeout(()=>{window['print']();},0x64);}export function toggleColumn(_0x27fca4,_0x1f082b){const _0x148c68=a16_0x2b6eac,_0x38d7b2={'WHxFr':function(_0x3ef525,_0x3e29e8){return _0x3ef525===_0x3e29e8;},'bWCpX':_0x148c68(0x15f),'XdFMO':_0x148c68(0x1df),'jNLJN':_0x148c68(0x2fe),'NroNx':_0x148c68(0x2a4),'LRioC':function(_0x27b6e7,_0x464e24){return _0x27b6e7!==_0x464e24;},'IeSsJ':function(_0x32ddfc,_0x321d49){return _0x32ddfc(_0x321d49);},'UBqoG':_0x148c68(0x1a4),'OzZHY':function(_0x16d4b6,_0x44ffd6){return _0x16d4b6!==_0x44ffd6;}};if(_0x38d7b2[_0x148c68(0x185)](_0x38d7b2[_0x148c68(0x1f5)],_0x27fca4)||_0x38d7b2['XdFMO']===_0x27fca4){[_0x38d7b2[_0x148c68(0x2f7)],_0x38d7b2[_0x148c68(0x114)]]['forEach'](_0x14c620=>{const _0x2d05db=_0x148c68;document[_0x2d05db(0x1de)]('#'+_0x14c620+_0x2d05db(0x309)+_0x14c620+'\x20.ingredients-sub-table')['forEach'](_0x55fa42=>{const _0x22b81d=_0x2d05db;_0x55fa42[_0x22b81d(0x307)][_0x22b81d(0x230)](_0x22b81d(0x28f)+_0x27fca4);}),document[_0x2d05db(0x1de)]('#'+_0x14c620+_0x2d05db(0x181)+_0x14c620+_0x2d05db(0x104))[_0x2d05db(0x304)](_0x126e46=>{const _0x38aff7=_0x2d05db;_0x126e46&&_0x126e46[_0x38aff7(0x307)][_0x38aff7(0x230)](_0x38aff7(0x28f)+_0x27fca4);});});const _0x292be0=_0x38d7b2[_0x148c68(0x244)](null,document['querySelector'](_0x148c68(0x24a)+_0x27fca4));localStorage[_0x148c68(0x30d)](_0x148c68(0x25c)+_0x27fca4+_0x148c68(0x167),_0x292be0),_0x38d7b2[_0x148c68(0x22e)](updateToggleIcons,_0x148c68(0x2fe)),_0x38d7b2[_0x148c68(0x22e)](updateToggleIcons,_0x148c68(0x2a4)),import(_0x38d7b2[_0x148c68(0x2f6)])[_0x148c68(0x189)](_0x1bf363=>{const _0x48b151=_0x148c68;_0x1bf363[_0x48b151(0x17c)]();}),import(_0x38d7b2[_0x148c68(0x2f6)])[_0x148c68(0x189)](_0x4381b3=>{const _0x15a31f=_0x148c68;_0x4381b3['renderRpnChart']&&_0x4381b3[_0x15a31f(0x1eb)]();});}else{document[_0x148c68(0x1de)]('#'+_0x1f082b+_0x148c68(0x309)+_0x1f082b+'\x20.ingredients-sub-table')[_0x148c68(0x304)](_0x248a7c=>{const _0x226007=_0x148c68;_0x248a7c[_0x226007(0x307)]['toggle'](_0x226007(0x28f)+_0x27fca4);});const _0x5e75b5=_0x38d7b2[_0x148c68(0x2b6)](null,document[_0x148c68(0x270)]('#'+_0x1f082b+_0x148c68(0x33c)+_0x27fca4));localStorage[_0x148c68(0x30d)](_0x1f082b+'-'+_0x27fca4+_0x148c68(0x167),_0x5e75b5),_0x38d7b2[_0x148c68(0x22e)](updateToggleIcons,_0x1f082b);}}export function toggleColumnVisibilityDropdown(){const _0x17e105=a16_0x2b6eac,_0x448a7e={'SswxL':_0x17e105(0x262),'elwrV':_0x17e105(0x2c6),'BUXGB':'click','IsUtR':_0x17e105(0x10f)},_0x47c313=document[_0x17e105(0x19d)](_0x448a7e[_0x17e105(0x2ee)]);_0x47c313[_0x17e105(0x307)]['toggle'](_0x448a7e[_0x17e105(0x2d7)]),_0x47c313[_0x17e105(0x307)]['contains'](_0x448a7e['elwrV'])||document['addEventListener'](_0x448a7e[_0x17e105(0x170)],function _0x39e12c(_0x51c21a){const _0x4f87c0=_0x17e105;_0x51c21a[_0x4f87c0(0x30e)]['closest'](_0x448a7e[_0x4f87c0(0x363)])||_0x51c21a[_0x4f87c0(0x30e)][_0x4f87c0(0x232)](_0x4f87c0(0x2f1))||(_0x47c313[_0x4f87c0(0x307)][_0x4f87c0(0x1f4)](_0x448a7e[_0x4f87c0(0x2d7)]),document[_0x4f87c0(0x1d4)](_0x448a7e[_0x4f87c0(0x170)],_0x39e12c));});}export function updateToggleIcons(_0x56fb2a){const _0x323d37=a16_0x2b6eac,_0x5a1615={'FLvdV':'hide-pde','SJZdv':_0x323d37(0x29c),'NBwUM':function(_0x50024a,_0x25422c){return _0x50024a===_0x25422c;},'qRVDP':'worstCaseProducts','bDIwq':function(_0x2e7570,_0x48664d){return _0x2e7570===_0x48664d;},'SganV':_0x323d37(0x2b8),'kaMDK':function(_0xaf694e,_0x22591c){return _0xaf694e===_0x22591c;},'oIKDN':function(_0xac9436,_0x17a713){return _0xac9436&&_0x17a713;},'Sjhnd':function(_0x19a104,_0xa94a98){return _0x19a104===_0xa94a98;},'mTIUb':_0x323d37(0x2ef),'jtPbT':_0x323d37(0x23a),'hUuXl':_0x323d37(0x2c2)},_0x465115=document[_0x323d37(0x19d)](_0x56fb2a);if(!_0x465115)return;let _0x10e321,_0x3d5d11;if(_0x5a1615[_0x323d37(0x2c8)](_0x5a1615['qRVDP'],_0x56fb2a)){const _0xf3e3b1=localStorage[_0x323d37(0x1af)](_0x323d37(0x315)),_0xfc5184=localStorage[_0x323d37(0x1af)](_0x323d37(0x29e));if(null===_0xf3e3b1&&null===_0xfc5184)_0x10e321=!0x1,_0x3d5d11=!0x1;else{const _0x580f7e=_0x5a1615[_0x323d37(0x299)](_0x5a1615[_0x323d37(0x16a)],_0xf3e3b1),_0x35f71c=_0x5a1615[_0x323d37(0x26c)](_0x5a1615[_0x323d37(0x16a)],_0xfc5184);_0x5a1615[_0x323d37(0x2ec)](_0x580f7e,_0x35f71c)?(_0x10e321=!0x1,_0x3d5d11=!0x0):(_0x10e321=_0x580f7e,_0x3d5d11=_0x35f71c);}}else{const _0x4f32b7=localStorage[_0x323d37(0x1af)](_0x56fb2a+_0x323d37(0x1fe)),_0x4c1887=localStorage['getItem'](_0x56fb2a+'-ld50Hidden');_0x10e321=_0x5a1615[_0x323d37(0x15c)](_0x5a1615[_0x323d37(0x16a)],_0x4f32b7),_0x3d5d11=_0x5a1615[_0x323d37(0x299)](_0x5a1615[_0x323d37(0x16a)],_0x4c1887);}const _0x5c85ef=_0x465115[_0x323d37(0x270)](_0x323d37(0x348)),_0xe32bf3=_0x465115[_0x323d37(0x270)](_0x5a1615[_0x323d37(0x13e)]);_0x5c85ef&&(_0x5c85ef[_0x323d37(0x13b)]=_0x10e321?_0x323d37(0x153):_0x323d37(0x168)),_0xe32bf3&&(_0xe32bf3[_0x323d37(0x13b)]=_0x3d5d11?_0x5a1615['jtPbT']:_0x5a1615[_0x323d37(0x358)]),document[_0x323d37(0x1de)]('#'+_0x56fb2a+_0x323d37(0x309)+_0x56fb2a+_0x323d37(0x2a1))[_0x323d37(0x304)](_0x406f9f=>{const _0x1d085e=_0x323d37;_0x406f9f&&(_0x406f9f[_0x1d085e(0x307)][_0x1d085e(0x230)](_0x5a1615['FLvdV'],_0x10e321),_0x406f9f[_0x1d085e(0x307)]['toggle'](_0x5a1615['SJZdv'],_0x3d5d11));}),document[_0x323d37(0x1de)]('#'+_0x56fb2a+_0x323d37(0x181)+_0x56fb2a+_0x323d37(0x104))[_0x323d37(0x304)](_0x4e9cfe=>{const _0x2d017e=_0x323d37;_0x4e9cfe&&(_0x4e9cfe[_0x2d017e(0x307)][_0x2d017e(0x230)](_0x2d017e(0x120),_0x10e321),_0x4e9cfe['classList'][_0x2d017e(0x230)](_0x2d017e(0x29c),_0x3d5d11));});}export function exportToExcel(){const _0x4afee9=a16_0x2b6eac,_0x32f9d1={'tcXBc':function(_0x112d06,_0x1b671d){return _0x112d06+_0x1b671d;},'mcKPJ':'Yes','Soppj':function(_0x5c3879){return _0x5c3879();},'AkMPk':_0x4afee9(0x281),'gZaNw':_0x4afee9(0x2e1),'wISkO':_0x4afee9(0x33a),'TUkVC':_0x4afee9(0x273),'oFxKn':function(_0x219564){return _0x219564();},'UtpJP':'Error\x20exporting\x20to\x20Excel:','yoMHN':function(_0x35cca5,_0xbb16e4,_0x22858b){return _0x35cca5(_0xbb16e4,_0x22858b);},'Tydwt':_0x4afee9(0x220),'YcjNq':_0x4afee9(0xfd),'DbqzW':_0x4afee9(0x1fb)};showLoader(),import(_0x32f9d1['DbqzW'])[_0x4afee9(0x189)](_0x49391f=>{const _0x43e956=_0x4afee9,{getProductTrainId:_0x5798b8,calculateScores:_0x47b767}=_0x49391f,_0x317b5b=[];if(a16_0x4cd0f5[_0x43e956(0x22c)][_0x43e956(0x304)](_0x4af392=>{const _0xdf2eef=_0x43e956;let _0x4d9fae='No';_0x4af392[_0xdf2eef(0x20b)]&&(_0x4d9fae=_0x32f9d1[_0xdf2eef(0x1c6)](_0x32f9d1[_0xdf2eef(0x2d1)],_0x4af392[_0xdf2eef(0x1c9)]?':\x20'+_0x4af392['criticalReason']:''));const _0x1cacc8=a16_0x3b78dc(_0x4af392),_0x4d60c6=_0x4af392[_0xdf2eef(0x202)]?new Date(_0x4af392[_0xdf2eef(0x202)])[_0xdf2eef(0x160)]():'';_0x317b5b['push']({'Date':_0x4d60c6,'Product\x20Code':_0x4af392[_0xdf2eef(0x31d)],'Product\x20Name':_0x4af392[_0xdf2eef(0x28b)],'Train\x20No.':_0x1cacc8,'Dosage\x20Form':_0x4af392[_0xdf2eef(0x2ea)]||'','Batch\x20Size\x20(Kg)':_0x4af392[_0xdf2eef(0x31a)],'Special\x20Case\x20Product':_0x4d9fae,'Active\x20Ingredient':'','Solubility':'','Therapeutic\x20Dose\x20(mg/day)':'','Cleanability':'','PDE\x20(µg/day)':'','LD50\x20(mg/kg)':'','Solubility\x20Score':'','Therapeutic\x20Dose\x20Score':'','Cleanability\x20Score':'','Toxicity\x20Score':'','RPN':'','RPN\x20Rating':''}),_0x4af392[_0xdf2eef(0x251)][_0xdf2eef(0x304)](_0x266513=>{const _0x1c399d=_0xdf2eef,_0x41cd69=_0x47b767(_0x266513);_0x317b5b[_0x1c399d(0x32a)]({'Date':'','Product\x20Code':'','Product\x20Name':'\x20\x20└─\x20'+_0x266513['name'],'Train\x20No.':'','Dosage\x20Form':'','Batch\x20Size\x20(Kg)':'','Special\x20Case\x20Product':'','Active\x20Ingredient':_0x266513[_0x1c399d(0x28b)],'Solubility':_0x266513[_0x1c399d(0x351)]||'','Therapeutic\x20Dose\x20(mg/day)':_0x266513['therapeuticDose']||'','Cleanability':_0x266513[_0x1c399d(0x180)]||'','PDE\x20(µg/day)':_0x266513[_0x1c399d(0x15f)]||'','LD50\x20(mg/kg)':_0x266513['ld50']||'','Solubility\x20Score':_0x41cd69['solubilityScore']||'','Therapeutic\x20Dose\x20Score':_0x41cd69[_0x1c399d(0x31b)]||'','Cleanability\x20Score':_0x41cd69[_0x1c399d(0x20a)]||'','Toxicity\x20Score':_0x41cd69[_0x1c399d(0x33d)]||_0x41cd69[_0x1c399d(0x186)]||'','RPN':_0x41cd69[_0x1c399d(0x1e5)],'RPN\x20Rating':_0x41cd69['rpnRatingText']});});}),0x0===_0x317b5b[_0x43e956(0x35b)])return _0x32f9d1[_0x43e956(0x22b)](hideLoader),void showCustomAlert(_0x32f9d1['AkMPk'],_0x32f9d1[_0x43e956(0x2ae)]);const _0x3c24b5=XLSX['utils']['json_to_sheet'](_0x317b5b),_0x3c62e3=XLSX[_0x43e956(0x191)][_0x43e956(0x326)]();XLSX[_0x43e956(0x191)][_0x43e956(0x199)](_0x3c62e3,_0x3c24b5,_0x32f9d1['wISkO']);const _0x3c2977=Object[_0x43e956(0x17a)](_0x317b5b[0x0])['map'](_0x2af170=>({'wch':Math[_0x43e956(0x198)](_0x2af170[_0x43e956(0x35b)],..._0x317b5b[_0x43e956(0xff)](_0x570b07=>String(_0x570b07[_0x2af170]||'')[_0x43e956(0x35b)]))+0x2}));_0x3c24b5[_0x43e956(0x27d)]=_0x3c2977,XLSX['writeFile'](_0x3c62e3,_0x32f9d1[_0x43e956(0x175)]),_0x32f9d1[_0x43e956(0x290)](hideLoader);})[_0x4afee9(0x173)](_0xf85df7=>{const _0xa353c9=_0x4afee9;console[_0xa353c9(0x2a0)](_0x32f9d1[_0xa353c9(0x133)],_0xf85df7),hideLoader(),_0x32f9d1['yoMHN'](showCustomAlert,_0x32f9d1['Tydwt'],_0x32f9d1[_0xa353c9(0x248)]);});}export function exportAllToJson(){const _0x3fe4c5=a16_0x2b6eac,_0x5685bd={'yCFjb':function(_0x12f75c){return _0x12f75c();},'ldpzc':_0x3fe4c5(0x2fd),'BiCsX':_0x3fe4c5(0x2ac),'PwmMY':function(_0x2bbac4,_0x17c8ac,_0x3a996c){return _0x2bbac4(_0x17c8ac,_0x3a996c);}};_0x5685bd[_0x3fe4c5(0x25b)](showLoader);try{const _0x1e2ab4={'exportDate':new Date()[_0x3fe4c5(0x335)](),'scoringCriteria':a16_0x4cd0f5[_0x3fe4c5(0x32e)],'products':a16_0x4cd0f5[_0x3fe4c5(0x22c)],'machines':a16_0x4cd0f5[_0x3fe4c5(0x34a)],'detergentIngredients':a16_0x4cd0f5[_0x3fe4c5(0x30f)]},_0x4f336c=JSON[_0x3fe4c5(0x14a)](_0x1e2ab4,null,0x2),_0xe33d5=new Blob([_0x4f336c],{'type':_0x5685bd['ldpzc']}),_0x56fe0f=URL['createObjectURL'](_0xe33d5),_0x752ead=document[_0x3fe4c5(0x2e0)]('a');_0x752ead[_0x3fe4c5(0x257)]=_0x56fe0f,_0x752ead[_0x3fe4c5(0x336)]=_0x5685bd[_0x3fe4c5(0x2fb)],document[_0x3fe4c5(0x101)][_0x3fe4c5(0x1f2)](_0x752ead),_0x752ead['click'](),document[_0x3fe4c5(0x101)][_0x3fe4c5(0x111)](_0x752ead),URL[_0x3fe4c5(0x13c)](_0x56fe0f);}catch(_0x32a4ce){_0x5685bd[_0x3fe4c5(0x24c)](showCustomAlert,_0x3fe4c5(0x220),_0x3fe4c5(0x16c)+_0x32a4ce[_0x3fe4c5(0x26d)]);}finally{hideLoader();}}export function importFromJson(_0x5005aa){const _0x3c1737=a16_0x2b6eac,_0x508744={'dkwpQ':_0x3c1737(0x345),'Xhkxj':_0x3c1737(0x218),'hfnZi':function(_0x10c1ff,_0x27c0f8,_0xb0d395){return _0x10c1ff(_0x27c0f8,_0xb0d395);},'fZwyW':_0x3c1737(0x220),'IFoFj':function(_0x5c7b28,_0xa01e7d,_0x334ddf){return _0x5c7b28(_0xa01e7d,_0x334ddf);},'QeUdE':'Failed\x20to\x20parse\x20JSON\x20file.'},_0x122542=_0x5005aa[_0x3c1737(0x30e)]['files'][0x0];if(!_0x122542)return;const _0x299ab2=new FileReader();_0x299ab2[_0x3c1737(0x140)]=function(_0x586dcc){const _0x59870b=_0x3c1737;try{const _0x3b5133=JSON[_0x59870b(0x242)](_0x586dcc[_0x59870b(0x30e)][_0x59870b(0x1c4)]);_0x3b5133&&_0x3b5133['products']&&_0x3b5133['scoringCriteria']&&_0x3b5133[_0x59870b(0x34a)]?(a16_0x4cd0f5[_0x59870b(0x35f)](_0x3b5133[_0x59870b(0x22c)]),a16_0x4cd0f5[_0x59870b(0x16d)](_0x3b5133['machines']),a16_0x4cd0f5[_0x59870b(0x2db)](_0x3b5133[_0x59870b(0x32e)]),_0x3b5133[_0x59870b(0x30f)]&&a16_0x4cd0f5[_0x59870b(0x2f8)](_0x3b5133[_0x59870b(0x30f)]),saveStateForUndo(),a16_0xb7686f(),showCustomAlert(_0x508744[_0x59870b(0x27e)],_0x508744[_0x59870b(0x2a5)])):_0x508744['hfnZi'](showCustomAlert,_0x508744[_0x59870b(0x215)],_0x59870b(0x2bd));}catch(_0x437679){_0x508744[_0x59870b(0x2c4)](showCustomAlert,_0x508744['fZwyW'],_0x508744[_0x59870b(0x157)]);}finally{_0x5005aa[_0x59870b(0x30e)]['value']='';}},_0x299ab2[_0x3c1737(0x32f)](_0x122542);}export function toggleOtherProductType(_0x4201a8,_0x3315f8){const _0x3e36d8=a16_0x2b6eac,_0x4f56dd={'aJBKa':_0x3e36d8(0x177),'JPKEp':_0x3e36d8(0x32b)},_0x305750=document[_0x3e36d8(0x19d)](_0x3315f8),_0x30b7f6=_0x305750[_0x3e36d8(0x270)](_0x4f56dd[_0x3e36d8(0x18a)]);_0x3e36d8(0x221)===_0x4201a8[_0x3e36d8(0x340)]?(_0x305750[_0x3e36d8(0x16b)][_0x3e36d8(0x2fc)]='block',_0x30b7f6[_0x3e36d8(0x2d8)]=!0x0):(_0x305750[_0x3e36d8(0x16b)][_0x3e36d8(0x2fc)]=_0x4f56dd['JPKEp'],_0x30b7f6['required']=!0x1,_0x30b7f6['value']='');}export function toggleOtherMachineStage(_0x38fd08,_0x5b85fd){const _0xe2aa03=a16_0x2b6eac,_0xab8a27={'eeCmh':_0xe2aa03(0x177),'lPYhh':function(_0x9c3a57,_0x14a492){return _0x9c3a57===_0x14a492;},'GKYUf':_0xe2aa03(0x194),'DmPTv':'none'},_0x3e3f60=document[_0xe2aa03(0x19d)](_0x5b85fd),_0x2a0b79=_0x3e3f60[_0xe2aa03(0x270)](_0xab8a27[_0xe2aa03(0x17d)]);_0xab8a27[_0xe2aa03(0x33e)](_0xe2aa03(0x221),_0x38fd08['value'])?(_0x3e3f60[_0xe2aa03(0x16b)][_0xe2aa03(0x2fc)]=_0xab8a27[_0xe2aa03(0x2c7)],_0x2a0b79['required']=!0x0):(_0x3e3f60[_0xe2aa03(0x16b)][_0xe2aa03(0x2fc)]=_0xab8a27['DmPTv'],_0x2a0b79['required']=!0x1,_0x2a0b79[_0xe2aa03(0x340)]='');}export function toggleOtherMachineGroup(_0x212a27,_0x106fc0){const _0x5a1e8d=a16_0x2b6eac,_0x45de75={'ANjfg':function(_0x310174,_0x482acf){return _0x310174===_0x482acf;},'GGpTL':_0x5a1e8d(0x194),'LoFPB':_0x5a1e8d(0x32b)},_0x396286=document[_0x5a1e8d(0x19d)](_0x106fc0),_0x1bafdf=_0x396286[_0x5a1e8d(0x270)](_0x5a1e8d(0x177));_0x45de75[_0x5a1e8d(0x264)](_0x5a1e8d(0x221),_0x212a27[_0x5a1e8d(0x340)])?(_0x396286[_0x5a1e8d(0x16b)][_0x5a1e8d(0x2fc)]=_0x45de75['GGpTL'],_0x1bafdf[_0x5a1e8d(0x2d8)]=!0x0):(_0x396286['style'][_0x5a1e8d(0x2fc)]=_0x45de75[_0x5a1e8d(0x2e4)],_0x1bafdf['required']=!0x1,_0x1bafdf[_0x5a1e8d(0x340)]='');}export function clampSafetyFactor(_0x2c52b4,_0x525328){const _0x573a28=a16_0x2b6eac,_0x457b63={'uhqLE':function(_0x1f6619,_0x2dc815){return _0x1f6619(_0x2dc815);},'oenFu':function(_0xb35f52,_0xcdf0a7){return _0xb35f52<_0xcdf0a7;},'FVVVl':function(_0xf1693d,_0x40c5f1){return _0xf1693d!==_0x40c5f1;},'sscWN':function(_0x28ea55,_0x13d769){return _0x28ea55(_0x13d769);},'mdywi':_0x573a28(0x324),'HTqIR':_0x573a28(0x159),'uXbbY':function(_0xfbc2f6,_0x31408a){return _0xfbc2f6(_0x31408a);}},_0x443af3=parseFloat(_0x2c52b4['min']),_0x1e7a5f=parseFloat(_0x2c52b4[_0x573a28(0x198)]);let _0xd04961=_0x457b63[_0x573a28(0x352)](parseFloat,_0x2c52b4[_0x573a28(0x340)]);_0x457b63[_0x573a28(0x352)](isNaN,_0xd04961)&&(_0xd04961=_0x443af3),_0x457b63[_0x573a28(0x1a0)](_0xd04961,_0x443af3)?_0xd04961=_0x443af3:_0xd04961>_0x1e7a5f&&(_0xd04961=_0x1e7a5f),_0x457b63[_0x573a28(0x2c1)](_0x457b63[_0x573a28(0x2df)](parseFloat,_0x2c52b4[_0x573a28(0x340)]),_0xd04961)&&(_0x2c52b4[_0x573a28(0x340)]=_0xd04961),_0x2c52b4['id'][_0x573a28(0x243)](_0x457b63['mdywi'])?_0x457b63[_0x573a28(0x352)](recalculateProductMacoForTrain,_0x525328):_0x2c52b4['id'][_0x573a28(0x243)](_0x457b63[_0x573a28(0x21a)])&&_0x457b63[_0x573a28(0x295)](recalculateDetergentMacoForTrain,_0x525328);}export function toggleTrain(_0x3be95b){const _0x448ac7=a16_0x2b6eac,_0x592bf7={'wnWnP':function(_0x4ee8ec,_0x1657cc){return _0x4ee8ec&&_0x1657cc;},'JqVsX':'collapsed'},_0x4d453d=document[_0x448ac7(0x19d)](_0x448ac7(0x188)+_0x3be95b),_0x1516fc=document[_0x448ac7(0x19d)]('toggle-'+_0x3be95b);_0x592bf7[_0x448ac7(0x229)](_0x4d453d,_0x1516fc)&&(_0x4d453d[_0x448ac7(0x307)][_0x448ac7(0x1e7)](_0x448ac7(0x150))?(_0x4d453d[_0x448ac7(0x307)][_0x448ac7(0x1e1)](_0x592bf7[_0x448ac7(0x1bd)]),_0x1516fc[_0x448ac7(0x1f1)]='▼'):(_0x4d453d[_0x448ac7(0x307)][_0x448ac7(0x1f4)](_0x592bf7[_0x448ac7(0x1bd)]),_0x1516fc['textContent']='▶'));}export function toggleMacoBreakdown(_0x449a59){const _0xe4b3a2=a16_0x2b6eac,_0x3d1cb1={'djpxx':_0xe4b3a2(0x2c6),'VUBbc':'Show\x20MACO\x20Calculation\x20Breakdown'},_0x2b879d=document[_0xe4b3a2(0x19d)](_0xe4b3a2(0x178)+_0x449a59),_0x1cc24b=document['getElementById'](_0xe4b3a2(0x18b)+_0x449a59);_0x2b879d['classList'][_0xe4b3a2(0x1e7)](_0x3d1cb1[_0xe4b3a2(0x134)])?(_0x2b879d[_0xe4b3a2(0x307)][_0xe4b3a2(0x1e1)](_0xe4b3a2(0x2c6)),_0x1cc24b[_0xe4b3a2(0x1f1)]='Hide\x20MACO\x20Calculation\x20Breakdown'):(_0x2b879d[_0xe4b3a2(0x307)][_0xe4b3a2(0x1f4)](_0x3d1cb1[_0xe4b3a2(0x134)]),_0x1cc24b[_0xe4b3a2(0x1f1)]=_0x3d1cb1['VUBbc']);}export function exportWorstCaseToExcel(_0x45c346=a16_0x2b6eac(0x18d)){const _0x14e109=a16_0x2b6eac,_0x305a47={'gzUxG':function(_0x431c4a,_0xfc3f95){return _0x431c4a(_0xfc3f95);},'cPPCz':function(_0x123f0a,_0x46167a){return _0x123f0a!==_0x46167a;},'FiRkb':'N/A','xluYP':function(_0x2f721e,_0x36c249){return _0x2f721e>_0x36c249;},'GaUMM':function(_0x2b2f19,_0x5c1c2f,_0x2c4104){return _0x2b2f19(_0x5c1c2f,_0x2c4104);},'PzYwe':'Yes','ouIlF':function(_0x1b793d){return _0x1b793d();},'rEFJP':_0x14e109(0x281),'mXOOa':_0x14e109(0x18d),'yOxHh':function(_0x186edc,_0x112560,_0x282d88){return _0x186edc(_0x112560,_0x282d88);},'zljXn':function(_0x570f26,_0x14385e){return _0x570f26===_0x14385e;},'sQVEQ':function(_0x2a639b,_0x3505d4,_0x9bfbf7){return _0x2a639b(_0x3505d4,_0x9bfbf7);},'rnEIH':_0x14e109(0x2a7),'uGudb':function(_0x555d0d){return _0x555d0d();},'NEqGR':_0x14e109(0x258),'pbNiC':function(_0x1d806f){return _0x1d806f();},'uNjZZ':'Error','queVU':_0x14e109(0x1fb)};_0x305a47['uGudb'](showLoader),import(_0x305a47[_0x14e109(0x1ac)])[_0x14e109(0x189)](_0x1efa90=>{const _0x900932=_0x14e109,{getProductTrainId:_0x2b42de,calculateScores:_0xe3546a,getToxicityPreference:_0xcb2fb7}=_0x1efa90,_0x334ac0=[];let _0x1ff15f=a16_0x4cd0f5[_0x900932(0x127)][_0x900932(0x2a4)]||a16_0x4cd0f5[_0x900932(0x22c)];if(0x0===_0x1ff15f[_0x900932(0x35b)])return _0x305a47['ouIlF'](hideLoader),void showCustomAlert(_0x305a47[_0x900932(0x210)],_0x900932(0x105));const _0x461da3={};_0x1ff15f[_0x900932(0x304)](_0xf8bdd5=>{const _0x3017d4=_0x900932,_0x44dffb=_0x305a47[_0x3017d4(0x201)](a16_0x3b78dc,_0xf8bdd5);_0x305a47[_0x3017d4(0x349)](_0x305a47[_0x3017d4(0x1fd)],_0x44dffb)&&(_0x461da3[_0x44dffb]||(_0x461da3[_0x44dffb]=[]),_0x461da3[_0x44dffb]['push'](_0xf8bdd5));});let _0x1b1ba0=_0x461da3;if(_0x305a47[_0x900932(0x1b5)]!==_0x45c346&&(_0x1b1ba0={},Array['isArray'](_0x45c346)?_0x45c346[_0x900932(0x304)](_0x56e3bf=>{_0x461da3[_0x56e3bf]&&(_0x1b1ba0[_0x56e3bf]=_0x461da3[_0x56e3bf]);}):_0x461da3[_0x45c346]&&(_0x1b1ba0={[_0x45c346]:_0x461da3[_0x45c346]}),0x0===Object['keys'](_0x1b1ba0)['length']))return hideLoader(),void _0x305a47[_0x900932(0x271)](showCustomAlert,_0x305a47['rEFJP'],(Array['isArray'](_0x45c346)?'Trains\x20'+_0x45c346[_0x900932(0x2f3)](',\x20'):_0x900932(0x225)+_0x45c346)+_0x900932(0x124));const _0x30174b=_0x305a47['ouIlF'](_0xcb2fb7);if(Object[_0x900932(0x17a)](_0x1b1ba0)['sort']((_0x2a3f5c,_0x272586)=>_0x2a3f5c-_0x272586)[_0x900932(0x304)](_0x13434d=>{const _0x5e668e=_0x900932,_0xb9b74e={'hPbtq':function(_0x2c8726,_0x199624){const _0x1769b7=a16_0x4e51;return _0x305a47[_0x1769b7(0x213)](_0x2c8726,_0x199624);},'VbyJH':function(_0x43908d,_0x2cff17,_0x4c707e){const _0x4401d0=a16_0x4e51;return _0x305a47[_0x4401d0(0x2c9)](_0x43908d,_0x2cff17,_0x4c707e);},'auDac':_0x305a47[_0x5e668e(0x1fd)],'HYYAC':_0x305a47['PzYwe']},_0x346965=_0x1b1ba0[_0x13434d];_0x334ac0[_0x5e668e(0x32a)]({'Train':_0x5e668e(0x225)+_0x13434d+_0x5e668e(0x1e8),'Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),_0x346965[_0x5e668e(0x304)](_0x2f1e6b=>{const _0x12f002=_0x5e668e,_0x1efd24=_0x2f1e6b['activeIngredients'][_0x12f002(0xff)](_0x28b2b2=>_0xe3546a(_0x28b2b2,_0x30174b)['rpn']);_0x2f1e6b[_0x12f002(0x2ff)]=_0xb9b74e['hPbtq'](_0x1efd24[_0x12f002(0x35b)],0x0)?Math['max'](..._0x1efd24):0x0;}),_0x346965[_0x5e668e(0x25e)]((_0x508159,_0xa5010c)=>_0xa5010c['sortValue']-_0x508159[_0x5e668e(0x2ff)]),_0x346965['forEach'](_0x4783b3=>{const _0x4860da=_0x5e668e,_0xfc1fb6={'bSwky':function(_0xbab0ed,_0x48f976,_0x5e4413){const _0x1c760a=a16_0x4e51;return _0xb9b74e[_0x1c760a(0x10a)](_0xbab0ed,_0x48f976,_0x5e4413);},'zgHsq':_0xb9b74e[_0x4860da(0x303)]},_0x4a5b97=_0x4783b3[_0x4860da(0x20b)]?_0xb9b74e[_0x4860da(0x1c5)]:'No';_0x334ac0[_0x4860da(0x32a)]({'Train':'','Product\x20Code':_0x4783b3[_0x4860da(0x31d)],'Product\x20Name':_0x4783b3[_0x4860da(0x28b)],'Highest\x20RPN':_0x4783b3[_0x4860da(0x2ff)],'Special\x20Case\x20Product':_0x4a5b97,'Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}),(_0x4783b3['activeIngredients'][_0x4860da(0x25e)]((_0x5d6ce0,_0xcb93d6)=>_0xe3546a(_0xcb93d6,_0x30174b)['rpn']-_0xe3546a(_0x5d6ce0,_0x30174b)[_0x4860da(0x1e5)])[_0x4860da(0x304)](_0x3c6210=>{const _0x332ef2=_0x4860da,_0x545cf8=_0xfc1fb6[_0x332ef2(0x2e8)](_0xe3546a,_0x3c6210,_0x30174b);_0x334ac0[_0x332ef2(0x32a)]({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':_0x3c6210['name'],'TD\x20Score':_0x545cf8[_0x332ef2(0x31b)],'Solubility\x20Score':_0x545cf8[_0x332ef2(0x118)],'Cleanability\x20Score':_0x545cf8['cleanabilityScore'],'PDE\x20Score':_0x545cf8[_0x332ef2(0x33d)]??_0x332ef2(0x2dd),'LD50\x20Score':_0x545cf8[_0x332ef2(0x186)]??_0xfc1fb6['zgHsq'],'RPN':_0x545cf8[_0x332ef2(0x1e5)],'Rating':_0x545cf8[_0x332ef2(0x119)]});}),_0x334ac0['push']({'Train':'','Product\x20Code':'','Product\x20Name':'','Highest\x20RPN':'','Special\x20Case\x20Product':'','Ingredient':'','TD\x20Score':'','Solubility\x20Score':'','Cleanability\x20Score':'','PDE\x20Score':'','LD50\x20Score':'','RPN':'','Rating':''}));});}),_0x305a47['zljXn'](0x0,_0x334ac0['length']))return _0x305a47[_0x900932(0x1cd)](hideLoader),void _0x305a47[_0x900932(0x27a)](showCustomAlert,_0x305a47[_0x900932(0x210)],_0x305a47[_0x900932(0x286)]);const _0x1540c7=XLSX[_0x900932(0x191)]['json_to_sheet'](_0x334ac0),_0x5b561b=XLSX[_0x900932(0x191)][_0x900932(0x326)]();XLSX[_0x900932(0x191)]['book_append_sheet'](_0x5b561b,_0x1540c7,_0x900932(0x1b2));const _0x1fbe66=Object[_0x900932(0x17a)](_0x334ac0[0x0])[_0x900932(0xff)](_0x35ec4e=>({'wch':Math[_0x900932(0x198)](_0x35ec4e[_0x900932(0x35b)],..._0x334ac0[_0x900932(0xff)](_0x1b0684=>String(_0x1b0684[_0x35ec4e]||'')[_0x900932(0x35b)]))+0x2}));_0x1540c7['!cols']=_0x1fbe66;const _0x4e6534=new Date()[_0x900932(0x335)]()[_0x900932(0x13f)]('T')[0x0];let _0x232397='';'all'!==_0x45c346&&(_0x232397=Array[_0x900932(0x216)](_0x45c346)?_0x900932(0x187)+_0x45c346[_0x900932(0x2f3)]('_'):_0x900932(0x205)+_0x45c346),XLSX['writeFile'](_0x5b561b,_0x900932(0x29a)+_0x232397+'_'+_0x4e6534+_0x900932(0x14f)),_0x305a47[_0x900932(0x301)](hideLoader);})[_0x14e109(0x173)](_0x30c5a9=>{const _0x275eb9=_0x14e109;console[_0x275eb9(0x2a0)](_0x305a47[_0x275eb9(0x182)],_0x30c5a9),_0x305a47['pbNiC'](hideLoader),_0x305a47[_0x275eb9(0x27a)](showCustomAlert,_0x305a47[_0x275eb9(0x22a)],_0x275eb9(0x344));});}export function exportMachinesToExcel(){const _0x1db728=a16_0x2b6eac,_0x5be2d5={'wrFdI':_0x1db728(0x12a),'jvIML':function(_0x4db2e2){return _0x4db2e2();},'lPtRu':function(_0x2633a8,_0x246ca3,_0x75edec){return _0x2633a8(_0x246ca3,_0x75edec);},'AMwSP':_0x1db728(0x275),'AAwWF':'Machines','fQrQY':_0x1db728(0x27d),'CcOWS':function(_0x4e61f6){return _0x4e61f6();},'ncvJh':_0x1db728(0x26b),'cxXFh':_0x1db728(0x346),'lYFmY':function(_0x265128,_0x214d78,_0x1b7fa5){return _0x265128(_0x214d78,_0x1b7fa5);},'ToYmH':'Error','msddJ':_0x1db728(0x2f0)};showLoader();try{if(0x0===a16_0x4cd0f5[_0x1db728(0x34a)]['length'])return _0x5be2d5['jvIML'](hideLoader),void _0x5be2d5['lPtRu'](showCustomAlert,'No\x20Data',_0x5be2d5['AMwSP']);const _0x8b6c2b=[],_0x52c6b7={};a16_0x4cd0f5['machines']['forEach'](_0xd78e89=>{const _0x64e536=_0x1db728;_0x52c6b7[_0xd78e89[_0x64e536(0x29f)]]||(_0x52c6b7[_0xd78e89['stage']]=[]),_0x52c6b7[_0xd78e89['stage']][_0x64e536(0x32a)](_0xd78e89);}),a16_0x4cd0f5[_0x1db728(0x112)][_0x1db728(0x304)](_0x235bf9=>{_0x52c6b7[_0x235bf9]&&_0x52c6b7[_0x235bf9]['forEach'](_0x17afff=>{const _0x2a4dec=a16_0x4e51,_0x4cbadd=a16_0x4cd0f5[_0x2a4dec(0x22c)]['filter'](_0x53c4b6=>_0x53c4b6[_0x2a4dec(0x1a3)]&&_0x53c4b6[_0x2a4dec(0x1a3)][_0x2a4dec(0x25a)](_0x17afff['id'])),_0x3cbbb2=_0x4cbadd[_0x2a4dec(0xff)](_0x55d38b=>_0x55d38b[_0x2a4dec(0x28b)])[_0x2a4dec(0x2f3)](',\x20')||_0x5be2d5[_0x2a4dec(0x27c)],_0x53f912=_0x4cbadd[_0x2a4dec(0x35b)];_0x8b6c2b[_0x2a4dec(0x32a)]({'Machine\x20Number':_0x17afff[_0x2a4dec(0x15a)],'Machine\x20Name':_0x17afff['name'],'Stage':_0x17afff['stage'],'Area\x20(sq\x20cm)':_0x17afff[_0x2a4dec(0x2ba)],'Assigned\x20Products\x20Count':_0x53f912,'Assigned\x20Products':_0x3cbbb2});});});const _0x5d9bd7=XLSX[_0x1db728(0x191)]['json_to_sheet'](_0x8b6c2b),_0x28785f=XLSX[_0x1db728(0x191)][_0x1db728(0x326)]();XLSX[_0x1db728(0x191)]['book_append_sheet'](_0x28785f,_0x5d9bd7,_0x5be2d5[_0x1db728(0x2cb)]);const _0xad0121=[{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0xf},{'wch':0x14},{'wch':0x32}];_0x5d9bd7[_0x5be2d5[_0x1db728(0x35c)]]=_0xad0121;const _0x5cffac=new Date()[_0x1db728(0x335)]()[_0x1db728(0x13f)]('T')[0x0];XLSX[_0x1db728(0x1ec)](_0x28785f,_0x1db728(0x116)+_0x5cffac+'.xlsx'),_0x5be2d5[_0x1db728(0x339)](hideLoader),_0x5be2d5['lPtRu'](showCustomAlert,_0x1db728(0x345),_0x5be2d5[_0x1db728(0x311)]);}catch(_0x2783c0){console[_0x1db728(0x2a0)](_0x5be2d5['cxXFh'],_0x2783c0),hideLoader(),_0x5be2d5['lYFmY'](showCustomAlert,_0x5be2d5[_0x1db728(0x190)],_0x5be2d5[_0x1db728(0x267)]);}}export function exportProductMacoToExcel(_0x5a08dc='all'){const _0x8c36e3=a16_0x2b6eac,_0x2c70fb={'UoWOE':function(_0x59d304,_0x2b08d2){return _0x59d304(_0x2b08d2);},'rthAu':function(_0x42caa8,_0x4585ef){return _0x42caa8/_0x4585ef;},'NnjvA':function(_0x3a6f70,_0x1c2de3){return _0x3a6f70*_0x1c2de3;},'QKmXs':function(_0x5aa98d,_0x4ab3bf){return _0x5aa98d/_0x4ab3bf;},'nMarr':function(_0x2f592b,_0x33b916){return _0x2f592b===_0x33b916;},'ODKpn':_0x8c36e3(0x2b8),'QJSch':function(_0x1b0cd2,_0x1def92){return _0x1b0cd2===_0x1def92;},'KdLXi':'productRegister-ld50Hidden','PzefG':function(_0xb3a38f,_0x200f6f){return _0xb3a38f===_0x200f6f;},'LjNfO':function(_0x55fc55,_0x340051){return _0x55fc55*_0x340051;},'Ycqok':function(_0x3292ab,_0x4bf8d5){return _0x3292ab/_0x4bf8d5;},'ERMSa':function(_0x9a972e,_0x201790,_0xd1b36c){return _0x9a972e(_0x201790,_0xd1b36c);},'PYcpl':_0x8c36e3(0x2aa),'UbjDn':_0x8c36e3(0x172),'mNrZX':_0x8c36e3(0x1d2),'hidGJ':function(_0x2dc567,_0x5d3336){return _0x2dc567>_0x5d3336;},'XbZDs':function(_0x10b9ae,_0x1274de){return _0x10b9ae*_0x1274de;},'jhXBz':function(_0x1cdae8){return _0x1cdae8();},'gpsuO':function(_0x3e1a8a,_0x3dc319){return _0x3e1a8a(_0x3dc319);},'peahE':function(_0x5ef3ef,_0x332775){return _0x5ef3ef!==_0x332775;},'rczFa':function(_0x1fa7f9,_0x406003){return _0x1fa7f9==_0x406003;},'CsTzu':_0x8c36e3(0x1cc),'TGyMs':_0x8c36e3(0x2dd),'QiwsK':function(_0x5be196,_0x3b493d){return _0x5be196(_0x3b493d);},'bwJKG':'No\x20Data','luyCn':function(_0x28bb6b,_0x2ba19a){return _0x28bb6b===_0x2ba19a;},'VOUOk':function(_0xcc7b8d){return _0xcc7b8d();},'ywMbc':function(_0x2ceaa8,_0x5c88f2,_0x5d4957){return _0x2ceaa8(_0x5c88f2,_0x5d4957);},'WYMim':'Product\x20MACO\x20Report','BcBrS':_0x8c36e3(0x27d),'FBzsC':_0x8c36e3(0x10b),'xNmAz':function(_0xb52d9a,_0x30a31f){return _0xb52d9a!==_0x30a31f;},'mjMwG':'all','RBqfl':function(_0x5d9904,_0x4edb07,_0x202aa7){return _0x5d9904(_0x4edb07,_0x202aa7);},'Mqine':_0x8c36e3(0x345),'klomo':'Product\x20MACO\x20data\x20exported\x20to\x20Excel\x20successfully!','PLLpV':'Error\x20exporting\x20Product\x20MACO\x20to\x20Excel:','mOlJH':function(_0x4ce0bf,_0x4e496c,_0x33c8e6){return _0x4ce0bf(_0x4e496c,_0x33c8e6);},'jbmAJ':_0x8c36e3(0x220),'gMcpM':'Failed\x20to\x20export\x20Product\x20MACO\x20data\x20to\x20Excel.','ladQb':function(_0x253454){return _0x253454();},'ytZAH':'./utils.js'};_0x2c70fb['ladQb'](showLoader),import(_0x2c70fb[_0x8c36e3(0x32c)])['then'](_0x5c87f6=>{const _0x467c0f=_0x8c36e3,_0xb76c1a={'ieXbm':_0x467c0f(0x2dd)},{getTrainData:_0x52eba5,getWorstCaseProductType:_0x5cd08b,getMacoPerSwabForTrain:_0xfc5e99,getLargestEssaForLineAndDosageForm:_0x1f3754}=_0x5c87f6,_0x2c93c6=_0x2c70fb[_0x467c0f(0x1e3)](_0x52eba5);if(_0x2c70fb[_0x467c0f(0x142)](0x0,_0x2c93c6[_0x467c0f(0x35b)]))return _0x2c70fb['jhXBz'](hideLoader),void _0x2c70fb['ERMSa'](showCustomAlert,_0x2c70fb[_0x467c0f(0x141)],'There\x20are\x20no\x20trains\x20to\x20export.\x20Assign\x20machines\x20to\x20products\x20first.');let _0x56b5f7=_0x2c93c6;if(_0x2c70fb[_0x467c0f(0x107)](_0x467c0f(0x18d),_0x5a08dc)&&(_0x56b5f7=Array[_0x467c0f(0x216)](_0x5a08dc)?_0x2c93c6['filter'](_0x83607a=>_0x5a08dc[_0x467c0f(0x25a)](String(_0x83607a['id']))):_0x2c93c6[_0x467c0f(0x176)](_0x2f2544=>String(_0x2f2544['id'])===String(_0x5a08dc))),_0x2c70fb[_0x467c0f(0x14c)](0x0,_0x56b5f7['length']))return _0x2c70fb[_0x467c0f(0x223)](hideLoader),void _0x2c70fb[_0x467c0f(0x1dc)](showCustomAlert,_0x2c70fb[_0x467c0f(0x141)],_0x467c0f(0x16f));const _0x48e46d=[];_0x56b5f7[_0x467c0f(0x304)](_0x20d4e3=>{const _0x198fed=_0x467c0f,_0x37f8ea=_0x2c70fb[_0x198fed(0x1d8)](_0x5cd08b,_0x20d4e3[_0x198fed(0x22c)][_0x198fed(0xff)](_0xe3d070=>_0xe3d070[_0x198fed(0x2ea)])),_0x508be3=(a16_0x4cd0f5['safetyFactorConfig'][_0x37f8ea]||a16_0x4cd0f5[_0x198fed(0x1b7)][_0x198fed(0x221)])[_0x198fed(0x198)],_0xbd81d=_0x2c70fb['rthAu'](_0x20d4e3[_0x198fed(0x35e)]*_0x20d4e3[_0x198fed(0x31f)],_0x508be3),_0x53d2e3=_0x2c70fb['NnjvA'](0xa,_0x20d4e3[_0x198fed(0x247)]);let _0x345139=_0x2c70fb['QKmXs'](0x1,0x0),_0x4968bc=_0x2c70fb['rthAu'](0x1,0x0);const _0x1998c2=_0x2c70fb[_0x198fed(0x341)](_0x2c70fb[_0x198fed(0x280)],localStorage[_0x198fed(0x1af)](_0x198fed(0x315))),_0x46e638=_0x2c70fb[_0x198fed(0x1db)](_0x2c70fb[_0x198fed(0x280)],localStorage['getItem'](_0x2c70fb[_0x198fed(0x231)]));if(_0x2c70fb['PzefG'](null,_0x20d4e3[_0x198fed(0x146)])||_0x1998c2||(_0x345139=_0x2c70fb['LjNfO'](_0x20d4e3['lowestPde'],_0x20d4e3[_0x198fed(0x31f)])),null!==_0x20d4e3[_0x198fed(0x287)]&&!_0x46e638){const _0x3a6e62=_0x2c70fb[_0x198fed(0x360)](_0x2c70fb['NnjvA'](0x46,_0x20d4e3['lowestLd50']),0x7d0),_0x3e2fdf=_0x20d4e3[_0x198fed(0x22c)]['flatMap'](_0x3d1991=>_0x3d1991[_0x198fed(0x251)][_0x198fed(0xff)](_0x1f0f5d=>_0x1f0f5d['mdd']/0x3e8)),_0x3c9f4c=Math[_0x198fed(0x328)](..._0x3e2fdf);_0x4968bc=_0x2c70fb[_0x198fed(0x102)](_0x3a6e62*_0x20d4e3['minMbsKg']*0x3e8,_0x2c70fb[_0x198fed(0x343)](_0x508be3,_0x3c9f4c));}const _0x5e9656=_0x2c70fb[_0x198fed(0x1b4)](_0x1f3754,_0x20d4e3,_0x2c93c6),_0x329066=0.004*_0x5e9656,_0x2c911a=[{'name':_0x2c70fb['PYcpl'],'value':_0xbd81d},{'name':_0x2c70fb[_0x198fed(0x156)],'value':_0x53d2e3}];null===_0x20d4e3[_0x198fed(0x146)]||_0x1998c2||_0x2c911a['push']({'name':'Health-Based\x20Limit\x20(PDE)','value':_0x345139}),null===_0x20d4e3['lowestLd50']||_0x46e638||_0x2c911a[_0x198fed(0x32a)]({'name':_0x2c70fb[_0x198fed(0x1c1)],'value':_0x4968bc}),_0x2c911a[_0x198fed(0x32a)]({'name':'Visual\x20Clean\x20Limit','value':_0x329066});const _0x54ac71=_0x2c911a[_0x198fed(0x1b3)]((_0x48a474,_0x36f452)=>_0x36f452[_0x198fed(0x340)]<_0x48a474['value']?_0x36f452:_0x48a474),_0x39c81f=_0x54ac71['value'],_0x588cce=_0x2c70fb[_0x198fed(0x269)](_0x5e9656,0x0)?_0x39c81f/_0x5e9656:0x0,_0x4f510c=_0x2c70fb['XbZDs'](_0x588cce,_0x20d4e3[_0x198fed(0x313)]),_0xb56748=_0x20d4e3[_0x198fed(0x1a3)][_0x198fed(0xff)](_0x1a9100=>{const _0x24567c=_0x198fed,_0x5e19bf=a16_0x4cd0f5['machines'][_0x24567c(0x350)](_0xa64644=>_0xa64644['id']===_0x1a9100);return _0x5e19bf||{'name':_0x24567c(0x268)+_0x1a9100+')','machineNumber':_0xb76c1a['ieXbm']};}),_0x55cc81=_0x20d4e3['machineIds'][_0x198fed(0xff)](_0x4f2895=>{const _0x5af938=_0x198fed,_0x596b04=a16_0x4cd0f5[_0x5af938(0x34a)][_0x5af938(0x350)](_0x2abe55=>_0x2abe55['id']===_0x4f2895);return _0x596b04?_0x596b04['name']:_0x5af938(0x268)+_0x4f2895+')';})[_0x198fed(0x2f3)](',\x20'),_0x5a5854=_0x20d4e3[_0x198fed(0x22c)]['map'](_0x5c1377=>_0x5c1377[_0x198fed(0x31d)]+_0x198fed(0x319)+_0x5c1377[_0x198fed(0x28b)])[_0x198fed(0x2f3)](';\x20'),_0x4f2def=_0x20d4e3[_0x198fed(0x1f9)]?_0x20d4e3[_0x198fed(0x1f9)][_0x198fed(0x34b)]+'\x20('+_0x20d4e3[_0x198fed(0x1f9)][_0x198fed(0x353)]+')\x20-\x20RPN:\x20'+_0x20d4e3['worstProductRpn'][_0x198fed(0x1e5)]:_0x198fed(0x2dd);_0x48e46d[_0x198fed(0x32a)]({'Train':'T'+(_0x2c70fb['jhXBz'](a16_0x185e9e)['get'](_0x2c70fb[_0x198fed(0x33b)](String,_0x20d4e3['id']))?.[_0x198fed(0x1cc)]||_0x20d4e3['id']),'Total\x20Products':_0x20d4e3[_0x198fed(0x22c)][_0x198fed(0x35b)],'Total\x20Machines':_0xb56748[_0x198fed(0x35b)],'Total\x20Area\x20(ESSA)\x20cm²':_0x20d4e3[_0x198fed(0x17f)]['toLocaleString'](),'Products':_0x5a5854,'Machines':_0x55cc81,'Worst-Case\x20Dosage\x20Form':_0x37f8ea,'Safety\x20Factor':_0x508be3,'Lowest\x20LTD\x20(mg)':_0x20d4e3[_0x198fed(0x35e)],'Min\x20Batch\x20Size\x20(kg)':_0x20d4e3['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x20d4e3[_0x198fed(0x31f)]['toFixed'](0x2),'Lowest\x20PDE\x20(mg)':_0x2c70fb[_0x198fed(0x107)](null,_0x20d4e3['lowestPde'])?_0x20d4e3[_0x198fed(0x146)]:_0x198fed(0x2dd),'Worst-Case\x20Product\x20(by\x20RPN)':_0x4f2def,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0xbd81d['toFixed'](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x53d2e3[_0x198fed(0x29b)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x2c70fb[_0x198fed(0x158)](_0x2c70fb[_0x198fed(0x174)],typeof _0x345139)?_0x345139[_0x198fed(0x29b)](0x2):_0x2c70fb[_0x198fed(0x14b)],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x329066['toFixed'](0x2),'Selected\x20MACO\x20Method':_0x54ac71[_0x198fed(0x28b)],'Final\x20MACO\x20(mg)':_0x39c81f['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x588cce[_0x198fed(0x241)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x2c70fb['QiwsK'](i,_0x4f510c)});});const _0xc1d27b=XLSX[_0x467c0f(0x191)][_0x467c0f(0x1b8)](_0x48e46d),_0x134982=XLSX[_0x467c0f(0x191)]['book_new']();XLSX[_0x467c0f(0x191)]['book_append_sheet'](_0x134982,_0xc1d27b,_0x2c70fb[_0x467c0f(0x23c)]),_0xc1d27b[_0x2c70fb[_0x467c0f(0x222)]]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0x12},{'wch':0xf},{'wch':0x12},{'wch':0xf},{'wch':0x14},{'wch':0xf},{'wch':0x12},{'wch':0x12}];const _0x4b23b2=new Date()['toISOString']()[_0x467c0f(0x13f)]('T')[0x0];let _0x487e0a=_0x2c70fb[_0x467c0f(0x11a)];if(_0x2c70fb['xNmAz'](_0x2c70fb[_0x467c0f(0x321)],_0x5a08dc)){if(Array[_0x467c0f(0x216)](_0x5a08dc))_0x487e0a+='_Trains_'+_0x5a08dc[_0x467c0f(0x25e)]((_0x421027,_0x52abfb)=>_0x421027-_0x52abfb)['join']('_');else _0x487e0a+=_0x467c0f(0x205)+_0x5a08dc;}_0x487e0a+='_'+_0x4b23b2+_0x467c0f(0x14f),XLSX['writeFile'](_0x134982,_0x487e0a),_0x2c70fb[_0x467c0f(0x1e3)](hideLoader),_0x2c70fb[_0x467c0f(0x276)](showCustomAlert,_0x2c70fb[_0x467c0f(0x266)],_0x2c70fb[_0x467c0f(0x19c)]);})[_0x8c36e3(0x173)](_0x1f9081=>{const _0x2a6c25=_0x8c36e3;console[_0x2a6c25(0x2a0)](_0x2c70fb[_0x2a6c25(0x10c)],_0x1f9081),_0x2c70fb[_0x2a6c25(0x223)](hideLoader),_0x2c70fb['mOlJH'](showCustomAlert,_0x2c70fb['jbmAJ'],_0x2c70fb['gMcpM']);});}export function exportDetergentMacoToExcel(_0x277288=a16_0x2b6eac(0x18d)){const _0x2f5889=a16_0x2b6eac,_0x41eec4={'atakz':function(_0x2d0711,_0x74f6a7){return _0x2d0711||_0x74f6a7;},'xtard':_0x2f5889(0x2dd),'GZKzC':function(_0x4e2ed9,_0x1f3420){return _0x4e2ed9(_0x1f3420);},'ocxxU':function(_0x3a9814,_0x47e1f8){return _0x3a9814/_0x47e1f8;},'EJDOh':function(_0x47e575,_0x2bb2fa){return _0x47e575*_0x2bb2fa;},'TnoFt':function(_0x44dd78,_0x45e0c3){return _0x44dd78>_0x45e0c3;},'TmuRV':function(_0x530fa6,_0x431e94){return _0x530fa6/_0x431e94;},'XUVST':function(_0x19f25c){return _0x19f25c();},'OnKwM':function(_0x2eaa81,_0x5f5875){return _0x2eaa81(_0x5f5875);},'tjECN':function(_0x215549){return _0x215549();},'aWCVl':function(_0x3fd281,_0x1e9244){return _0x3fd281!==_0x1e9244;},'YkReD':_0x2f5889(0x18d),'aBara':function(_0x436ed3,_0x5f5b49){return _0x436ed3===_0x5f5b49;},'xzFhU':function(_0xaa8f90,_0x25c604,_0x5bc07d){return _0xaa8f90(_0x25c604,_0x5bc07d);},'ARjJX':'No\x20Data','ubhLU':_0x2f5889(0x1b0),'licJF':function(_0x2004a4,_0x4bf0c5){return _0x2004a4===_0x4bf0c5;},'fpQdt':function(_0x5b3966){return _0x5b3966();},'lnaPC':_0x2f5889(0x135),'JVytg':function(_0x515501,_0x24c24f){return _0x515501(_0x24c24f);},'yQbTc':'bodyWeight','SEQYW':function(_0x364595,_0x3d30f1){return _0x364595>_0x3d30f1;},'wUwqE':_0x2f5889(0x26e),'HUTwn':_0x2f5889(0x256),'vLtSD':_0x2f5889(0x294),'RxXvv':function(_0xd9da53){return _0xd9da53();},'GrfnP':function(_0xfd550e,_0xdbfa44,_0x14a664){return _0xfd550e(_0xdbfa44,_0x14a664);},'WLnJG':_0x2f5889(0x220),'CDGMh':_0x2f5889(0x18c),'HWqZj':function(_0x2c8414){return _0x2c8414();},'OveRd':'./utils.js'};_0x41eec4['HWqZj'](showLoader),import(_0x41eec4[_0x2f5889(0x21c)])[_0x2f5889(0x189)](_0x447709=>{const _0x3393de=_0x2f5889,{getTrainData:_0x412240,getWorstCaseProductType:_0x31050f}=_0x447709;let _0x10283f=_0x41eec4[_0x3393de(0x12d)](_0x412240);if(_0x41eec4['aWCVl'](_0x41eec4[_0x3393de(0x162)],_0x277288)&&(_0x10283f=Array[_0x3393de(0x216)](_0x277288)?_0x10283f['filter'](_0x32218e=>_0x277288[_0x3393de(0x25a)](String(_0x32218e['id']))):_0x10283f[_0x3393de(0x176)](_0x4125d9=>String(_0x4125d9['id'])===String(_0x277288))),_0x41eec4[_0x3393de(0x145)](0x0,_0x10283f['length']))return hideLoader(),void _0x41eec4[_0x3393de(0x1ca)](showCustomAlert,_0x41eec4[_0x3393de(0x1da)],_0x41eec4[_0x3393de(0x110)]);if(_0x41eec4[_0x3393de(0x226)](0x0,a16_0x4cd0f5['detergentIngredients']['length']))return _0x41eec4[_0x3393de(0x34d)](hideLoader),void _0x41eec4[_0x3393de(0x1ca)](showCustomAlert,_0x41eec4[_0x3393de(0x1da)],_0x41eec4[_0x3393de(0x1d1)]);const _0x6c14d1=[],_0x5cca76=_0x41eec4['JVytg'](parseFloat,document[_0x3393de(0x19d)](_0x41eec4[_0x3393de(0x24f)])?.[_0x3393de(0x340)])||0x46,_0x4a2753=a16_0x4cd0f5[_0x3393de(0x30f)]['map'](_0x4a983e=>parseFloat(_0x4a983e[_0x3393de(0x1df)]))[_0x3393de(0x176)](_0x2dd510=>!isNaN(_0x2dd510)),_0x8c3cea=_0x41eec4['SEQYW'](_0x4a2753['length'],0x0)?Math[_0x3393de(0x328)](..._0x4a2753):0x0,_0x4839cd=a16_0x4cd0f5[_0x3393de(0x30f)]['map'](_0x4bb552=>_0x4bb552[_0x3393de(0x28b)])[_0x3393de(0x176)](_0x5a547f=>''!==_0x5a547f['trim']())['join'](',\x20');_0x10283f[_0x3393de(0x304)](_0x39a1ad=>{const _0x1a4ff4=_0x3393de,_0x2511eb={'YbHCK':function(_0x3fd5e2,_0x372ee5){const _0x1d6ce9=a16_0x4e51;return _0x41eec4[_0x1d6ce9(0x1b1)](_0x3fd5e2,_0x372ee5);},'SLLpb':_0x41eec4[_0x1a4ff4(0x17b)]},_0x4dfb10=_0x41eec4[_0x1a4ff4(0x282)](_0x31050f,_0x39a1ad[_0x1a4ff4(0x22c)][_0x1a4ff4(0xff)](_0x5bc9be=>_0x5bc9be[_0x1a4ff4(0x2ea)])),_0x1d2e28=a16_0x4cd0f5[_0x1a4ff4(0x1b7)][_0x4dfb10]||a16_0x4cd0f5[_0x1a4ff4(0x1b7)][_0x1a4ff4(0x221)],_0x239891=document[_0x1a4ff4(0x19d)](_0x1a4ff4(0x26f)+_0x39a1ad['id']),_0xa82ca7=_0x239891&&parseFloat(_0x239891[_0x1a4ff4(0x340)])||_0x1d2e28[_0x1a4ff4(0x198)],_0x2d4db1=_0x41eec4[_0x1a4ff4(0x30a)](_0x41eec4[_0x1a4ff4(0x362)](0.0005*_0x8c3cea,_0x5cca76),_0xa82ca7),_0x321e1c=_0x41eec4[_0x1a4ff4(0x362)](_0x2d4db1,_0x39a1ad[_0x1a4ff4(0x31f)]),_0x4d9392=_0x447709[_0x1a4ff4(0x27f)](_0x39a1ad,_0x10283f),_0x323ecb=_0x41eec4[_0x1a4ff4(0x2d5)](_0x4d9392,0x0)?_0x41eec4[_0x1a4ff4(0x2a8)](_0x321e1c,_0x4d9392):0x0,_0x364f6e=_0x323ecb*_0x39a1ad[_0x1a4ff4(0x313)],_0x1725d1=_0x39a1ad[_0x1a4ff4(0x1a3)]['map'](_0x4d7384=>{const _0x27a6c3=_0x1a4ff4,_0x41700e=a16_0x4cd0f5[_0x27a6c3(0x34a)]['find'](_0x52ef31=>_0x52ef31['id']===_0x4d7384);return _0x2511eb[_0x27a6c3(0x239)](_0x41700e,{'name':_0x27a6c3(0x268)+_0x4d7384+')','machineNumber':_0x2511eb[_0x27a6c3(0x2dc)]});}),_0x5a6b27=_0x39a1ad['machineIds'][_0x1a4ff4(0xff)](_0x245782=>{const _0x7a5127=_0x1a4ff4,_0x1d1bd1=a16_0x4cd0f5['machines'][_0x7a5127(0x350)](_0x3a851b=>_0x3a851b['id']===_0x245782);return _0x1d1bd1?_0x1d1bd1[_0x7a5127(0x28b)]:_0x7a5127(0x268)+_0x245782+')';})[_0x1a4ff4(0x2f3)](',\x20'),_0x5142ef=_0x39a1ad[_0x1a4ff4(0x22c)]['map'](_0x26020a=>_0x26020a[_0x1a4ff4(0x31d)]+_0x1a4ff4(0x319)+_0x26020a[_0x1a4ff4(0x28b)])['join'](';\x20'),_0x2502b9=_0x39a1ad[_0x1a4ff4(0x1f9)]?_0x39a1ad[_0x1a4ff4(0x1f9)]['productName']+'\x20('+_0x39a1ad['worstProductRpn'][_0x1a4ff4(0x353)]+_0x1a4ff4(0x1dd)+_0x39a1ad[_0x1a4ff4(0x1f9)][_0x1a4ff4(0x1e5)]:_0x41eec4[_0x1a4ff4(0x17b)];_0x6c14d1[_0x1a4ff4(0x32a)]({'Train':'T'+(_0x41eec4[_0x1a4ff4(0x122)](a16_0x185e9e)[_0x1a4ff4(0x139)](_0x41eec4[_0x1a4ff4(0x282)](String,_0x39a1ad['id']))?.[_0x1a4ff4(0x1cc)]||_0x39a1ad['id']),'Total\x20Products':_0x39a1ad['products'][_0x1a4ff4(0x35b)],'Total\x20Machines':_0x1725d1['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x39a1ad[_0x1a4ff4(0x17f)][_0x1a4ff4(0x15b)](),'Products':_0x5142ef,'Machines':_0x5a6b27,'Worst-Case\x20Dosage\x20Form':_0x4dfb10,'Safety\x20Factor\x20Range':_0x1d2e28[_0x1a4ff4(0x328)]+_0x1a4ff4(0x319)+_0x1d2e28[_0x1a4ff4(0x198)],'Applied\x20Safety\x20Factor':_0xa82ca7,'Detergent\x20Ingredients':_0x4839cd,'Body\x20Weight\x20(kg)':_0x5cca76,'Minimum\x20LD50\x20(mg/kg)':_0x8c3cea,'Min\x20Batch\x20Size\x20(kg)':_0x39a1ad[_0x1a4ff4(0x247)],'Min\x20BS/MDD\x20Ratio':_0x39a1ad[_0x1a4ff4(0x31f)][_0x1a4ff4(0x29b)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x2502b9,'ADI\x20(mg)':_0x2d4db1[_0x1a4ff4(0x29b)](0x4),'MACO\x20(mg)':_0x321e1c[_0x1a4ff4(0x29b)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x323ecb[_0x1a4ff4(0x241)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x41eec4[_0x1a4ff4(0x126)](i,_0x364f6e)});});const _0xae8d56=XLSX[_0x3393de(0x191)][_0x3393de(0x1b8)](_0x6c14d1),_0x1e8d00=XLSX['utils']['book_new']();XLSX['utils']['book_append_sheet'](_0x1e8d00,_0xae8d56,_0x41eec4[_0x3393de(0x1ea)]),_0xae8d56[_0x3393de(0x27d)]=[{'wch':0x8},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x32},{'wch':0x32},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0x1e},{'wch':0xc},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x28},{'wch':0xc},{'wch':0xc},{'wch':0x12},{'wch':0x12}];const _0x46cf60=new Date()[_0x3393de(0x335)]()[_0x3393de(0x13f)]('T')[0x0];XLSX[_0x3393de(0x1ec)](_0x1e8d00,_0x3393de(0x1bb)+_0x46cf60+_0x3393de(0x14f)),_0x41eec4[_0x3393de(0x122)](hideLoader),_0x41eec4['xzFhU'](showCustomAlert,'Success',_0x41eec4[_0x3393de(0x278)]);})[_0x2f5889(0x173)](_0x4520a9=>{const _0x5409bf=_0x2f5889;console['error'](_0x41eec4[_0x5409bf(0x34f)],_0x4520a9),_0x41eec4[_0x5409bf(0x254)](hideLoader),_0x41eec4[_0x5409bf(0x249)](showCustomAlert,_0x41eec4[_0x5409bf(0x2b9)],_0x41eec4[_0x5409bf(0x306)]);});}export function exportTrainSummaryToExcel(_0x104b69=a16_0x2b6eac(0x18d)){const _0x494427=a16_0x2b6eac,_0x292f6b={'nwxpV':function(_0x452782,_0x566d20){return _0x452782||_0x566d20;},'VeIPc':function(_0x98a525){return _0x98a525();},'OgSog':function(_0xff8b52,_0x5561a0){return _0xff8b52!==_0x5561a0;},'pFvFK':_0x494427(0x2dd),'yilOH':function(_0x4609b1){return _0x4609b1();},'OmRNr':function(_0x28ecca,_0x4eef8c){return _0x28ecca===_0x4eef8c;},'MeDGI':function(_0x56764e,_0x368e0c,_0x23beda){return _0x56764e(_0x368e0c,_0x23beda);},'hvyxN':function(_0x4a9aae,_0x541fef){return _0x4a9aae!==_0x541fef;},'VPgnd':_0x494427(0x18d),'uUlFV':function(_0x79755,_0x4d1091){return _0x79755===_0x4d1091;},'LsBBH':_0x494427(0x281),'nvnUg':_0x494427(0x16f),'uKyZW':'!cols','UoaBk':function(_0x80d162,_0x435945){return _0x80d162!==_0x435945;},'OOnmW':function(_0x378d36){return _0x378d36();},'VmKIS':_0x494427(0x345),'IfVtq':'Error\x20exporting\x20Train\x20Summary\x20to\x20Excel:','CBOCq':function(_0x5841d5,_0x17d1cd,_0x3f5a4e){return _0x5841d5(_0x17d1cd,_0x3f5a4e);},'ANQAa':_0x494427(0x220),'FCLmL':_0x494427(0x1fb)};_0x292f6b[_0x494427(0x356)](showLoader),import(_0x292f6b[_0x494427(0x195)])[_0x494427(0x189)](_0x5da8bb=>{const _0x416947=_0x494427,_0x43bd77={'bIxMs':function(_0x206b20,_0x97215c){const _0x295072=a16_0x4e51;return _0x292f6b[_0x295072(0x296)](_0x206b20,_0x97215c);},'ifKVy':function(_0x260dac){const _0x1eb005=a16_0x4e51;return _0x292f6b[_0x1eb005(0x284)](_0x260dac);},'sYWqn':function(_0x5a1b2e,_0x5d0b05){const _0x2cd435=a16_0x4e51;return _0x292f6b[_0x2cd435(0x289)](_0x5a1b2e,_0x5d0b05);},'vsZWM':_0x292f6b['pFvFK']},{getTrainData:_0x384c5d}=_0x5da8bb,_0x478bce=_0x292f6b[_0x416947(0xfe)](_0x384c5d);if(_0x292f6b['OmRNr'](0x0,_0x478bce['length']))return hideLoader(),void _0x292f6b['MeDGI'](showCustomAlert,_0x416947(0x281),_0x416947(0x1b0));let _0x47540e=_0x478bce;if(_0x292f6b[_0x416947(0x1ad)](_0x292f6b[_0x416947(0x138)],_0x104b69)&&(_0x47540e=Array[_0x416947(0x216)](_0x104b69)?_0x478bce[_0x416947(0x176)](_0x3ae6dc=>_0x104b69[_0x416947(0x25a)](String(_0x3ae6dc['id']))):_0x478bce[_0x416947(0x176)](_0x5a29b0=>String(_0x5a29b0['id'])===String(_0x104b69))),_0x292f6b['uUlFV'](0x0,_0x47540e['length']))return _0x292f6b[_0x416947(0x284)](hideLoader),void _0x292f6b[_0x416947(0x154)](showCustomAlert,_0x292f6b[_0x416947(0x144)],_0x292f6b['nvnUg']);const _0x307346=[];_0x47540e[_0x416947(0x304)](_0x1725de=>{const _0x30f650=_0x416947,_0x377a81=_0x1725de[_0x30f650(0x1a3)][_0x30f650(0xff)](_0x3f2c67=>{const _0xdc4aca=_0x30f650,_0x2880e4=a16_0x4cd0f5[_0xdc4aca(0x34a)][_0xdc4aca(0x350)](_0x305366=>_0x305366['id']===_0x3f2c67);return _0x43bd77[_0xdc4aca(0x203)](_0x2880e4,{'id':_0x3f2c67,'name':_0xdc4aca(0x268)+_0x3f2c67+')','machineNumber':'N/A'});}),_0x3ddc02=_0x1725de[_0x30f650(0x1a3)][_0x30f650(0xff)](_0x2a8b1c=>{const _0x451398=_0x30f650,_0x3b701f=a16_0x4cd0f5[_0x451398(0x34a)][_0x451398(0x350)](_0x2610f7=>_0x2610f7['id']===_0x2a8b1c);return _0x3b701f?_0x3b701f[_0x451398(0x28b)]:_0x451398(0x268)+_0x2a8b1c+')';})['join'](',\x20'),_0x53ca70=_0x1725de[_0x30f650(0x22c)]['map'](_0x404d4b=>_0x404d4b[_0x30f650(0x31d)]+_0x30f650(0x319)+_0x404d4b[_0x30f650(0x28b)])[_0x30f650(0x2f3)](';\x20'),_0x1fd3f1=_0x1725de['products'][_0x30f650(0xff)](_0x3b5824=>_0x3b5824[_0x30f650(0x31d)]+':\x20'+_0x3b5824['name'])[_0x30f650(0x2f3)]('\x0a'),_0x2a6708=_0x377a81[_0x30f650(0xff)](_0x379d92=>_0x379d92[_0x30f650(0x15a)]+':\x20'+_0x379d92[_0x30f650(0x28b)])[_0x30f650(0x2f3)]('\x0a');_0x307346[_0x30f650(0x32a)]({'Train\x20ID':'T'+(_0x43bd77['ifKVy'](a16_0x185e9e)[_0x30f650(0x139)](String(_0x1725de['id']))?.[_0x30f650(0x1cc)]||_0x1725de['id']),'Products\x20Count':_0x1725de[_0x30f650(0x22c)][_0x30f650(0x35b)],'Machines\x20Count':_0x377a81[_0x30f650(0x35b)],'Total\x20Area\x20(ESSA)\x20cm²':_0x1725de[_0x30f650(0x17f)][_0x30f650(0x15b)](),'Products\x20(Code\x20-\x20Name)':_0x53ca70,'Machines\x20(Number\x20-\x20Name)':_0x3ddc02,'Products\x20Detailed':_0x1fd3f1,'Machines\x20Detailed':_0x2a6708,'Min\x20Batch\x20Size\x20(kg)':_0x1725de[_0x30f650(0x247)],'Min\x20BS/MDD\x20Ratio':_0x1725de[_0x30f650(0x31f)][_0x30f650(0x29b)](0x2),'Assumed\x20SSA\x20(cm²)':_0x1725de[_0x30f650(0x313)],'Lowest\x20LTD\x20(mg)':_0x1725de[_0x30f650(0x35e)],'Lowest\x20PDE\x20(mg)':_0x43bd77[_0x30f650(0x297)](null,_0x1725de[_0x30f650(0x146)])?_0x1725de[_0x30f650(0x146)]:'N/A','Worst\x20RPN\x20Product':_0x1725de[_0x30f650(0x1f9)]?_0x1725de['worstProductRpn']['productName']+'\x20('+_0x1725de[_0x30f650(0x1f9)]['ingredientName']+')\x20-\x20RPN:\x20'+_0x1725de[_0x30f650(0x1f9)][_0x30f650(0x1e5)]:_0x43bd77[_0x30f650(0x2ab)]});});const _0x5d87e9=XLSX[_0x416947(0x191)]['json_to_sheet'](_0x307346),_0x222a7d=XLSX[_0x416947(0x191)][_0x416947(0x326)]();XLSX['utils'][_0x416947(0x199)](_0x222a7d,_0x5d87e9,_0x416947(0x2a6)),_0x5d87e9[_0x292f6b[_0x416947(0x132)]]=[{'wch':0xa},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x3c},{'wch':0x3c},{'wch':0x28},{'wch':0x28},{'wch':0xf},{'wch':0xf},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32}];const _0x5a418e=new Date()[_0x416947(0x335)]()[_0x416947(0x13f)]('T')[0x0];let _0x33e665='Train_Summary_Report';if(_0x292f6b[_0x416947(0x196)](_0x292f6b[_0x416947(0x138)],_0x104b69)){if(Array['isArray'](_0x104b69))_0x33e665+=_0x416947(0x187)+_0x104b69[_0x416947(0x25e)]((_0x39f556,_0x3fe230)=>_0x39f556-_0x3fe230)[_0x416947(0x2f3)]('_');else _0x33e665+=_0x416947(0x205)+_0x104b69;}_0x33e665+='_'+_0x5a418e+_0x416947(0x14f),XLSX[_0x416947(0x1ec)](_0x222a7d,_0x33e665),_0x292f6b['OOnmW'](hideLoader),showCustomAlert(_0x292f6b[_0x416947(0x1f7)],_0x416947(0x11e));})[_0x494427(0x173)](_0xac76a9=>{const _0x43b6f5=_0x494427;console[_0x43b6f5(0x2a0)](_0x292f6b['IfVtq'],_0xac76a9),_0x292f6b[_0x43b6f5(0x356)](hideLoader),_0x292f6b['CBOCq'](showCustomAlert,_0x292f6b[_0x43b6f5(0x246)],_0x43b6f5(0x33f));});}export function exportSummaryToExcel(){const _0x3a50ad=a16_0x2b6eac,_0x1a453f={'juRuQ':function(_0x58f227,_0xc34480){return _0x58f227!==_0xc34480;},'jNRhM':_0x3a50ad(0x2dd),'Kvafq':'Yes','WwqNk':function(_0x2dc07c,_0x587b09){return _0x2dc07c(_0x587b09);},'uukAy':function(_0x5c4fcb,_0x53482d){return _0x5c4fcb>_0x53482d;},'ebKbg':function(_0x4ac834,_0x2ed1ed){return _0x4ac834===_0x2ed1ed;},'LlHFW':function(_0x12d33d,_0x209e25){return _0x12d33d===_0x209e25;},'OGxec':function(_0x2d5506){return _0x2d5506();},'ruvej':_0x3a50ad(0x100),'rlics':function(_0x3be311,_0x46817c){return _0x3be311>_0x46817c;},'ucJtp':'!cols','YyrLU':_0x3a50ad(0x2da),'WarOE':_0x3a50ad(0x208),'RUmKJ':function(_0x72b2c,_0x16abf9,_0x419035){return _0x72b2c(_0x16abf9,_0x419035);},'cjwKB':_0x3a50ad(0x345),'ShGcB':_0x3a50ad(0x14e),'qLYlr':_0x3a50ad(0x23b),'xwPHK':_0x3a50ad(0x220),'OEWnM':_0x3a50ad(0x1f6),'oThvy':function(_0x4d12ef){return _0x4d12ef();},'xqJxi':'./utils.js'};_0x1a453f[_0x3a50ad(0x228)](showLoader),import(_0x1a453f[_0x3a50ad(0x166)])[_0x3a50ad(0x189)](_0x4d7d83=>{const _0x5e31d7=_0x3a50ad,_0x33d6e9={'PWlXS':function(_0x473030,_0x234911){const _0x7fd54b=a16_0x4e51;return _0x1a453f[_0x7fd54b(0x11f)](_0x473030,_0x234911);},'TcMCV':function(_0x219e90,_0x2dc289){const _0x50b644=a16_0x4e51;return _0x1a453f[_0x50b644(0x1fa)](_0x219e90,_0x2dc289);}},{getProductTrainId:_0x467ea6,calculateScores:_0x1341df}=_0x4d7d83,_0x3a5cc5=a16_0x4cd0f5['products'][_0x5e31d7(0x310)](_0x5a3986=>{const _0x4ad981=_0x5e31d7,_0x7f07db=a16_0x3b78dc(_0x5a3986);return _0x5a3986[_0x4ad981(0x251)][_0x4ad981(0xff)](_0x2993e2=>({'productName':_0x5a3986[_0x4ad981(0x28b)],'productCode':_0x5a3986['productCode'],'ingredientName':_0x2993e2[_0x4ad981(0x28b)],'rpn':_0x1341df(_0x2993e2)[_0x4ad981(0x1e5)],'trainId':_0x4ad981(0x2dd)!==_0x7f07db?'T'+_0x7f07db:_0x4ad981(0x2dd),'scores':_0x1341df(_0x2993e2)}));})[_0x5e31d7(0x25e)]((_0x272609,_0x4e37e0)=>_0x4e37e0['rpn']-_0x272609[_0x5e31d7(0x1e5)])[_0x5e31d7(0x1cb)](0x0,0xa),_0x20bdaf=a16_0x4cd0f5[_0x5e31d7(0x22c)][_0x5e31d7(0x176)](_0x31ae65=>_0x31ae65[_0x5e31d7(0x20b)]);if(_0x1a453f['ebKbg'](0x0,_0x3a5cc5['length'])&&_0x1a453f[_0x5e31d7(0x11d)](0x0,_0x20bdaf[_0x5e31d7(0x35b)]))return _0x1a453f['OGxec'](hideLoader),void showCustomAlert(_0x5e31d7(0x281),_0x1a453f[_0x5e31d7(0x143)]);const _0x5a4cfc=XLSX['utils'][_0x5e31d7(0x326)]();if(_0x1a453f[_0x5e31d7(0x2cc)](_0x3a5cc5[_0x5e31d7(0x35b)],0x0)){const _0x78c966=_0x3a5cc5[_0x5e31d7(0xff)]((_0x382b98,_0x51a397)=>({'Rank':_0x51a397+0x1,'Product\x20Code':_0x382b98['productCode'],'Product\x20Name':_0x382b98[_0x5e31d7(0x34b)],'Train':_0x382b98[_0x5e31d7(0x21b)],'Ingredient':_0x382b98[_0x5e31d7(0x353)],'RPN':_0x382b98['rpn']})),_0x2bbdf2=XLSX[_0x5e31d7(0x191)]['json_to_sheet'](_0x78c966),_0x3c14bf=[{'wch':0x8},{'wch':0xf},{'wch':0x1e},{'wch':0xa},{'wch':0x19},{'wch':0x8}];_0x2bbdf2[_0x1a453f['ucJtp']]=_0x3c14bf,XLSX[_0x5e31d7(0x191)][_0x5e31d7(0x199)](_0x5a4cfc,_0x2bbdf2,_0x1a453f[_0x5e31d7(0x2ed)]);}if(_0x20bdaf[_0x5e31d7(0x35b)]>0x0){const _0x590fe8=_0x20bdaf[_0x5e31d7(0xff)](_0x2fc126=>({'Product\x20Code':_0x2fc126['productCode'],'Product\x20Name':_0x2fc126[_0x5e31d7(0x28b)],'Product\x20Type':_0x2fc126[_0x5e31d7(0x2ea)],'Batch\x20Size\x20(kg)':_0x2fc126[_0x5e31d7(0x31a)],'MDD\x20(mg)':_0x2fc126[_0x5e31d7(0x2ca)],'Critical\x20Reason':_0x2fc126[_0x5e31d7(0x1c9)]||'No\x20reason\x20provided','Train':'N/A'!==a16_0x3b78dc(_0x2fc126)?'T'+a16_0x3b78dc(_0x2fc126):_0x5e31d7(0x2dd)})),_0x4f67de=XLSX[_0x5e31d7(0x191)][_0x5e31d7(0x1b8)](_0x590fe8),_0x43b463=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0x32},{'wch':0xa}];_0x4f67de[_0x1a453f['ucJtp']]=_0x43b463,XLSX[_0x5e31d7(0x191)][_0x5e31d7(0x199)](_0x5a4cfc,_0x4f67de,_0x1a453f[_0x5e31d7(0x113)]);}const _0x46157b=a16_0x4cd0f5[_0x5e31d7(0x22c)][_0x5e31d7(0xff)](_0x155b4a=>{const _0x5a8f83=_0x5e31d7,_0x210978=a16_0x3b78dc(_0x155b4a),_0x260d88=_0x155b4a['activeIngredients']['reduce']((_0x2ec0f3,_0x578c97)=>{const _0x1ef006=a16_0x4e51,_0x45431e=_0x33d6e9[_0x1ef006(0x272)](_0x1341df,_0x578c97)['rpn'];return _0x33d6e9['TcMCV'](_0x45431e,_0x2ec0f3[_0x1ef006(0x1e5)])?{..._0x578c97,'rpn':_0x45431e}:_0x2ec0f3;},{'rpn':0x0,'name':_0x5a8f83(0x2dd)});return{'Product\x20Code':_0x155b4a[_0x5a8f83(0x31d)],'Product\x20Name':_0x155b4a['name'],'Product\x20Type':_0x155b4a[_0x5a8f83(0x2ea)],'Batch\x20Size\x20(kg)':_0x155b4a['batchSizeKg'],'MDD\x20(mg)':_0x155b4a[_0x5a8f83(0x2ca)],'Train':_0x1a453f[_0x5a8f83(0x237)](_0x1a453f[_0x5a8f83(0x238)],_0x210978)?'T'+_0x210978:_0x1a453f[_0x5a8f83(0x238)],'Is\x20Critical':_0x155b4a[_0x5a8f83(0x20b)]?_0x1a453f['Kvafq']:'No','Critical\x20Reason':_0x155b4a[_0x5a8f83(0x1c9)]||_0x5a8f83(0x2dd),'Ingredients\x20Count':_0x155b4a[_0x5a8f83(0x251)][_0x5a8f83(0x35b)],'Highest\x20RPN\x20Ingredient':_0x260d88[_0x5a8f83(0x28b)],'Highest\x20RPN\x20Value':_0x260d88[_0x5a8f83(0x1e5)]||0x0};}),_0x1abc41=XLSX[_0x5e31d7(0x191)]['json_to_sheet'](_0x46157b);_0x1abc41[_0x1a453f['ucJtp']]=[{'wch':0xf},{'wch':0x1e},{'wch':0xf},{'wch':0xc},{'wch':0xc},{'wch':0xa},{'wch':0xa},{'wch':0x28},{'wch':0xc},{'wch':0x19},{'wch':0xc}],XLSX[_0x5e31d7(0x191)][_0x5e31d7(0x199)](_0x5a4cfc,_0x1abc41,_0x5e31d7(0x28a));const _0x284341=new Date()[_0x5e31d7(0x335)]()[_0x5e31d7(0x13f)]('T')[0x0];XLSX[_0x5e31d7(0x1ec)](_0x5a4cfc,_0x5e31d7(0x1a8)+_0x284341+_0x5e31d7(0x14f)),_0x1a453f[_0x5e31d7(0x2d0)](hideLoader),_0x1a453f[_0x5e31d7(0x1c8)](showCustomAlert,_0x1a453f[_0x5e31d7(0x279)],_0x1a453f[_0x5e31d7(0x333)]);})[_0x3a50ad(0x173)](_0x124800=>{const _0x39e52c=_0x3a50ad;console[_0x39e52c(0x2a0)](_0x1a453f['qLYlr'],_0x124800),hideLoader(),_0x1a453f[_0x39e52c(0x1c8)](showCustomAlert,_0x1a453f[_0x39e52c(0x329)],_0x1a453f['OEWnM']);});}export function exportAllTabsToExcel(){const _0x2d70bd=a16_0x2b6eac,_0x180228={'bvdHi':'N/A','eNafW':function(_0xc2922){return _0xc2922();},'NFQZU':function(_0x51efc8,_0x1f06b6){return _0x51efc8(_0x1f06b6);},'hCvHS':function(_0x26a4f1,_0x47b42d){return _0x26a4f1(_0x47b42d);},'Hwaep':_0x2d70bd(0x259),'QLzWT':function(_0x5fc599,_0x35aa4e){return _0x5fc599(_0x35aa4e);},'HTALr':function(_0x1ec49a,_0x2ec686){return _0x1ec49a!==_0x2ec686;},'IoRjB':'Yes','dnknI':_0x2d70bd(0x19e),'sIFIE':function(_0x842761,_0x3981b8){return _0x842761||_0x3981b8;},'zoRvu':function(_0x5d1ae9,_0x3f6454){return _0x5d1ae9*_0x3f6454;},'mKPkg':_0x2d70bd(0x29e),'BHaqV':function(_0x398f11,_0x29e028){return _0x398f11/_0x29e028;},'kawnX':function(_0x588284,_0x3a4da0){return _0x588284*_0x3a4da0;},'TYYpQ':function(_0x3fe878,_0x205cfa,_0x5ba183){return _0x3fe878(_0x205cfa,_0x5ba183);},'mGgVU':_0x2d70bd(0x2aa),'vbiGp':_0x2d70bd(0x172),'jGxEK':function(_0x18dc51,_0x1d8ac0){return _0x18dc51===_0x1d8ac0;},'Ggpoe':_0x2d70bd(0x1a1),'CIqMt':function(_0x821e8,_0x38675b){return _0x821e8>_0x38675b;},'AwPFR':function(_0x1a348c,_0x56e6ac){return _0x1a348c/_0x56e6ac;},'vRvLq':function(_0x26b195,_0x39f7a9){return _0x26b195*_0x39f7a9;},'QXFQg':function(_0x261e29,_0x4533e8){return _0x261e29==_0x4533e8;},'KKrXW':_0x2d70bd(0x1cc),'hweek':function(_0xb9f848,_0x567ae8){return _0xb9f848(_0x567ae8);},'LvDFD':function(_0x36b81d,_0x252db3){return _0x36b81d(_0x252db3);},'MClrn':function(_0x39497e,_0x5ddb10){return _0x39497e*_0x5ddb10;},'ChibM':function(_0x29c364,_0x4a8d48){return _0x29c364>_0x4a8d48;},'mhjpa':function(_0x797f6c,_0x5b9352){return _0x797f6c*_0x5b9352;},'mIhQJ':function(_0x47f5aa,_0x542872){return _0x47f5aa===_0x542872;},'PsIic':function(_0x785ea4,_0x4d7603,_0x377cab){return _0x785ea4(_0x4d7603,_0x377cab);},'hBUBE':_0x2d70bd(0x281),'DxLrC':'Product\x20MACO','CnKOI':'Error\x20creating\x20Product\x20MACO\x20sheet:','IPVun':function(_0x952703,_0x22baa0){return _0x952703(_0x22baa0);},'qtfbg':_0x2d70bd(0x1a2),'drlaB':_0x2d70bd(0x320),'vCVXt':_0x2d70bd(0x263),'pwevE':_0x2d70bd(0x2b0),'LhjJp':'Error\x20creating\x20Train\x20Summary\x20sheet:','rQHag':_0x2d70bd(0x2da),'sITtG':'Error\x20creating\x20Top\x2010\x20RPN\x20sheet:','FOoLN':'Critical\x20Products','wWqBJ':_0x2d70bd(0x1a6),'zdzZb':_0x2d70bd(0x28a),'DlRfH':_0x2d70bd(0x115),'IvMXO':function(_0x4740d2,_0x311633,_0x551416){return _0x4740d2(_0x311633,_0x551416);},'rFtCF':'Success','hTUMN':function(_0x1ae0b8){return _0x1ae0b8();},'kzHSL':_0x2d70bd(0x1fb)};showLoader(),import(_0x180228[_0x2d70bd(0x193)])[_0x2d70bd(0x189)](_0x596689=>{const _0x5355a7=_0x2d70bd,_0x1e6474={'FkVST':function(_0x54b70d,_0x509425){return _0x180228['sIFIE'](_0x54b70d,_0x509425);},'CRIcO':function(_0x516307,_0x322f34){return _0x180228['hCvHS'](_0x516307,_0x322f34);},'GeiIt':function(_0x46c3eb,_0x17a321){return _0x46c3eb/_0x17a321;},'rGHBc':function(_0x58ab48,_0x31eabf){const _0x1338cb=a16_0x4e51;return _0x180228[_0x1338cb(0x25f)](_0x58ab48,_0x31eabf);},'DZfdf':_0x5355a7(0x315),'vaStR':function(_0x4b0d7,_0x338a38){return _0x4b0d7===_0x338a38;},'hhdyk':_0x180228[_0x5355a7(0x354)],'vMyIa':function(_0x3e08d5,_0x40b527){const _0x2ea099=_0x5355a7;return _0x180228[_0x2ea099(0x10d)](_0x3e08d5,_0x40b527);},'mLrOw':function(_0x3f57e8,_0x4cef06){return _0x3f57e8/_0x4cef06;},'pvssm':function(_0x2bdf20,_0x4d9d2d){const _0x56b311=_0x5355a7;return _0x180228[_0x56b311(0x2b4)](_0x2bdf20,_0x4d9d2d);},'NyVqX':function(_0x630016,_0x1cebc9){return _0x180228['zoRvu'](_0x630016,_0x1cebc9);},'JAgQo':function(_0x191a0b,_0x28a2f8){const _0x4296e9=_0x5355a7;return _0x180228[_0x4296e9(0x1f0)](_0x191a0b,_0x28a2f8);},'yGgNY':function(_0x5a6a08,_0xfbe3e0){return _0x5a6a08*_0xfbe3e0;},'zElZD':function(_0x124947,_0x32d233,_0x483ea5){return _0x180228['TYYpQ'](_0x124947,_0x32d233,_0x483ea5);},'IzeEz':_0x180228[_0x5355a7(0x1d9)],'BXhnu':_0x180228[_0x5355a7(0x23f)],'ilQcw':function(_0x2462a2,_0x2c44e3){const _0x4fd193=_0x5355a7;return _0x180228[_0x4fd193(0x15d)](_0x2462a2,_0x2c44e3);},'EuhwJ':_0x180228[_0x5355a7(0x152)],'jCHWi':_0x5355a7(0x1d2),'odDGT':_0x5355a7(0x131),'ewbeK':function(_0x5bebfa,_0xee4d5){const _0x1fece9=_0x5355a7;return _0x180228[_0x1fece9(0x2c0)](_0x5bebfa,_0xee4d5);},'uiAaV':function(_0x4251f6,_0x419d33){const _0x4c4193=_0x5355a7;return _0x180228[_0x4c4193(0x283)](_0x4251f6,_0x419d33);},'HFgIR':function(_0x5af4e0,_0x35759e){const _0x1a09f9=_0x5355a7;return _0x180228[_0x1a09f9(0x2d2)](_0x5af4e0,_0x35759e);},'QHCMT':_0x180228[_0x5355a7(0x322)],'CFbIv':function(_0x337d9a,_0x3b8d3a){return _0x180228['QXFQg'](_0x337d9a,_0x3b8d3a);},'xUwdE':_0x180228[_0x5355a7(0x32d)],'kcNII':function(_0x262b4c,_0x4b12c5){const _0xd79e0d=_0x5355a7;return _0x180228[_0xd79e0d(0x2eb)](_0x262b4c,_0x4b12c5);},'YSdly':function(_0x24b0ee,_0x1de768){const _0x129710=_0x5355a7;return _0x180228[_0x129710(0x14d)](_0x24b0ee,_0x1de768);},'BkUdC':function(_0x576820,_0x5e8e68){return _0x180228['AwPFR'](_0x576820,_0x5e8e68);},'vMgPA':function(_0x2c7c9f,_0x56e1b5){const _0x3e8abf=_0x5355a7;return _0x180228[_0x3e8abf(0x1b9)](_0x2c7c9f,_0x56e1b5);},'cLAdq':function(_0x1be33f,_0x3a6c5b){const _0x595324=_0x5355a7;return _0x180228[_0x595324(0x184)](_0x1be33f,_0x3a6c5b);},'KFdgZ':function(_0x2c1047,_0x4e9547){const _0x357b7d=_0x5355a7;return _0x180228[_0x357b7d(0x211)](_0x2c1047,_0x4e9547);},'WJvOL':_0x180228['IoRjB']},{getTrainData:_0x484723,getWorstCaseProductType:_0x1476d6,getProductTrainId:_0x583dee,calculateScores:_0x12b3d9}=_0x596689,_0x4b4915=_0x180228[_0x5355a7(0x235)](_0x484723);if(_0x180228['mIhQJ'](0x0,_0x4b4915[_0x5355a7(0x35b)]))return _0x180228[_0x5355a7(0x235)](hideLoader),void _0x180228[_0x5355a7(0x261)](showCustomAlert,_0x180228['hBUBE'],_0x5355a7(0x1b0));const _0xd1f14c=XLSX[_0x5355a7(0x191)][_0x5355a7(0x326)]();try{const _0x42be84=[];_0x4b4915[_0x5355a7(0x304)](_0x24613e=>{const _0x51838a=_0x5355a7,_0x462bad={'hcHuT':function(_0x13cb2a,_0x4c0072){const _0x1110c6=a16_0x4e51;return _0x1e6474[_0x1110c6(0x1e2)](_0x13cb2a,_0x4c0072);},'AgxON':_0x51838a(0x2dd)},_0x1b9803=_0x1e6474[_0x51838a(0x2bc)](_0x1476d6,_0x24613e['products'][_0x51838a(0xff)](_0xb05852=>_0xb05852[_0x51838a(0x2ea)])),_0x43eded=(a16_0x4cd0f5[_0x51838a(0x1b7)][_0x1b9803]||a16_0x4cd0f5[_0x51838a(0x1b7)][_0x51838a(0x221)])[_0x51838a(0x198)],_0x21d695=_0x1e6474[_0x51838a(0x26a)](_0x24613e[_0x51838a(0x35e)]*_0x24613e[_0x51838a(0x31f)],_0x43eded),_0x584dc9=_0x1e6474[_0x51838a(0x253)](0xa,_0x24613e[_0x51838a(0x247)]);let _0x1be236=_0x1e6474['GeiIt'](0x1,0x0),_0x39e403=_0x1e6474[_0x51838a(0x26a)](0x1,0x0);const _0x1e021f='true'===localStorage[_0x51838a(0x1af)](_0x1e6474[_0x51838a(0x11c)]),_0x1b6b38=_0x1e6474['vaStR']('true',localStorage['getItem'](_0x1e6474[_0x51838a(0x2c5)]));if(_0x1e6474[_0x51838a(0x1ef)](null,_0x24613e['lowestPde'])||_0x1e021f||(_0x1be236=_0x24613e[_0x51838a(0x146)]*_0x24613e['minBsMddRatio']),_0x1e6474[_0x51838a(0x2b7)](null,_0x24613e[_0x51838a(0x287)])&&!_0x1b6b38){const _0x4007d6=_0x1e6474['mLrOw'](0x46*_0x24613e['lowestLd50'],0x7d0),_0x2fe127=_0x24613e[_0x51838a(0x22c)][_0x51838a(0x310)](_0xafa9d5=>_0xafa9d5[_0x51838a(0x251)][_0x51838a(0xff)](_0xc7418c=>_0xc7418c[_0x51838a(0x2d6)]/0x3e8)),_0xba9325=Math[_0x51838a(0x328)](..._0x2fe127);_0x39e403=_0x1e6474['pvssm'](_0x1e6474[_0x51838a(0x288)](_0x1e6474[_0x51838a(0x197)](_0x4007d6,_0x24613e['minMbsKg']),0x3e8),_0x1e6474[_0x51838a(0x35a)](_0x43eded,_0xba9325));}const _0x190bb7=_0x1e6474[_0x51838a(0x20c)](getLargestEssaForLineAndDosageForm,_0x24613e,_0x4b4915),_0x34c837=0.004*_0x190bb7,_0x7beb09=[{'name':_0x1e6474[_0x51838a(0x28d)],'value':_0x21d695},{'name':_0x1e6474[_0x51838a(0x234)],'value':_0x584dc9}];_0x1e6474[_0x51838a(0x148)](null,_0x24613e[_0x51838a(0x146)])||_0x1e021f||_0x7beb09[_0x51838a(0x32a)]({'name':_0x1e6474['EuhwJ'],'value':_0x1be236}),_0x1e6474[_0x51838a(0x148)](null,_0x24613e['lowestLd50'])||_0x1b6b38||_0x7beb09['push']({'name':_0x1e6474['jCHWi'],'value':_0x39e403}),_0x7beb09[_0x51838a(0x32a)]({'name':_0x1e6474[_0x51838a(0x240)],'value':_0x34c837});const _0x2da6a3=_0x7beb09[_0x51838a(0x1b3)]((_0xb828fc,_0x382ba5)=>_0x382ba5['value']<_0xb828fc['value']?_0x382ba5:_0xb828fc),_0x598c6d=_0x2da6a3[_0x51838a(0x340)],_0x54581e=_0x1e6474[_0x51838a(0x357)](_0x190bb7,0x0)?_0x1e6474[_0x51838a(0x338)](_0x598c6d,_0x190bb7):0x0,_0x2f99a8=_0x1e6474['HFgIR'](_0x54581e,_0x24613e['assumedSsa']),_0x38785a=_0x24613e[_0x51838a(0x1a3)][_0x51838a(0xff)](_0x59dd14=>{const _0x5c1b66=_0x51838a,_0x22d846=a16_0x4cd0f5[_0x5c1b66(0x34a)][_0x5c1b66(0x350)](_0x49d732=>_0x49d732['id']===_0x59dd14);return _0x462bad[_0x5c1b66(0x236)](_0x22d846,{'name':_0x5c1b66(0x268)+_0x59dd14+')','machineNumber':_0x462bad[_0x5c1b66(0x21e)]});}),_0x5861a6=_0x24613e['machineIds'][_0x51838a(0xff)](_0x3007e8=>{const _0x125e55=_0x51838a,_0x12c9bf=a16_0x4cd0f5[_0x125e55(0x34a)][_0x125e55(0x350)](_0x5b9db3=>_0x5b9db3['id']===_0x3007e8);return _0x12c9bf?_0x12c9bf[_0x125e55(0x28b)]:'Unknown\x20(ID:\x20'+_0x3007e8+')';})[_0x51838a(0x2f3)](',\x20'),_0x2f4872=_0x24613e[_0x51838a(0x22c)][_0x51838a(0xff)](_0x547ce2=>_0x547ce2[_0x51838a(0x31d)]+'\x20-\x20'+_0x547ce2['name'])[_0x51838a(0x2f3)](';\x20'),_0x3717c4=_0x24613e[_0x51838a(0x1f9)]?_0x24613e['worstProductRpn'][_0x51838a(0x34b)]+'\x20('+_0x24613e[_0x51838a(0x1f9)][_0x51838a(0x353)]+_0x51838a(0x1dd)+_0x24613e[_0x51838a(0x1f9)][_0x51838a(0x1e5)]:_0x51838a(0x2dd);_0x42be84[_0x51838a(0x32a)]({'Train':'T'+(a16_0x185e9e()[_0x51838a(0x139)](_0x1e6474['CRIcO'](String,_0x24613e['id']))?.[_0x51838a(0x1cc)]||_0x24613e['id']),'Total\x20Products':_0x24613e[_0x51838a(0x22c)][_0x51838a(0x35b)],'Total\x20Machines':_0x38785a[_0x51838a(0x35b)],'Total\x20Area\x20(ESSA)\x20cm²':_0x24613e[_0x51838a(0x17f)]['toLocaleString'](),'Products':_0x2f4872,'Machines':_0x5861a6,'Worst-Case\x20Dosage\x20Form':_0x1b9803,'Safety\x20Factor':_0x43eded,'Lowest\x20LTD\x20(mg)':_0x24613e[_0x51838a(0x35e)],'Min\x20Batch\x20Size\x20(kg)':_0x24613e['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x24613e['minBsMddRatio'][_0x51838a(0x29b)](0x2),'Lowest\x20PDE\x20(mg)':_0x1e6474[_0x51838a(0x2b7)](null,_0x24613e[_0x51838a(0x146)])?_0x24613e[_0x51838a(0x146)]:_0x1e6474['QHCMT'],'Worst-Case\x20Product\x20(by\x20RPN)':_0x3717c4,'MACO\x20-\x20Therapeutic\x20Dose\x20(mg)':_0x21d695[_0x51838a(0x29b)](0x2),'MACO\x20-\x2010\x20ppm\x20(mg)':_0x584dc9[_0x51838a(0x29b)](0x2),'MACO\x20-\x20Health-Based\x20(mg)':_0x1e6474[_0x51838a(0x2be)](_0x1e6474['xUwdE'],typeof _0x1be236)?_0x1be236[_0x51838a(0x29b)](0x2):_0x1e6474[_0x51838a(0x227)],'MACO\x20-\x20Visual\x20Clean\x20(mg)':_0x34c837[_0x51838a(0x29b)](0x2),'Selected\x20MACO\x20Method':_0x2da6a3[_0x51838a(0x28b)],'Final\x20MACO\x20(mg)':_0x598c6d['toFixed'](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x54581e[_0x51838a(0x241)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':i(_0x2f99a8)});});const _0x4c820d=XLSX['utils'][_0x5355a7(0x1b8)](_0x42be84);XLSX['utils'][_0x5355a7(0x199)](_0xd1f14c,_0x4c820d,_0x180228['DxLrC']);}catch(_0x1734ce){console[_0x5355a7(0x2a0)](_0x180228[_0x5355a7(0x13d)],_0x1734ce);}try{if(_0x180228[_0x5355a7(0x184)](a16_0x4cd0f5[_0x5355a7(0x30f)][_0x5355a7(0x35b)],0x0)){const _0x5061d2=_0x180228[_0x5355a7(0x2e5)](parseFloat,document[_0x5355a7(0x19d)](_0x180228[_0x5355a7(0x250)])?.[_0x5355a7(0x340)])||0x46,_0x50722e=a16_0x4cd0f5[_0x5355a7(0x30f)][_0x5355a7(0xff)](_0x2406e2=>parseFloat(_0x2406e2[_0x5355a7(0x1df)]))['filter'](_0x354178=>!isNaN(_0x354178)),_0x385ba5=_0x180228[_0x5355a7(0x2c0)](_0x50722e[_0x5355a7(0x35b)],0x0)?Math[_0x5355a7(0x328)](..._0x50722e):0x0,_0x224c23=a16_0x4cd0f5[_0x5355a7(0x30f)][_0x5355a7(0xff)](_0x389b64=>_0x389b64['name'])[_0x5355a7(0x176)](_0x2c9a3b=>''!==_0x2c9a3b['trim']())[_0x5355a7(0x2f3)](',\x20'),_0xef0c6f=[];_0x4b4915[_0x5355a7(0x304)](_0x211006=>{const _0xa50593=_0x5355a7,_0x258108={'WqSxk':_0x1e6474['QHCMT']},_0x2c16dc=_0x1e6474['kcNII'](_0x1476d6,_0x211006[_0xa50593(0x22c)][_0xa50593(0xff)](_0x4d29b4=>_0x4d29b4[_0xa50593(0x2ea)])),_0x30ad0e=a16_0x4cd0f5[_0xa50593(0x1b7)][_0x2c16dc]||a16_0x4cd0f5[_0xa50593(0x1b7)][_0xa50593(0x221)],_0x4c4144=document[_0xa50593(0x19d)]('sf-input-train-'+_0x211006['id']),_0x4e1b98=_0x4c4144&&_0x1e6474['YSdly'](parseFloat,_0x4c4144[_0xa50593(0x340)])||_0x30ad0e[_0xa50593(0x198)],_0x1ebed0=_0x1e6474[_0xa50593(0x1e9)](_0x1e6474['NyVqX'](0.0005,_0x385ba5)*_0x5061d2,_0x4e1b98),_0x209b0f=_0x1e6474['vMgPA'](_0x1ebed0,_0x211006[_0xa50593(0x31f)]),_0x8b5446=getLargestEssaForLineAndDosageForm(_0x211006,_0x4b4915),_0x3a34c5=_0x1e6474[_0xa50593(0x1a5)](_0x8b5446,0x0)?_0x1e6474['BkUdC'](_0x209b0f,_0x8b5446):0x0,_0xc575fa=_0x1e6474[_0xa50593(0x1d6)](_0x3a34c5,_0x211006['assumedSsa']),_0x81227a=_0x211006['machineIds']['map'](_0xc90de4=>{const _0x2fb0dd=a16_0x4cd0f5['machines']['find'](_0x2f2844=>_0x2f2844['id']===_0xc90de4);return _0x2fb0dd||{'name':'Unknown\x20(ID:\x20'+_0xc90de4+')','machineNumber':_0x258108['WqSxk']};}),_0x58b263=_0x211006[_0xa50593(0x1a3)][_0xa50593(0xff)](_0x539bf0=>{const _0x3268ac=_0xa50593,_0x28d113=a16_0x4cd0f5['machines'][_0x3268ac(0x350)](_0x2bb7d0=>_0x2bb7d0['id']===_0x539bf0);return _0x28d113?_0x28d113['name']:_0x3268ac(0x268)+_0x539bf0+')';})['join'](',\x20'),_0x496311=_0x211006['products'][_0xa50593(0xff)](_0xcf2751=>_0xcf2751[_0xa50593(0x31d)]+_0xa50593(0x319)+_0xcf2751['name'])[_0xa50593(0x2f3)](';\x20'),_0x4f3dc2=_0x211006['worstProductRpn']?_0x211006['worstProductRpn'][_0xa50593(0x34b)]+'\x20('+_0x211006[_0xa50593(0x1f9)][_0xa50593(0x353)]+_0xa50593(0x1dd)+_0x211006['worstProductRpn'][_0xa50593(0x1e5)]:_0xa50593(0x2dd);_0xef0c6f[_0xa50593(0x32a)]({'Train':'T'+(a16_0x185e9e()[_0xa50593(0x139)](String(_0x211006['id']))?.[_0xa50593(0x1cc)]||_0x211006['id']),'Total\x20Products':_0x211006['products'][_0xa50593(0x35b)],'Total\x20Machines':_0x81227a['length'],'Total\x20Area\x20(ESSA)\x20cm²':_0x211006[_0xa50593(0x17f)]['toLocaleString'](),'Products':_0x496311,'Machines':_0x58b263,'Worst-Case\x20Dosage\x20Form':_0x2c16dc,'Safety\x20Factor\x20Range':_0x30ad0e[_0xa50593(0x328)]+_0xa50593(0x319)+_0x30ad0e[_0xa50593(0x198)],'Applied\x20Safety\x20Factor':_0x4e1b98,'Detergent\x20Ingredients':_0x224c23,'Body\x20Weight\x20(kg)':_0x5061d2,'Minimum\x20LD50\x20(mg/kg)':_0x385ba5,'Min\x20Batch\x20Size\x20(kg)':_0x211006[_0xa50593(0x247)],'Min\x20BS/MDD\x20Ratio':_0x211006['minBsMddRatio'][_0xa50593(0x29b)](0x2),'Worst-Case\x20Product\x20(by\x20RPN)':_0x4f3dc2,'ADI\x20(mg)':_0x1ebed0[_0xa50593(0x29b)](0x4),'MACO\x20(mg)':_0x209b0f[_0xa50593(0x29b)](0x2),'MACO\x20per\x20Area\x20(mg/cm²)':_0x3a34c5[_0xa50593(0x241)](0x3),'MACO\x20per\x20Swab\x20(mg/Swab)':_0x1e6474['CRIcO'](i,_0xc575fa)});});const _0x1b16e8=XLSX[_0x5355a7(0x191)]['json_to_sheet'](_0xef0c6f);XLSX['utils'][_0x5355a7(0x199)](_0xd1f14c,_0x1b16e8,_0x180228[_0x5355a7(0x164)]);}}catch(_0x6c9c8){console['error'](_0x180228[_0x5355a7(0x2cf)],_0x6c9c8);}try{const _0x8f0a7c=[];_0x4b4915['forEach'](_0x4dbb68=>{const _0x65ac65=_0x5355a7,_0x3b9ccb={'HEKJo':_0x180228[_0x65ac65(0x322)]},_0x1041c9=_0x4dbb68[_0x65ac65(0x1a3)][_0x65ac65(0xff)](_0x239447=>{const _0x4b0318=_0x65ac65,_0x2c876f=a16_0x4cd0f5[_0x4b0318(0x34a)]['find'](_0x42bd8a=>_0x42bd8a['id']===_0x239447);return _0x2c876f||{'id':_0x239447,'name':_0x4b0318(0x268)+_0x239447+')','machineNumber':_0x3b9ccb[_0x4b0318(0x314)]};}),_0x2148ab=_0x4dbb68['machineIds']['map'](_0x46a8b5=>{const _0x3db79a=_0x65ac65,_0x2e55ae=a16_0x4cd0f5[_0x3db79a(0x34a)][_0x3db79a(0x350)](_0x32eac6=>_0x32eac6['id']===_0x46a8b5);return _0x2e55ae?_0x2e55ae['name']:_0x3db79a(0x268)+_0x46a8b5+')';})[_0x65ac65(0x2f3)](',\x20'),_0xf9689d=_0x4dbb68['products']['map'](_0x19023d=>_0x19023d[_0x65ac65(0x31d)]+_0x65ac65(0x319)+_0x19023d['name'])[_0x65ac65(0x2f3)](';\x20'),_0x3092c7=_0x4dbb68['products'][_0x65ac65(0xff)](_0x168226=>_0x168226['productCode']+':\x20'+_0x168226[_0x65ac65(0x28b)])[_0x65ac65(0x2f3)]('\x0a'),_0xa13478=_0x1041c9[_0x65ac65(0xff)](_0x5abd9b=>_0x5abd9b[_0x65ac65(0x15a)]+':\x20'+_0x5abd9b['name'])[_0x65ac65(0x2f3)]('\x0a');_0x8f0a7c['push']({'Train\x20ID':'T'+(_0x180228[_0x65ac65(0x235)](a16_0x185e9e)['get'](_0x180228['NFQZU'](String,_0x4dbb68['id']))?.['number']||_0x4dbb68['id']),'Products\x20Count':_0x4dbb68[_0x65ac65(0x22c)][_0x65ac65(0x35b)],'Machines\x20Count':_0x1041c9[_0x65ac65(0x35b)],'Total\x20Area\x20(ESSA)\x20cm²':_0x4dbb68[_0x65ac65(0x17f)][_0x65ac65(0x15b)](),'Products\x20(Code\x20-\x20Name)':_0xf9689d,'Machines\x20(Number\x20-\x20Name)':_0x2148ab,'Products\x20Detailed':_0x3092c7,'Machines\x20Detailed':_0xa13478,'Min\x20Batch\x20Size\x20(kg)':_0x4dbb68['minMbsKg'],'Min\x20BS/MDD\x20Ratio':_0x4dbb68[_0x65ac65(0x31f)][_0x65ac65(0x29b)](0x2),'Assumed\x20SSA\x20(cm²)':_0x4dbb68[_0x65ac65(0x313)],'Lowest\x20LTD\x20(mg)':_0x4dbb68[_0x65ac65(0x35e)],'Lowest\x20PDE\x20(mg)':null!==_0x4dbb68[_0x65ac65(0x146)]?_0x4dbb68['lowestPde']:_0x180228['bvdHi'],'Worst\x20RPN\x20Product':_0x4dbb68[_0x65ac65(0x1f9)]?_0x4dbb68['worstProductRpn'][_0x65ac65(0x34b)]+'\x20('+_0x4dbb68[_0x65ac65(0x1f9)][_0x65ac65(0x353)]+')\x20-\x20RPN:\x20'+_0x4dbb68['worstProductRpn']['rpn']:_0x180228[_0x65ac65(0x322)]});});const _0x2dba17=XLSX['utils'][_0x5355a7(0x1b8)](_0x8f0a7c);XLSX[_0x5355a7(0x191)]['book_append_sheet'](_0xd1f14c,_0x2dba17,_0x180228['pwevE']);}catch(_0x3f376b){console[_0x5355a7(0x2a0)](_0x180228['LhjJp'],_0x3f376b);}try{const _0x22d616=a16_0x4cd0f5[_0x5355a7(0x22c)][_0x5355a7(0x310)](_0x596430=>{const _0x456ab1=_0x5355a7,_0x205f74=_0x180228[_0x456ab1(0x151)](a16_0x3b78dc,_0x596430);return _0x596430[_0x456ab1(0x251)]['map'](_0x46af96=>({'productName':_0x596430[_0x456ab1(0x28b)],'productCode':_0x596430[_0x456ab1(0x31d)],'ingredientName':_0x46af96[_0x456ab1(0x28b)],'rpn':_0x12b3d9(_0x46af96)[_0x456ab1(0x1e5)],'trainId':_0x456ab1(0x2dd)!==_0x205f74?'T'+_0x205f74:_0x456ab1(0x2dd)}));})['sort']((_0x265df7,_0x101676)=>_0x101676[_0x5355a7(0x1e5)]-_0x265df7[_0x5355a7(0x1e5)])['slice'](0x0,0xa);if(_0x180228[_0x5355a7(0x2c0)](_0x22d616[_0x5355a7(0x35b)],0x0)){const _0x35904c=_0x22d616['map']((_0x2e1756,_0x4935b5)=>({'Rank':_0x4935b5+0x1,'Product\x20Code':_0x2e1756['productCode'],'Product\x20Name':_0x2e1756[_0x5355a7(0x34b)],'Train':_0x2e1756[_0x5355a7(0x21b)],'Ingredient':_0x2e1756[_0x5355a7(0x353)],'RPN':_0x2e1756[_0x5355a7(0x1e5)]})),_0x2969f1=XLSX['utils']['json_to_sheet'](_0x35904c);XLSX[_0x5355a7(0x191)]['book_append_sheet'](_0xd1f14c,_0x2969f1,_0x180228[_0x5355a7(0x2c3)]);}}catch(_0x536a7e){console[_0x5355a7(0x2a0)](_0x180228['sITtG'],_0x536a7e);}try{const _0x369c10=a16_0x4cd0f5[_0x5355a7(0x22c)][_0x5355a7(0x176)](_0x404666=>_0x404666['isCritical']);if(_0x369c10['length']>0x0){const _0x4a5b75=_0x369c10[_0x5355a7(0xff)](_0x5c7b66=>({'Product\x20Code':_0x5c7b66['productCode'],'Product\x20Name':_0x5c7b66[_0x5355a7(0x28b)],'Product\x20Type':_0x5c7b66['productType'],'Batch\x20Size\x20(kg)':_0x5c7b66[_0x5355a7(0x31a)],'MDD\x20(mg)':_0x5c7b66[_0x5355a7(0x2ca)],'Critical\x20Reason':_0x5c7b66[_0x5355a7(0x1c9)]||_0x5355a7(0x2d3),'Train':_0x5355a7(0x2dd)!==a16_0x3b78dc(_0x5c7b66)?'T'+a16_0x3b78dc(_0x5c7b66):_0x5355a7(0x2dd)})),_0x6f25ce=XLSX['utils'][_0x5355a7(0x1b8)](_0x4a5b75);XLSX[_0x5355a7(0x191)]['book_append_sheet'](_0xd1f14c,_0x6f25ce,_0x180228[_0x5355a7(0x12e)]);}}catch(_0x5e7b51){console[_0x5355a7(0x2a0)](_0x180228[_0x5355a7(0x212)],_0x5e7b51);}try{const _0x2007d6=a16_0x4cd0f5[_0x5355a7(0x22c)]['map'](_0x12994b=>{const _0x90606e=_0x5355a7,_0x194802=a16_0x3b78dc(_0x12994b),_0xb48be7=_0x12994b[_0x90606e(0x251)][_0x90606e(0x1b3)]((_0x3cb93b,_0x4041ef)=>{const _0x45726f=_0x90606e,_0x2db428=_0x1e6474[_0x45726f(0x2bc)](_0x12b3d9,_0x4041ef)['rpn'];return _0x2db428>_0x3cb93b[_0x45726f(0x1e5)]?{..._0x4041ef,'rpn':_0x2db428}:_0x3cb93b;},{'rpn':0x0,'name':_0x90606e(0x2dd)});return{'Product\x20Code':_0x12994b[_0x90606e(0x31d)],'Product\x20Name':_0x12994b[_0x90606e(0x28b)],'Product\x20Type':_0x12994b[_0x90606e(0x2ea)],'Batch\x20Size\x20(kg)':_0x12994b[_0x90606e(0x31a)],'MDD\x20(mg)':_0x12994b['mddMg'],'Train':_0x1e6474[_0x90606e(0x227)]!==_0x194802?'T'+_0x194802:_0x1e6474[_0x90606e(0x227)],'Is\x20Critical':_0x12994b[_0x90606e(0x20b)]?_0x1e6474[_0x90606e(0x2a3)]:'No','Critical\x20Reason':_0x12994b[_0x90606e(0x1c9)]||_0x1e6474[_0x90606e(0x227)],'Ingredients\x20Count':_0x12994b[_0x90606e(0x251)][_0x90606e(0x35b)],'Highest\x20RPN\x20Ingredient':_0xb48be7['name'],'Highest\x20RPN\x20Value':_0xb48be7[_0x90606e(0x1e5)]||0x0};}),_0x5e691a=XLSX[_0x5355a7(0x191)][_0x5355a7(0x1b8)](_0x2007d6);XLSX[_0x5355a7(0x191)]['book_append_sheet'](_0xd1f14c,_0x5e691a,_0x180228[_0x5355a7(0x183)]);}catch(_0x862558){console[_0x5355a7(0x2a0)](_0x180228[_0x5355a7(0x123)],_0x862558);}try{const _0x18d2f6=[];a16_0x4cd0f5[_0x5355a7(0x22c)][_0x5355a7(0x304)](_0x64c435=>{const _0x467988=_0x5355a7,_0x8583c2={'CNCkp':_0x180228[_0x467988(0x1ee)],'FuRil':'N/A'},_0xb36b3d=_0x180228[_0x467988(0x171)](a16_0x3b78dc,_0x64c435),_0x58c39d={'Product\x20Code':_0x64c435[_0x467988(0x31d)],'Product\x20Name':_0x64c435[_0x467988(0x28b)],'Product\x20Type':_0x64c435[_0x467988(0x2ea)],'Batch\x20Size\x20(kg)':_0x64c435[_0x467988(0x31a)],'MDD\x20(mg)':_0x64c435[_0x467988(0x2ca)],'Train':_0x180228['HTALr'](_0x467988(0x2dd),_0xb36b3d)?'T'+_0xb36b3d:_0x180228[_0x467988(0x322)],'Is\x20Critical':_0x64c435['isCritical']?_0x180228[_0x467988(0x1b6)]:'No','Critical\x20Reason':_0x64c435['criticalReason']||_0x180228['bvdHi'],'Ingredient\x20Type':_0x180228['dnknI'],'Ingredient\x20Name':'','LTD\x20(mg)':'','PDE\x20(mg)':'','LD50\x20(mg/kg)':'','Severity':'','Occurrence':'','Detection':'','RPN':''};_0x18d2f6[_0x467988(0x32a)](_0x58c39d),_0x64c435[_0x467988(0x251)]['forEach'](_0x150c8d=>{const _0x3ffbaa=_0x467988,_0x519c7e=_0x12b3d9(_0x150c8d);_0x18d2f6[_0x3ffbaa(0x32a)]({'Product\x20Code':'','Product\x20Name':'','Product\x20Type':'','Batch\x20Size\x20(kg)':'','MDD\x20(mg)':'','Train':'','Is\x20Critical':'','Critical\x20Reason':'','Ingredient\x20Type':_0x8583c2[_0x3ffbaa(0x24d)],'Ingredient\x20Name':_0x150c8d[_0x3ffbaa(0x28b)],'LTD\x20(mg)':_0x150c8d[_0x3ffbaa(0x2e6)]||_0x8583c2[_0x3ffbaa(0x28e)],'PDE\x20(mg)':_0x150c8d[_0x3ffbaa(0x2cd)]||'N/A','LD50\x20(mg/kg)':_0x150c8d[_0x3ffbaa(0x1df)]||_0x3ffbaa(0x2dd),'Severity':_0x519c7e[_0x3ffbaa(0x149)],'Occurrence':_0x519c7e['occurrence'],'Detection':_0x519c7e['detection'],'RPN':_0x519c7e['rpn']});});});const _0x652a22=XLSX[_0x5355a7(0x191)][_0x5355a7(0x1b8)](_0x18d2f6);XLSX[_0x5355a7(0x191)][_0x5355a7(0x199)](_0xd1f14c,_0x652a22,_0x5355a7(0x1d5));}catch(_0x48a893){console['error']('Error\x20creating\x20Product\x20Register\x20sheet:',_0x48a893);}const _0x1a5810=new Date()[_0x5355a7(0x335)]()[_0x5355a7(0x13f)]('T')[0x0];XLSX['writeFile'](_0xd1f14c,_0x5355a7(0x2ad)+_0x1a5810+_0x5355a7(0x14f)),hideLoader(),_0x180228[_0x5355a7(0x308)](showCustomAlert,_0x180228[_0x5355a7(0x2bb)],'Complete\x20report\x20with\x20all\x20tabs\x20exported\x20to\x20Excel\x20successfully!');})[_0x2d70bd(0x173)](_0x52fa10=>{const _0x5497ad=_0x2d70bd;console[_0x5497ad(0x2a0)](_0x5497ad(0x277),_0x52fa10),_0x180228[_0x5497ad(0x10e)](hideLoader),_0x180228[_0x5497ad(0x16e)](showCustomAlert,_0x5497ad(0x220),_0x5497ad(0x2f4));});}export function toggleStageSection(_0x4a74bb){const _0x471976=a16_0x2b6eac,_0x3e8a87={'uuYvJ':function(_0x321a4e,_0x1ef4c3){return _0x321a4e===_0x1ef4c3;},'zMWyR':_0x471976(0x32b),'ssSpf':_0x471976(0x214),'JtOOE':_0x471976(0x2af)},_0x472835=document[_0x471976(0x19d)](_0x471976(0x1ff)+_0x4a74bb),_0x4c7f8f=_0x3e8a87['uuYvJ'](_0x3e8a87[_0x471976(0x316)],_0x472835[_0x471976(0x16b)][_0x471976(0x2fc)]);_0x472835[_0x471976(0x16b)][_0x471976(0x2fc)]=_0x4c7f8f?'':_0x471976(0x32b),localStorage[_0x471976(0x30d)]('machineStage-'+_0x4a74bb+'-hidden',!_0x4c7f8f);const _0xa63bba=_0x472835[_0x471976(0x24b)][_0x471976(0x270)](_0x3e8a87[_0x471976(0x2d4)]);_0xa63bba&&(_0xa63bba[_0x471976(0x1f1)]=_0x4c7f8f?_0x3e8a87[_0x471976(0x207)]:_0x471976(0x2f5));}